adodb-csvlib.inc.php:// security - hide paths
adodb-csvlib.inc.php:  V4.54 5 Nov 2004  (c) 2000-2004 John Lim (jlim@natsoft.com.my). All rights reserved.
adodb-csvlib.inc.php:		$max = ($rs) ? $rs->FieldCount() : 0;
adodb-csvlib.inc.php:		if ($max <= 0 || $rs->dataProvider == 'empty') { // is insert/update/delete
adodb-csvlib.inc.php:				$sql .= ','.$conn->Affected_Rows();
adodb-csvlib.inc.php:				$sql .= ','.$conn->Insert_ID();
adodb-csvlib.inc.php:			$text = "====-1,0,$sql\n";
adodb-csvlib.inc.php:		$tt = ($rs->timeCreated) ? $rs->timeCreated : time();
adodb-csvlib.inc.php:		if ($rs->databaseType == 'array') {
adodb-csvlib.inc.php:			$rows =& $rs->_array;
adodb-csvlib.inc.php:			while (!$rs->EOF) {	
adodb-csvlib.inc.php:				$rows[] = $rs->fields;
adodb-csvlib.inc.php:				$rs->MoveNext();
adodb-csvlib.inc.php:			$o =& $rs->FetchField($i);
adodb-csvlib.inc.php:		$savefetch = isset($rs->adodbFetchMode) ? $rs->adodbFetchMode : $rs->fetchMode;
adodb-csvlib.inc.php:		$rs->InitArrayFields($rows,$flds);
adodb-csvlib.inc.php:		$rs->fetchMode = $savefetch;
adodb-csvlib.inc.php:			// $meta[0] is -1 means return an empty recordset
adodb-csvlib.inc.php:				if ($meta[0] == "====-1") {
adodb-csvlib.inc.php:						$err = "Corrupt first line for format -1";
adodb-csvlib.inc.php:					$rs->fields = array();
adodb-csvlib.inc.php:					$rs->timeCreated = $meta[1];
adodb-csvlib.inc.php:					$rs->EOF = true;
adodb-csvlib.inc.php:					$rs->_numOfFields=0;
adodb-csvlib.inc.php:					$rs->sql = urldecode($meta[2]);
adodb-csvlib.inc.php:					$rs->affectedrows = (integer)$meta[3];
adodb-csvlib.inc.php:					$rs->insertid = $meta[4];	
adodb-csvlib.inc.php:			# -4 sec before timeout, give processes 1/32 chance of timing out
adodb-csvlib.inc.php:			# -2 sec before timeout, give processes 1/16 chance of timing out
adodb-csvlib.inc.php:			# -1 sec after timeout give processes 1/4 chance of timing out
adodb-csvlib.inc.php:						$tdiff = (integer)( $meta[1]+$timeout - time());
adodb-csvlib.inc.php:				// new cache format - use serialize extensively...
adodb-csvlib.inc.php:					if (is_object($rs)) $rs->timeCreated = $ttl;
adodb-csvlib.inc.php:						//echo htmlspecialchars($text),' !--END--!<p>';
adodb-csvlib.inc.php:				$fld->name = urldecode($o2[0]);
adodb-csvlib.inc.php:				$fld->type = $o2[1];
adodb-csvlib.inc.php:				$fld->max_length = $o2[2];
adodb-csvlib.inc.php:		$rs->timeCreated = $ttl;
adodb-csvlib.inc.php:		$rs->InitArrayFields($arr,$flds);
adodb-csvlib.inc.php:	# What a stupid need - having to simulate locking.
adodb-csvlib.inc.php:	# 1. $tempfile name is not unique -- very very low
adodb-csvlib.inc.php:	# 2. unlink($filename) fails -- ok, rename will fail
adodb-csvlib.inc.php:	# 3. adodb reads stale file because unlink fails -- ok, $rs timeout occurs
adodb-csvlib.inc.php:	# 4. another process creates $filename between unlink() and rename() -- ok, rename() fails and  cache updated
adodb-csvlib.inc.php:			// getmypid() actually returns 0 on Win98 - never mind!
adodb-datadict.inc.php:  V4.54 5 Nov 2004  (c) 2000-2004 John Lim (jlim@natsoft.com.my). All rights reserved.
adodb-datadict.inc.php:		See adodb/tests/test-datadict.php for docs and examples.
adodb-datadict.inc.php:// security - hide paths
adodb-datadict.inc.php:		return preg_match('/^[a-z0-9]*$/i', $text);
adodb-datadict.inc.php:	@param tokenchars     Include the following characters in tokens apart from A-Z and 0-9 
adodb-datadict.inc.php:function Lens_ParseArgs($args,$endstmtchar=',',$tokenchars='_.-')
adodb-datadict.inc.php:	var $renameColumn = 'ALTER TABLE %s RENAME COLUMN %s TO %s';	// table, old-column, new-column, column-definitions (not used by default)
adodb-datadict.inc.php:		if (!$this->connection->IsConnected()) return array();
adodb-datadict.inc.php:		return $this->connection->MetaTables();
adodb-datadict.inc.php:		if (!$this->connection->IsConnected()) return array();
adodb-datadict.inc.php:		return $this->connection->MetaColumns($this->TableName($tab), $upper, $schema);
adodb-datadict.inc.php:		if (!$this->connection->IsConnected()) return array();
adodb-datadict.inc.php:		return $this->connection->MetaPrimaryKeys($this->TableName($tab), $owner, $intkey);
adodb-datadict.inc.php:		if (!$this->connection->IsConnected()) return array();
adodb-datadict.inc.php:		return $this->connection->MetaIndexes($this->TableName($table), $primary, $owner);
adodb-datadict.inc.php:	function MetaType($t,$len=-1,$fieldobj=false)
adodb-datadict.inc.php:		if ( !is_object($this->connection) ) {
adodb-datadict.inc.php:		$quote = $this->connection->nameQuote;
adodb-datadict.inc.php:		if ( !preg_match('/^[' . $this->nameRegex . ']+$/', $name) ) {
adodb-datadict.inc.php:		if ( $this->schema ) {
adodb-datadict.inc.php:			return $this->NameQuote($this->schema) .'.'. $this->NameQuote($name);
adodb-datadict.inc.php:		return $this->NameQuote($name);
adodb-datadict.inc.php:		$conn = &$this->connection;
adodb-datadict.inc.php:		$saved = $conn->debug;
adodb-datadict.inc.php:			if ($this->debug) $conn->debug = true;
adodb-datadict.inc.php:			$ok = $conn->Execute($line);
adodb-datadict.inc.php:			$conn->debug = $saved;
adodb-datadict.inc.php:				if ($this->debug) ADOConnection::outp($conn->ErrorMsg());
adodb-datadict.inc.php:		T:  Date-time 
adodb-datadict.inc.php:		$options = $this->_Options($options);
adodb-datadict.inc.php:		$s = 'CREATE DATABASE ' . $this->NameQuote($dbname);
adodb-datadict.inc.php:		if (isset($options[$this->upperName]))
adodb-datadict.inc.php:			$s .= ' '.$options[$this->upperName];
adodb-datadict.inc.php:			$flds[$key] = $this->NameQuote($fld);
adodb-datadict.inc.php:		return $this->_IndexSQL($this->NameQuote($idxname), $this->TableName($tabname), $flds, $this->_Options($idxoptions));
adodb-datadict.inc.php:		return array(sprintf($this->dropIndex, $this->NameQuote($idxname), $this->TableName($tabname)));
adodb-datadict.inc.php:		$this->schema = $schema;
adodb-datadict.inc.php:		$tabname = $this->TableName ($tabname);
adodb-datadict.inc.php:		list($lines,$pkey) = $this->_GenFields($flds);
adodb-datadict.inc.php:		$alter = 'ALTER TABLE ' . $tabname . $this->addCol . ' ';
adodb-datadict.inc.php:	 * @param string $tabname table-name
adodb-datadict.inc.php:	 * @param string $flds column-name and type for the changed column
adodb-datadict.inc.php:		$tabname = $this->TableName ($tabname);
adodb-datadict.inc.php:		list($lines,$pkey) = $this->_GenFields($flds);
adodb-datadict.inc.php:		$alter = 'ALTER TABLE ' . $tabname . $this->alterCol . ' ';
adodb-datadict.inc.php:	 * @param string $tabname table-name
adodb-datadict.inc.php:	 * @param string $oldcolumn column-name to be renamed
adodb-datadict.inc.php:	 * @param string $newcolumn new column-name
adodb-datadict.inc.php:	 * @param string $flds='' complete column-defintion-string like for AddColumnSQL, only used by mysql atm., default=''
adodb-datadict.inc.php:		$tabname = $this->TableName ($tabname);
adodb-datadict.inc.php:			list($lines,$pkey) = $this->_GenFields($flds);
adodb-datadict.inc.php:		return array(sprintf($this->renameColumn,$tabname,$this->NameQuote($oldcolumn),$this->NameQuote($newcolumn),$column_def));
adodb-datadict.inc.php:	 * @param string $tabname table-name
adodb-datadict.inc.php:	 * @param string $flds column-name and type for the changed column
adodb-datadict.inc.php:		$tabname = $this->TableName ($tabname);
adodb-datadict.inc.php:		$alter = 'ALTER TABLE ' . $tabname . $this->dropCol . ' ';
adodb-datadict.inc.php:			$sql[] = $alter . $this->NameQuote($v);
adodb-datadict.inc.php:		return array (sprintf($this->dropTable, $this->TableName($tabname)));
adodb-datadict.inc.php:		return array (sprintf($this->renameTable, $this->TableName($tabname),$this->TableName($newname)));
adodb-datadict.inc.php:		list($lines,$pkey) = $this->_GenFields($flds, true);
adodb-datadict.inc.php:		$taboptions = $this->_Options($tableoptions);
adodb-datadict.inc.php:		$tabname = $this->TableName ($tabname);
adodb-datadict.inc.php:		$sql = $this->_TableSQL($tabname,$lines,$pkey,$taboptions);
adodb-datadict.inc.php:		$tsql = $this->_Triggers($tabname,$taboptions);
adodb-datadict.inc.php:		$this->autoIncrement = false;
adodb-datadict.inc.php:			//-----------------
adodb-datadict.inc.php:				case 'TYPE': 	$ty = $v; $ftype = $this->ActualType(strtoupper($v)); break;
adodb-datadict.inc.php:			//--------------------
adodb-datadict.inc.php:				if ($this->debug) ADOConnection::outp("Undefined NAME");
adodb-datadict.inc.php:			$fname = $this->NameQuote($fname);
adodb-datadict.inc.php:				if ($this->debug) ADOConnection::outp("Undefined TYPE for field '$fname'");
adodb-datadict.inc.php:			$ftype = $this->_GetSize($ftype, $ty, $fsize, $fprec);
adodb-datadict.inc.php:			//--------------------
adodb-datadict.inc.php:				if (substr($this->connection->databaseType,0,5) == 'mysql') {
adodb-datadict.inc.php:					$fdefault = $this->connection->sysTimeStamp;
adodb-datadict.inc.php:				if (substr($this->connection->databaseType,0,5) == 'mysql') {
adodb-datadict.inc.php:					$fdefault = $this->connection->sysDate;
adodb-datadict.inc.php:					if (strlen($fdefault) != 1 && substr($fdefault,0,1) == ' ' && substr($fdefault,strlen($fdefault)-1) == ' ') 
adodb-datadict.inc.php:						$fdefault = $this->connection->qstr($fdefault);
adodb-datadict.inc.php:			$suffix = $this->_CreateSuffix($fname,$ftype,$fnotnull,$fdefault,$fautoinc,$fconstraint,$funsigned);
adodb-datadict.inc.php:			if ($fautoinc) $this->autoIncrement = true;
adodb-datadict.inc.php:			$sql[] = sprintf ($this->dropIndex, $idxname);
adodb-datadict.inc.php:		if ( isset($idxoptions[$this->upperName]) )
adodb-datadict.inc.php:			$s .= $idxoptions[$this->upperName];
adodb-datadict.inc.php:			$sql[] = sprintf($this->dropTable,$tabname);
adodb-datadict.inc.php:			if ($this->autoIncrement) {
adodb-datadict.inc.php:				$sInc = $this->_DropAutoIncrement($tabname);
adodb-datadict.inc.php:		if (isset($tableoptions[$this->upperName.'_CONSTRAINTS'])) 
adodb-datadict.inc.php:			$s .= "\n".$tableoptions[$this->upperName.'_CONSTRAINTS'];
adodb-datadict.inc.php:		if (isset($tableoptions[$this->upperName])) $s .= $tableoptions[$this->upperName];
adodb-datadict.inc.php:		used when table has auto-incrementing field that is emulated using triggers
adodb-datadict.inc.php:		$cols = &$this->MetaColumns($tablename);
adodb-datadict.inc.php:			return $this->CreateTableSQL($tablename, $flds, $tableoptions);
adodb-datadict.inc.php:		list($lines,$pkey) = $this->_GenFields($flds);
adodb-datadict.inc.php:		$alter = 'ALTER TABLE ' . $this->TableName($tablename);
adodb-datadict.inc.php:				if ($flds && in_array(strtoupper(substr($flds[0][1],0,4)),$this->invalidResizeTypes4)) continue;	 
adodb-datadict.inc.php:				$sql[] = $alter . $this->alterCol . ' ' . $v;
adodb-datadict.inc.php:				$sql[] = $alter . $this->addCol . ' ' . $v;
adodb-errorhandler.inc.php: * @version V4.54 5 Nov 2004  (c) 2000-2004 John Lim (jlim@natsoft.com.my). All rights reserved.
adodb-errorhandler.inc.php:* @param $p1		$fn specific parameter - see below
adodb-errorhandler.inc.php:* @param $p2		$fn specific parameter - see below
adodb-errorhandler.inc.php:* @param $thisConn	$current connection object - can be false if no connection object created
adodb-errorhandler.inc.php:		$t = date('Y-m-d H:i:s');
adodb-error.inc.php: * @version V4.54 5 Nov 2004 (c) 2000-2004 John Lim (jlim@natsoft.com.my). All rights reserved.
adodb-error.inc.php: * Portions (c)1997-2002 The PHP Group.
adodb-error.inc.php:if (!defined("DB_ERROR")) define("DB_ERROR",-1);
adodb-error.inc.php:	define("DB_ERROR_SYNTAX",              -2);
adodb-error.inc.php:	define("DB_ERROR_CONSTRAINT",          -3);
adodb-error.inc.php:	define("DB_ERROR_NOT_FOUND",           -4);
adodb-error.inc.php:	define("DB_ERROR_ALREADY_EXISTS",      -5);
adodb-error.inc.php:	define("DB_ERROR_UNSUPPORTED",         -6);
adodb-error.inc.php:	define("DB_ERROR_MISMATCH",            -7);
adodb-error.inc.php:	define("DB_ERROR_INVALID",             -8);
adodb-error.inc.php:	define("DB_ERROR_NOT_CAPABLE",         -9);
adodb-error.inc.php:	define("DB_ERROR_TRUNCATED",          -10);
adodb-error.inc.php:	define("DB_ERROR_INVALID_NUMBER",     -11);
adodb-error.inc.php:	define("DB_ERROR_INVALID_DATE",       -12);
adodb-error.inc.php:	define("DB_ERROR_DIVZERO",            -13);
adodb-error.inc.php:	define("DB_ERROR_NODBSELECTED",       -14);
adodb-error.inc.php:	define("DB_ERROR_CANNOT_CREATE",      -15);
adodb-error.inc.php:	define("DB_ERROR_CANNOT_DELETE",      -16);
adodb-error.inc.php:	define("DB_ERROR_CANNOT_DROP",        -17);
adodb-error.inc.php:	define("DB_ERROR_NOSUCHTABLE",        -18);
adodb-error.inc.php:	define("DB_ERROR_NOSUCHFIELD",        -19);
adodb-error.inc.php:	define("DB_ERROR_NEED_MORE_DATA",     -20);
adodb-error.inc.php:	define("DB_ERROR_NOT_LOCKED",         -21);
adodb-error.inc.php:	define("DB_ERROR_VALUE_COUNT_ON_ROW", -22);
adodb-error.inc.php:	define("DB_ERROR_INVALID_DSN",        -23);
adodb-error.inc.php:	define("DB_ERROR_CONNECT_FAILED",     -24);
adodb-error.inc.php:	define("DB_ERROR_EXTENSION_NOT_FOUND",-25);
adodb-error.inc.php:	define("DB_ERROR_NOSUCHDB",           -25);
adodb-error.inc.php:	define("DB_ERROR_ACCESS_VIOLATION",   -26);
adodb-error.inc.php:		include_once(ADODB_DIR."/lang/adodb-$ADODB_LANG.inc.php");
adodb-error.inc.php:            -104 => DB_ERROR_SYNTAX,
adodb-error.inc.php:            -150 => DB_ERROR_ACCESS_VIOLATION,
adodb-error.inc.php:            -151 => DB_ERROR_ACCESS_VIOLATION,
adodb-error.inc.php:            -155 => DB_ERROR_NOSUCHTABLE,
adodb-error.inc.php:            -157 => DB_ERROR_NOSUCHFIELD,
adodb-error.inc.php:            -158 => DB_ERROR_VALUE_COUNT_ON_ROW,
adodb-error.inc.php:            -170 => DB_ERROR_MISMATCH,
adodb-error.inc.php:            -171 => DB_ERROR_MISMATCH,
adodb-error.inc.php:            -172 => DB_ERROR_INVALID,
adodb-error.inc.php:            -204 => DB_ERROR_INVALID,
adodb-error.inc.php:            -205 => DB_ERROR_NOSUCHFIELD,
adodb-error.inc.php:            -206 => DB_ERROR_NOSUCHFIELD,
adodb-error.inc.php:            -208 => DB_ERROR_INVALID,
adodb-error.inc.php:            -219 => DB_ERROR_NOSUCHTABLE,
adodb-error.inc.php:            -297 => DB_ERROR_CONSTRAINT,
adodb-error.inc.php:            -530 => DB_ERROR_CONSTRAINT,
adodb-error.inc.php:            -803 => DB_ERROR_CONSTRAINT,
adodb-error.inc.php:            -551 => DB_ERROR_ACCESS_VIOLATION,
adodb-error.inc.php:            -552 => DB_ERROR_ACCESS_VIOLATION,
adodb-error.inc.php:            -922 => DB_ERROR_NOSUCHDB,
adodb-error.inc.php:            -923 => DB_ERROR_CONNECT_FAILED,
adodb-error.inc.php:            -924 => DB_ERROR_CONNECT_FAILED
adodb-error.inc.php:            '-201'    => DB_ERROR_SYNTAX,
adodb-error.inc.php:            '-206'    => DB_ERROR_NOSUCHTABLE,
adodb-error.inc.php:            '-217'    => DB_ERROR_NOSUCHFIELD,
adodb-error.inc.php:            '-329'    => DB_ERROR_NODBSELECTED,
adodb-error.inc.php:            '-1204'   => DB_ERROR_INVALID_DATE,
adodb-error.inc.php:            '-1205'   => DB_ERROR_INVALID_DATE,
adodb-error.inc.php:            '-1206'   => DB_ERROR_INVALID_DATE,
adodb-error.inc.php:            '-1209'   => DB_ERROR_INVALID_DATE,
adodb-error.inc.php:            '-1210'   => DB_ERROR_INVALID_DATE,
adodb-error.inc.php:            '-1212'   => DB_ERROR_INVALID_DATE
adodb-errorpear.inc.php: * @version V4.50 6 July 2004 (c) 2000-2004 John Lim (jlim@natsoft.com.my). All rights reserved.
adodb-errorpear.inc.php:* @param $p1		$fn specific parameter - see below
adodb-errorpear.inc.php:* @param $P2		$fn specific parameter - see below
adodb-exceptions.inc.php: * @version V4.54 5 Nov 2004  (c) 2000-2004 John Lim (jlim@natsoft.com.my). All rights reserved.
adodb-exceptions.inc.php: * Exception-handling code using PHP5 exceptions (try-catch-throw).
adodb-exceptions.inc.php:			$this->sql = $p1;
adodb-exceptions.inc.php:			$this->params = $p2;
adodb-exceptions.inc.php:			$user = $thisConnection->user;
adodb-exceptions.inc.php:		$this->dbms = $dbms;
adodb-exceptions.inc.php:		$this->host = $thisConnection->host;
adodb-exceptions.inc.php:		$this->database = $thisConnection->database;
adodb-exceptions.inc.php:		$this->fn = $fn;
adodb-exceptions.inc.php:		$this->msg = $errmsg;
adodb-exceptions.inc.php:		if (!is_numeric($errno)) $errno = -1;
adodb-exceptions.inc.php:* @param $p1		$fn specific parameter - see below
adodb-exceptions.inc.php:* @param $P2		$fn specific parameter - see below
adodb.inc.php: * Database specific drivers are stored in the adodb/drivers/adodb-*.inc.php
adodb.inc.php:	 @version V4.54 5 Nov 2004  (c) 2000-2004 John Lim (jlim#natsoft.com.my). All rights reserved.
adodb.inc.php:		$ADODB_COUNTRECS,	// count number of records returned - slows down query
adodb.inc.php:		$ADODB_COMPAT_FETCH, // If $ADODB_COUNTRECS and this is true, $rs->fields is available on EOF
adodb.inc.php:		define('ADODB_BAD_RS','<p>Bad $rs in %s. Connection or SQL invalid. Try using $connection->debug=true;</p>');
adodb.inc.php:		define('ADODB_TABLE_REGEX','([]0-9a-z_\"\`\.\@\[-]*)');
adodb.inc.php:	Controls ADODB_FETCH_ASSOC field-name case. Default is 2, use native case-names.
adodb.inc.php: 		0 = assoc lowercase field names. $rs->fields['orderid']
adodb.inc.php:		1 = assoc uppercase field names. $rs->fields['ORDERID']
adodb.inc.php:		2 = use native-case field names. $rs->fields['OrderID']
adodb.inc.php:		// PHP's version scheme makes converting to numbers difficult - workaround
adodb.inc.php:		$ADODB_COUNTRECS,	// count number of records returned - slows down query
adodb.inc.php:		$ADODB_vers = 'V4.54 5 Nov 2004  (c) 2000-2004 John Lim (jlim#natsoft.com.my). All rights reserved. Released BSD & LGPL.';
adodb.inc.php:		 * Determines whether recordset->RecordCount() is used. 
adodb.inc.php:		 * Set to false for highest performance -- RecordCount() will always return -1 then
adodb.inc.php:	 * Helper class for FetchFields -- holds info on a column
adodb.inc.php:		// actually, this has already been built-in in the postgres, fbsql AND mysql module? ^-^
adodb.inc.php:		$thisConnection->_transOK = false;
adodb.inc.php:		if ($thisConnection->_oldRaiseFn) {
adodb.inc.php:			$fn = $thisConnection->_oldRaiseFn;
adodb.inc.php:	var $maxblobsize = 262144; 	/// maximum size of blobs or large text fields (262144 = 256K)-- some db's die otherwise like foxpro
adodb.inc.php:	var $concat_operator = '+'; /// default concat operator -- change to || for Oracle/Interbase	
adodb.inc.php:	var $fmtDate = "'Y-m-d'";	/// used by DBDate() as the default date format used by the database
adodb.inc.php:	var $fmtTimeStamp = "'Y-m-d, h:i:s A'"; /// used by DBTimeStamp as the default timestamp fmt.
adodb.inc.php:	var $charSet=false; 		/// character set to use - only for interbase, postgres and oci8
adodb.inc.php:	//--
adodb.inc.php:	var $readOnly = false; 			/// this is a readonly database - used by phpLens
adodb.inc.php:	//--
adodb.inc.php:	var $arrayClass = 'ADORecordSet_array'; /// name of class used to generate array recordsets, which are pre-downloaded recordsets
adodb.inc.php:	var $noNullStrings = false; /// oracle specific stuff - if true ensures that '' is converted to ' '
adodb.inc.php:	var $autoCommit = true; 	/// do not modify this yourself - actually private
adodb.inc.php:	var $_errorCode = false;	/// Last error code, not guaranteed to be used - only by oci8					
adodb.inc.php:		die('Virtual Class -- cannot instantiate');
adodb.inc.php:    	return !empty($this->_connectionID);
adodb.inc.php:		if (preg_match('/([0-9]+\.([0-9\.])+)/',$str, $arr)) return $arr[1];
adodb.inc.php:		if (!empty($ADODB_FLUSH) && ob_get_length() !== false) flush(); //  do not flush if output buffering enabled - useless - thx to Jesse Mullan 
adodb.inc.php:		$rs =& $this->_Execute("select $this->sysTimeStamp");
adodb.inc.php:		if ($rs && !$rs->EOF) return $this->UnixTimeStamp(reset($rs->fields));
adodb.inc.php:		if ($argHostname != "") $this->host = $argHostname;
adodb.inc.php:		if ($argUsername != "") $this->user = $argUsername;
adodb.inc.php:		if ($argPassword != "") $this->password = $argPassword; // not stored for security reasons
adodb.inc.php:		if ($argDatabaseName != "") $this->database = $argDatabaseName;		
adodb.inc.php:		$this->_isPersistentConnection = false;	
adodb.inc.php:			if ($this->_nconnect($this->host, $this->user, $this->password, $this->database)) return true;
adodb.inc.php:			 if ($this->_connect($this->host, $this->user, $this->password, $this->database)) return true;
adodb.inc.php:		$err = $this->ErrorMsg();
adodb.inc.php:		if ($fn = $this->raiseErrorFn) 
adodb.inc.php:			$fn($this->databaseType,'CONNECT',$this->ErrorNo(),$err,$this->host,$this->database,$this);
adodb.inc.php:		$this->_connectionID = false;
adodb.inc.php:		if ($this->debug) ADOConnection::outp( $this->host.': '.$err);
adodb.inc.php:		return $this->_connect($argHostname, $argUsername, $argPassword, $argDatabaseName);
adodb.inc.php:	 * Always force a new connection to database - currently only works with oracle
adodb.inc.php:		return $this->Connect($argHostname, $argUsername, $argPassword, $argDatabaseName, true);
adodb.inc.php:			return $this->Connect($argHostname,$argUsername,$argPassword,$argDatabaseName);
adodb.inc.php:		if ($argHostname != "") $this->host = $argHostname;
adodb.inc.php:		if ($argUsername != "") $this->user = $argUsername;
adodb.inc.php:		if ($argPassword != "") $this->password = $argPassword;
adodb.inc.php:		if ($argDatabaseName != "") $this->database = $argDatabaseName;		
adodb.inc.php:		$this->_isPersistentConnection = true;	
adodb.inc.php:		if ($this->_pconnect($this->host, $this->user, $this->password, $this->database)) return true;
adodb.inc.php:		$err = $this->ErrorMsg();
adodb.inc.php:		if ($fn = $this->raiseErrorFn) {
adodb.inc.php:			$fn($this->databaseType,'PCONNECT',$this->ErrorNo(),$err,$this->host,$this->database,$this);
adodb.inc.php:		$this->_connectionID = false;
adodb.inc.php:		if ($this->debug) ADOConnection::outp( $this->host.': '.$err);
adodb.inc.php:		if (!$col) $col = $this->sysDate;
adodb.inc.php:	 *   $stmt = $db->Prepare("insert into table (id, name) values (?,?)");
adodb.inc.php:	 *   $db->Execute($stmt,array(1,'Jill')) or die('insert failed');
adodb.inc.php:	 *   $db->Execute($stmt,array(2,'Joe')) or die('insert failed');
adodb.inc.php:		return $this->Prepare($sql,$param);
adodb.inc.php:		return $this->qstr($s,false);
adodb.inc.php:		return $this->qstr($s,get_magic_quotes_gpc());
adodb.inc.php:		$s = $this->qstr($s,false);
adodb.inc.php:	* PEAR DB Compat - do not use internally. 
adodb.inc.php:		return $this->ErrorNo();
adodb.inc.php:	* PEAR DB Compat - do not use internally. 
adodb.inc.php:		return $this->GenID($seq_name);
adodb.inc.php:		return $this->CommitTrans();
adodb.inc.php:		return $this->RollbackTrans();
adodb.inc.php:	* PEAR DB Compat - do not use internally. 
adodb.inc.php:	* 	for easy porting :-)
adodb.inc.php:		$old = $this->fetchMode;
adodb.inc.php:		$this->fetchMode = $mode;
adodb.inc.php:	* PEAR DB Compat - do not use internally. 
adodb.inc.php:		$rs = &$this->Execute($sql, $inputarr);
adodb.inc.php:	* PEAR DB Compat - do not use internally
adodb.inc.php:		$rs = &$this->SelectLimit($sql, $count, $offset, $params); 
adodb.inc.php:	* PEAR DB Compat - do not use internally
adodb.inc.php:		return $this->Close();
adodb.inc.php:		 $DB->Param('a')
adodb.inc.php:		InParameter and OutParameter are self-documenting versions of Parameter().
adodb.inc.php:		return $this->Parameter($stmt,$var,$name,false,$maxLen,$type);
adodb.inc.php:		return $this->Parameter($stmt,$var,$name,true,$maxLen,$type);
adodb.inc.php:		$stmt = $db->Prepare('select * from table where id =:myid and group=:group');
adodb.inc.php:		$db->Parameter($stmt,$id,'myid');
adodb.inc.php:		$db->Parameter($stmt,$group,'group',64);
adodb.inc.php:		$db->Execute();
adodb.inc.php:		b. CompleteTrans auto-detects SQL errors, and will rollback on errors, commit otherwise.<br>
adodb.inc.php:		if ($this->transOff > 0) {
adodb.inc.php:			$this->transOff += 1;
adodb.inc.php:		$this->_oldRaiseFn = $this->raiseErrorFn;
adodb.inc.php:		$this->raiseErrorFn = $errfn;
adodb.inc.php:		$this->_transOK = true;
adodb.inc.php:		if ($this->debug && $this->transCnt > 0) ADOConnection::outp("Bad Transaction: StartTrans called within BeginTrans");
adodb.inc.php:		$this->BeginTrans();
adodb.inc.php:		$this->transOff = 1;
adodb.inc.php:		if ($this->transOff > 1) {
adodb.inc.php:			$this->transOff -= 1;
adodb.inc.php:		$this->raiseErrorFn = $this->_oldRaiseFn;
adodb.inc.php:		$this->transOff = 0;
adodb.inc.php:		if ($this->_transOK && $autoComplete) {
adodb.inc.php:			if (!$this->CommitTrans()) {
adodb.inc.php:				$this->_transOK = false;
adodb.inc.php:				if ($this->debug) ADOConnection::outp("Smart Commit failed");
adodb.inc.php:				if ($this->debug) ADOConnection::outp("Smart Commit occurred");
adodb.inc.php:			$this->RollbackTrans();
adodb.inc.php:			if ($this->debug) ADOCOnnection::outp("Smart Rollback occurred");
adodb.inc.php:		return $this->_transOK;
adodb.inc.php:		if ($this->debug) 
adodb.inc.php:			if ($this->transOff == 0) {
adodb.inc.php:		$this->_transOK = false;
adodb.inc.php:		if ($this->transOff > 0) return $this->_transOK == false;
adodb.inc.php:		if ($this->fnExecute) {
adodb.inc.php:			$fn = $this->fnExecute;
adodb.inc.php:			if (!is_array($sql) && !$this->_bindInputArray) {
adodb.inc.php:							$sql .= $this->qstr($v);
adodb.inc.php:					$ret =& $this->_Execute($sql);
adodb.inc.php:					$stmt = $this->Prepare($sql);
adodb.inc.php:						$ret =& $this->_Execute($stmt,$arr);
adodb.inc.php:					$ret =& $this->_Execute($sql,$inputarr);
adodb.inc.php:			$ret =& $this->_Execute($sql,false);
adodb.inc.php:		if ($this->debug) {
adodb.inc.php:			if (empty($ADODB_INCLUDED_LIB)) include_once(ADODB_DIR.'/adodb-lib.inc.php');
adodb.inc.php:			$this->_queryID = _adodb_debug_execute($this, $sql,$inputarr);
adodb.inc.php:			$this->_queryID = @$this->_query($sql,$inputarr);
adodb.inc.php:		if ($this->_queryID === false) { // error handling if query fails
adodb.inc.php:			if ($this->debug == 99) adodb_backtrace(true,5);	
adodb.inc.php:			$fn = $this->raiseErrorFn;
adodb.inc.php:				$fn($this->databaseType,'EXECUTE',$this->ErrorNo(),$this->ErrorMsg(),$sql,$inputarr,$this);
adodb.inc.php:		if ($this->_queryID === true) { // return simplified recordset for inserts/updates/deletes with lower overhead
adodb.inc.php:		$rsclass = $this->rsPrefix.$this->databaseType;
adodb.inc.php:		$rs =& new $rsclass($this->_queryID,$this->fetchMode);
adodb.inc.php:		$rs->connection = &$this; // Pablo suggestion
adodb.inc.php:		$rs->Init();
adodb.inc.php:		if (is_array($sql)) $rs->sql = $sql[0];
adodb.inc.php:		else $rs->sql = $sql;
adodb.inc.php:		if ($rs->_numOfRows <= 0) {
adodb.inc.php:				if (!$rs->EOF) { 
adodb.inc.php:					$rs = &$this->_rs2rs($rs,-1,-1,!is_array($sql));
adodb.inc.php:					$rs->_queryID = $this->_queryID;
adodb.inc.php:					$rs->_numOfRows = 0;
adodb.inc.php:		if (empty($this->_genSeqSQL)) return false;
adodb.inc.php:		return $this->Execute(sprintf($this->_genSeqSQL,$seqname,$startID));
adodb.inc.php:		if (empty($this->_dropSeqSQL)) return false;
adodb.inc.php:		return $this->Execute(sprintf($this->_dropSeqSQL,$seqname));
adodb.inc.php:	 * Generates a sequence id and stores it in $this->genID;
adodb.inc.php:	 * GenID is only available if $this->hasGenID = true;
adodb.inc.php:		if (!$this->hasGenID) {
adodb.inc.php:		$getnext = sprintf($this->_genIDSQL,$seqname);
adodb.inc.php:		$holdtransOK = $this->_transOK;
adodb.inc.php:		@($rs = $this->Execute($getnext));
adodb.inc.php:			$this->_transOK = $holdtransOK; //if the status was ok before reset
adodb.inc.php:			$createseq = $this->Execute(sprintf($this->_genSeqSQL,$seqname,$startID));
adodb.inc.php:			$rs = $this->Execute($getnext);
adodb.inc.php:		if ($rs && !$rs->EOF) $this->genID = reset($rs->fields);
adodb.inc.php:		else $this->genID = 0; // false
adodb.inc.php:		if ($rs) $rs->Close();
adodb.inc.php:		return $this->genID;
adodb.inc.php:		if ($this->_logsql && $this->lastInsID) return $this->lastInsID;
adodb.inc.php:		if ($this->hasInsertID) return $this->_insertid($table,$column);
adodb.inc.php:		if ($this->debug) {
adodb.inc.php:	   if ($this->hasInsertID){
adodb.inc.php:		   return $this->Insert_ID($table,$id);
adodb.inc.php:		   return $this->GetOne("SELECT MAX($id) FROM $table");
adodb.inc.php:		if ($this->hasAffectedRows) {
adodb.inc.php:			if ($this->fnExecute === 'adodb_log_sql') {
adodb.inc.php:				if ($this->_logsql && $this->_affected !== false) return $this->_affected;
adodb.inc.php:			$val = $this->_affectedrows();
adodb.inc.php:		if ($this->debug) ADOConnection::outp( '<p>Affected_Rows error</p>',false);
adodb.inc.php:		return '!! '.strtoupper($this->dataProvider.' '.$this->databaseType).': '.$this->_errorMsg;
adodb.inc.php:		return ($this->_errorMsg) ? -1 : 0;
adodb.inc.php:		include_once(ADODB_DIR."/adodb-error.inc.php");
adodb.inc.php:		if ($err === false) $err = $this->ErrorNo();
adodb.inc.php:		return adodb_error($this->dataProvider,$this->databaseType,$err);
adodb.inc.php:		include_once(ADODB_DIR."/adodb-error.inc.php");
adodb.inc.php:	// owner not used in base class - see oci8
adodb.inc.php:		$objs =& $this->MetaColumns($table);
adodb.inc.php:				if (!empty($v->primary_key))
adodb.inc.php:					$p[] = $v->name;
adodb.inc.php:			return ADODB_VIEW_PRIMARYKEYS($this->databaseType, $this->database, $table, $owner);
adodb.inc.php:	* Will select, getting rows from $offset (1-based), for $nrows. 
adodb.inc.php:	*  SelectLimit('select * from table',3); will return rows 1 to 3 (1-based)
adodb.inc.php:	*  SelectLimit('select * from table',3,2); will return rows 3 to 5 (1-based)
adodb.inc.php:	* Uses SELECT TOP for Microsoft databases (when $this->hasTop is set)
adodb.inc.php:	* @param [offset]	is the row to start calculations from (1-based)
adodb.inc.php:	* @return		the recordset ($rs->databaseType == 'array')
adodb.inc.php:	function &SelectLimit($sql,$nrows=-1,$offset=-1, $inputarr=false,$secs2cache=0)
adodb.inc.php:		if ($this->hasTop && $nrows > 0) {
adodb.inc.php:		 // Informix requires first before distinct - F Riosa
adodb.inc.php:			$ismssql = (strpos($this->databaseType,'mssql') !== false);
adodb.inc.php:			else $isaccess = (strpos($this->databaseType,'access') !== false);
adodb.inc.php:						'/(^\s*select\s+(distinctrow|distinct)?)/i','\\1 '.$this->hasTop.' '.$nrows.' ',$sql);
adodb.inc.php:							$ret =& $this->CacheExecute($secs2cache, $sql,$inputarr);
adodb.inc.php:							$ret =& $this->Execute($sql,$inputarr);
adodb.inc.php:						'/(^\s*select\s+(distinctrow|distinct)?)/i','\\1 '.$this->hasTop.' '.$nrows.' ',$sql);
adodb.inc.php:						'/(^\s*select\s)/i','\\1 '.$this->hasTop.' '.$nrows.' ',$sql);
adodb.inc.php:					'/(^\s*select\s+(distinctrow|distinct)?)/i','\\1 '.$this->hasTop.' '.$nn.' ',$sql);
adodb.inc.php:					'/(^\s*select\s)/i','\\1 '.$this->hasTop.' '.$nn.' ',$sql);
adodb.inc.php:		// 0 to offset-1 which will be discarded anyway. So we disable $ADODB_COUNTRECS.
adodb.inc.php:			if ($secs2cache>0) $rs = &$this->CacheExecute($secs2cache,$sql,$inputarr);
adodb.inc.php:			else $rs = &$this->Execute($sql,$inputarr);
adodb.inc.php:			if ($secs2cache>0) $rs = &$this->CacheExecute($secs2cache,$sql,$inputarr);
adodb.inc.php:			else $rs = &$this->Execute($sql,$inputarr);
adodb.inc.php:		if ($rs && !$rs->EOF) {
adodb.inc.php:			$rs =& $this->_rs2rs($rs,$nrows,$offset);
adodb.inc.php:		$rs2 =& $this->_rs2rs($rs);
adodb.inc.php:		$rs2->connection =& $ignore;
adodb.inc.php:	function &_rs2rs(&$rs,$nrows=-1,$offset=-1,$close=true)
adodb.inc.php:		$dbtype = $rs->databaseType;
adodb.inc.php:			$rs = &$rs;  // required to prevent crashing in 4.2.1, but does not happen in 4.3.1 -- why ?
adodb.inc.php:		if (($dbtype == 'array' || $dbtype == 'csv') && $nrows == -1 && $offset == -1) {
adodb.inc.php:			$rs->MoveFirst();
adodb.inc.php:			$rs = &$rs; // required to prevent crashing in 4.2.1, but does not happen in 4.3.1-- why ?
adodb.inc.php:		for ($i=0, $max=$rs->FieldCount(); $i < $max; $i++) {
adodb.inc.php:			$flds[] = $rs->FetchField($i);
adodb.inc.php:		$arr =& $rs->GetArrayLimit($nrows,$offset);
adodb.inc.php:		if ($close) $rs->Close();
adodb.inc.php:		$arrayClass = $this->arrayClass;
adodb.inc.php:		$rs2->connection = &$this;
adodb.inc.php:		$rs2->sql = $rs->sql;
adodb.inc.php:		$rs2->dataProvider = $this->dataProvider;
adodb.inc.php:		$rs2->InitArrayFields($arr,$flds);
adodb.inc.php:		$rs2->fetchMode = isset($rs->adodbFetchMode) ? $rs->adodbFetchMode : $rs->fetchMode;
adodb.inc.php:		$arr =& $this->GetArray($sql,$inputarr);
adodb.inc.php:		$rs =& $this->Execute($sql, $inputarr);
adodb.inc.php:		$arr =& $rs->GetAssoc($force_array,$first2cols);
adodb.inc.php:		$rs =& $this->CacheExecute($secs2cache, $sql, $inputarr);
adodb.inc.php:		$arr =& $rs->GetAssoc($force_array,$first2cols);
adodb.inc.php:		$rs = &$this->Execute($sql,$inputarr);
adodb.inc.php:			if (!$rs->EOF) $ret = reset($rs->fields);
adodb.inc.php:			$rs->Close();
adodb.inc.php:		$rs = &$this->CacheExecute($secs2cache,$sql,$inputarr);
adodb.inc.php:			if (!$rs->EOF) $ret = reset($rs->fields);
adodb.inc.php:			$rs->Close();
adodb.inc.php:	  	$rs = &$this->Execute($sql, $inputarr);
adodb.inc.php:				while (!$rs->EOF) {
adodb.inc.php:					$rv[] = trim(reset($rs->fields));
adodb.inc.php:					$rs->MoveNext();
adodb.inc.php:				while (!$rs->EOF) {
adodb.inc.php:					$rv[] = reset($rs->fields);
adodb.inc.php:					$rs->MoveNext();
adodb.inc.php:	   		$rs->Close();
adodb.inc.php:	  	$rs = &$this->CacheExecute($secs, $sql, $inputarr);
adodb.inc.php:				while (!$rs->EOF) {
adodb.inc.php:					$rv[] = trim(reset($rs->fields));
adodb.inc.php:					$rs->MoveNext();
adodb.inc.php:				while (!$rs->EOF) {
adodb.inc.php:					$rv[] = reset($rs->fields);
adodb.inc.php:					$rs->MoveNext();
adodb.inc.php:	   		$rs->Close();
adodb.inc.php:		if (!$date) $date = $this->sysDate;
adodb.inc.php:		$rs =& $this->Execute($sql,$inputarr);
adodb.inc.php:		$arr =& $rs->GetArray();
adodb.inc.php:		$rs->Close();
adodb.inc.php:		return $this->CacheGetArray($secs2cache,$sql,$inputarr);
adodb.inc.php:		$rs =& $this->CacheExecute($secs2cache,$sql,$inputarr);
adodb.inc.php:		$arr =& $rs->GetArray();
adodb.inc.php:		$rs->Close();
adodb.inc.php:		$rs =& $this->Execute($sql,$inputarr);
adodb.inc.php:			if (!$rs->EOF) $arr = $rs->fields;
adodb.inc.php:			$rs->Close();
adodb.inc.php:		$rs =& $this->CacheExecute($secs2cache,$sql,$inputarr);
adodb.inc.php:			if (!$rs->EOF) $arr = $rs->fields;
adodb.inc.php:			$rs->Close();
adodb.inc.php:	* ADOdb's Replace() uses update-insert semantics, not insert-delete-duplicates of MySQL.
adodb.inc.php:	* $this->Replace('products', array('prodname' =>"'Nails'","price" => 3.99), 'prodname');
adodb.inc.php:	* has_autoinc	the primary key is an auto-inc field, so skip in insert.
adodb.inc.php:		if (empty($ADODB_INCLUDED_LIB)) include_once(ADODB_DIR.'/adodb-lib.inc.php');
adodb.inc.php:	* Will select, getting rows from $offset (1-based), for $nrows. 
adodb.inc.php:	*  CacheSelectLimit(15,'select * from table',3); will return rows 1 to 3 (1-based)
adodb.inc.php:	*  CacheSelectLimit(15,'select * from table',3,2); will return rows 3 to 5 (1-based)
adodb.inc.php:	* @param [offset]	is the row to start calculations from (1-based)
adodb.inc.php:	* @return		the recordset ($rs->databaseType == 'array')
adodb.inc.php:	function &CacheSelectLimit($secs2cache,$sql,$nrows=-1,$offset=-1,$inputarr=false)
adodb.inc.php:			if ($sql === false) $sql = -1;
adodb.inc.php:			if ($offset == -1) $offset = false;
adodb.inc.php:			$rs =& $this->SelectLimit($secs2cache,$sql,$nrows,$offset,$this->cacheSecs);
adodb.inc.php:			$rs =& $this->SelectLimit($sql,$nrows,$offset,$inputarr,$secs2cache);
adodb.inc.php:				$cmd = 'rm -rf '.$ADODB_CACHE_DIR.'/??/adodb_*.cache'; 
adodb.inc.php:				// old version 'rm -f `find '.$ADODB_CACHE_DIR.' -name adodb_*.cache`';
adodb.inc.php:			if ($this->debug) {
adodb.inc.php:		if (empty($ADODB_INCLUDED_CSV)) include_once(ADODB_DIR.'/adodb-csvlib.inc.php');
adodb.inc.php:		$f = $this->_gencachename($sql.serialize($inputarr),false);
adodb.inc.php:			if ($this->debug) ADOConnection::outp( "CacheFlush: failed for $f");
adodb.inc.php:	*  - sql statement
adodb.inc.php:	*  - database type (oci8, ibase, ifx, etc)
adodb.inc.php:	*  - database name
adodb.inc.php:	*  - userid
adodb.inc.php:	*  - setFetchMode (adodb 4.23)
adodb.inc.php:	* When not in safe mode, we create 256 sub-directories in the cache directory ($ADODB_CACHE_DIR). 
adodb.inc.php:		if ($this->fetchMode === false) { 
adodb.inc.php:			$mode = $this->fetchMode;
adodb.inc.php:		$m = md5($sql.$this->databaseType.$this->database.$this->user.$mode);
adodb.inc.php:				if ($this->debug) ADOConnection::outp( "Unable to mkdir $dir for $sql");
adodb.inc.php:			$secs2cache = $this->cacheSecs;
adodb.inc.php:		if (empty($ADODB_INCLUDED_CSV)) include_once(ADODB_DIR.'/adodb-csvlib.inc.php');
adodb.inc.php:		$md5file = $this->_gencachename($sql.serialize($inputarr),true);
adodb.inc.php:			$this->numCacheHits += 1;
adodb.inc.php:			$this->numCacheMisses += 1;
adodb.inc.php:			if ($this->debug) {
adodb.inc.php:					ADOConnection::outp("Please disable magic_quotes_runtime - it corrupts cache files :(");
adodb.inc.php:				if ($this->debug !== -1) ADOConnection::outp( " $md5file cache failure: $err (see sql below)");
adodb.inc.php:			$rs = &$this->Execute($sql,$inputarr);
adodb.inc.php:				$eof = $rs->EOF;
adodb.inc.php:				$rs = &$this->_rs2rs($rs); // read entire recordset into memory immediately
adodb.inc.php:				if (!adodb_write_file($md5file,$txt,$this->debug)) {
adodb.inc.php:					if ($fn = $this->raiseErrorFn) {
adodb.inc.php:						$fn($this->databaseType,'CacheExecute',-32000,"Cache write error",$md5file,$sql,$this);
adodb.inc.php:					if ($this->debug) ADOConnection::outp( " Cache write error");
adodb.inc.php:				if ($rs->EOF && !$eof) {
adodb.inc.php:					$rs->MoveFirst();
adodb.inc.php:					$rs->connection = &$this; // Pablo suggestion
adodb.inc.php:			$this->_errorMsg = '';
adodb.inc.php:			$this->_errorCode = 0;
adodb.inc.php:			if ($this->fnCacheExecute) {
adodb.inc.php:				$fn = $this->fnCacheExecute;
adodb.inc.php:			$rs->connection = &$this; // Pablo suggestion
adodb.inc.php:			if ($this->debug){ 
adodb.inc.php:				$ttl = $rs->timeCreated + $secs2cache - time();
adodb.inc.php:		if (empty($ADODB_INCLUDED_LIB)) include_once(ADODB_DIR.'/adodb-lib.inc.php');
adodb.inc.php:		if (empty($ADODB_INCLUDED_LIB)) include_once(ADODB_DIR.'/adodb-lib.inc.php');
adodb.inc.php:	*	$conn->Execute('INSERT INTO blobtable (id, blobcol) VALUES (1, null)');
adodb.inc.php:	*	$conn->UpdateBlob('blobtable','blobcol',$blob,'id=1');
adodb.inc.php:		return $this->Execute("UPDATE $table SET $column=? WHERE $where",array($val)) != false;
adodb.inc.php:	*	$conn->Execute('INSERT INTO blobtable (id, blobcol) VALUES (1, null)');
adodb.inc.php:	*	$conn->UpdateBlob('blobtable','blobcol',$blobpath,'id=1');
adodb.inc.php:		return $this->UpdateBlob($table,$column,$val,$where,$blobtype);
adodb.inc.php:		include_once(ADODB_DIR.'/adodb-perf.inc.php');
adodb.inc.php:		if ($enable) $this->fnExecute = 'adodb_log_sql';
adodb.inc.php:		else $this->fnExecute = false;
adodb.inc.php:		$old = $this->_logsql;	
adodb.inc.php:		$this->_logsql = $enable;
adodb.inc.php:		if ($enable && !$old) $this->_affected = false;
adodb.inc.php:	*	$conn->Execute('INSERT INTO clobtable (id, clobcol) VALUES (1, null)');
adodb.inc.php:	*	$conn->UpdateClob('clobtable','clobcol',$clob,'id=1');
adodb.inc.php:		return $this->UpdateBlob($table,$column,$val,$where,'CLOB');
adodb.inc.php:		$this->locale = $locale;
adodb.inc.php:				$this->fmtDate="'Y-m-d'";
adodb.inc.php:				$this->fmtTimeStamp = "'Y-m-d H:i:s'";
adodb.inc.php:				$this->fmtDate="'d-m-Y'";
adodb.inc.php:				$this->fmtTimeStamp = "'d-m-Y H:i:s'";
adodb.inc.php:				$this->fmtDate="'d.m.Y'";
adodb.inc.php:				$this->fmtTimeStamp = "'d.m.Y H:i:s'";
adodb.inc.php:		$rez = $this->_close();
adodb.inc.php:		$this->_connectionID = false;
adodb.inc.php:			if ($this->metaDatabasesSQL) {
adodb.inc.php:				if ($this->fetchMode !== false) $savem = $this->SetFetchMode(false);
adodb.inc.php:				$arr = $this->GetCol($this->metaDatabasesSQL);
adodb.inc.php:				if (isset($savem)) $this->SetFetchMode($savem);
adodb.inc.php:	 * @param mask  is the input mask - only supported by oci8 and postgresql
adodb.inc.php:		if ($this->metaTablesSQL) {
adodb.inc.php:			if ($this->fetchMode !== false) $savem = $this->SetFetchMode(false);
adodb.inc.php:			$rs = $this->Execute($this->metaTablesSQL);
adodb.inc.php:			if (isset($savem)) $this->SetFetchMode($savem);
adodb.inc.php:			$arr =& $rs->GetArray();
adodb.inc.php:			$rs->Close();
adodb.inc.php:	 * @schema is optional database schema to use - not supported by all databases.
adodb.inc.php:		if (!empty($this->metaColumnsSQL)) {
adodb.inc.php:			$this->_findschema($table,$schema);
adodb.inc.php:			if ($this->fetchMode !== false) $savem = $this->SetFetchMode(false);
adodb.inc.php:			$rs = $this->Execute(sprintf($this->metaColumnsSQL,($upper)?strtoupper($table):$table));
adodb.inc.php:			if (isset($savem)) $this->SetFetchMode($savem);
adodb.inc.php:			if ($rs === false || $rs->EOF) return $false;
adodb.inc.php:			while (!$rs->EOF) { //print_r($rs->fields);
adodb.inc.php:				$fld->name = $rs->fields[0];
adodb.inc.php:				$fld->type = $rs->fields[1];
adodb.inc.php:				if (isset($rs->fields[3]) && $rs->fields[3]) {
adodb.inc.php:					if ($rs->fields[3]>0) $fld->max_length = $rs->fields[3];
adodb.inc.php:					$fld->scale = $rs->fields[4];
adodb.inc.php:					if ($fld->scale>0) $fld->max_length += 1;
adodb.inc.php:					$fld->max_length = $rs->fields[2];
adodb.inc.php:				else $retarr[strtoupper($fld->name)] = $fld;
adodb.inc.php:				$rs->MoveNext();
adodb.inc.php:			$rs->Close();
adodb.inc.php:		$objarr =& $this->MetaColumns($table);
adodb.inc.php:			foreach($objarr as $v) $arr[$i++] = $v->name;
adodb.inc.php:			foreach($objarr as $v) $arr[strtoupper($v->name)] = $v->name;
adodb.inc.php:	 * Usage: $db->Concat($str1,$str2);
adodb.inc.php:		return implode($this->concat_operator, $arr);
adodb.inc.php:			if ($this->isoDates) return "'$d'";
adodb.inc.php:		return adodb_date($this->fmtDate,$d);
adodb.inc.php:			return adodb_date($this->fmtTimeStamp,$ts);
adodb.inc.php:		if ($this->isoDates && strlen($ts) !== 14) return "'$ts'";
adodb.inc.php:		return adodb_date($this->fmtTimeStamp,$ts);
adodb.inc.php:	 * @param $v is a date string in YYYY-MM-DD format
adodb.inc.php:			return adodb_mktime($v->hour,$v->minute,$v->second,$v->month,$v->day, $v->year);
adodb.inc.php:		if (!preg_match( "|^([0-9]{4})[-/\.]?([0-9]{1,2})[-/\.]?([0-9]{1,2})|", 
adodb.inc.php:		// h-m-s-MM-DD-YY
adodb.inc.php:	 * @param $v is a timestamp string in YYYY-MM-DD HH-NN-SS format
adodb.inc.php:			return adodb_mktime($v->hour,$v->minute,$v->second,$v->month,$v->day, $v->year);
adodb.inc.php:			"|^([0-9]{4})[-/\.]?([0-9]{1,2})[-/\.]?([0-9]{1,2})[ ,-]*(([0-9]{1,2}):?([0-9]{1,2}):?([0-9\.]{1,4}))?|", 
adodb.inc.php:		// h-m-s-MM-DD-YY
adodb.inc.php:	 * @param v  	is the character date in YYYY-MM-DD format, returned by database
adodb.inc.php:	function UserDate($v,$fmt='Y-m-d',$gmt=false)
adodb.inc.php:		$tt = $this->UnixDate($v);
adodb.inc.php:		// $tt == -1 if pre TIMESTAMP_FIRST_YEAR
adodb.inc.php:		if (($tt === false || $tt == -1) && $v != false) return $v;
adodb.inc.php:		else if ($tt == 0) return $this->emptyDate;
adodb.inc.php:		else if ($tt == -1) { // pre-TIMESTAMP_FIRST_YEAR
adodb.inc.php:	 * @param v  	is the character timestamp in YYYY-MM-DD hh:mm:ss format
adodb.inc.php:	function UserTimeStamp($v,$fmt='Y-m-d H:i:s',$gmt=false)
adodb.inc.php:		$tt = $this->UnixTimeStamp($v);
adodb.inc.php:		// $tt == -1 if pre TIMESTAMP_FIRST_YEAR
adodb.inc.php:		if (($tt === false || $tt == -1) && $v != false) return $v;
adodb.inc.php:		if ($tt == 0) return $this->emptyTimeStamp;
adodb.inc.php:			if ($this->replaceQuote[0] == '\\'){
adodb.inc.php:			return  str_replace("'",$this->replaceQuote,$s);
adodb.inc.php:		if ($this->replaceQuote == "\\'")  // ' already quoted, no need to change anything
adodb.inc.php:			return str_replace("\\'",$this->replaceQuote,$s);
adodb.inc.php:	 * to the string single-quotes.
adodb.inc.php:	 * An example is  $db->qstr("Don't bother",magic_quotes_runtime());
adodb.inc.php:			if ($this->replaceQuote[0] == '\\'){
adodb.inc.php:			return  "'".str_replace("'",$this->replaceQuote,$s)."'";
adodb.inc.php:		if ($this->replaceQuote == "\\'")  // ' already quoted, no need to change anything
adodb.inc.php:			return "'".str_replace("\\'",$this->replaceQuote,$s)."'";
adodb.inc.php:	* @param page		is the page number to get (1-based)
adodb.inc.php:	* @return		the recordset ($rs->databaseType == 'array')
adodb.inc.php:		if (empty($ADODB_INCLUDED_LIB)) include_once(ADODB_DIR.'/adodb-lib.inc.php');
adodb.inc.php:		if ($this->pageExecuteCountRows) $rs =& _adodb_pageexecute_all_rows($this, $sql, $nrows, $page, $inputarr, $secs2cache);
adodb.inc.php:	* @param page		is the page number to get (1-based)
adodb.inc.php:	* @return		the recordset ($rs->databaseType == 'array')
adodb.inc.php:		/*switch($this->dataProvider) {
adodb.inc.php:		$rs =& $this->PageExecute($sql,$nrows,$page,$inputarr,$secs2cache);
adodb.inc.php:	* Internal placeholder for record objects. Used by ADORecordSet->FetchObj().
adodb.inc.php:	include_once(ADODB_DIR.'/adodb-time.inc.php');
adodb.inc.php:	if (PHP_VERSION < 5) include_once(ADODB_DIR.'/adodb-php4.inc.php');
adodb.inc.php:	else include_once(ADODB_DIR.'/adodb-iterator.inc.php');
adodb.inc.php:	 * No prefetching of data is done, so the RecordCount() can return -1 ( which
adodb.inc.php:	var $timeCreated=0; 	/// datetime in Unix format rs created -- for cached recordsets
adodb.inc.php:	var $bind = false; 		/// used by Fields() to hold array - should be private?
adodb.inc.php:	var $_numOfRows = -1;	/** number of rows, or -1 */
adodb.inc.php:	var $_numOfFields = -1;	/** number of fields in recordset */
adodb.inc.php:	var $_queryID = -1;		/** This variable keeps the result link identifier.	*/
adodb.inc.php:	var $_currentRow = -1;	/** This variable keeps the current row in the Recordset.	*/
adodb.inc.php:	var $_currentPage = -1;	/** Added by Iván Oliva to implement recordset pagination */
adodb.inc.php:	var $_lastPageNo = -1; 
adodb.inc.php:	 * @param queryID  	this is the queryID returned by ADOConnection->_query()
adodb.inc.php:		$this->_queryID = $queryID;
adodb.inc.php:		if ($this->_inited) return;
adodb.inc.php:		$this->_inited = true;
adodb.inc.php:		if ($this->_queryID) @$this->_initrs();
adodb.inc.php:			$this->_numOfRows = 0;
adodb.inc.php:			$this->_numOfFields = 0;
adodb.inc.php:		if ($this->_numOfRows != 0 && $this->_numOfFields && $this->_currentRow == -1) {
adodb.inc.php:			$this->_currentRow = 0;
adodb.inc.php:			if ($this->EOF = ($this->_fetch() === false)) {
adodb.inc.php:				$this->_numOfRows = 0; // _numOfRows could be -1
adodb.inc.php:			$this->EOF = true;
adodb.inc.php:		if (empty($ADODB_INCLUDED_LIB)) include_once(ADODB_DIR.'/adodb-lib.inc.php');
adodb.inc.php:		if (empty($ADODB_INCLUDED_LIB)) include_once(ADODB_DIR.'/adodb-lib.inc.php');
adodb.inc.php:	 * return recordset as a 2-dimensional array.
adodb.inc.php:	 * @param [nRows]  is the number of rows to return. -1 means every row.
adodb.inc.php:	 * @return an array indexed by the rows (0-based) from the recordset
adodb.inc.php:	function &GetArray($nRows = -1) 
adodb.inc.php:		while (!$this->EOF && $nRows != $cnt) {
adodb.inc.php:			$results[] = $this->fields;
adodb.inc.php:			$this->MoveNext();
adodb.inc.php:	function &GetAll($nRows = -1)
adodb.inc.php:		$arr =& $this->GetArray($nRows);
adodb.inc.php:	 * return recordset as a 2-dimensional array. 
adodb.inc.php:	 * Helper function for ADOConnection->SelectLimit()
adodb.inc.php:	 * @param offset	is the row to start calculations from (1-based)
adodb.inc.php:	 * @return an array indexed by the rows (0-based) from the recordset
adodb.inc.php:	function &GetArrayLimit($nrows,$offset=-1) 
adodb.inc.php:			$arr =& $this->GetArray($nrows);
adodb.inc.php:		$this->Move($offset);
adodb.inc.php:		while (!$this->EOF && $nrows != $cnt) {
adodb.inc.php:			$results[$cnt++] = $this->fields;
adodb.inc.php:			$this->MoveNext();
adodb.inc.php:	 * @param [nRows]  is the number of rows to return. -1 means every row.
adodb.inc.php:	 * @return an array indexed by the rows (0-based) from the recordset
adodb.inc.php:	function &GetRows($nRows = -1) 
adodb.inc.php:		$arr =& $this->GetArray($nRows);
adodb.inc.php:	 * return whole recordset as a 2-dimensional associative array if there are more than 2 columns. 
adodb.inc.php:	 * If there is only 2 columns, it will return a 1 dimensional array of key-value pairs unless
adodb.inc.php:		$cols = $this->_numOfFields;
adodb.inc.php:		$numIndex = isset($this->fields[0]);
adodb.inc.php:					while (!$this->EOF) {
adodb.inc.php:						$results[trim($this->fields[0])] = array_slice($this->fields, 1);
adodb.inc.php:					while (!$this->EOF) {
adodb.inc.php:						$results[trim(reset($this->fields))] = array_slice($this->fields, 1);
adodb.inc.php:					while (!$this->EOF) {
adodb.inc.php:						$results[trim($this->fields[0])] = array_slice($this->fields, 1);
adodb.inc.php:						$this->MoveNext();
adodb.inc.php:					while (!$this->EOF) {
adodb.inc.php:						$results[trim(reset($this->fields))] = array_slice($this->fields, 1);
adodb.inc.php:						$this->MoveNext();
adodb.inc.php:					while (!$this->EOF) {
adodb.inc.php:					// some bug in mssql PHP 4.02 -- doesn't handle references properly so we FORCE creating a new string
adodb.inc.php:						$results[trim(($this->fields[0]))] = $this->fields[1];
adodb.inc.php:					while (!$this->EOF) {
adodb.inc.php:					// some bug in mssql PHP 4.02 -- doesn't handle references properly so we FORCE creating a new string
adodb.inc.php:						$v1 = trim(reset($this->fields));
adodb.inc.php:						$v2 = ''.next($this->fields); 
adodb.inc.php:					while (!$this->EOF) {
adodb.inc.php:					// some bug in mssql PHP 4.02 -- doesn't handle references properly so we FORCE creating a new string
adodb.inc.php:						$results[trim(($this->fields[0]))] = $this->fields[1];
adodb.inc.php:						$this->MoveNext();
adodb.inc.php:					while (!$this->EOF) {
adodb.inc.php:					// some bug in mssql PHP 4.02 -- doesn't handle references properly so we FORCE creating a new string
adodb.inc.php:						$v1 = trim(reset($this->fields));
adodb.inc.php:						$v2 = ''.next($this->fields); 
adodb.inc.php:						$this->MoveNext();
adodb.inc.php:	 * @param v  	is the character timestamp in YYYY-MM-DD hh:mm:ss format
adodb.inc.php:	function UserTimeStamp($v,$fmt='Y-m-d H:i:s')
adodb.inc.php:		$tt = $this->UnixTimeStamp($v);
adodb.inc.php:		// $tt == -1 if pre TIMESTAMP_FIRST_YEAR
adodb.inc.php:		if (($tt === false || $tt == -1) && $v != false) return $v;
adodb.inc.php:		if ($tt === 0) return $this->emptyTimeStamp;
adodb.inc.php:	 * @param v  	is the character date in YYYY-MM-DD format, returned by database
adodb.inc.php:	function UserDate($v,$fmt='Y-m-d')
adodb.inc.php:		$tt = $this->UnixDate($v);
adodb.inc.php:		// $tt == -1 if pre TIMESTAMP_FIRST_YEAR
adodb.inc.php:		if (($tt === false || $tt == -1) && $v != false) return $v;
adodb.inc.php:		else if ($tt == 0) return $this->emptyDate;
adodb.inc.php:		else if ($tt == -1) { // pre-TIMESTAMP_FIRST_YEAR
adodb.inc.php:	 * @param $v is a date string in YYYY-MM-DD format
adodb.inc.php:	 * @param $v is a timestamp string in YYYY-MM-DD HH-NN-SS format
adodb.inc.php:	* PEAR DB Compat - do not use internally
adodb.inc.php:		return $this->Close();
adodb.inc.php:		return $this->_numOfRows;
adodb.inc.php:		return $this->_numOfFields;
adodb.inc.php:		if ($this->EOF) {
adodb.inc.php:		$arr = $this->fields;
adodb.inc.php:		$this->_currentRow++;
adodb.inc.php:		if (!$this->_fetch()) $this->EOF = true;
adodb.inc.php:		if ($this->EOF) return (defined('PEAR_ERROR_RETURN')) ? new PEAR_Error('EOF',-1): false;
adodb.inc.php:		$arr = $this->fields;
adodb.inc.php:		$this->MoveNext();
adodb.inc.php:		if ($this->_currentRow == 0) return true;
adodb.inc.php:		return $this->Move(0);			
adodb.inc.php:		if ($this->_numOfRows >= 0) return $this->Move($this->_numOfRows-1);
adodb.inc.php:		if ($this->EOF) return false;
adodb.inc.php:		while (!$this->EOF) {
adodb.inc.php:			$f = $this->fields;
adodb.inc.php:			$this->MoveNext();
adodb.inc.php:		$this->fields = $f;
adodb.inc.php:		$this->EOF = false;
adodb.inc.php:		if (!$this->EOF) {
adodb.inc.php:			$this->_currentRow++;
adodb.inc.php:			if ($this->_fetch()) return true;
adodb.inc.php:		$this->EOF = true;
adodb.inc.php:		/* -- tested error handling when scrolling cursor -- seems useless.
adodb.inc.php:		$conn = $this->connection;
adodb.inc.php:		if ($conn && $conn->raiseErrorFn && ($errno = $conn->ErrorNo())) {
adodb.inc.php:			$fn = $conn->raiseErrorFn;
adodb.inc.php:			$fn($conn->databaseType,'MOVENEXT',$errno,$conn->ErrorMsg().' ('.$this->sql.')',$conn->host,$conn->database);
adodb.inc.php:	 * @param rowNumber is the row to move to (0-based)
adodb.inc.php:		$this->EOF = false;
adodb.inc.php:		if ($rowNumber == $this->_currentRow) return true;
adodb.inc.php:		if ($rowNumber >= $this->_numOfRows)
adodb.inc.php:	   		if ($this->_numOfRows != -1) $rowNumber = $this->_numOfRows-2;
adodb.inc.php:		if ($this->canSeek) { 
adodb.inc.php:			if ($this->_seek($rowNumber)) {
adodb.inc.php:				$this->_currentRow = $rowNumber;
adodb.inc.php:				if ($this->_fetch()) {
adodb.inc.php:				$this->EOF = true;
adodb.inc.php:			if ($rowNumber < $this->_currentRow) return false;
adodb.inc.php:				while (!$this->EOF && $this->_currentRow < $rowNumber) {
adodb.inc.php:				while (! $this->EOF && $this->_currentRow < $rowNumber) {
adodb.inc.php:					$this->_currentRow++;
adodb.inc.php:					if (!$this->_fetch()) $this->EOF = true;
adodb.inc.php:			return !($this->EOF);
adodb.inc.php:		$this->fields = false;	
adodb.inc.php:		$this->EOF = true;
adodb.inc.php:		return $this->fields[$colname];
adodb.inc.php:		$this->bind = array();
adodb.inc.php:		for ($i=0; $i < $this->_numOfFields; $i++) {
adodb.inc.php:			$o =& $this->FetchField($i);
adodb.inc.php:			if ($upper === 2) $this->bind[$o->name] = $i;
adodb.inc.php:			else $this->bind[($upper) ? strtoupper($o->name) : strtolower($o->name)] = $i;
adodb.inc.php:   * before you execute your SQL statement, and access $rs->fields['col'] directly.
adodb.inc.php:	 //	if (!$this->fields) return $record;
adodb.inc.php:	   	if (!$this->bind) {
adodb.inc.php:			$this->GetAssocKeys($upper);
adodb.inc.php:		foreach($this->bind as $k => $v) {
adodb.inc.php:			$record[$k] = $this->fields[$v];
adodb.inc.php:		// free connection object - this seems to globally free the object
adodb.inc.php:		// $this->connection = false; 
adodb.inc.php:		if (!$this->_closed) {
adodb.inc.php:			$this->_closed = true;
adodb.inc.php:			return $this->_close();		
adodb.inc.php:	 * @return the number of rows or -1 if this is not supported
adodb.inc.php:	function RecordCount() {return $this->_numOfRows;}
adodb.inc.php:		return ($this->_maxRecordCount) ? $this->_maxRecordCount : $this->RecordCount();
adodb.inc.php:	 * @return the number of rows or -1 if this is not supported
adodb.inc.php:	function RowCount() {return $this->_numOfRows;} 
adodb.inc.php:		$lnumrows = $this->_numOfRows;
adodb.inc.php:		if ($lnumrows == -1 && $this->connection) {
adodb.inc.php:				$resultrows = &$this->connection->Execute("SELECT COUNT(*) FROM $table $condition");
adodb.inc.php:				if ($resultrows) $lnumrows = reset($resultrows->fields);
adodb.inc.php:	 * @return the current row in the recordset. If at EOF, will return the last row. 0-based.
adodb.inc.php:	function CurrentRow() {return $this->_currentRow;}
adodb.inc.php:	 * synonym for CurrentRow -- for ADO compat
adodb.inc.php:	 * @return the current row in the recordset. If at EOF, will return the last row. 0-based.
adodb.inc.php:	function AbsolutePosition() {return $this->_currentRow;}
adodb.inc.php:	function FieldCount() {return $this->_numOfFields;}   
adodb.inc.php:	 * @param fieldoffset	is the column position to access(0-based).
adodb.inc.php:		for ($i=0, $max=$this->_numOfFields; $i < $max; $i++) 
adodb.inc.php:			$arr[] = $this->FetchField($i);
adodb.inc.php:		$o =& $this->FetchObject(false);
adodb.inc.php:		if (empty($this->_obj)) {
adodb.inc.php:			$this->_obj =& new ADOFetchObj();
adodb.inc.php:			$this->_names = array();
adodb.inc.php:			for ($i=0; $i <$this->_numOfFields; $i++) {
adodb.inc.php:				$f = $this->FetchField($i);
adodb.inc.php:				$this->_names[] = $f->name;
adodb.inc.php:		$o = &$this->_obj;
adodb.inc.php:		for ($i=0; $i <$this->_numOfFields; $i++) {
adodb.inc.php:			$name = $this->_names[$i];
adodb.inc.php:			$o->$n = $this->Fields($name);
adodb.inc.php:	* The default is lower-case field names.
adodb.inc.php:		$o = $this->FetchNextObject(false);
adodb.inc.php:		if ($this->_numOfRows != 0 && !$this->EOF) {
adodb.inc.php:			$o = $this->FetchObject($isupper);	
adodb.inc.php:			$this->_currentRow++;
adodb.inc.php:			if ($this->_fetch()) return $o;
adodb.inc.php:		$this->EOF = true;
adodb.inc.php:	 * @param t  is the type passed in. Normally is ADOFieldObject->type.
adodb.inc.php:	function MetaType($t,$len=-1,$fieldobj=false)
adodb.inc.php:			$t = $fieldobj->type;
adodb.inc.php:			$len = $fieldobj->max_length;
adodb.inc.php:		'BIGINT' => 'N', // this is bigger than PHP 32-bit integers
adodb.inc.php:			if ($this->blobSize >= 0) {
adodb.inc.php:				if ($len > $this->blobSize) return 'X';
adodb.inc.php:			if (!empty($fieldobj->primary_key)) return 'R';
adodb.inc.php:			 if (isset($fieldobj->binary)) 
adodb.inc.php:				 return ($fieldobj->binary) ? 'B' : 'X';
adodb.inc.php:			if (!empty($this->datetime)) return 'T';
adodb.inc.php:			if ($t == 'LONG' && $this->dataProvider == 'oci8') return 'B';
adodb.inc.php:	function AbsolutePage($page=-1)
adodb.inc.php:		if ($page != -1) $this->_currentPage = $page;
adodb.inc.php:		return $this->_currentPage;
adodb.inc.php:		if ($status != false) $this->_atFirstPage = $status;
adodb.inc.php:		return $this->_atFirstPage;
adodb.inc.php:		if ($page != false) $this->_lastPageNo = $page;
adodb.inc.php:		return $this->_lastPageNo;
adodb.inc.php:		if ($status != false) $this->_atLastPage = $status;
adodb.inc.php:		return $this->_atLastPage;
adodb.inc.php:		var $_array; 	// holds the 2-dimensional data array
adodb.inc.php:			// fetch() on EOF does not delete $this->fields
adodb.inc.php:			$this->compat = !empty($ADODB_COMPAT_FETCH);
adodb.inc.php:			$this->ADORecordSet($fakeid); // fake queryID		
adodb.inc.php:			$this->fetchMode = $ADODB_FETCH_MODE;
adodb.inc.php:		 * @param array		is a 2-dimensional array holding the data.
adodb.inc.php:			$this->_array = $array;
adodb.inc.php:			$this->_types = $typearr;	
adodb.inc.php:				$this->_skiprow1 = false;
adodb.inc.php:				$this->_colnames = $colnames;
adodb.inc.php:				$this->_skiprow1 = true;
adodb.inc.php:				$this->_colnames = $array[0];
adodb.inc.php:			$this->Init();
adodb.inc.php:		 * @param array		is a 2-dimensional array holding the data.
adodb.inc.php:			$this->_array =& $array;
adodb.inc.php:			$this->_skiprow1= false;
adodb.inc.php:				$this->_fieldobjects =& $fieldarr;
adodb.inc.php:			$this->Init();
adodb.inc.php:		function &GetArray($nRows=-1)
adodb.inc.php:			if ($nRows == -1 && $this->_currentRow <= 0 && !$this->_skiprow1) {
adodb.inc.php:				return $this->_array;
adodb.inc.php:			$this->_numOfRows =  sizeof($this->_array);
adodb.inc.php:			if ($this->_skiprow1) $this->_numOfRows -= 1;
adodb.inc.php:			$this->_numOfFields =(isset($this->_fieldobjects)) ?
adodb.inc.php:				 sizeof($this->_fieldobjects):sizeof($this->_types);
adodb.inc.php:			$mode = isset($this->adodbFetchMode) ? $this->adodbFetchMode : $this->fetchMode;
adodb.inc.php:				if (!isset($this->fields[$colname])) $colname = strtolower($colname);
adodb.inc.php:				return $this->fields[$colname];
adodb.inc.php:			if (!$this->bind) {
adodb.inc.php:				$this->bind = array();
adodb.inc.php:				for ($i=0; $i < $this->_numOfFields; $i++) {
adodb.inc.php:					$o = $this->FetchField($i);
adodb.inc.php:					$this->bind[strtoupper($o->name)] = $i;
adodb.inc.php:			return $this->fields[$this->bind[strtoupper($colname)]];
adodb.inc.php:		function &FetchField($fieldOffset = -1) 
adodb.inc.php:			if (isset($this->_fieldobjects)) {
adodb.inc.php:				return $this->_fieldobjects[$fieldOffset];
adodb.inc.php:			$o->name = $this->_colnames[$fieldOffset];
adodb.inc.php:			$o->type =  $this->_types[$fieldOffset];
adodb.inc.php:			$o->max_length = -1; // length not known
adodb.inc.php:			if (sizeof($this->_array) && 0 <= $row && $row < $this->_numOfRows) {
adodb.inc.php:				$this->_currentRow = $row;
adodb.inc.php:				if ($this->_skiprow1) $row += 1;
adodb.inc.php:				$this->fields = $this->_array[$row];
adodb.inc.php:			if (!$this->EOF) {		
adodb.inc.php:				$this->_currentRow++;
adodb.inc.php:				$pos = $this->_currentRow;
adodb.inc.php:				if ($this->_numOfRows <= $pos) {
adodb.inc.php:					if (!$this->compat) $this->fields = false;
adodb.inc.php:					if ($this->_skiprow1) $pos += 1;
adodb.inc.php:					$this->fields = $this->_array[$pos];
adodb.inc.php:				$this->EOF = true;
adodb.inc.php:			$pos = $this->_currentRow;
adodb.inc.php:			if ($this->_numOfRows <= $pos) {
adodb.inc.php:				if (!$this->compat) $this->fields = false;
adodb.inc.php:			if ($this->_skiprow1) $pos += 1;
adodb.inc.php:			$this->fields = $this->_array[$pos];
adodb.inc.php:		@include_once(ADODB_DIR."/drivers/adodb-".$db.".inc.php");
adodb.inc.php:		$file = ADODB_DIR."/drivers/adodb-".$db.".inc.php";
adodb.inc.php:				$db = str_replace('@/','@adodb-fakehost/',$db);
adodb.inc.php:					$errorfn('ADONewConnection', 'ADONewConnection', -998,
adodb.inc.php:			if ($errorfn)  $obj->raiseErrorFn = $errorfn;
adodb.inc.php:					case 'debug':		$obj->debug = (integer) $v; break;
adodb.inc.php:					case 'dialect': 	$obj->dialect = (integer) $v; break;
adodb.inc.php:					case 'charset':		$obj->charset = $v; break;
adodb.inc.php:					case 'buffers':		$obj->buffers = $v; break;
adodb.inc.php:					case 'fetchmode':   $obj->SetFetchMode($v); break;
adodb.inc.php:					case 'charpage':	$obj->charPage = $v; break;
adodb.inc.php:					case 'clientflags': $obj->clientFlags = $v; break;
adodb.inc.php:					case 'port': $obj->port = $v; break;
adodb.inc.php:					case 'socket': $obj->socket = $v; break;
adodb.inc.php:					case 'nls_date_format': $obj->NLS_DATE_FORMAT = $v; break;
adodb.inc.php:					$ok = $obj->Connect($dsna['host'], $dsna['user'], $dsna['pass'], $dsna['path']);
adodb.inc.php:					$ok = $obj->PConnect($dsna['host'], $dsna['user'], $dsna['pass'], $dsna['path']);
adodb.inc.php:		$drivername = _adodb_getdriver($conn->dataProvider,$conn->databaseType,true);
adodb.inc.php:		include_once(ADODB_DIR.'/adodb-perf.inc.php');
adodb.inc.php:		@include_once(ADODB_DIR."/perf/perf-$drivername.inc.php");
adodb.inc.php:		if (!$drivername) $drivername = _adodb_getdriver($conn->dataProvider,$conn->databaseType);
adodb.inc.php:		include_once(ADODB_DIR.'/adodb-lib.inc.php');
adodb.inc.php:		include_once(ADODB_DIR.'/adodb-datadict.inc.php');
adodb.inc.php:		$path = ADODB_DIR."/datadict/datadict-$drivername.inc.php";
adodb.inc.php:		$dict->dataProvider = $conn->dataProvider;
adodb.inc.php:		$dict->connection = &$conn;
adodb.inc.php:		$dict->upperName = strtoupper($drivername);
adodb.inc.php:		$dict->quote = $conn->nameQuote;
adodb.inc.php:		if (!empty($conn->_connectionID))
adodb.inc.php:			$dict->serverInfo = $conn->ServerInfo();
adodb.inc.php:		Perform a stack-crawl and pretty print it.
adodb.inc.php:		@param printOrArr  Pass in a boolean to indicate print, or an $exception->trace array (assumes that print is true then).
adodb.inc.php:		if (empty($ADODB_INCLUDED_LIB)) include_once(ADODB_DIR.'/adodb-lib.inc.php');
adodb-iterator.inc.php:  V4.54 5 Nov 2004  (c) 2000-2004 John Lim (jlim@natsoft.com.my). All rights reserved.
adodb-iterator.inc.php:  		$rs = $db->Execute("select * from adoxyz");
adodb-iterator.inc.php:	Iterator code based on http://cvs.php.net/cvs.php/php-src/ext/spl/examples/cachingiterator.inc?login=2
adodb-iterator.inc.php:        $this->rs = $rs;
adodb-iterator.inc.php:        $this->rs->MoveFirst();
adodb-iterator.inc.php:        return !$this->rs->EOF;
adodb-iterator.inc.php:        return $this->rs->_currentRow;
adodb-iterator.inc.php:        return $this->rs->fields;
adodb-iterator.inc.php:        $this->rs->MoveNext();
adodb-iterator.inc.php:		return call_user_func_array(array($this->rs, $func), $params);
adodb-iterator.inc.php:		return !$this->rs->EOF;
adodb-iterator.inc.php:	/* this is experimental - i don't really know what to return... */
adodb-lib.inc.php:// security - hide paths
adodb-lib.inc.php: @version V4.54 5 Nov 2004 (c) 2000-2004 John Lim (jlim\@natsoft.com.my). All rights reserved.
adodb-lib.inc.php:// See also http://www.php.net/manual/en/function.array-change-key-case.php
adodb-lib.inc.php:				$v = $zthis->qstr($v);
adodb-lib.inc.php:			$rs = $zthis->Execute($update);
adodb-lib.inc.php:				if ($zthis->poorAffectedRows) {
adodb-lib.inc.php:					if ($zthis->ErrorNo()<>0) return 0;
adodb-lib.inc.php:				# for mysql - which is silly. 
adodb-lib.inc.php:					$cnt = $zthis->GetOne("select count(*) from $table where $where");
adodb-lib.inc.php:					if (($zthis->Affected_Rows()>0)) return 1;
adodb-lib.inc.php:	//	print "<p>Error=".$this->ErrorNo().'<p>';
adodb-lib.inc.php:		$rs = $zthis->Execute($insert);
adodb-lib.inc.php:	if ($zthis->FieldCount() > 1) $hasvalue=true;
adodb-lib.inc.php:	while(!$zthis->EOF) {
adodb-lib.inc.php:		$zval = rtrim(reset($zthis->fields));
adodb-lib.inc.php:		if (sizeof($zthis->fields) > 1) {
adodb-lib.inc.php:			if (isset($zthis->fields[1]))
adodb-lib.inc.php:				$zval2 = rtrim($zthis->fields[1]);
adodb-lib.inc.php:				$zval2 = rtrim(next($zthis->fields));
adodb-lib.inc.php:			$zthis->MoveNext();
adodb-lib.inc.php:		$zthis->MoveNext();
adodb-lib.inc.php:		if ($zthis->dataProvider == 'oci8') {
adodb-lib.inc.php:		} else if ( $zthis->databaseType == 'postgres' || $zthis->databaseType == 'postgres7')  {
adodb-lib.inc.php:			$info = $zthis->ServerInfo();
adodb-lib.inc.php:		// with mssql, access and postgresql. Also a good speedup optimization - skips sorting!
adodb-lib.inc.php:			$qryRecs = $zthis->CacheGetOne($secs2cache/2,$rewritesql,$inputarr);
adodb-lib.inc.php:			$qryRecs = $zthis->GetOne($rewritesql,$inputarr);
adodb-lib.inc.php:	//--------------------------------------------
adodb-lib.inc.php:	// query rewrite failed - so try slower way...
adodb-lib.inc.php:	$rstest = &$zthis->Execute($rewritesql,$inputarr);
adodb-lib.inc.php:	  		$qryRecs = $rstest->RecordCount();
adodb-lib.inc.php:		if ($qryRecs == -1) { 
adodb-lib.inc.php:		// some databases will return -1 on MoveLast() - change to MoveNext()
adodb-lib.inc.php:				while(!$rstest->EOF) {
adodb-lib.inc.php:				while(!$rstest->EOF) {
adodb-lib.inc.php:					$rstest->MoveNext();
adodb-lib.inc.php:			$qryRecs = $rstest->_currentRow;
adodb-lib.inc.php:		$rstest->Close();
adodb-lib.inc.php:		if ($qryRecs == -1) return 0;
adodb-lib.inc.php:	$zthis->_maxRecordCount = $qryRecs;
adodb-lib.inc.php:	$offset = $nrows * ($page-1);
adodb-lib.inc.php:		$rsreturn = &$zthis->CacheSelectLimit($secs2cache, $sql, $nrows, $offset, $inputarr);
adodb-lib.inc.php:		$rsreturn = &$zthis->SelectLimit($sql, $nrows, $offset, $inputarr, $secs2cache);
adodb-lib.inc.php:		$rsreturn->_maxRecordCount = $qryRecs;
adodb-lib.inc.php:		$rsreturn->rowsPerPage = $nrows;
adodb-lib.inc.php:		$rsreturn->AbsolutePage($page);
adodb-lib.inc.php:		$rsreturn->AtFirstPage($atfirstpage);
adodb-lib.inc.php:		$rsreturn->AtLastPage($atlastpage);
adodb-lib.inc.php:		$rsreturn->LastPageNo($lastpageno);
adodb-lib.inc.php:	$pagecounteroffset = ($pagecounter * $nrows) - $nrows;
adodb-lib.inc.php:	if ($secs2cache>0) $rstest = &$zthis->CacheSelectLimit($secs2cache, $sql, $nrows, $pagecounteroffset, $inputarr);
adodb-lib.inc.php:	else $rstest = &$zthis->SelectLimit($sql, $nrows, $pagecounteroffset, $inputarr, $secs2cache);
adodb-lib.inc.php:		while ($rstest && $rstest->EOF && $pagecounter>0) {
adodb-lib.inc.php:			$pagecounter--;
adodb-lib.inc.php:			$pagecounteroffset = $nrows * ($pagecounter - 1);
adodb-lib.inc.php:			$rstest->Close();
adodb-lib.inc.php:			if ($secs2cache>0) $rstest = &$zthis->CacheSelectLimit($secs2cache, $sql, $nrows, $pagecounteroffset, $inputarr);
adodb-lib.inc.php:			else $rstest = &$zthis->SelectLimit($sql, $nrows, $pagecounteroffset, $inputarr, $secs2cache);
adodb-lib.inc.php:		if ($rstest) $rstest->Close();
adodb-lib.inc.php:	$offset = $nrows * ($page-1);
adodb-lib.inc.php:	if ($secs2cache > 0) $rsreturn = &$zthis->CacheSelectLimit($secs2cache, $sql, $nrows, $offset, $inputarr);
adodb-lib.inc.php:	else $rsreturn = &$zthis->SelectLimit($sql, $nrows, $offset, $inputarr, $secs2cache);
adodb-lib.inc.php:		$rsreturn->rowsPerPage = $nrows;
adodb-lib.inc.php:		$rsreturn->AbsolutePage($page);
adodb-lib.inc.php:		$rsreturn->AtFirstPage($atfirstpage);
adodb-lib.inc.php:		$rsreturn->AtLastPage($atlastpage);
adodb-lib.inc.php:		$hasnumeric = isset($rs->fields[0]);
adodb-lib.inc.php:		for ($i=0, $max=$rs->FieldCount(); $i < $max; $i++) {
adodb-lib.inc.php:			$field = $rs->FetchField($i);
adodb-lib.inc.php:			$upperfname = strtoupper($field->name);
adodb-lib.inc.php:				if ($hasnumeric) $val = $rs->fields[$i];
adodb-lib.inc.php:				else if (isset($rs->fields[$upperfname])) $val = $rs->fields[$upperfname];
adodb-lib.inc.php:				else if (isset($rs->fields[$field->name])) $val =  $rs->fields[$field->name];
adodb-lib.inc.php:				else if (isset($rs->fields[strtolower($upperfname)])) $val =  $rs->fields[strtolower($upperfname)];
adodb-lib.inc.php:					$type = $rs->MetaType($field->type);
adodb-lib.inc.php:						$fnameq = $zthis->nameQuote.$upperfname.$zthis->nameQuote;
adodb-lib.inc.php:                            $setFields .= $field->name . " = null, ";
adodb-lib.inc.php:                                $setFields .= $field->name . " = null, ";
adodb-lib.inc.php:			preg_match("/FROM\s+".ADODB_TABLE_REGEX."/is", $rs->sql, $tableName);
adodb-lib.inc.php:			preg_match('/\sWHERE\s(.*)/is', $rs->sql, $whereClause);
adodb-lib.inc.php:				$whereClause[1] = substr($whereClause[1], 0, strlen($whereClause[1]) - strlen($discard[1]));
adodb-lib.inc.php:		$sql = 'UPDATE '.$tableName[1].' SET '.substr($setFields, 0, -2);
adodb-lib.inc.php:		$rsclass = $zthis->rsPrefix.$zthis->databaseType;
adodb-lib.inc.php:		$recordSet =& new $rsclass(-1,$zthis->fetchMode);
adodb-lib.inc.php:		$recordSet->connection = &$zthis;
adodb-lib.inc.php:			$columns = $zthis->MetaColumns( $tableName );
adodb-lib.inc.php:		if (isset($rs->insertSig) && is_integer($cacheRS) && $cacheRS == $rs->insertSig) {
adodb-lib.inc.php:			for ($i=0, $max=$rs->FieldCount(); $i < $max; $i++) 
adodb-lib.inc.php:				$columns[] = $rs->FetchField($i);
adodb-lib.inc.php:			$rs->insertSig = $cacheSig++;
adodb-lib.inc.php:		$upperfname = strtoupper($field->name);
adodb-lib.inc.php:				$fnameq = $zthis->nameQuote.$upperfname.$zthis->nameQuote;
adodb-lib.inc.php:			$type = $recordSet->MetaType($field->type);
adodb-lib.inc.php:		if (preg_match("/FROM\s+".ADODB_TABLE_REGEX."/is", $rs->sql, $tableName))
adodb-lib.inc.php:	$fields = substr($fields, 0, -2);
adodb-lib.inc.php:	$values = substr($values, 0, -2);
adodb-lib.inc.php: * It handles the string construction of 1 column -> sql string based on
adodb-lib.inc.php:        if (!empty($zthis->hasReturningInto)) {
adodb-lib.inc.php:            $zthis->_returningArray[$fname] = ':xx'.$fname.'xx';
adodb-lib.inc.php:       if (!empty($zthis->hasReturningInto)) {
adodb-lib.inc.php:            $zthis->_returningArray[$fname] = ':xx'.$fname.'xx';
adodb-lib.inc.php:		switch($zthis->dataProvider)  {
adodb-lib.inc.php:				$sql = $zthis->qstr($arrFields[$fname],$magicq) . ", ";
adodb-lib.inc.php:				$sql .= $fnameq . "=" . $zthis->qstr($arrFields[$fname],$magicq) . ", ";
adodb-lib.inc.php:				$sql = $zthis->DBDate($arrFields[$fname]) . ", ";
adodb-lib.inc.php:				$sql .= $fnameq . "=" . $zthis->DBDate($arrFields[$fname]) . ", ";
adodb-lib.inc.php:				$sql = $zthis->DBTimeStamp($arrFields[$fname]) . ", ";
adodb-lib.inc.php:				$sql .= $fnameq . "=" . $zthis->DBTimeStamp($arrFields[$fname]) . ", ";
adodb-lib.inc.php:	// check if running from browser or command-line
adodb-lib.inc.php:		if ($zthis->debug === -1)
adodb-lib.inc.php:			ADOConnection::outp( "<br>\n($zthis->databaseType): ".htmlspecialchars($sqlTxt)." &nbsp; <code>$ss</code>\n<br>\n",false);
adodb-lib.inc.php:			ADOConnection::outp( "<hr>\n($zthis->databaseType): ".htmlspecialchars($sqlTxt)." &nbsp; <code>$ss</code>\n<hr>\n",false);
adodb-lib.inc.php:		ADOConnection::outp("-----\n($zthis->databaseType): ".$sqlTxt."\n-----\n",false);
adodb-lib.inc.php:	$qID = $zthis->_query($sql,$inputarr);
adodb-lib.inc.php:	if ($zthis->databaseType == 'mssql') { 
adodb-lib.inc.php:		if($emsg = $zthis->ErrorMsg()) {
adodb-lib.inc.php:			if ($err = $zthis->ErrorNo()) ADOConnection::outp($err.': '.$emsg);
adodb-lib.inc.php:		ADOConnection::outp($zthis->ErrorNo() .': '. $zthis->ErrorMsg());
adodb-lib.inc.php:	$fmt =  ($html) ? "</font><font color=#808080 size=-1> %% line %4d, file: <a href=\"file:/%s\">%s</a></font>" : "%% line %4d, file: %s";
adodb-lib.inc.php:	$tabs = sizeof($traceArr)-2;
adodb-lib.inc.php:		$levels -= 1;
adodb-lib.inc.php:		$tabs -= 1;
adodb-pager.inc.php:	V4.54 5 Nov 2004  (c) 2000-2004 John Lim (jlim@natsoft.com.my). All rights reserved.
adodb-pager.inc.php:	//----------------------------------------------
adodb-pager.inc.php:	//		$id should be only be [a-z0-9]*
adodb-pager.inc.php:		$this->sql = $sql;
adodb-pager.inc.php:		$this->id = $id;
adodb-pager.inc.php:		$this->db = $db;
adodb-pager.inc.php:		$this->showPageLinks = $showPageLinks;
adodb-pager.inc.php:		$this->curr_page = $HTTP_SESSION_VARS[$curr_page];
adodb-pager.inc.php:	//---------------------------
adodb-pager.inc.php:		<a href="<?php echo $PHP_SELF,'?',$this->id;?>_next_page=1"><?php echo $this->first;?></a> &nbsp; 
adodb-pager.inc.php:			print "$this->first &nbsp; ";
adodb-pager.inc.php:	//--------------------------
adodb-pager.inc.php:		<a href="<?php echo $PHP_SELF,'?',$this->id,'_next_page=',$this->rs->AbsolutePage() + 1 ?>"><?php echo $this->next;?></a> &nbsp; 
adodb-pager.inc.php:			print "$this->next &nbsp; ";
adodb-pager.inc.php:	//------------------
adodb-pager.inc.php:	// $this->db->pageExecuteCountRows = false, which disables
adodb-pager.inc.php:		if (!$this->db->pageExecuteCountRows) return;
adodb-pager.inc.php:			<a href="<?php echo $PHP_SELF,'?',$this->id,'_next_page=',$this->rs->LastPageNo() ?>"><?php echo $this->last;?></a> &nbsp; 
adodb-pager.inc.php:			print "$this->last &nbsp; ";
adodb-pager.inc.php:	//---------------------------------------------------
adodb-pager.inc.php:            $pages        = $this->rs->LastPageNo();
adodb-pager.inc.php:            $linksperpage = $this->linksPerPage ? $this->linksPerPage : $pages;
adodb-pager.inc.php:                if($this->rs->AbsolutePage() >= $i)
adodb-pager.inc.php:            $end = $start+$linksperpage-1;
adodb-pager.inc.php:			$link = $this->id . "_next_page";
adodb-pager.inc.php:			if ($this->startLinks && $start > 1) {
adodb-pager.inc.php:				$pos = $start - 1;
adodb-pager.inc.php:				$numbers .= "<a href=$PHP_SELF?$link=$pos>$this->startLinks</a>  ";
adodb-pager.inc.php:                if ($this->rs->AbsolutePage() == $i)
adodb-pager.inc.php:                    $numbers .= "<font color=$this->linkSelectedColor><b>$i</b></font>  ";
adodb-pager.inc.php:			if ($this->moreLinks && $end < $pages) 
adodb-pager.inc.php:				$numbers .= "<a href=$PHP_SELF?$link=$i>$this->moreLinks</a>  ";
adodb-pager.inc.php:		<a href="<?php echo $PHP_SELF,'?',$this->id,'_next_page=',$this->rs->AbsolutePage() - 1 ?>"><?php echo $this->prev;?></a> &nbsp; 
adodb-pager.inc.php:			print "$this->prev &nbsp; ";
adodb-pager.inc.php:	//--------------------------------------------------------
adodb-pager.inc.php:		$gSQLBlockRows = $this->rows;
adodb-pager.inc.php:		rs2html($this->rs,$this->gridAttributes,$this->gridHeader,$this->htmlSpecialChars);
adodb-pager.inc.php:	//-------------------------------------------------------
adodb-pager.inc.php:		if (!$this->rs->AtFirstPage()) {
adodb-pager.inc.php:			$this->Render_First();
adodb-pager.inc.php:			$this->Render_Prev();
adodb-pager.inc.php:			$this->Render_First(false);
adodb-pager.inc.php:			$this->Render_Prev(false);
adodb-pager.inc.php:        if ($this->showPageLinks){
adodb-pager.inc.php:            $this->Render_PageLinks();
adodb-pager.inc.php:		if (!$this->rs->AtLastPage()) {
adodb-pager.inc.php:			$this->Render_Next();
adodb-pager.inc.php:			$this->Render_Last();
adodb-pager.inc.php:			$this->Render_Next(false);
adodb-pager.inc.php:			$this->Render_Last(false);
adodb-pager.inc.php:	//-------------------
adodb-pager.inc.php:		if (!$this->db->pageExecuteCountRows) return '';
adodb-pager.inc.php:		$lastPage = $this->rs->LastPageNo();
adodb-pager.inc.php:		if ($lastPage == -1) $lastPage = 1; // check for empty rs.
adodb-pager.inc.php:		if ($this->curr_page > $lastPage) $this->curr_page = 1;
adodb-pager.inc.php:		return "<font size=-1>$this->page ".$this->curr_page."/".$lastPage."</font>";
adodb-pager.inc.php:	//-----------------------------------
adodb-pager.inc.php:		$this->rows = $rows;
adodb-pager.inc.php:		if ($this->db->pageExecuteCountRows) $ADODB_COUNTRECS = true;
adodb-pager.inc.php:		if ($this->cache)
adodb-pager.inc.php:			$rs = &$this->db->CachePageExecute($this->cache,$this->sql,$rows,$this->curr_page);
adodb-pager.inc.php:			$rs = &$this->db->PageExecute($this->sql,$rows,$this->curr_page);
adodb-pager.inc.php:		$this->rs = &$rs;
adodb-pager.inc.php:			print "<h3>Query failed: $this->sql</h3>";
adodb-pager.inc.php:		if (!$rs->EOF && (!$rs->AtFirstPage() || !$rs->AtLastPage())) 
adodb-pager.inc.php:			$header = $this->RenderNav();
adodb-pager.inc.php:		$grid = $this->RenderGrid();
adodb-pager.inc.php:		$footer = $this->RenderPageCount();
adodb-pager.inc.php:		$rs->Close();
adodb-pager.inc.php:		$this->rs = false;
adodb-pager.inc.php:		$this->RenderLayout($header,$grid,$footer);
adodb-pager.inc.php:	//------------------------------------------------------
adodb-pear.inc.php: * @version V4.54 5 Nov 2004 (c) 2000-2004 John Lim (jlim@natsoft.com.my). All rights reserved.
adodb-pear.inc.php: * and Tomas V.V.Cox <cox@idecnet.com>.	Portions (c)1997-2002 The PHP Group.
adodb-pear.inc.php: ---------
adodb-pear.inc.php: 	query - returns PEAR_Error on error
adodb-pear.inc.php:	limitQuery - return PEAR_Error on error
adodb-pear.inc.php:	prepare - does not return PEAR_Error on error
adodb-pear.inc.php:	execute - does not return PEAR_Error on error
adodb-pear.inc.php:	setFetchMode - supports ASSOC and ORDERED
adodb-pear.inc.php: ---------
adodb-pear.inc.php: 	numRows - returns -1 if not supported
adodb-pear.inc.php:	fetchInto - does not support passing of fetchmode
adodb-pear.inc.php:	fetchRows - does not support passing of fetchmode
adodb-pear.inc.php:include_once ADODB_PEAR."/adodb-errorpear.inc.php";
adodb-pear.inc.php:define("DB_ERROR",-1);
adodb-pear.inc.php: * these are constants for the tableInfo-function
adodb-pear.inc.php:		include_once(ADODB_DIR."/drivers/adodb-$type.inc.php");
adodb-pear.inc.php:		if (!is_object($obj)) $obj =& new PEAR_Error('Unknown Database Driver: '.$dsninfo['phptype'],-1);
adodb-pear.inc.php:			 @include_once("adodb-$type.inc.php");
adodb-pear.inc.php:			 @include_once("adodb-$type.inc.php");
adodb-pear.inc.php:			$obj =& new PEAR_Error('Unknown Database Driver: '.$dsninfo['phptype'],-1);
adodb-pear.inc.php:				case 'dialect': 	$obj->dialect = $v; break;
adodb-pear.inc.php:				case 'charset':		$obj->charset = $v; break;
adodb-pear.inc.php:				case 'buffers':		$obj->buffers = $v; break;
adodb-pear.inc.php:				case 'charpage':	$obj->charPage = $v; break;
adodb-pear.inc.php:				case 'clientflags': $obj->clientFlags = $v; break;
adodb-pear.inc.php:		if($persist) $ok = $obj->PConnect($dsninfo['hostspec'], $dsninfo['username'],$dsninfo['password'],$dsninfo['database']);
adodb-pear.inc.php:		else  $ok = $obj->Connect($dsninfo['hostspec'], $dsninfo['username'],$dsninfo['password'],$dsninfo['database']);
adodb-perf.inc.php:V4.54 5 Nov 2004  (c) 2000-2004 John Lim (jlim@natsoft.com.my). All rights reserved.
adodb-perf.inc.php:	$conn->fnExecute = false;
adodb-perf.inc.php:	$rs =& $conn->Execute($sql,$inputarr);
adodb-perf.inc.php:	if (!empty($conn->_logsql)) {
adodb-perf.inc.php:		$conn->_logsql = false; // disable logsql error simulation
adodb-perf.inc.php:		$dbT = $conn->databaseType;
adodb-perf.inc.php:		$time = $a1 - $a0;
adodb-perf.inc.php:			$errM = $conn->ErrorMsg();
adodb-perf.inc.php:			$errN = $conn->ErrorNo();
adodb-perf.inc.php:			$conn->lastInsID = 0;
adodb-perf.inc.php:			$dbg = $conn->debug;
adodb-perf.inc.php:			$conn->debug = false;
adodb-perf.inc.php:			if (!is_object($rs) || $rs->dataProvider == 'empty') 
adodb-perf.inc.php:				$conn->_affected = $conn->affected_rows(true);
adodb-perf.inc.php:			$conn->lastInsID = @$conn->Insert_ID();
adodb-perf.inc.php:			$conn->debug = $dbg;
adodb-perf.inc.php:		$saved = $conn->debug;
adodb-perf.inc.php:		$conn->debug = 0;
adodb-perf.inc.php:		$d = $conn->sysTimeStamp;
adodb-perf.inc.php:		if (empty($d)) $d = date("'Y-m-d H:i:s'");
adodb-perf.inc.php:		if ($conn->dataProvider == 'oci8' && $dbT != 'oci8po') {
adodb-perf.inc.php:			$sql1 = $conn->qstr($arr['b']);
adodb-perf.inc.php:			$sql2 = $conn->qstr($arr['c']);
adodb-perf.inc.php:			$params = $conn->qstr($arr['d']);
adodb-perf.inc.php:			$tracer = $conn->qstr($arr['e']);
adodb-perf.inc.php:		$ok = $conn->Execute($isql,$arr);
adodb-perf.inc.php:		$conn->debug = $saved;
adodb-perf.inc.php:			$conn->_logsql = true; 
adodb-perf.inc.php:			$err2 = $conn->ErrorMsg();
adodb-perf.inc.php:			$conn->_logsql = true; // enable logsql error simulation
adodb-perf.inc.php:				if ($perf->CreateLogTable()) $ok = $conn->Execute($isql,$arr);
adodb-perf.inc.php:				$ok = $conn->Execute("create table $perf_table (
adodb-perf.inc.php:				$conn->_logsql = false;
adodb-perf.inc.php:		$conn->_errorMsg = $errM;
adodb-perf.inc.php:		$conn->_errorCode = $errN;
adodb-perf.inc.php:	$conn->fnExecute = 'adodb_log_sql';
adodb-perf.inc.php:		e.g. to invoke $this->GetIndexValue(), set this array element to '=GetIndexValue',
adodb-perf.inc.php:		// http://msdn.microsoft.com/library/default.asp?url=/library/en-us/wmisdk/wmi/example__obtaining_raw_performance_data.asp
adodb-perf.inc.php:			$info[0] = $c->PercentProcessorTime;
adodb-perf.inc.php:			$info[3] = $c->TimeStamp_Sys100NS;
adodb-perf.inc.php:		// Algorithm - Steve Blinch (BlitzAffe Online, http://www.blitzaffe.com)
adodb-perf.inc.php:		$info = $this->_CPULoad();
adodb-perf.inc.php:		if (empty($this->_lastLoad)) {
adodb-perf.inc.php:			$this->_lastLoad = $info;
adodb-perf.inc.php:			$info = $this->_CPULoad();
adodb-perf.inc.php:		$last = $this->_lastLoad;
adodb-perf.inc.php:		$this->_lastLoad = $info;
adodb-perf.inc.php:		$d_user = $info[0] - $last[0];
adodb-perf.inc.php:		$d_nice = $info[1] - $last[1];
adodb-perf.inc.php:		$d_system = $info[2] - $last[2];
adodb-perf.inc.php:		$d_idle = $info[3] - $last[3];
adodb-perf.inc.php:		//printf("Delta - User: %f  Nice: %f  System: %f  Idle: %f<br>",$d_user,$d_nice,$d_system,$d_idle);
adodb-perf.inc.php:			return 100*(1-$d_user/$d_idle);
adodb-perf.inc.php:		$saveE = $this->conn->fnExecute;
adodb-perf.inc.php:		$this->conn->fnExecute = false;
adodb-perf.inc.php:		$sqlq = $this->conn->qstr($sql);
adodb-perf.inc.php:		$arr = $this->conn->GetArray(
adodb-perf.inc.php:		$this->conn->fnExecute = $saveE;
adodb-perf.inc.php:		$saveE = $this->conn->fnExecute;
adodb-perf.inc.php:		$this->conn->fnExecute = false;
adodb-perf.inc.php:		$rs =& $this->conn->SelectLimit("select distinct count(*),sql1,tracer as error_msg from $perf_table where tracer like 'ERROR:%' group by sql1,tracer order by 1 desc",$numsql);//,$numsql);
adodb-perf.inc.php:		$this->conn->fnExecute = $saveE;
adodb-perf.inc.php:			return "<p>$this->helpurl. ".$this->conn->ErrorMsg()."</p>";
adodb-perf.inc.php:			$saveE = $this->conn->fnExecute;
adodb-perf.inc.php:			$this->conn->fnExecute = false;
adodb-perf.inc.php:				echo "<a name=explain></a>".$this->Explain($HTTP_GET_VARS['sql'],$partial)."\n";
adodb-perf.inc.php:			$sql1 = $this->sql1;
adodb-perf.inc.php:			//$this->conn->debug=1;
adodb-perf.inc.php:			$rs =& $this->conn->SelectLimit(
adodb-perf.inc.php:				where {$this->conn->upperCase}({$this->conn->substr}(sql0,1,5)) not in ('DROP ','INSER','COMMI','CREAT')
adodb-perf.inc.php:			$this->conn->fnExecute = $saveE;
adodb-perf.inc.php:			if (!$rs) return "<p>$this->helpurl. ".$this->conn->ErrorMsg()."</p>";
adodb-perf.inc.php:			$max = $this->maxLength;
adodb-perf.inc.php:			while (!$rs->EOF) {
adodb-perf.inc.php:				$sql = $rs->fields[1];
adodb-perf.inc.php:				if (strlen($raw)>$max-100) {
adodb-perf.inc.php:					$sql2 = substr($sql,0,$max-500);
adodb-perf.inc.php:				if ($this->explain == false || strlen($prefix)>$max) {
adodb-perf.inc.php:				$s .= "<tr><td>".adodb_round($rs->fields[0],6)."<td align=right>".$rs->fields[2]."<td><font size=-1>".$prefix.htmlspecialchars($sql).$suffix."</font>".
adodb-perf.inc.php:					"<td>".$rs->fields[3]."<td>".$rs->fields[4]."</tr>";
adodb-perf.inc.php:				$rs->MoveNext();
adodb-perf.inc.php:			$saveE = $this->conn->fnExecute;
adodb-perf.inc.php:			$this->conn->fnExecute = false;
adodb-perf.inc.php:				echo "<a name=explain></a>".$this->Explain($HTTP_GET_VARS['sql'],$partial)."\n";
adodb-perf.inc.php:			$sql1 = $this->sql1;
adodb-perf.inc.php:			$rs =& $this->conn->SelectLimit(
adodb-perf.inc.php:				where {$this->conn->upperCase}({$this->conn->substr}(sql0,1,5))  not in ('DROP ','INSER','COMMI','CREAT')
adodb-perf.inc.php:			$this->conn->fnExecute = $saveE;
adodb-perf.inc.php:			if (!$rs) return "<p>$this->helpurl. ".$this->conn->ErrorMsg()."</p>";
adodb-perf.inc.php:			$max = $this->maxLength;
adodb-perf.inc.php:			while (!$rs->EOF) {
adodb-perf.inc.php:				$sql = $rs->fields[1];
adodb-perf.inc.php:				if (strlen($raw)>$max-100) {
adodb-perf.inc.php:					$sql2 = substr($sql,0,$max-500);
adodb-perf.inc.php:				if($this->explain == false || strlen($prefix>$max)) {
adodb-perf.inc.php:				$s .= "<tr><td>".adodb_round($rs->fields[0],6)."<td align=right>".$rs->fields[2]."<td><font size=-1>".$prefix.htmlspecialchars($sql).$suffix."</font>".
adodb-perf.inc.php:					"<td>".$rs->fields[3]."<td>".$rs->fields[4]."</tr>";
adodb-perf.inc.php:				$rs->MoveNext();
adodb-perf.inc.php:		if (empty($this->settings[$param])) return false;
adodb-perf.inc.php:		$sql = $this->settings[$param][1];
adodb-perf.inc.php:		return $this->_DBParameter($sql);
adodb-perf.inc.php:		$arr[0] = (float)$this->DBParameter('data cache hit ratio');
adodb-perf.inc.php:		$arr[1] = (float)$this->DBParameter('data reads');
adodb-perf.inc.php:		$arr[2] = (float)$this->DBParameter('data writes');
adodb-perf.inc.php:		$arr[3] = (integer) $this->DBParameter('current connections');
adodb-perf.inc.php:		Low-level Get Database Parameter
adodb-perf.inc.php:		$savelog = $this->conn->LogSQL(false);
adodb-perf.inc.php:			$rs = $this->conn->Execute($sql1);
adodb-perf.inc.php:				while (!$rs->EOF) {
adodb-perf.inc.php:					$keyf = reset($rs->fields);
adodb-perf.inc.php:						$ret = $rs->fields[$pos];
adodb-perf.inc.php:					$rs->MoveNext();
adodb-perf.inc.php:				$rs->Close();
adodb-perf.inc.php:			$this->conn->LogSQL($savelog);
adodb-perf.inc.php:				return $this->$fn();
adodb-perf.inc.php:			$sql = str_replace('$DATABASE',$this->conn->database,$sql);
adodb-perf.inc.php:			$ret = $this->conn->GetOne($sql);
adodb-perf.inc.php:			$this->conn->LogSQL($savelog);
adodb-perf.inc.php:		if ($val < $this->warnRatio) 
adodb-perf.inc.php:			 return '<font color=red><b>Cache ratio should be at least '.$this->warnRatio.'%</b></font>';
adodb-perf.inc.php:	$conn = $this->conn;
adodb-perf.inc.php:	$app = $conn->host;
adodb-perf.inc.php:	if ($conn->host && $conn->database) $app .= ', db=';
adodb-perf.inc.php:	$app .= $conn->database;
adodb-perf.inc.php:	$savelog = $this->conn->LogSQL(false);	
adodb-perf.inc.php:	$info = $conn->ServerInfo();
adodb-perf.inc.php:		$this->conn->Execute("delete from $perf_table");
adodb-perf.inc.php:	$this->conn->LogSQL($savelog);
adodb-perf.inc.php:			echo $this->HealthCheck();
adodb-perf.inc.php:			//$this->conn->debug=1;
adodb-perf.inc.php:			echo $this->CheckMemory();
adodb-perf.inc.php:			$this->Poll($pollsecs);
adodb-perf.inc.php:			$this->DoSQLForm();
adodb-perf.inc.php:			echo($this->SuspiciousSQL($nsql));
adodb-perf.inc.php:			echo($this->ExpensiveSQL($nsql));
adodb-perf.inc.php:			echo($this->InvalidSQL($nsql));
adodb-perf.inc.php:			echo $this->Tables(); break;
adodb-perf.inc.php:		Runs in infinite loop, returning real-time statistics
adodb-perf.inc.php:		$this->conn->fnExecute = false;
adodb-perf.inc.php:		//$this->conn->debug=1;
adodb-perf.inc.php:		$arro =& $this->PollParameters();
adodb-perf.inc.php:			$arr =& $this->PollParameters();
adodb-perf.inc.php:			$reads  = sprintf('%12.4f',($arr[1]-$arro[1])/$secs);
adodb-perf.inc.php:			$writes = sprintf('%12.4f',($arr[2]-$arro[2])/$secs);
adodb-perf.inc.php:			$load = $this->CPULoad();
adodb-perf.inc.php:				$oslabel = 'WS-CPU%';
adodb-perf.inc.php:		return $this->HealthCheck(true);
adodb-perf.inc.php:		$saveE = $this->conn->fnExecute;
adodb-perf.inc.php:		$this->conn->fnExecute = false;	
adodb-perf.inc.php:		else $html = $this->table.'<tr><td colspan=3><h3>'.$this->conn->databaseType.'</h3></td></tr>'.$this->titles;
adodb-perf.inc.php:		foreach($this->settings as $name => $arr) {
adodb-perf.inc.php:				if ($cli) $html .= " -- $arr -- \n";
adodb-perf.inc.php:				else $html .= "<tr bgcolor=$this->color><td colspan=3><i>$arr</i> &nbsp;</td></tr>";
adodb-perf.inc.php:			$val = $this->_DBParameter($how);
adodb-perf.inc.php:				$desc = $this->$fn($val);
adodb-perf.inc.php:				$m = $this->conn->ErrorMsg();
adodb-perf.inc.php:				//$bgc = ($bgc == ' bgcolor='.$this->color) ? ' bgcolor=white' : ' bgcolor='.$this->color;
adodb-perf.inc.php:				$html  .= str_replace('&nbsp;','',sprintf($this->cliFormat,strip_tags($name),strip_tags($val),strip_tags($desc)));
adodb-perf.inc.php:		$this->conn->fnExecute = $saveE;
adodb-perf.inc.php:		if (!$this->tablesSQL) return false;
adodb-perf.inc.php:		$savelog = $this->conn->LogSQL(false);
adodb-perf.inc.php:		$rs = $this->conn->Execute($this->tablesSQL.' order by '.$orderby);
adodb-perf.inc.php:		$this->conn->LogSQL($savelog);
adodb-perf.inc.php:		if (!$this->createTableSQL) return false;
adodb-perf.inc.php:		$savelog = $this->conn->LogSQL(false);
adodb-perf.inc.php:		$ok = $this->conn->Execute($this->createTableSQL);
adodb-perf.inc.php:		$this->conn->LogSQL($savelog);
adodb-perf.inc.php:		$sql = $this->undomq(trim($sql));
adodb-perf.inc.php:		if (substr($sql,strlen($sql)-1) === ';') {
adodb-perf.inc.php:			$sqla = $this->SplitSQL($sql);
adodb-perf.inc.php:			$savelog = $this->conn->LogSQL(false);
adodb-perf.inc.php:			$rs = $this->conn->Execute($sqls);
adodb-perf.inc.php:			$this->conn->LogSQL($savelog);
adodb-perf.inc.php:			if ($rs && is_object($rs) && !$rs->EOF) {
adodb-perf.inc.php:				while ($rs->NextRecordSet()) {
adodb-perf.inc.php:				$e1 = (integer) $this->conn->ErrorNo();
adodb-perf.inc.php:				$e2 = $this->conn->ErrorMsg();
adodb-perf.inc.php:					if (empty($e1)) $e1 = '-1'; // postgresql fix
adodb-perf.inc.php.#.LENS-03-09-05:V4.23 16 June 2004  (c) 2000-2004 John Lim (jlim@natsoft.com.my). All rights reserved.
adodb-perf.inc.php.#.LENS-03-09-05:	$conn->fnExecute = false;
adodb-perf.inc.php.#.LENS-03-09-05:	$rs =& $conn->Execute($sql,$inputarr);
adodb-perf.inc.php.#.LENS-03-09-05:	if (!empty($conn->_logsql)) {
adodb-perf.inc.php.#.LENS-03-09-05:		$conn->_logsql = false; // disable logsql error simulation
adodb-perf.inc.php.#.LENS-03-09-05:		$dbT = $conn->databaseType;
adodb-perf.inc.php.#.LENS-03-09-05:		$time = $a1 - $a0;
adodb-perf.inc.php.#.LENS-03-09-05:			$errM = $conn->ErrorMsg();
adodb-perf.inc.php.#.LENS-03-09-05:			$errN = $conn->ErrorNo();
adodb-perf.inc.php.#.LENS-03-09-05:			$conn->lastInsID = 0;
adodb-perf.inc.php.#.LENS-03-09-05:			$dbg = $conn->debug;
adodb-perf.inc.php.#.LENS-03-09-05:			$conn->debug = false;
adodb-perf.inc.php.#.LENS-03-09-05:			if (!is_object($rs) || $rs->dataProvider == 'empty') 
adodb-perf.inc.php.#.LENS-03-09-05:				$conn->_affected = $conn->affected_rows(true);
adodb-perf.inc.php.#.LENS-03-09-05:			$conn->lastInsID = @$conn->Insert_ID();
adodb-perf.inc.php.#.LENS-03-09-05:			$conn->debug = $dbg;
adodb-perf.inc.php.#.LENS-03-09-05:		$saved = $conn->debug;
adodb-perf.inc.php.#.LENS-03-09-05:		$conn->debug = 0;
adodb-perf.inc.php.#.LENS-03-09-05:		if ($conn->dataProvider == 'oci8' && $dbT != 'oci8po') {
adodb-perf.inc.php.#.LENS-03-09-05:			$isql = "insert into $perf_table values($conn->sysTimeStamp,:b,:c,:d,:e,:f)";
adodb-perf.inc.php.#.LENS-03-09-05:			$sql1 = $conn->qstr($arr['b']);
adodb-perf.inc.php.#.LENS-03-09-05:			$sql2 = $conn->qstr($arr['c']);
adodb-perf.inc.php.#.LENS-03-09-05:			$params = $conn->qstr($arr['d']);
adodb-perf.inc.php.#.LENS-03-09-05:			$tracer = $conn->qstr($arr['e']);
adodb-perf.inc.php.#.LENS-03-09-05:			$isql = "insert into $perf_table (created,sql0,sql1,params,tracer,timer) values($conn->sysTimeStamp,$sql1,$sql2,$params,$tracer,$timer)";
adodb-perf.inc.php.#.LENS-03-09-05:			$isql = "insert into $perf_table (created,sql0,sql1,params,tracer,timer) values( $conn->sysTimeStamp,?,?,?,?,?)";
adodb-perf.inc.php.#.LENS-03-09-05:		$ok = $conn->Execute($isql,$arr);
adodb-perf.inc.php.#.LENS-03-09-05:		$conn->debug = $saved;
adodb-perf.inc.php.#.LENS-03-09-05:			$conn->_logsql = true; 
adodb-perf.inc.php.#.LENS-03-09-05:			$err2 = $conn->ErrorMsg();
adodb-perf.inc.php.#.LENS-03-09-05:			$conn->_logsql = true; // enable logsql error simulation
adodb-perf.inc.php.#.LENS-03-09-05:				if ($perf->CreateLogTable()) $ok = $conn->Execute($isql,$arr);
adodb-perf.inc.php.#.LENS-03-09-05:				$ok = $conn->Execute("create table $perf_table (
adodb-perf.inc.php.#.LENS-03-09-05:				$conn->_logsql = false;
adodb-perf.inc.php.#.LENS-03-09-05:		$conn->_errorMsg = $errM;
adodb-perf.inc.php.#.LENS-03-09-05:		$conn->_errorCode = $errN;
adodb-perf.inc.php.#.LENS-03-09-05:	$conn->fnExecute = 'adodb_log_sql';
adodb-perf.inc.php.#.LENS-03-09-05:		e.g. to invoke $this->GetIndexValue(), set this array element to '=GetIndexValue',
adodb-perf.inc.php.#.LENS-03-09-05:		// http://msdn.microsoft.com/library/default.asp?url=/library/en-us/wmisdk/wmi/example__obtaining_raw_performance_data.asp
adodb-perf.inc.php.#.LENS-03-09-05:			$info[0] = $c->PercentProcessorTime;
adodb-perf.inc.php.#.LENS-03-09-05:			$info[3] = $c->TimeStamp_Sys100NS;
adodb-perf.inc.php.#.LENS-03-09-05:		// Algorithm - Steve Blinch (BlitzAffe Online, http://www.blitzaffe.com)
adodb-perf.inc.php.#.LENS-03-09-05:		$info = $this->_CPULoad();
adodb-perf.inc.php.#.LENS-03-09-05:		if (empty($this->_lastLoad)) {
adodb-perf.inc.php.#.LENS-03-09-05:			$this->_lastLoad = $info;
adodb-perf.inc.php.#.LENS-03-09-05:			$info = $this->_CPULoad();
adodb-perf.inc.php.#.LENS-03-09-05:		$last = $this->_lastLoad;
adodb-perf.inc.php.#.LENS-03-09-05:		$this->_lastLoad = $info;
adodb-perf.inc.php.#.LENS-03-09-05:		$d_user = $info[0] - $last[0];
adodb-perf.inc.php.#.LENS-03-09-05:		$d_nice = $info[1] - $last[1];
adodb-perf.inc.php.#.LENS-03-09-05:		$d_system = $info[2] - $last[2];
adodb-perf.inc.php.#.LENS-03-09-05:		$d_idle = $info[3] - $last[3];
adodb-perf.inc.php.#.LENS-03-09-05:		//printf("Delta - User: %f  Nice: %f  System: %f  Idle: %f<br>",$d_user,$d_nice,$d_system,$d_idle);
adodb-perf.inc.php.#.LENS-03-09-05:			return 100*(1-$d_user/$d_idle);
adodb-perf.inc.php.#.LENS-03-09-05:		$saveE = $this->conn->fnExecute;
adodb-perf.inc.php.#.LENS-03-09-05:		$this->conn->fnExecute = false;
adodb-perf.inc.php.#.LENS-03-09-05:		$sqlq = $this->conn->qstr($sql);
adodb-perf.inc.php.#.LENS-03-09-05:		$arr = $this->conn->GetArray(
adodb-perf.inc.php.#.LENS-03-09-05:		$this->conn->fnExecute = $saveE;
adodb-perf.inc.php.#.LENS-03-09-05:		$saveE = $this->conn->fnExecute;
adodb-perf.inc.php.#.LENS-03-09-05:		$this->conn->fnExecute = false;
adodb-perf.inc.php.#.LENS-03-09-05:		$rs =& $this->conn->SelectLimit("select distinct count(*),sql1,tracer as error_msg from $perf_table where tracer like 'ERROR:%' group by sql1,tracer order by 1 desc",$numsql);//,$numsql);
adodb-perf.inc.php.#.LENS-03-09-05:		$this->conn->fnExecute = $saveE;
adodb-perf.inc.php.#.LENS-03-09-05:			return "<p>$this->helpurl. ".$this->conn->ErrorMsg()."</p>";
adodb-perf.inc.php.#.LENS-03-09-05:			$saveE = $this->conn->fnExecute;
adodb-perf.inc.php.#.LENS-03-09-05:			$this->conn->fnExecute = false;
adodb-perf.inc.php.#.LENS-03-09-05:				echo "<a name=explain></a>".$this->Explain($HTTP_GET_VARS['sql'],$partial)."\n";
adodb-perf.inc.php.#.LENS-03-09-05:			$sql1 = $this->sql1;
adodb-perf.inc.php.#.LENS-03-09-05:			//$this->conn->debug=1;
adodb-perf.inc.php.#.LENS-03-09-05:			$rs =& $this->conn->SelectLimit(
adodb-perf.inc.php.#.LENS-03-09-05:				where {$this->conn->upperCase}({$this->conn->substr}(sql0,1,5)) not in ('DROP ','INSER','COMMI','CREAT')
adodb-perf.inc.php.#.LENS-03-09-05:			$this->conn->fnExecute = $saveE;
adodb-perf.inc.php.#.LENS-03-09-05:			if (!$rs) return "<p>$this->helpurl. ".$this->conn->ErrorMsg()."</p>";
adodb-perf.inc.php.#.LENS-03-09-05:			$max = $this->maxLength;
adodb-perf.inc.php.#.LENS-03-09-05:			while (!$rs->EOF) {
adodb-perf.inc.php.#.LENS-03-09-05:				$sql = $rs->fields[1];
adodb-perf.inc.php.#.LENS-03-09-05:				if (strlen($raw)>$max-100) {
adodb-perf.inc.php.#.LENS-03-09-05:					$sql2 = substr($sql,0,$max-500);
adodb-perf.inc.php.#.LENS-03-09-05:				if ($this->explain == false || strlen($prefix)>$max) {
adodb-perf.inc.php.#.LENS-03-09-05:				$s .= "<tr><td>".adodb_round($rs->fields[0],6)."<td align=right>".$rs->fields[2]."<td><font size=-1>".$prefix.htmlspecialchars($sql).$suffix."</font>".
adodb-perf.inc.php.#.LENS-03-09-05:					"<td>".$rs->fields[3]."<td>".$rs->fields[4]."</tr>";
adodb-perf.inc.php.#.LENS-03-09-05:				$rs->MoveNext();
adodb-perf.inc.php.#.LENS-03-09-05:			$saveE = $this->conn->fnExecute;
adodb-perf.inc.php.#.LENS-03-09-05:			$this->conn->fnExecute = false;
adodb-perf.inc.php.#.LENS-03-09-05:				echo "<a name=explain></a>".$this->Explain($HTTP_GET_VARS['sql'],$partial)."\n";
adodb-perf.inc.php.#.LENS-03-09-05:			$sql1 = $this->sql1;
adodb-perf.inc.php.#.LENS-03-09-05:			$rs =& $this->conn->SelectLimit(
adodb-perf.inc.php.#.LENS-03-09-05:				where {$this->conn->upperCase}({$this->conn->substr}(sql0,1,5))  not in ('DROP ','INSER','COMMI','CREAT')
adodb-perf.inc.php.#.LENS-03-09-05:			$this->conn->fnExecute = $saveE;
adodb-perf.inc.php.#.LENS-03-09-05:			if (!$rs) return "<p>$this->helpurl. ".$this->conn->ErrorMsg()."</p>";
adodb-perf.inc.php.#.LENS-03-09-05:			$max = $this->maxLength;
adodb-perf.inc.php.#.LENS-03-09-05:			while (!$rs->EOF) {
adodb-perf.inc.php.#.LENS-03-09-05:				$sql = $rs->fields[1];
adodb-perf.inc.php.#.LENS-03-09-05:				if (strlen($raw)>$max-100) {
adodb-perf.inc.php.#.LENS-03-09-05:					$sql2 = substr($sql,0,$max-500);
adodb-perf.inc.php.#.LENS-03-09-05:				if($this->explain == false || strlen($prefix>$max)) {
adodb-perf.inc.php.#.LENS-03-09-05:				$s .= "<tr><td>".adodb_round($rs->fields[0],6)."<td align=right>".$rs->fields[2]."<td><font size=-1>".$prefix.htmlspecialchars($sql).$suffix."</font>".
adodb-perf.inc.php.#.LENS-03-09-05:					"<td>".$rs->fields[3]."<td>".$rs->fields[4]."</tr>";
adodb-perf.inc.php.#.LENS-03-09-05:				$rs->MoveNext();
adodb-perf.inc.php.#.LENS-03-09-05:		if (empty($this->settings[$param])) return false;
adodb-perf.inc.php.#.LENS-03-09-05:		$sql = $this->settings[$param][1];
adodb-perf.inc.php.#.LENS-03-09-05:		return $this->_DBParameter($sql);
adodb-perf.inc.php.#.LENS-03-09-05:		$arr[0] = (float)$this->DBParameter('data cache hit ratio');
adodb-perf.inc.php.#.LENS-03-09-05:		$arr[1] = (float)$this->DBParameter('data reads');
adodb-perf.inc.php.#.LENS-03-09-05:		$arr[2] = (float)$this->DBParameter('data writes');
adodb-perf.inc.php.#.LENS-03-09-05:		$arr[3] = (integer) $this->DBParameter('current connections');
adodb-perf.inc.php.#.LENS-03-09-05:		Low-level Get Database Parameter
adodb-perf.inc.php.#.LENS-03-09-05:		$savelog = $this->conn->LogSQL(false);
adodb-perf.inc.php.#.LENS-03-09-05:			$rs = $this->conn->Execute($sql1);
adodb-perf.inc.php.#.LENS-03-09-05:				while (!$rs->EOF) {
adodb-perf.inc.php.#.LENS-03-09-05:					$keyf = reset($rs->fields);
adodb-perf.inc.php.#.LENS-03-09-05:						$ret = $rs->fields[$pos];
adodb-perf.inc.php.#.LENS-03-09-05:					$rs->MoveNext();
adodb-perf.inc.php.#.LENS-03-09-05:				$rs->Close();
adodb-perf.inc.php.#.LENS-03-09-05:			$this->conn->LogSQL($savelog);
adodb-perf.inc.php.#.LENS-03-09-05:				return $this->$fn();
adodb-perf.inc.php.#.LENS-03-09-05:			$sql = str_replace('$DATABASE',$this->conn->database,$sql);
adodb-perf.inc.php.#.LENS-03-09-05:			$ret = $this->conn->GetOne($sql);
adodb-perf.inc.php.#.LENS-03-09-05:			$this->conn->LogSQL($savelog);
adodb-perf.inc.php.#.LENS-03-09-05:		if ($val < $this->warnRatio) 
adodb-perf.inc.php.#.LENS-03-09-05:			 return '<font color=red><b>Cache ratio should be at least '.$this->warnRatio.'%</b></font>';
adodb-perf.inc.php.#.LENS-03-09-05:	$conn = $this->conn;
adodb-perf.inc.php.#.LENS-03-09-05:	$app = $conn->host;
adodb-perf.inc.php.#.LENS-03-09-05:	if ($conn->host && $conn->database) $app .= ', db=';
adodb-perf.inc.php.#.LENS-03-09-05:	$app .= $conn->database;
adodb-perf.inc.php.#.LENS-03-09-05:	$savelog = $this->conn->LogSQL(false);	
adodb-perf.inc.php.#.LENS-03-09-05:	$info = $conn->ServerInfo();
adodb-perf.inc.php.#.LENS-03-09-05:		$this->conn->Execute("delete from $perf_table");
adodb-perf.inc.php.#.LENS-03-09-05:	$this->conn->LogSQL($savelog);
adodb-perf.inc.php.#.LENS-03-09-05:			echo $this->HealthCheck();
adodb-perf.inc.php.#.LENS-03-09-05:			//$this->conn->debug=1;
adodb-perf.inc.php.#.LENS-03-09-05:			echo $this->CheckMemory();
adodb-perf.inc.php.#.LENS-03-09-05:			$this->Poll($pollsecs);
adodb-perf.inc.php.#.LENS-03-09-05:			$this->DoSQLForm();
adodb-perf.inc.php.#.LENS-03-09-05:			echo($this->SuspiciousSQL($nsql));
adodb-perf.inc.php.#.LENS-03-09-05:			echo($this->ExpensiveSQL($nsql));
adodb-perf.inc.php.#.LENS-03-09-05:			echo($this->InvalidSQL($nsql));
adodb-perf.inc.php.#.LENS-03-09-05:			echo $this->Tables(); break;
adodb-perf.inc.php.#.LENS-03-09-05:		Runs in infinite loop, returning real-time statistics
adodb-perf.inc.php.#.LENS-03-09-05:		$this->conn->fnExecute = false;
adodb-perf.inc.php.#.LENS-03-09-05:		//$this->conn->debug=1;
adodb-perf.inc.php.#.LENS-03-09-05:		$arro =& $this->PollParameters();
adodb-perf.inc.php.#.LENS-03-09-05:			$arr =& $this->PollParameters();
adodb-perf.inc.php.#.LENS-03-09-05:			$reads  = sprintf('%12.4f',($arr[1]-$arro[1])/$secs);
adodb-perf.inc.php.#.LENS-03-09-05:			$writes = sprintf('%12.4f',($arr[2]-$arro[2])/$secs);
adodb-perf.inc.php.#.LENS-03-09-05:			$load = $this->CPULoad();
adodb-perf.inc.php.#.LENS-03-09-05:				$oslabel = 'WS-CPU%';
adodb-perf.inc.php.#.LENS-03-09-05:		return $this->HealthCheck(true);
adodb-perf.inc.php.#.LENS-03-09-05:		$saveE = $this->conn->fnExecute;
adodb-perf.inc.php.#.LENS-03-09-05:		$this->conn->fnExecute = false;	
adodb-perf.inc.php.#.LENS-03-09-05:		else $html = $this->table.'<tr><td colspan=3><h3>'.$this->conn->databaseType.'</h3></td></tr>'.$this->titles;
adodb-perf.inc.php.#.LENS-03-09-05:		foreach($this->settings as $name => $arr) {
adodb-perf.inc.php.#.LENS-03-09-05:				if ($cli) $html .= " -- $arr -- \n";
adodb-perf.inc.php.#.LENS-03-09-05:				else $html .= "<tr bgcolor=$this->color><td colspan=3><i>$arr</i> &nbsp;</td></tr>";
adodb-perf.inc.php.#.LENS-03-09-05:			$val = $this->_DBParameter($how);
adodb-perf.inc.php.#.LENS-03-09-05:				$desc = $this->$fn($val);
adodb-perf.inc.php.#.LENS-03-09-05:				$m = $this->conn->ErrorMsg();
adodb-perf.inc.php.#.LENS-03-09-05:				//$bgc = ($bgc == ' bgcolor='.$this->color) ? ' bgcolor=white' : ' bgcolor='.$this->color;
adodb-perf.inc.php.#.LENS-03-09-05:				$html  .= str_replace('&nbsp;','',sprintf($this->cliFormat,strip_tags($name),strip_tags($val),strip_tags($desc)));
adodb-perf.inc.php.#.LENS-03-09-05:		$this->conn->fnExecute = $saveE;
adodb-perf.inc.php.#.LENS-03-09-05:		if (!$this->tablesSQL) return false;
adodb-perf.inc.php.#.LENS-03-09-05:		$savelog = $this->conn->LogSQL(false);
adodb-perf.inc.php.#.LENS-03-09-05:		$rs = $this->conn->Execute($this->tablesSQL.' order by '.$orderby);
adodb-perf.inc.php.#.LENS-03-09-05:		$this->conn->LogSQL($savelog);
adodb-perf.inc.php.#.LENS-03-09-05:		if (!$this->createTableSQL) return false;
adodb-perf.inc.php.#.LENS-03-09-05:		$savelog = $this->conn->LogSQL(false);
adodb-perf.inc.php.#.LENS-03-09-05:		$ok = $this->conn->Execute($this->createTableSQL);
adodb-perf.inc.php.#.LENS-03-09-05:		$this->conn->LogSQL($savelog);
adodb-perf.inc.php.#.LENS-03-09-05:		$sql = $this->undomq(trim($sql));
adodb-perf.inc.php.#.LENS-03-09-05:		if (substr($sql,strlen($sql)-1) === ';') {
adodb-perf.inc.php.#.LENS-03-09-05:			$sqla = $this->SplitSQL($sql);
adodb-perf.inc.php.#.LENS-03-09-05:			$savelog = $this->conn->LogSQL(false);
adodb-perf.inc.php.#.LENS-03-09-05:			$rs = $this->conn->Execute($sqls);
adodb-perf.inc.php.#.LENS-03-09-05:			$this->conn->LogSQL($savelog);
adodb-perf.inc.php.#.LENS-03-09-05:			if ($rs && is_object($rs) && !$rs->EOF) {
adodb-perf.inc.php.#.LENS-03-09-05:				while ($rs->NextRecordSet()) {
adodb-perf.inc.php.#.LENS-03-09-05:				$e1 = (integer) $this->conn->ErrorNo();
adodb-perf.inc.php.#.LENS-03-09-05:				$e2 = $this->conn->ErrorMsg();
adodb-perf.inc.php.#.LENS-03-09-05:					if (empty($e1)) $e1 = '-1'; // postgresql fix
adodb-php4.inc.php:  V4.54 5 Nov 2004  (c) 2000-2004 John Lim (jlim@natsoft.com.my). All rights reserved.
adodb-time.inc.php:Because of this, dates are restricted to the years 1901-2038 on Unix 
adodb-time.inc.php:and 1970-2038 on Windows due to integer overflow for dates beyond 
adodb-time.inc.php:native function's signed integers (normally 32-bits) with PHP floating 
adodb-time.inc.php:point numbers (normally 64-bits).
adodb-time.inc.php:the 32-bit signed integer range.
adodb-time.inc.php:adodb_mktime(0,0,0,10,15,1582) - adodb_mktime(0,0,0,10,4,1582) 
adodb-time.inc.php:(c) 2003-2004 John Lim and released under BSD-style license except for code by 
adodb-time.inc.php:a - "am" or "pm" 
adodb-time.inc.php:A - "AM" or "PM" 
adodb-time.inc.php:d - day of the month, 2 digits with leading zeros; i.e. "01" to "31" 
adodb-time.inc.php:D - day of the week, textual, 3 letters; e.g. "Fri" 
adodb-time.inc.php:F - month, textual, long; e.g. "January" 
adodb-time.inc.php:g - hour, 12-hour format without leading zeros; i.e. "1" to "12" 
adodb-time.inc.php:G - hour, 24-hour format without leading zeros; i.e. "0" to "23" 
adodb-time.inc.php:h - hour, 12-hour format; i.e. "01" to "12" 
adodb-time.inc.php:H - hour, 24-hour format; i.e. "00" to "23" 
adodb-time.inc.php:i - minutes; i.e. "00" to "59" 
adodb-time.inc.php:j - day of the month without leading zeros; i.e. "1" to "31" 
adodb-time.inc.php:l (lowercase 'L') - day of the week, textual, long; e.g. "Friday"  
adodb-time.inc.php:L - boolean for whether it is a leap year; i.e. "0" or "1" 
adodb-time.inc.php:m - month; i.e. "01" to "12" 
adodb-time.inc.php:M - month, textual, 3 letters; e.g. "Jan" 
adodb-time.inc.php:n - month without leading zeros; i.e. "1" to "12" 
adodb-time.inc.php:O - Difference to Greenwich time in hours; e.g. "+0200" 
adodb-time.inc.php:Q - Quarter, as in 1, 2, 3, 4 
adodb-time.inc.php:r - RFC 822 formatted date; e.g. "Thu, 21 Dec 2000 16:01:07 +0200" 
adodb-time.inc.php:s - seconds; i.e. "00" to "59" 
adodb-time.inc.php:S - English ordinal suffix for the day of the month, 2 characters; 
adodb-time.inc.php:t - number of days in the given month; i.e. "28" to "31"
adodb-time.inc.php:T - Timezone setting of this machine; e.g. "EST" or "MDT" 
adodb-time.inc.php:U - seconds since the Unix Epoch (January 1 1970 00:00:00 GMT)  
adodb-time.inc.php:w - day of the week, numeric, i.e. "0" (Sunday) to "6" (Saturday) 
adodb-time.inc.php:Y - year, 4 digits; e.g. "1999" 
adodb-time.inc.php:y - year, 2 digits; e.g. "99" 
adodb-time.inc.php:z - day of the year; i.e. "0" to "365" 
adodb-time.inc.php:Z - timezone offset in seconds (i.e. "-43200" to "43200"). 
adodb-time.inc.php:B - Swatch Internet time 
adodb-time.inc.php:I (capital i) - "1" if Daylight Savings Time, "0" otherwise.
adodb-time.inc.php:W - ISO-8601 week number of year, weeks starting on Monday 
adodb-time.inc.php:  adodb_date2('d-M-Y H:i','2003-12-25 13:01:34');
adodb-time.inc.php:work outside 32-bit signed range, so i decided not to implement it.
adodb-time.inc.php:- 18 July 2004 0.15
adodb-time.inc.php:- 23 June 2004 0.14
adodb-time.inc.php:unrealistic as it does not take into account time-zone, geographic location, current year.
adodb-time.inc.php:- 28 Apr 2004 0.13
adodb-time.inc.php:- 20 Mar 2004 0.12
adodb-time.inc.php:Fixed month calculation error in adodb_date. 2102-June-01 appeared as 2102-May-32.
adodb-time.inc.php:- 26 Oct 2003 0.11
adodb-time.inc.php:- 9 Aug 2003 0.10
adodb-time.inc.php:- 1 July 2003 0.09
adodb-time.inc.php:- 3 March 2003 0.08
adodb-time.inc.php:- 27 Feb 2003 0.07
adodb-time.inc.php:- 4 Feb 2003 0.06
adodb-time.inc.php:Fixed a typo, 1852 changed to 1582! This means that pre-1852 dates
adodb-time.inc.php:- 29 Jan 2003 0.05
adodb-time.inc.php:- 28 Jan 2003 0.04
adodb-time.inc.php:mktime uses invalid dates around 5-14 Oct 1582. Released with ADOdb 3.10.
adodb-time.inc.php:Added limbo 5-14 Oct 1582 check, when we set to 15 Oct 1582.
adodb-time.inc.php:- 27 Jan 2003 0.03
adodb-time.inc.php:- 27 Jan 2003 0.02
adodb-time.inc.php:Fixed problem with time-zones west of GMT +0000.
adodb-time.inc.php:- 24 Jan 2003 0.01
adodb-time.inc.php:	glibc-2.2.5-34 and greater has been changed to return -1 for dates <
adodb-time.inc.php:	echo (mktime(0, 0, 0, 1, 1, 1960));  // prints -1
adodb-time.inc.php:	 http://lists.debian.org/debian-glibc/2002/debian-glibc-200205/msg00010.html
adodb-time.inc.php:	if ("$y1-$m-13 00:00:00" != adodb_date('Y-n-d H:i:s',$t)) {
adodb-time.inc.php:	if (!(adodb_date('Y-m-d') == date('Y-m-d'))) print 'Error in '.adodb_mktime(0,0,0).'<br>';
adodb-time.inc.php:	if (!(adodb_date('Y-m-d',$t) == '2102-06-01')) print 'Error in '.adodb_date('Y-m-d',$t).'<br>';
adodb-time.inc.php:	if (!(adodb_date('Y-m-d',$t) == '2102-02-01')) print 'Error in '.adodb_date('Y-m-d',$t).'<br>';
adodb-time.inc.php:	//http://www.holidayorigins.com/html/columbus_day.html - Friday check
adodb-time.inc.php:	if (!(adodb_date('D Y-m-d',$t) == 'Fri 1492-10-11')) print 'Error in Columbus landing<br>';
adodb-time.inc.php:	if (!(adodb_date('Y-m-d',$t) == '1500-02-29')) print 'Error in julian leap years<br>';
adodb-time.inc.php:	if (!(adodb_date('Y-m-d',$t) == '1700-03-01')) print 'Error in gregorian leap years<br>';
adodb-time.inc.php:	$diff = (adodb_mktime(0,0,0,10,15,1582) - adodb_mktime(0,0,0,10,4,1582));
adodb-time.inc.php:	if (!(adodb_date('Y-m-d',$t) == '1965-04-02')) print 'Error in day overflow 1 <br>';
adodb-time.inc.php:	if (!(adodb_date('Y-m-d',$t) == '1971-05-03')) print 'Error in day overflow 2 <br>';
adodb-time.inc.php:	if (!(adodb_date('Y-m-d',$t) == '1965-03-01')) print 'Error in day overflow 3 '.adodb_date('Y-m-d',$t).' <br>';
adodb-time.inc.php:	if (!(adodb_date('Y-m-d',$t) == '1966-01-01')) print 'Error in day overflow 4 '.adodb_date('Y-m-d',$t).' <br>';
adodb-time.inc.php:	if (!(adodb_date('Y-m-d',$t) == '1966-02-01')) print 'Error in day overflow 5 '.adodb_date('Y-m-d',$t).' <br>';
adodb-time.inc.php:	if (!(adodb_date('Y-m-d',$t) == '1966-01-03')) print 'Error in mth overflow 1 <br>';
adodb-time.inc.php:	print "Testing 2-digit => 4-digit year conversion<p>";
adodb-time.inc.php:	if (adodb_year_digit_check(00) != 2000) print "Err 2-digit 2000<br>";
adodb-time.inc.php:	if (adodb_year_digit_check(10) != 2010) print "Err 2-digit 2010<br>";
adodb-time.inc.php:	if (adodb_year_digit_check(20) != 2020) print "Err 2-digit 2020<br>";
adodb-time.inc.php:	if (adodb_year_digit_check(30) != 2030) print "Err 2-digit 2030<br>";
adodb-time.inc.php:	if (adodb_year_digit_check(40) != 1940) print "Err 2-digit 1940<br>";
adodb-time.inc.php:	if (adodb_year_digit_check(50) != 1950) print "Err 2-digit 1950<br>";
adodb-time.inc.php:	if (adodb_year_digit_check(90) != 1990) print "Err 2-digit 1990<br>";
adodb-time.inc.php:	$fmt = '\d\a\t\e T Y-m-d H:i:s a A d D F g G h H i j l L m M n O \R\F\C822 r s t U w y Y z Z 2003';
adodb-time.inc.php:	for ($i=100; --$i > 0; ) {
adodb-time.inc.php:	// Test generation of dates outside 1901-2038
adodb-time.inc.php:	for ($i=100; --$i >= 0;) {
adodb-time.inc.php:		$y1 = 100+rand(0,1970-100);
adodb-time.inc.php:		$y1 = 3000-rand(0,3000-1970);
adodb-time.inc.php:	$i = 365.25*86400*($start-1970);
adodb-time.inc.php:	else print "<p><b>Failed</b> :-(</p>";
adodb-time.inc.php:Pope Gregory removed 10 days - October 5 to October 14 - from the year 1582 and 
adodb-time.inc.php:	    $month -= 2;
adodb-time.inc.php:	    $year--;
adodb-time.inc.php:	$day =  ( floor((13 * $month - 1) / 5) +
adodb-time.inc.php:	        floor(($year / 100) / 4) - 2 *
adodb-time.inc.php:	return (($day - 7 * floor($day / 7))) + $greg_correction;
adodb-time.inc.php: Checks for leap year, returns true if it is. No 2-digit year check. Also 
adodb-time.inc.php:	// if gregorian calendar (>1582), century not-divisible by 400 is not leap
adodb-time.inc.php: checks for leap year, returns true if it is. Has 2-digit year check
adodb-time.inc.php:	Fix 2-digit years. Works for any century.
adodb-time.inc.php: 	Assumes that if 2-digit is more than 30 years in future, then previous century.
adodb-time.inc.php:			$c0 = $century - 1;
adodb-time.inc.php:		// if 2-digit year is less than 30 years in future, set it to this century
adodb-time.inc.php:		// otherwise if more than 30 years in future, then we set 2-digit year to the prev century.
adodb-time.inc.php:	$TZ = mktime(0,0,0,1,2,1970,0) - gmmktime(0,0,0,1,2,1970,0);
adodb-time.inc.php:		if ((abs($d) <= 0x7FFFFFFF)) { // check if number in 32-bit signed range
adodb-time.inc.php:	Low-level function that returns the getdate() array. We have a special
adodb-time.inc.php:	$d =  $origd - ($is_gmt ? 0 : adodb_get_gmt_diff());
adodb-time.inc.php:	if ($d < -12219321600) $d -= 86400*10; // if 15 Oct 1582 or earlier, gregorian correction 
adodb-time.inc.php:		for ($a = 1970 ; --$a >= 0;) {
adodb-time.inc.php:		for ($a = 13 ; --$a > 0;) {
adodb-time.inc.php:		$d += ($ndays - $day+1)* $_day_power;
adodb-time.inc.php:			if ($leaf = _adodb_is_leap_year($a)) $d -= $d366;
adodb-time.inc.php:			else $d -= $d365;
adodb-time.inc.php:			$d -= $mtab[$a] * $_day_power;
adodb-time.inc.php:		$d = $d - ($day-1) * $_day_power;
adodb-time.inc.php:	$d -= $hour * $_hour_power;
adodb-time.inc.php:	$secs = $d - $min * $_min_power;
adodb-time.inc.php:			"|^([0-9]{4})[-/\.]?([0-9]{1,2})[-/\.]?([0-9]{1,2})[ -]?(([0-9]{1,2}):?([0-9]{1,2}):?([0-9\.]{1,4}))?|", 
adodb-time.inc.php:		// h-m-s-MM-DD-YY
adodb-time.inc.php:		if ((abs($d) <= 0x7FFFFFFF)) { // check if number in 32-bit signed range
adodb-time.inc.php:			$dates .= sprintf(' %s%04d',($gmt<0)?'+':'-',abs($gmt)/36); break;
adodb-time.inc.php:		case 'y': $dates .= substr($year,strlen($year)-2,2); break;
adodb-time.inc.php:			$dates .= ($is_gmt) ? 0 : -adodb_get_gmt_diff(); break;
adodb-time.inc.php:			$dates .= sprintf('%s%04d',($gmt<0)?'+':'-',abs($gmt)/36); break;
adodb-time.inc.php:			if ($hour > 12) $hh = $hour - 12; 
adodb-time.inc.php:			if ($hour > 12) $hh = $hour - 12; 
adodb-time.inc.php:	Not a very fast algorithm - O(n) operation. Could be optimized to O(1).
adodb-time.inc.php:		$mon -= $y*12;
adodb-time.inc.php:		$_total_date +=$day-1;
adodb-time.inc.php:		for ($a = 1969 ; $a >= $year; $a--) {
adodb-time.inc.php:				for($b=12;$b>$mon;$b--) {
adodb-time.inc.php:		$_total_date += $loop_table[$mon] - $day;
adodb-time.inc.php:		$_day_time = $_day_power - $_day_time;
adodb-time.inc.php:		$ret = -( $_total_date * $_day_power + $_day_time - $gmt_different);
adodb-time.inc.php:		if ($ret < -12220185600) $ret += 10*86400; // if earlier than 5 Oct 1582 - gregorian correction
adodb-time.inc.php:		else if ($ret < -12219321600) $ret = -12219321600; // if in limbo, reset to 15 Oct 1582.
Binary file adodb-time.zip matches
adodb-xmlschema.inc.php: * build a database on any ADOdb-supported platform using a simple
adodb-xmlschema.inc.php: * @author Richard Tango-Lowy & Dan Cech
adodb-xmlschema.inc.php:	require( 'adodb-datadict.inc.php' );
adodb-xmlschema.inc.php:		$this->parent =& $parent;
adodb-xmlschema.inc.php:		return is_object( $this->parent ) ? $this->parent->supportedPlatform( $platform ) : TRUE;
adodb-xmlschema.inc.php:		return is_object( $this->parent ) ? $this->parent->prefix( $name ) : $name;
adodb-xmlschema.inc.php:	* @var array Field specifier: Meta-information about each field
adodb-xmlschema.inc.php:	* @var array Table options: Table-level options
adodb-xmlschema.inc.php:		$this->parent =& $parent;
adodb-xmlschema.inc.php:		$this->name = $this->prefix($attributes['NAME']);
adodb-xmlschema.inc.php:		$this->currentElement = strtoupper( $tag );
adodb-xmlschema.inc.php:		switch( $this->currentElement ) {
adodb-xmlschema.inc.php:				if( !isset( $attributes['PLATFORM'] ) OR $this->supportedPlatform( $attributes['PLATFORM'] ) ) {
adodb-xmlschema.inc.php:					xml_set_object( $parser, $this->addIndex( $attributes ) );
adodb-xmlschema.inc.php:				if( !isset( $attributes['PLATFORM'] ) OR $this->supportedPlatform( $attributes['PLATFORM'] ) ) {
adodb-xmlschema.inc.php:					xml_set_object( $parser, $this->addData( $attributes ) );
adodb-xmlschema.inc.php:				$this->drop();
adodb-xmlschema.inc.php:				$this->addField( $fieldName, $fieldType, $fieldSize, $fieldOpts );
adodb-xmlschema.inc.php:				$this->addFieldOpt( $this->current_field, $this->currentElement );
adodb-xmlschema.inc.php:				$this->addFieldOpt( $this->current_field, $this->currentElement, $attributes['VALUE'] );
adodb-xmlschema.inc.php:				$this->addFieldOpt( $this->current_field, $this->currentElement );
adodb-xmlschema.inc.php:		switch( $this->currentElement ) {
adodb-xmlschema.inc.php:				if( isset( $this->current_field ) ) {
adodb-xmlschema.inc.php:					$this->addFieldOpt( $this->current_field, $this->currentElement, $cdata );
adodb-xmlschema.inc.php:					$this->addTableOpt( $cdata );
adodb-xmlschema.inc.php:				$this->addTableOpt( $cdata );
adodb-xmlschema.inc.php:		$this->currentElement = '';
adodb-xmlschema.inc.php:				$this->parent->addSQL( $this->create( $this->parent ) );
adodb-xmlschema.inc.php:				xml_set_object( $parser, $this->parent );
adodb-xmlschema.inc.php:				$this->destroy();
adodb-xmlschema.inc.php:				unset($this->current_field);
adodb-xmlschema.inc.php:		$this->indexes[$name] =& new dbIndex( $this, $attributes );
adodb-xmlschema.inc.php:		return $this->indexes[$name];
adodb-xmlschema.inc.php:		if( !isset( $this->data ) ) {
adodb-xmlschema.inc.php:			$this->data =& new dbData( $this, $attributes );
adodb-xmlschema.inc.php:		return $this->data;
adodb-xmlschema.inc.php:	* 	- C:  varchar
adodb-xmlschema.inc.php:	*	- X:  CLOB (character large object) or largest varchar size
adodb-xmlschema.inc.php:	*	- C2: Multibyte varchar
adodb-xmlschema.inc.php:	*	- X2: Multibyte CLOB
adodb-xmlschema.inc.php:	*	- B:  BLOB (binary large object)
adodb-xmlschema.inc.php:	*	- D:  Date (some databases do not support this, and we return a datetime type)
adodb-xmlschema.inc.php:	*	- T:  Datetime or Timestamp
adodb-xmlschema.inc.php:	*	- L:  Integer field suitable for storing booleans (0 or 1)
adodb-xmlschema.inc.php:	*	- I:  Integer (mapped to I4)
adodb-xmlschema.inc.php:	*	- I1: 1-byte integer
adodb-xmlschema.inc.php:	*	- I2: 2-byte integer
adodb-xmlschema.inc.php:	*	- I4: 4-byte integer
adodb-xmlschema.inc.php:	*	- I8: 8-byte integer
adodb-xmlschema.inc.php:	*	- F:  Floating point number
adodb-xmlschema.inc.php:	*	- N:  Numeric or decimal number
adodb-xmlschema.inc.php:		$field_id = $this->FieldID( $name );
adodb-xmlschema.inc.php:		$this->current_field = $field_id;
adodb-xmlschema.inc.php:		$this->fields[$field_id]['NAME'] = $name;
adodb-xmlschema.inc.php:		$this->fields[$field_id]['TYPE'] = $type;
adodb-xmlschema.inc.php:			$this->fields[$field_id]['SIZE'] = $size;
adodb-xmlschema.inc.php:			$this->fields[$field_id]['OPTS'][] = $opts;
adodb-xmlschema.inc.php:			$this->fields[$this->FieldID( $field )]['OPTS'][] = $opt;
adodb-xmlschema.inc.php:			$this->fields[$this->FieldID( $field )]['OPTS'][] = array( $opt => $value );
adodb-xmlschema.inc.php:	* This method takes a comma-separated list of table-level options
adodb-xmlschema.inc.php:		$this->opts[] = $opt;
adodb-xmlschema.inc.php:		return $this->opts;
adodb-xmlschema.inc.php:		if( is_array( $legacy_indexes = $xmls->dict->MetaIndexes( $this->name ) ) ) {
adodb-xmlschema.inc.php:				$sql[] = $xmls->dict->DropIndexSQL( $index, $this->name );
adodb-xmlschema.inc.php:		foreach( $this->drop_field as $field ) {
adodb-xmlschema.inc.php:			unset( $this->fields[$field] );
adodb-xmlschema.inc.php:		if( is_array( $legacy_fields = $xmls->dict->MetaColumns( $this->name ) ) ) {
adodb-xmlschema.inc.php:			if( $this->drop_table ) {
adodb-xmlschema.inc.php:				$sql[] = $xmls->dict->DropTableSQL( $this->name );
adodb-xmlschema.inc.php:				if( !isset( $this->fields[$field_id] ) ) {
adodb-xmlschema.inc.php:					$sql[] = $xmls->dict->DropColumnSQL( $this->name, '`'.$field->name.'`' );
adodb-xmlschema.inc.php:			if( $this->drop_table ) {
adodb-xmlschema.inc.php:		foreach( $this->fields as $field_id => $finfo ) {
adodb-xmlschema.inc.php:			$sql[] = $xmls->dict->CreateTableSQL( $this->name, $fldarray, $this->opts );
adodb-xmlschema.inc.php:			logMsg( "Upgrading {$this->name} using '{$xmls->upgrade}'" );
adodb-xmlschema.inc.php:			switch( $xmls->upgrade ) {
adodb-xmlschema.inc.php:					$sql[] = $xmls->dict->ChangeTableSQL( $this->name, $fldarray, $this->opts );
adodb-xmlschema.inc.php:					$sql[] = $xmls->dict->DropTableSQL( $this->name );
adodb-xmlschema.inc.php:					$sql[] = $xmls->dict->CreateTableSQL( $this->name, $fldarray, $this->opts );
adodb-xmlschema.inc.php:		foreach( $this->indexes as $index ) {
adodb-xmlschema.inc.php:			$sql[] = $index->create( $xmls );
adodb-xmlschema.inc.php:		if( isset( $this->data ) ) {
adodb-xmlschema.inc.php:			$sql[] = $this->data->create( $xmls );
adodb-xmlschema.inc.php:		if( isset( $this->current_field ) ) {
adodb-xmlschema.inc.php:			logMsg( "Dropping field '{$this->current_field}' from table '{$this->name}'" );
adodb-xmlschema.inc.php:			// $this->drop_field[$this->current_field] = $xmls->dict->DropColumnSQL( $this->name, $this->current_field );
adodb-xmlschema.inc.php:			$this->drop_field[$this->current_field] = $this->current_field;
adodb-xmlschema.inc.php:			logMsg( "Dropping table '{$this->name}'" );
adodb-xmlschema.inc.php:			// $this->drop_table = $xmls->dict->DropTableSQL( $this->name );
adodb-xmlschema.inc.php:			$this->drop_table = TRUE;
adodb-xmlschema.inc.php:	* @var array	Index options: Index-level options
adodb-xmlschema.inc.php:		$this->parent =& $parent;
adodb-xmlschema.inc.php:		$this->name = $this->prefix ($attributes['NAME']);
adodb-xmlschema.inc.php:		$this->currentElement = strtoupper( $tag );
adodb-xmlschema.inc.php:		switch( $this->currentElement ) {
adodb-xmlschema.inc.php:				$this->drop();
adodb-xmlschema.inc.php:				$this->addIndexOpt( $this->currentElement );
adodb-xmlschema.inc.php:		switch( $this->currentElement ) {
adodb-xmlschema.inc.php:				$this->addField( $cdata );
adodb-xmlschema.inc.php:		$this->currentElement = '';
adodb-xmlschema.inc.php:				xml_set_object( $parser, $this->parent );
adodb-xmlschema.inc.php:		$this->columns[$this->FieldID( $name )] = $name;
adodb-xmlschema.inc.php:		return $this->columns;
adodb-xmlschema.inc.php:	* @param string $opt Comma-separated list of index options.
adodb-xmlschema.inc.php:		$this->opts[] = $opt;
adodb-xmlschema.inc.php:		return $this->opts;
adodb-xmlschema.inc.php:		if( $this->drop ) {
adodb-xmlschema.inc.php:		foreach( $this->columns as $id => $col ) {
adodb-xmlschema.inc.php:			if( !isset( $this->parent->fields[$id] ) ) {
adodb-xmlschema.inc.php:				unset( $this->columns[$id] );
adodb-xmlschema.inc.php:		return $xmls->dict->CreateIndexSQL( $this->name, $this->parent->name, $this->columns, $this->opts );
adodb-xmlschema.inc.php:		$this->drop = TRUE;
adodb-xmlschema.inc.php:		$this->parent =& $parent;
adodb-xmlschema.inc.php:		$this->currentElement = strtoupper( $tag );
adodb-xmlschema.inc.php:		switch( $this->currentElement ) {
adodb-xmlschema.inc.php:				$this->row = count( $this->data );
adodb-xmlschema.inc.php:				$this->data[$this->row] = array();
adodb-xmlschema.inc.php:				$this->addField($attributes);
adodb-xmlschema.inc.php:		switch( $this->currentElement ) {
adodb-xmlschema.inc.php:				$this->addData( $cdata );
adodb-xmlschema.inc.php:		$this->currentElement = '';
adodb-xmlschema.inc.php:				xml_set_object( $parser, $this->parent );
adodb-xmlschema.inc.php:			$name = count($this->data[$this->row]);
adodb-xmlschema.inc.php:		$this->current_field = $this->FieldID( $name );
adodb-xmlschema.inc.php:	* @param string $opt Comma-separated list of index options.
adodb-xmlschema.inc.php:		if( !isset( $this->data[$this->row] ) ) {
adodb-xmlschema.inc.php:			$this->data[$this->row] = array();
adodb-xmlschema.inc.php:		if( !isset( $this->data[$this->row][$this->current_field] ) ) {
adodb-xmlschema.inc.php:			$this->data[$this->row][$this->current_field] = '';
adodb-xmlschema.inc.php:		$this->data[$this->row][$this->current_field] .= $cdata;
adodb-xmlschema.inc.php:		$table = $xmls->dict->TableName($this->parent->name);
adodb-xmlschema.inc.php:		$table_field_count = count($this->parent->fields);
adodb-xmlschema.inc.php:		foreach( $this->data as $row ) {
adodb-xmlschema.inc.php:			$table_fields = $this->parent->fields;
adodb-xmlschema.inc.php:						$fields[$name] = $xmls->db->qstr( $field_data );
adodb-xmlschema.inc.php:		$this->parent =& $parent;
adodb-xmlschema.inc.php:			$this->prefixKey = $attributes['KEY'];
adodb-xmlschema.inc.php:				$this->prefixMethod = 'AUTO';
adodb-xmlschema.inc.php:				$this->prefixMethod = 'MANUAL';
adodb-xmlschema.inc.php:				$this->prefixMethod = 'NONE';
adodb-xmlschema.inc.php:		$this->currentElement = strtoupper( $tag );
adodb-xmlschema.inc.php:		switch( $this->currentElement ) {
adodb-xmlschema.inc.php:				if( !isset( $attributes['PLATFORM'] ) OR $this->supportedPlatform( $attributes['PLATFORM'] ) ) {
adodb-xmlschema.inc.php:					$this->newQuery();
adodb-xmlschema.inc.php:					$this->discardQuery();
adodb-xmlschema.inc.php:		switch( $this->currentElement ) {
adodb-xmlschema.inc.php:				$this->buildQuery( $cdata );
adodb-xmlschema.inc.php:		$this->currentElement = '';
adodb-xmlschema.inc.php:				$this->addQuery();
adodb-xmlschema.inc.php:				$this->parent->addSQL( $this->create( $this->parent ) );
adodb-xmlschema.inc.php:				xml_set_object( $parser, $this->parent );
adodb-xmlschema.inc.php:				$this->destroy();
adodb-xmlschema.inc.php:	* Re-initializes the query.
adodb-xmlschema.inc.php:		$this->query = '';
adodb-xmlschema.inc.php:		unset( $this->query );
adodb-xmlschema.inc.php:		if( !isset( $this->query ) OR empty( $sql ) ) {
adodb-xmlschema.inc.php:		$this->query .= $sql;
adodb-xmlschema.inc.php:		return $this->query;
adodb-xmlschema.inc.php:		if( !isset( $this->query ) ) {
adodb-xmlschema.inc.php:		$this->queries[] = $return = trim($this->query);
adodb-xmlschema.inc.php:		unset( $this->query );
adodb-xmlschema.inc.php:		foreach( $this->queries as $id => $query ) {
adodb-xmlschema.inc.php:			switch( $this->prefixMethod ) {
adodb-xmlschema.inc.php:					$query = $this->prefixQuery( '/^\s*((?is)INSERT\s+(INTO\s+)?)((\w+\s*,?\s*)+)(\s.*$)/', $query, $xmls->objectPrefix );
adodb-xmlschema.inc.php:					$query = $this->prefixQuery( '/^\s*((?is)UPDATE\s+(FROM\s+)?)((\w+\s*,?\s*)+)(\s.*$)/', $query, $xmls->objectPrefix );
adodb-xmlschema.inc.php:					$query = $this->prefixQuery( '/^\s*((?is)DELETE\s+(FROM\s+)?)((\w+\s*,?\s*)+)(\s.*$)/', $query, $xmls->objectPrefix );
adodb-xmlschema.inc.php:					if( isset( $this->prefixKey ) AND( $this->prefixKey !== '' ) ) {
adodb-xmlschema.inc.php:						$query = str_replace( $this->prefixKey, $xmls->objectPrefix, $query );
adodb-xmlschema.inc.php:						$query = str_replace( XMLS_PREFIX , $xmls->objectPrefix, $query );
adodb-xmlschema.inc.php:			$this->queries[$id] = trim( $query );
adodb-xmlschema.inc.php:		return $this->queries;
adodb-xmlschema.inc.php:* Loads and parses an XML file, creating an array of "ready-to-run" SQL statements
adodb-xmlschema.inc.php:* @author Richard Tango-Lowy & Dan Cech
adodb-xmlschema.inc.php:		$this->mgq = get_magic_quotes_runtime();
adodb-xmlschema.inc.php:		$this->db =& $db;
adodb-xmlschema.inc.php:		$this->debug = $this->db->debug;
adodb-xmlschema.inc.php:		$this->dict = NewDataDictionary( $this->db );
adodb-xmlschema.inc.php:		$this->sqlArray = array();
adodb-xmlschema.inc.php:		$this->schemaVersion = XMLS_SCHEMA_VERSION;
adodb-xmlschema.inc.php:		$this->executeInline( XMLS_EXECUTE_INLINE );
adodb-xmlschema.inc.php:		$this->continueOnError( XMLS_CONTINUE_ON_ERROR );
adodb-xmlschema.inc.php:		$this->setUpgradeMethod();
adodb-xmlschema.inc.php:				$this->upgrade = $method;
adodb-xmlschema.inc.php:				$this->upgrade = $method;
adodb-xmlschema.inc.php:				$this->upgrade = 'ALTER';
adodb-xmlschema.inc.php:				$this->upgrade = 'NONE';
adodb-xmlschema.inc.php:				$this->upgrade = XMLS_DEFAULT_UPGRADE_METHOD;
adodb-xmlschema.inc.php:		return $this->upgrade;
adodb-xmlschema.inc.php:			$this->executeInline = $mode;
adodb-xmlschema.inc.php:		return $this->executeInline;
adodb-xmlschema.inc.php:			$this->continueOnError = $mode;
adodb-xmlschema.inc.php:		return $this->continueOnError;
adodb-xmlschema.inc.php:		return $this->ParseSchemaString( $this->ConvertSchemaFile( $filename ), $returnSchema );
adodb-xmlschema.inc.php:		if( $this->SchemaFileVersion( $filename ) != $this->schemaVersion ) {
adodb-xmlschema.inc.php:		$this->success = 2;
adodb-xmlschema.inc.php:		$xmlParser = $this->create_parser();
adodb-xmlschema.inc.php:		return $this->sqlArray;
adodb-xmlschema.inc.php:		if( $this->SchemaStringVersion( $xmlstring ) != $this->schemaVersion ) {
adodb-xmlschema.inc.php:		$this->success = 2;
adodb-xmlschema.inc.php:		$xmlParser = $this->create_parser();
adodb-xmlschema.inc.php:		return $this->sqlArray;
adodb-xmlschema.inc.php:		return $this->RemoveSchemaString( $this->ConvertSchemaFile( $filename ), $returnSchema );
adodb-xmlschema.inc.php:		if( !( $version = $this->SchemaStringVersion( $schema ) ) ) {
adodb-xmlschema.inc.php:		return $this->ParseSchemaString( $this->TransformSchema( $schema, 'remove-' . $version), $returnSchema );
adodb-xmlschema.inc.php:			$continueOnErr = $this->ContinueOnError();
adodb-xmlschema.inc.php:			$sqlArray = $this->sqlArray;
adodb-xmlschema.inc.php:			$this->success = 0;
adodb-xmlschema.inc.php:			$this->success = $this->dict->ExecuteSQLArray( $sqlArray, $continueOnErr );
adodb-xmlschema.inc.php:		return $this->success;
adodb-xmlschema.inc.php:		return $this->getSQL( $format, $sqlArray );
adodb-xmlschema.inc.php:			$sqlArray = $this->sqlArray;
adodb-xmlschema.inc.php:				$this->obj = new dbTable( $this, $attributes );
adodb-xmlschema.inc.php:				xml_set_object( $parser, $this->obj );
adodb-xmlschema.inc.php:				if( !isset( $attributes['PLATFORM'] ) OR $this->supportedPlatform( $attributes['PLATFORM'] ) ) {
adodb-xmlschema.inc.php:					$this->obj = new dbQuerySet( $this, $attributes );
adodb-xmlschema.inc.php:					xml_set_object( $parser, $this->obj );
adodb-xmlschema.inc.php:	* DTD version. For instance, to convert a schema created for an pre-1.0 version for 
adodb-xmlschema.inc.php:		if( !( $version = $this->SchemaStringVersion( $schema ) ) ) {
adodb-xmlschema.inc.php:			$newVersion = $this->schemaVersion;
adodb-xmlschema.inc.php:			$result = $this->TransformSchema( $schema, 'convert-' . $version . '-' . $newVersion);
adodb-xmlschema.inc.php:	* DTD version. For instance, to convert a schema created for an pre-1.0 version for 
adodb-xmlschema.inc.php:		if( !( $version = $this->SchemaFileVersion( $filename ) ) ) {
adodb-xmlschema.inc.php:			$newVersion = $this->schemaVersion;
adodb-xmlschema.inc.php:			$result = $this->TransformSchema( $filename, 'convert-' . $version . '-' . $newVersion, 'file' );
adodb-xmlschema.inc.php:			if( preg_match( $this->versionRegex, $data, $matches ) ) {
adodb-xmlschema.inc.php:		if( preg_match( $this->versionRegex, $xmlstring, $matches ) ) {
adodb-xmlschema.inc.php:		$old_mode = $this->db->SetFetchMode( ADODB_FETCH_NUM );
adodb-xmlschema.inc.php:				. '<schema version="' . $this->schemaVersion . '">' . "\n";
adodb-xmlschema.inc.php:		if( is_array( $tables = $this->db->MetaTables( 'TABLES' ) ) ) {
adodb-xmlschema.inc.php:				$rs = $this->db->Execute( 'SELECT * FROM ' . $table . ' WHERE -1' );
adodb-xmlschema.inc.php:				$fields = $this->db->MetaColumns( $table );
adodb-xmlschema.inc.php:				$indexes = $this->db->MetaIndexes( $table );
adodb-xmlschema.inc.php:						if( $details->max_length > 0 ) {
adodb-xmlschema.inc.php:							$extra .= ' size="' . $details->max_length . '"';
adodb-xmlschema.inc.php:						if( $details->primary_key ) {
adodb-xmlschema.inc.php:						} elseif( $details->not_null ) {
adodb-xmlschema.inc.php:						if( $details->has_default ) {
adodb-xmlschema.inc.php:							$content[] = '<DEFAULT value="' . $details->default_value . '"/>';
adodb-xmlschema.inc.php:						if( $details->auto_increment ) {
adodb-xmlschema.inc.php:						$details->primary_key = 0;
adodb-xmlschema.inc.php:						$type = $rs->MetaType( $details );
adodb-xmlschema.inc.php:						$schema .= '		<field name="' . $details->name . '" type="' . $type . '"' . $extra . '>';
adodb-xmlschema.inc.php:					$rs = $this->db->Execute( 'SELECT * FROM ' . $table );
adodb-xmlschema.inc.php:						while( $row = $rs->FetchRow() ) {
adodb-xmlschema.inc.php:		$this->db->SetFetchMode( $old_mode );
adodb-xmlschema.inc.php:				$this->objectPrefix = '';
adodb-xmlschema.inc.php:			case !preg_match( '/^[a-z][a-z0-9_]+$/i', $prefix ):
adodb-xmlschema.inc.php:		if( $underscore AND substr( $prefix, -1 ) != '_' ) {
adodb-xmlschema.inc.php:		$this->objectPrefix = $prefix;
adodb-xmlschema.inc.php:		if( !empty( $this->objectPrefix ) ) {
adodb-xmlschema.inc.php:			return preg_replace( '/^(`?)(.+)$/', '$1' . $this->objectPrefix . '$2', $name );
adodb-xmlschema.inc.php:		$regex = '/^(\w*\|)*' . $this->db->databaseType . '(\|\w*)*$/';
adodb-xmlschema.inc.php:		$this->sqlArray = array();
adodb-xmlschema.inc.php:				$this->addSQL( $line );
adodb-xmlschema.inc.php:			$this->sqlArray[] = $sql;
adodb-xmlschema.inc.php:			if( $this->ExecuteInline() && ( $this->success == 2 || $this->ContinueOnError() ) ) {
adodb-xmlschema.inc.php:				$saved = $this->db->debug;
adodb-xmlschema.inc.php:				$this->db->debug = $this->debug;
adodb-xmlschema.inc.php:				$ok = $this->db->Execute( $sql );
adodb-xmlschema.inc.php:				$this->db->debug = $saved;
adodb-xmlschema.inc.php:					if( $this->debug ) {
adodb-xmlschema.inc.php:						ADOConnection::outp( $this->db->ErrorMsg() );
adodb-xmlschema.inc.php:					$this->success = 1;
adodb-xmlschema.inc.php:			$sqlArray = $this->sqlArray;
adodb-xmlschema.inc.php:		return $this->sqlArray;
adodb-xmlschema.inc.php:		set_magic_quotes_runtime( $this->mgq );
contrib/toxmlrpc.inc.php:    * @todo document the xmlrpc-struct used to encode recordset info
contrib/toxmlrpc.inc.php:        $numfields = $adodbrs->FieldCount();
contrib/toxmlrpc.inc.php:        $numrecords = $adodbrs->RecordCount();
contrib/toxmlrpc.inc.php:            $fld = $adodbrs->FetchField($i);
contrib/toxmlrpc.inc.php:            if (isset($fld->name))
contrib/toxmlrpc.inc.php:                $fieldarray["name"] = new xmlrpcval ($fld->name);
contrib/toxmlrpc.inc.php:            if (isset($fld->type))
contrib/toxmlrpc.inc.php:                $fieldarray["type"] = new xmlrpcval ($fld->type);
contrib/toxmlrpc.inc.php:            if (isset($fld->max_length))
contrib/toxmlrpc.inc.php:                $fieldarray["max_length"] = new xmlrpcval ($fld->max_length, "int");
contrib/toxmlrpc.inc.php:            if (isset($fld->not_null))
contrib/toxmlrpc.inc.php:                $fieldarray["not_null"] = new xmlrpcval ($fld->not_null, "boolean");
contrib/toxmlrpc.inc.php:            if (isset($fld->has_default))
contrib/toxmlrpc.inc.php:                $fieldarray["has_default"] = new xmlrpcval ($fld->has_default, "boolean");
contrib/toxmlrpc.inc.php:            if (isset($fld->default_value))
contrib/toxmlrpc.inc.php:                $fieldarray["default_value"] = new xmlrpcval ($fld->default_value);
contrib/toxmlrpc.inc.php:        $sql = new xmlrpcval ($adodbrs->sql);
contrib/toxmlrpc.inc.php:        while (!$adodbrs->EOF) {
contrib/toxmlrpc.inc.php:            if ($adodbrs->fetchMode == 'ADODB_FETCH_BOTH' || count($adodbrs->fields) == 2 * $adodbrs->FieldCount())
contrib/toxmlrpc.inc.php:                        $columns[$i] = xmlrpc_encode ($adodbrs->fields[$i]);
contrib/toxmlrpc.inc.php:                foreach ($adodbrs->fields as $val)
contrib/toxmlrpc.inc.php:            $adodbrs->MoveNext();
contrib/toxmlrpc.inc.php:          return $xmlrpc->serialize();
contrib/toxmlrpc.inc.php:    * Given a well-formed xmlrpc struct object returns an AdoDB object
contrib/toxmlrpc.inc.php:        $header =& $xmlrpcval->structmem('header');
contrib/toxmlrpc.inc.php:        $numfields = $header->structmem('fieldcount');
contrib/toxmlrpc.inc.php:        $numfields = $numfields->scalarval();
contrib/toxmlrpc.inc.php:        $numrecords = $header->structmem('recordcount');
contrib/toxmlrpc.inc.php:        $numrecords = $numrecords->scalarval();
contrib/toxmlrpc.inc.php:        $sqlstring = $header->structmem('sql');
contrib/toxmlrpc.inc.php:        $sqlstring = $sqlstring->scalarval();
contrib/toxmlrpc.inc.php:        $fieldinfo =& $header->structmem('fieldinfo');
contrib/toxmlrpc.inc.php:            $temp =& $fieldinfo->arraymem($i);
contrib/toxmlrpc.inc.php:            while (list($key,$value) = $temp->structeach()) {
contrib/toxmlrpc.inc.php:                if ($key == "name") $fld->name = $value->scalarval();
contrib/toxmlrpc.inc.php:                if ($key == "type") $fld->type = $value->scalarval();
contrib/toxmlrpc.inc.php:                if ($key == "max_length") $fld->max_length = $value->scalarval();
contrib/toxmlrpc.inc.php:                if ($key == "not_null") $fld->not_null = $value->scalarval();
contrib/toxmlrpc.inc.php:                if ($key == "has_default") $fld->has_default = $value->scalarval();
contrib/toxmlrpc.inc.php:                if ($key == "default_value") $fld->default_value = $value->scalarval();
contrib/toxmlrpc.inc.php:        $body =& $xmlrpcval->structmem('body');
contrib/toxmlrpc.inc.php:            $xmlrpcrs_row =& $body->arraymem($i);
contrib/toxmlrpc.inc.php:                $temp =& $xmlrpcrs_row->arraymem($j);
contrib/toxmlrpc.inc.php:                $data_array[$i][$j] = $temp->scalarval();
contrib/toxmlrpc.inc.php:        // finally build in-memory recordset object and return it
contrib/toxmlrpc.inc.php:        $rs->InitArrayFields($data_array,$fields_array);
Binary file cute_icons_for_site/adodb.gif matches
Binary file cute_icons_for_site/adodb2.gif matches
datadict/datadict-postgres.inc.php:  V4.54 5 Nov 2004  (c) 2000-2004 John Lim (jlim@natsoft.com.my). All rights reserved.
datadict/datadict-postgres.inc.php:// security - hide paths
datadict/datadict-postgres.inc.php:	function MetaType($t,$len=-1,$fieldobj=false)
datadict/datadict-postgres.inc.php:			$t = $fieldobj->type;
datadict/datadict-postgres.inc.php:			$len = $fieldobj->max_length;
datadict/datadict-postgres.inc.php:		$is_serial = is_object($fieldobj) && $fieldobj->primary_key && $fieldobj->unique && 
datadict/datadict-postgres.inc.php:			$fieldobj->has_default && substr($fieldobj->default_value,0,8) == 'nextval(';
datadict/datadict-postgres.inc.php:				if ($len <= $this->blobSize) return 'C';
datadict/datadict-postgres.inc.php:	 * @param string $tabname table-name
datadict/datadict-postgres.inc.php:	 * @param string $flds column-names and types for the changed columns
datadict/datadict-postgres.inc.php:		$tabname = $this->TableName ($tabname);
datadict/datadict-postgres.inc.php:		list($lines,$pkey) = $this->_GenFields($flds);
datadict/datadict-postgres.inc.php:		$alter = 'ALTER TABLE ' . $tabname . $this->addCol . ' ';
datadict/datadict-postgres.inc.php:	 * @param string $tabname table-name
datadict/datadict-postgres.inc.php:	 * @param string $flds column-name and type for the changed column
datadict/datadict-postgres.inc.php:			if ($this->debug) ADOConnection::outp("AlterColumnSQL needs a complete table-definiton for PostgreSQL");
datadict/datadict-postgres.inc.php:		return $this->_recreate_copy_table($tabname,False,$tableflds,$tableoptions);
datadict/datadict-postgres.inc.php:	 * @param string $tabname table-name
datadict/datadict-postgres.inc.php:	 * @param string $flds column-name and type for the changed column
datadict/datadict-postgres.inc.php:		$has_drop_column = 7.3 <= (float) @$this->serverInfo['version'];
datadict/datadict-postgres.inc.php:			if ($this->debug) ADOConnection::outp("DropColumnSQL needs complete table-definiton for PostgreSQL < 7.3");
datadict/datadict-postgres.inc.php:		return $this->_recreate_copy_table($tabname,$flds,$tableflds,$tableoptions);
datadict/datadict-postgres.inc.php:	 * @param string $tabname table-name
datadict/datadict-postgres.inc.php:	 * @param string $dropflds column-names to drop
datadict/datadict-postgres.inc.php:		foreach($this->MetaColumns($tabname) as $fld) {
datadict/datadict-postgres.inc.php:			if (!$dropflds || !in_array($fld->name,$dropflds)) {
datadict/datadict-postgres.inc.php:				if (preg_match('/'.$fld->name.' (I|I2|I4|I8|N|F)/i',$tableflds,$matches) && 
datadict/datadict-postgres.inc.php:					in_array($fld->type,array('varchar','char','text','bytea'))) {
datadict/datadict-postgres.inc.php:					$copyflds[] = "to_number($fld->name,'S99D99')";
datadict/datadict-postgres.inc.php:					$copyflds[] = $fld->name;
datadict/datadict-postgres.inc.php:				if ($fld->primary_key && $fld->has_default && 
datadict/datadict-postgres.inc.php:					preg_match("/nextval\('([^']+)'::text\)/",$fld->default_value,$matches)) {
datadict/datadict-postgres.inc.php:					$seq_fld = $fld->name;
datadict/datadict-postgres.inc.php:		$aSql = array_merge($aSql,$this->DropTableSQL($tabname));
datadict/datadict-postgres.inc.php:		$aSql = array_merge($aSql,$this->CreateTableSQL($tabname,$tableflds,$tableoptions));
datadict/datadict-postgres.inc.php:		foreach($this->MetaIndexes($tabname) as $idx_name => $idx_data)
datadict/datadict-postgres.inc.php:			if (substr($idx_name,-5) != '_pkey' && (!$dropflds || !count(array_intersect($dropflds,$idx_data['columns'])))) {
datadict/datadict-postgres.inc.php:				$aSql = array_merge($aSql,$this->CreateIndexSQL($idx_name,$tabname,$idx_data['columns'],
datadict/datadict-postgres.inc.php:		$drop_seq = $this->_DropAutoIncrement($tabname);
datadict/datadict-postgres.inc.php:	// search for a sequece for the given table (asumes the seqence-name contains the table-name!)
datadict/datadict-postgres.inc.php:		$tabname = $this->connection->quote('%'.$tabname.'%');
datadict/datadict-postgres.inc.php:		$seq = $this->connection->GetOne("SELECT relname FROM pg_class WHERE NOT relname ~ 'pg_.*' AND relname LIKE $tabname AND relkind='S'");
datadict/datadict-postgres.inc.php:		if (!$seq || $this->connection->GetOne("SELECT relname FROM pg_class JOIN pg_depend ON pg_class.relfilenode=pg_depend.objid WHERE relname='$seq' AND relkind='S' AND deptype='i'")) {
datadict/datadict-postgres.inc.php:			$sql[] = sprintf ($this->dropIndex, $idxname, $tabname);
datadict/datadict-postgres.inc.php:		if ( isset($idxoptions[$this->upperName]) )
datadict/datadict-postgres.inc.php:			$s .= $idxoptions[$this->upperName];
datadict/datadict-sapdb.inc.php:  V4.50 6 July 2004  (c) 2000-2004 John Lim (jlim@natsoft.com.my). All rights reserved.
datadict/datadict-sapdb.inc.php:  Modified from datadict-generic.inc.php for sapdb by RalfBecker-AT-outdoor-training.de
datadict/datadict-sapdb.inc.php:// security - hide paths
datadict/datadict-sapdb.inc.php:	function MetaType($t,$len=-1,$fieldobj=false)
datadict/datadict-sapdb.inc.php:			$t = $fieldobj->type;
datadict/datadict-sapdb.inc.php:			$len = $fieldobj->max_length;
datadict/datadict-sapdb.inc.php:			'LONG'		=> 'X',		// no way to differ between 'X' and 'B' :-(
datadict/datadict-sapdb.inc.php:		// convert integer-types simulated with fixed back to integer
datadict/datadict-sapdb.inc.php:		if ($t == 'FIXED' && !$fieldobj->scale && ($len == 20 || $len == 3)) {
datadict/datadict-sapdb.inc.php:		if ($fieldobj->auto_increment) $type = 'R';
datadict/datadict-sapdb.inc.php:		$tabname = $this->TableName ($tabname);
datadict/datadict-sapdb.inc.php:		list($lines,$pkey) = $this->_GenFields($flds);
datadict/datadict-sapdb.inc.php:		$tabname = $this->TableName ($tabname);
datadict/datadict-sapdb.inc.php:		list($lines,$pkey) = $this->_GenFields($flds);
datadict/datadict-sapdb.inc.php:		$tabname = $this->TableName ($tabname);
datadict/datadict-sapdb.inc.php:			$flds[$k] = $this->NameQuote($v);
datadict/datadict-sybase.inc.php:  V4.54 5 Nov 2004  (c) 2000-2004 John Lim (jlim@natsoft.com.my). All rights reserved.
datadict/datadict-sybase.inc.php:// security - hide paths
datadict/datadict-sybase.inc.php:	function MetaType($t,$len=-1,$fieldobj=false)
datadict/datadict-sybase.inc.php:			$t = $fieldobj->type;
datadict/datadict-sybase.inc.php:			$len = $fieldobj->max_length;
datadict/datadict-sybase.inc.php:		$len = -1; // mysql max_length is not accurate
datadict/datadict-sybase.inc.php:		$tabname = $this->TableName ($tabname);
datadict/datadict-sybase.inc.php:		list($lines,$pkey) = $this->_GenFields($flds);
datadict/datadict-sybase.inc.php:		$s = "ALTER TABLE $tabname $this->addCol";
datadict/datadict-sybase.inc.php:		$tabname = $this->TableName ($tabname);
datadict/datadict-sybase.inc.php:		list($lines,$pkey) = $this->_GenFields($flds);
datadict/datadict-sybase.inc.php:			$sql[] = "ALTER TABLE $tabname $this->alterCol $v";
datadict/datadict-sybase.inc.php:		$tabname = $this->TableName($tabname);
datadict/datadict-sybase.inc.php:			$f[] = "\n$this->dropCol ".$this->NameQuote($v);
datadict/datadict-sybase.inc.php:			$sql[] = sprintf ($this->dropIndex, $idxname, $tabname);
datadict/datadict-sybase.inc.php:		if ( isset($idxoptions[$this->upperName]) )
datadict/datadict-sybase.inc.php:			$s .= $idxoptions[$this->upperName];
datadict/datadict-ibase.inc.php:  V4.54 5 Nov 2004  (c) 2000-2004 John Lim (jlim@natsoft.com.my). All rights reserved.
datadict/datadict-ibase.inc.php:// security - hide paths
datadict/datadict-ibase.inc.php:		if ($this->debug) ADOConnection::outp("AlterColumnSQL not supported");
datadict/datadict-ibase.inc.php:		if ($this->debug) ADOConnection::outp("DropColumnSQL not supported");
datadict/datadict-access.inc.php:  V4.54 5 Nov 2004  (c) 2000-2004 John Lim (jlim@natsoft.com.my). All rights reserved.
datadict/datadict-access.inc.php:// security - hide paths
datadict/datadict-access.inc.php:			if ($this->debug) ADOConnection::outp("Warning: Access does not supported DEFAULT values (field $fname)");
datadict/datadict-access.inc.php:		if ($this->debug) ADOConnection::outp("AlterColumnSQL not supported");
datadict/datadict-access.inc.php:		if ($this->debug) ADOConnection::outp("DropColumnSQL not supported");
datadict/datadict-oci8.inc.php:  V4.54 5 Nov 2004  (c) 2000-2004 John Lim (jlim@natsoft.com.my). All rights reserved.
datadict/datadict-oci8.inc.php:// security - hide paths
datadict/datadict-oci8.inc.php:	function MetaType($t,$len=-1)
datadict/datadict-oci8.inc.php:			$t = $fieldobj->type;
datadict/datadict-oci8.inc.php:			$len = $fieldobj->max_length;
datadict/datadict-oci8.inc.php:			if (isset($this) && $len <= $this->blobSize) return 'C';
datadict/datadict-oci8.inc.php:			if (isset($this) && $len <= $this->blobSize) return 'C2';
datadict/datadict-oci8.inc.php:		$options = $this->_Options($options);
datadict/datadict-oci8.inc.php:		list($lines,$pkey) = $this->_GenFields($flds);
datadict/datadict-oci8.inc.php:		list($lines,$pkey) = $this->_GenFields($flds);
datadict/datadict-oci8.inc.php:		foreach ($flds as $k => $v) $flds[$k] = $this->NameQuote($v);
datadict/datadict-oci8.inc.php:			if ($this->debug) ADOConnection::outp("NOT NULL and DEFAULT='' illegal in Oracle");
datadict/datadict-oci8.inc.php:		if ($fautoinc) $this->seqField = $fname;
datadict/datadict-oci8.inc.php:		if (!$this->seqField) return array();
datadict/datadict-oci8.inc.php:		if ($this->schema) {
datadict/datadict-oci8.inc.php:			$seqname = $this->schema.'.'.$this->seqPrefix.$tab;
datadict/datadict-oci8.inc.php:			$trigname = $this->schema.'.'.$this->trigPrefix.$this->seqPrefix.$tab;
datadict/datadict-oci8.inc.php:			$seqname = $this->seqPrefix.$tabname;
datadict/datadict-oci8.inc.php:			$trigname = $this->trigPrefix.$seqname;
datadict/datadict-oci8.inc.php:		$sql[] = "CREATE OR REPLACE TRIGGER $trigname BEFORE insert ON $tabname FOR EACH ROW WHEN (NEW.$this->seqField IS NULL OR NEW.$this->seqField = 0) BEGIN select $seqname.nextval into :new.$this->seqField from dual; END;";
datadict/datadict-oci8.inc.php:		$this->seqField = false;
datadict/datadict-oci8.inc.php:			$sql[] = sprintf ($this->dropIndex, $idxname, $tabname);
datadict/datadict-oci8.inc.php:		if ( isset($idxoptions[$this->upperName]) )
datadict/datadict-oci8.inc.php:			$s .= $idxoptions[$this->upperName];
datadict/datadict-oci8.inc.php:		$table = $this->connection->qstr($table);
datadict/datadict-oci8.inc.php:		$col = $this->connection->qstr($col);	
datadict/datadict-oci8.inc.php:		$cmt = $this->connection->qstr($cmt);
datadict/datadict-db2.inc.php:  V4.54 5 Nov 2004  (c) 2000-2004 John Lim (jlim@natsoft.com.my). All rights reserved.
datadict/datadict-db2.inc.php:// security - hide paths
datadict/datadict-db2.inc.php:		if ($this->debug) ADOConnection::outp("AlterColumnSQL not supported");
datadict/datadict-db2.inc.php:		if ($this->debug) ADOConnection::outp("DropColumnSQL not supported");
datadict/datadict-db2.inc.php:		$cols = &$this->MetaColumns($tablename);
datadict/datadict-db2.inc.php:			return $this->CreateTableSQL($tablename, $flds, $tableoptions);
datadict/datadict-db2.inc.php:		list($lines,$pkey) = $this->_GenFields($flds);
datadict/datadict-db2.inc.php:		$alter = 'ALTER TABLE ' . $this->TableName($tablename);
datadict/datadict-db2.inc.php:				// Find the next non-blank value;
datadict/datadict-db2.inc.php:				$sql[] = $alter . $this->alterCol . ' ' . $v;
datadict/datadict-db2.inc.php:				$sql[] = $alter . $this->addCol . ' ' . $v;
datadict/datadict-informix.inc.php:  V4.54 5 Nov 2004  (c) 2000-2004 John Lim (jlim@natsoft.com.my). All rights reserved.
datadict/datadict-informix.inc.php:// security - hide paths
datadict/datadict-informix.inc.php:		if ($this->debug) ADOConnection::outp("AlterColumnSQL not supported");
datadict/datadict-informix.inc.php:		if ($this->debug) ADOConnection::outp("DropColumnSQL not supported");
datadict/datadict-generic.inc.php:  V4.54 5 Nov 2004  (c) 2000-2004 John Lim (jlim@natsoft.com.my). All rights reserved.
datadict/datadict-generic.inc.php:// security - hide paths
datadict/datadict-generic.inc.php:		if ($this->debug) ADOConnection::outp("AlterColumnSQL not supported");
datadict/datadict-generic.inc.php:		if ($this->debug) ADOConnection::outp("DropColumnSQL not supported");
datadict/datadict-firebird.inc.php:  V4.54 5 Nov 2004  (c) 2000-2004 John Lim (jlim@natsoft.com.my). All rights reserved.
datadict/datadict-firebird.inc.php:		if ( !is_object($this->connection) ) {
datadict/datadict-firebird.inc.php:		$quote = $this->connection->nameQuote;
datadict/datadict-firebird.inc.php:		if ( !preg_match('/^[' . $this->nameRegex . ']+$/', $name) ) {
datadict/datadict-firebird.inc.php:		$options = $this->_Options($options);
datadict/datadict-firebird.inc.php:		if ($fautoinc) $this->seqField = $fname;
datadict/datadict-firebird.inc.php:		if (!$this->seqField) return array();
datadict/datadict-firebird.inc.php:		if ($this->schema) {
datadict/datadict-firebird.inc.php:			$seqField = $this->seqField;
datadict/datadict-firebird.inc.php:			$seqname = $this->schema.'.'.$this->seqPrefix.$tab;
datadict/datadict-firebird.inc.php:			$trigname = $this->schema.'.trig_'.$this->seqPrefix.$tab;
datadict/datadict-firebird.inc.php:			$seqField = $this->seqField;
datadict/datadict-firebird.inc.php:			$seqname = $this->seqPrefix.$tab1;
datadict/datadict-firebird.inc.php:		$this->seqField = false;
datadict/datadict-mssql.inc.php:  V4.54 5 Nov 2004  (c) 2000-2004 John Lim (jlim@natsoft.com.my). All rights reserved.
datadict/datadict-mssql.inc.php:// security - hide paths
datadict/datadict-mssql.inc.php:	function MetaType($t,$len=-1,$fieldobj=false)
datadict/datadict-mssql.inc.php:			$t = $fieldobj->type;
datadict/datadict-mssql.inc.php:			$len = $fieldobj->max_length;
datadict/datadict-mssql.inc.php:		$len = -1; // mysql max_length is not accurate
datadict/datadict-mssql.inc.php:		$tabname = $this->TableName ($tabname);
datadict/datadict-mssql.inc.php:		list($lines,$pkey) = $this->_GenFields($flds);
datadict/datadict-mssql.inc.php:		$s = "ALTER TABLE $tabname $this->addCol";
datadict/datadict-mssql.inc.php:		$tabname = $this->TableName ($tabname);
datadict/datadict-mssql.inc.php:		list($lines,$pkey) = $this->_GenFields($flds);
datadict/datadict-mssql.inc.php:			$sql[] = "ALTER TABLE $tabname $this->alterCol $v";
datadict/datadict-mssql.inc.php:		$tabname = $this->TableName ($tabname);
datadict/datadict-mssql.inc.php:			$f[] = "\n$this->dropCol ".$this->NameQuote($v);
datadict/datadict-mssql.inc.php:			$sql[] = sprintf ($this->dropIndex, $idxname, $tabname);
datadict/datadict-mssql.inc.php:		if ( isset($idxoptions[$this->upperName]) )
datadict/datadict-mssql.inc.php:			$s .= $idxoptions[$this->upperName];
datadict/datadict-mysql.inc.php:  V4.54 5 Nov 2004  (c) 2000-2004 John Lim (jlim@natsoft.com.my). All rights reserved.
datadict/datadict-mysql.inc.php:// security - hide paths
datadict/datadict-mysql.inc.php:	var $renameColumn = 'ALTER TABLE %s CHANGE COLUMN %s %s %s';	// needs column-definition!
datadict/datadict-mysql.inc.php:	function MetaType($t,$len=-1,$fieldobj=false)
datadict/datadict-mysql.inc.php:			$t = $fieldobj->type;
datadict/datadict-mysql.inc.php:			$len = $fieldobj->max_length;
datadict/datadict-mysql.inc.php:		$is_serial = is_object($fieldobj) && $fieldobj->primary_key && $fieldobj->auto_increment;
datadict/datadict-mysql.inc.php:		$len = -1; // mysql max_length is not accurate
datadict/datadict-mysql.inc.php:			if ($len <= $this->blobSize) return 'C';
datadict/datadict-mysql.inc.php:			return !empty($fieldobj->binary) ? 'B' : 'X';
datadict/datadict-mysql.inc.php:			if ($this->alterTableAddIndex) $sql[] = "ALTER TABLE $tabname DROP INDEX $idxname";
datadict/datadict-mysql.inc.php:			else $sql[] = sprintf($this->dropIndex, $idxname, $tabname);
datadict/datadict-mysql.inc.php:		if ($this->alterTableAddIndex) $s = "ALTER TABLE $tabname ADD $unique INDEX $idxname ";
datadict/datadict-mysql.inc.php:		if ( isset($idxoptions[$this->upperName]) )
datadict/datadict-mysql.inc.php:			$s .= $idxoptions[$this->upperName];
docs/old-changelog.htm:<p>ADOdb sessions using oracle clobs contributed by achim.gosse#ddd.de. See adodb-session-clob.php. 
docs/old-changelog.htm:  stop at /n. Thx Pao-Hsi Huang. 
docs/old-changelog.htm:<p>MetaType now checks empty($this->blobSize) instead of empty($this). 
docs/old-changelog.htm:<p>For DataDict, oci8 autoincrement trigger missing semi-colon. Fixed. 
docs/old-changelog.htm:  include adodb-error.inc.php yourself, with MetaError() and MetaErrorMsg($errno). 
docs/old-changelog.htm:<p>Error handling in ExecuteSQLArray(), adodb-datadict.inc.php did not work. 
docs/old-changelog.htm:<p>We now auto-quote postgresql connection parameters when building connection 
docs/old-changelog.htm:<p>We now test with odbc mysql - made some changes to odbc recordset constructor. 
docs/old-changelog.htm:  using the data-dict interface. 
docs/old-changelog.htm:  what to set $this->fields when EOF was reached. Now at EOF, ADOdb sets $this->fields 
docs/old-changelog.htm:<p> Misc fixes for table creation in adodb-datadict.inc.php. Thx to iamsure. 
docs/old-changelog.htm:<p> Move() and MoveLast() internals changed to support to support EOF and $this->fields 
docs/old-changelog.htm:  - this is very much alpha quality code. The API can still change. See adodb/tests/test-datadict.php 
docs/old-changelog.htm:  - suspect PHP bug. 
docs/old-changelog.htm:<p>Made arrays for getinsertsql and getupdatesql case-insensitive. Suggested by 
docs/old-changelog.htm:  PConnect() will actually call non-persistent Connect(). 
docs/old-changelog.htm:<p>Added $this->ibase_timefmt to allow you to change the date and time format. 
docs/old-changelog.htm:<p>Uses updated adodb-time.inc.php 0.06. 
docs/old-changelog.htm:<p>Added adodb_date(), adodb_getdate(), adodb_mktime() and adodb-time.inc.php. 
docs/old-changelog.htm:<p>Felho Bacsi reported a minor white-space regular expression problem in GetInsertSQL. 
docs/old-changelog.htm:<p>Changed odbc to auto-detect when 0 records returned is wrong due to bad odbc 
docs/old-changelog.htm:  of additional bind parameters -- William Lovaton walovaton#yahoo.com.mx. 
docs/old-changelog.htm:<p>We now use SCOPE_IDENTITY() instead of @@IDENTITY for mssql - thx to marchesini#eside.it 
docs/old-changelog.htm:<p>Fixed adodb-pear.inc.php syntax error. 
docs/old-changelog.htm:  to detect and convert non-oid fields. Also added BlobEncode to postgres when 
docs/old-changelog.htm:$conn->charPage = CP_UTF8;
docs/old-changelog.htm:$conn->Connect($dsn);
docs/old-changelog.htm:<p>Speedup of odbc non-SELECT sql statements. 
docs/old-changelog.htm:<p>New $arr = $db-&gt;ServerInfo( ) function. Returns $arr['description'] which 
docs/old-changelog.htm:<p>Found misplaced MoveNext() in adodb-postgres.inc.php. Fixed. 
docs/old-changelog.htm:<p>Sybase SelectLimit not reliable because 'set rowcount' not cached - fixed. 
docs/old-changelog.htm:<p>Moved ADOConnection to adodb-connection.inc.php and ADORecordSet to adodb-recordset.inc.php. 
docs/old-changelog.htm:<p>Added inputarray handling into _adodb_pageexecute_all_rows - "Ross Smith" RossSmith#bnw.com. 
docs/old-changelog.htm:<p>Fixed pager problems with some databases that returned -1 for _currentRow on 
docs/old-changelog.htm:  MoveLast() by switching to MoveNext() in adodb-lib.inc.php. 
docs/old-changelog.htm:<p>Also fixed uninited $discard in adodb-lib.inc.php. 
docs/old-changelog.htm:  - thx to Christian Bugge for reporting the problem. 
docs/old-changelog.htm:<p>Increased buffers for adodb-csvlib.inc.php for extremely long sql from 8192 
docs/old-changelog.htm:<p>Fixed mysql text/blob types problem in MetaTypes base class - thx to horacio 
docs/old-changelog.htm:  to be generated - useful for group by's. 
docs/old-changelog.htm:<p>Fixed interbase replaceQuote for dialect != 1. Thx to "BEGUIN Pierre-Henri 
docs/old-changelog.htm:  - INFOCOB" phb#infocob.com. 
docs/old-changelog.htm:<p>Added white-space check to QA. 
docs/old-changelog.htm:<p>Now you can set the trigger_error type your own user-defined type in adodb-errorhandler.inc.php. 
docs/old-changelog.htm:<p>$conn->_rs2rs does not create a new recordset when it detects it is of type 
docs/old-changelog.htm:<p>Added render_pagelinks to adodb-pager.inc.php. Code by "Pablo Costa" pablo#cbsp.com.br. 
docs/old-changelog.htm:<p>adodb-session.php now updates only the expiry date if the crc32 check indicates 
docs/old-changelog.htm:<p>We have an empty recordset, but RecordCount() could return -1. Fixed. Reported by  "Jonathan Polansky" jonathan#polansky.com.
docs/old-changelog.htm:<p>Fixed informix SELECT FIRST x DISTINCT, and not SELECT DISTINCT FIRST x - reported by F Riosa
docs/old-changelog.htm:<p>If you set $conn->autoRollback=true, we auto-rollback persistent connections for odbc, mysql, oci8, mssql. 
docs/old-changelog.htm:<p>Changed PageExecute() to use non-greedy preg_match when searching for "FROM" keyword.
docs/old-changelog.htm:<p>Added $conn->OffsetDate($dayFraction,$date=false) to generate sql that calcs 
docs/old-changelog.htm:<p>Fixed ms access bug - SelectLimit() did not support ties - fixed.
docs/old-changelog.htm:<p>Karsten Kraus (Karsten.Kraus#web.de), contributed error-handling code to ADONewConnection. 
docs/old-changelog.htm:<p>Added new parameter to GetAssoc() to allow returning an array of key-value pairs, 
docs/old-changelog.htm:<p>Corrected mssql $conn->sysDate to return only date using convert().
docs/old-changelog.htm:<p>Added toexport.inc.php to export recordsets in CSV and tab-delimited format.
docs/old-changelog.htm:<p>CachePageExecute() does not work - fixed - thx John Huong.
docs/old-changelog.htm:<p>Interbase aliases not set properly in FetchField() - fixed. Thx Stefan Goethals.
docs/old-changelog.htm:<p>Fixed PageExecute() rewrite sql problem - COUNT(*) and ORDER BY don't go together with
docs/old-changelog.htm:<p>DB2 support for CHARACTER type added - thx John Huong huongch#bigfoot.com
docs/old-changelog.htm:<p>For ado, $argProvider not properly checked. Fixed - kalimero#ngi.it
docs/old-changelog.htm:<p>Added $conn->Replace() function for update with automatic insert if the record does not exist. 
docs/old-changelog.htm:<p>adodb_sess_read in adodb-session.php now returns ''correctly - thanks to Jorma Tuomainen, webmaster#wizactive.com
docs/old-changelog.htm:<p>Added drivers <i>informix72</i> for pre-7.3 versions, and <i>oci805</i> for 
docs/old-changelog.htm:with $conn-&gt;_has_stupid_odbc_fetch_api_change.
docs/old-changelog.htm:  is no longer a number, but the 1-char data type returned by MetaType.
docs/old-changelog.htm:<p>Extensive revisions to informix driver - thanks to Samuel CARRIERE samuel_carriere#hotmail.com 
docs/old-changelog.htm:<p>Added TIME type to MySQL - patch by Manfred h9125297#zechine.wu-wien.ac.at
docs/old-changelog.htm:<p>Empty recordsets were not cached - fixed.
docs/old-changelog.htm:<p>SelectLimit for oci8 improved - Our FIRST_ROWS optimization now does not overwrite existing hint.
docs/old-changelog.htm:<p>Mssql driver speedup by 10-15%.
docs/old-changelog.htm:take the value defined in $connection->cacheSecs (default is 3600 seconds). Note that
docs/old-changelog.htm:CacheSelectLimit(), the secs2cache is still compulsory - sigh.
docs/old-changelog.htm:<p>Added @ when returning Fields() to prevent spurious error - "Michael William Miller" mille562#pilot.msu.edu
docs/old-changelog.htm: using the postgres specific pg_lo_import()/pg_lo_open() - i don't use them but hopefully others will
docs/old-changelog.htm:  so you need to set strings to ' ' to prevent the nullifying of strings. $conn->noNullStrings = true;
docs/old-changelog.htm:  <p>Fixed UnixTimeStamp() bug - wasn't setting minutes and seconds properly. Patch from Agusti Fita i Borrell agusti#anglatecnic.com.
docs/old-changelog.htm: <p>Sequence start id support. Now $conn->Gen_ID('seqname', 50) to start sequence from 50.
docs/old-changelog.htm: <p>CSV driver fix for selectlimit, from Andreas - akaiser#vocote.de.
docs/old-changelog.htm:<p>Mssql date regex had error. Fixed - reported by Minh Hoang vb_user#yahoo.com.
docs/old-changelog.htm:indicate whether quotes should be inserted based on magic quote settings - suggested by
docs/old-changelog.htm: <p>Now instead of using $rs->fields[0] internally, we use reset($rs->fields) so 
docs/old-changelog.htm:Absolute to the adodb-lib.inc.php file not set properly. Fixed.<p>
docs/old-changelog.htm:<p>Major speedup of ADOdb for low-end web sites by reducing the php code loading and compiling
docs/old-changelog.htm:Moved csv code to adodb-csvlib.inc.php to reduce adodb.inc.php parsing. This file
docs/old-changelog.htm:Also moved PageExecute(), GetSelectSQL() and GetUpdateSQL() core code to adodb-lib.inc.php.
docs/old-changelog.htm:<p>GenID now returns 0 if not available. Safer is that you should check $conn->hasGenID 
docs/old-changelog.htm:<p>MSSQL now supports GenID(). It generates a 16-byte GUID from mssql newid() 
docs/old-changelog.htm:  Ereg doesn't support t or n! Reported by marino Carlos xaplo#postnuke-espanol.org</p>
docs/old-changelog.htm:<p>Added $recordset->connection. This is the ADOConnection object for the recordset. 
docs/old-changelog.htm:Speedup for Concat() using implode() - Benjamin Curtis ben_curtis#yahoo.com<p>
docs/old-changelog.htm:<p>Oci8 was mistakenly reporting errors when $db->debug = true.
docs/old-changelog.htm:<p>If a connection failed with ODBC, it was not correctly reported - fixed.
docs/old-changelog.htm:<p>_connectionID was inited to -1, changed to false.
docs/old-changelog.htm:<p>Added $rs->FetchRow(), to simplify API, ala PEAR DB
docs/old-changelog.htm:<p>Added PEAR DB compat mode, which is still faster than PEAR! See adodb-pear.inc.php.
docs/old-changelog.htm:<p>Revised adodb-cryptsession.php thanks to Ari.
docs/old-changelog.htm:<p>Added adodb-errorhandler.inc.php, adodb-errorpear.inc.php and raiseErrorFn on Freek's urging.
docs/old-changelog.htm:<p>Added encrypted sessions (see adodb-cryptsession.php). By Ari Kuorikoski &lt;kuoriari#finebyte.com></p>
docs/old-changelog.htm:<p>Jumped to version 1.20 because I don't like 13 :-)</p>
docs/old-changelog.htm:<p>SelectLimit: SELECT TOP -1 * FROM TABLE not support by Microsoft. Fixed.</p>
docs/old-changelog.htm:<p>When the horrible magic_quotes is enabled, back-slash () is changed to double-backslash (\).
docs/old-changelog.htm:in UnixDate() - thanks to milhouse31#hotmail.com.</p>
docs/old-changelog.htm:<p>MoveNext() moved to leaf classes for speed in MySQL/PostgreSQL. 10-15% speedup.</p>
docs/old-changelog.htm:<p>Added null handling in bindInputArray in Execute() -- Ron Baldwin suggestion.</p>
docs/old-changelog.htm:<p>Added fix to input parameters in Execute for non-strings by Ron Baldwin.</p>
docs/old-changelog.htm:<p>Fixed $this->GetArray() in GetRows().</p>
docs/old-changelog.htm:<p>Oracle and OCI8: 1st parameter is always blank -- now warns if it is filled.</p>
docs/old-changelog.htm:<p>Added transaction support for PostgresSQL -- thanks to "Eric G. Werk" egw#netguide.dk.</p>
docs/old-changelog.htm:<p>Added adodb-session.php for session support.</p>
docs/old-changelog.htm:<p>Oracle default date format (DD-MON-YY) did not match ADOdb default date format (which is YYYY-MM-DD). Use ALTER SESSION to force the default date.</p>
docs/old-changelog.htm:<p>MoveNext() did not check EOF properly -- fixed.</p>
docs/old-changelog.htm:<p>Added new field to ADORecordSet -- canSeek</p>
docs/old-changelog.htm:<p>Added new field to ADORecordSet/ADOConnection -- dataProvider to indicate whether 
docs/old-changelog.htm:<p>Changed class ODBCFieldObject to ADOFieldObject -- not documented currently.</p>
docs/docs-adodb.htm:<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
docs/docs-adodb.htm:<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
docs/docs-adodb.htm:  background-color: #eee;
docs/docs-adodb.htm:  font-size: 12px;
docs/docs-adodb.htm:<p>V4.54 5 Nov 2004 (c) 2000-2004 John Lim (jlim#natsoft.com)</p>
docs/docs-adodb.htm:<p><font size="1">This software is dual licensed using BSD-Style and LGPL. This 
docs/docs-adodb.htm:	<b><a href="#speed">High Speed ADOdb - tuning tips</a></b><br>
docs/docs-adodb.htm:	<a href="#ex9">Example 9: Exporting in CSV or Tab-Delimited Format</a> <br>
docs/docs-adodb.htm:  Statistics and Query-Rewriting: <a href="#logsql">LogSQL</a> <a href="#fnexecute">fnExecute 
docs/docs-adodb.htm:  is now required (because we use array-based str_replace).</p>
docs/docs-adodb.htm:  ADOdb for true portability and scalability. See adodb-session.php for more information.</p>
docs/docs-adodb.htm:  <li><b>Portable table and index creation</b> with the <a href="docs-datadict.htm">datadict</a> classes.
docs/docs-adodb.htm:  </li><li><b>Database performance monitoring and SQL tuning</b> with the <a href="docs-perf.htm">performance monitoring</a> classes.
docs/docs-adodb.htm:  </li><li><b>Database-backed sessions</b> with the <a href="docs-session.htm">session management</a> classes. Supports session expiry notification.
docs/docs-adodb.htm:visit <a href="http://phplens.com/phpeverywhere/adodb-cool-apps">adodb-cool-apps</a>): 
docs/docs-adodb.htm:(ACID): PHP-based analysis engine to search and process a database of
docs/docs-adodb.htm:security incidents generated by security-related software such as IDSes
docs/docs-adodb.htm:advanced blocks system, and is fully multi-lingual enabled. <p>
docs/docs-adodb.htm:</p></li><li><a href="http://www.auto-net.no/easypublish.php?page=index&amp;lang_id=2">EasyPublish CMS</a>
docs/docs-adodb.htm:integrated modules on your internet, intranet- and extranet-sites. From
docs/docs-adodb.htm:  the connection settings correctly. You can debug using <i>$db-&gt;debug = true</i> as shown below:</p>
docs/docs-adodb.htm:<pre>&lt;?php<br>	include('adodb/adodb.inc.php');<br>	$db = <a href="#adonewconnection">ADONewConnection</a>($dbdriver); # eg 'mysql' or 'postgres'<br>	$db-&gt;debug = true;<br>	$db-&gt;<a href="#connect">Connect</a>($server, $user, $password, $database);<br>	$rs = $db-&gt;<a href="#execute">Execute</a>('select * from some_small_table');<br>	print "&lt;pre&gt;";<br>	print_r($rs-&gt;<a href="#getrows">GetRows</a>());<br>	print "&lt;/pre&gt;";<br>?&gt;</pre>
docs/docs-adodb.htm:</li><li>adodb-lib.inc.php
docs/docs-adodb.htm:</li><li>adodb-time.inc.php
docs/docs-adodb.htm:</li><li>drivers/adodb-$database.inc.php
docs/docs-adodb.htm:</li><li>adodb-php4.inc.php
docs/docs-adodb.htm:</li><li>adodb-iterator.inc.php
docs/docs-adodb.htm:<li>adodb-error.inc.php and lang/adodb-$lang.inc.php (if you use MetaError())
docs/docs-adodb.htm:</li><li>adodb-csvlib.inc.php (if you use cached recordsets - CacheExecute(), etc)
docs/docs-adodb.htm:</li><li>adodb-exceptions.inc.php and adodb-errorhandler.inc.php (if you use adodb error handler or php5 exceptions).
docs/docs-adodb.htm: to a particular database is in the adodb/driver/adodb-????.inc.php file.</p>
docs/docs-adodb.htm:whether to use <i>persistent</i> or <i>non-persistent</i> connections. The advantage of <i>persistent</i>
docs/docs-adodb.htm:when you call Close()). <i>Non-persistent </i>connections take up much fewer resources though,
docs/docs-adodb.htm:reducing the risk of your database and your web-server becoming overloaded. 
docs/docs-adodb.htm:use $conn-&gt;<a href="#pconnect">PConnect()</a>,
docs/docs-adodb.htm: or $conn-&gt;<a href="#connect">Connect()</a> for non-persistent connections.
docs/docs-adodb.htm:</p><pre>	<font color="#008000"># non-persistent connection</font>
docs/docs-adodb.htm:	$arr = $db-&gt;GetArray("select * from table");
docs/docs-adodb.htm:<pre><a name="connect_ex">	$conn = &amp;ADONewConnection('mysql'); <br>	$conn-&gt;PConnect('localhost','userid','password','database');<br>	<br>	<font color="#008000"># or dsn </font>
docs/docs-adodb.htm:<pre>	$conn = &amp;ADONewConnection('postgres7'); <br>	$conn-&gt;PConnect('host=localhost port=5432 dbname=mary');</pre>
docs/docs-adodb.htm: <pre>	$conn-&gt;PConnect('localhost','userid','password','database');<br> </pre>
docs/docs-adodb.htm:</p><pre> &lt;?php<br>require('/path/to/adodb.inc.php');<br><br>$host = 'ldap.baylor.edu';<br>$ldapbase = 'ou=People,o=Baylor University,c=US';<br><br>$ldap = NewADOConnection( 'ldap' );<br>$ldap-&gt;Connect( $host, $user_name='', $password='', $ldapbase );<br><br>echo "&lt;pre&gt;";<br><br>print_r( $ldap-&gt;ServerInfo() );<br>$ldap-&gt;SetFetchMode(ADODB_FETCH_ASSOC);<br>$userName = 'eldridge';<br>$filter="(|(CN=$userName*)(sn=$userName*)(givenname=$userName*)(uid=$userName*))";<br><br>$rs = $ldap-&gt;Execute( $filter );<br>if ($rs)<br>	while ($arr = $rs-&gt;FetchRow()) {<br>	     print_r($arr);	<br>	}<br><br>$rs = $ldap-&gt;Execute( $filter );<br>if ($rs) <br>	while (!$rs-&gt;EOF) {<br> 		print_r($rs-&gt;fields);	<br>		$rs-&gt;MoveNext();<br>	} <br>	<br>print_r( $ldap-&gt;GetArray( $filter ) );<br><br>print_r( $ldap-&gt;GetRow( $filter ) );<br><br>$ldap-&gt;Close();<br>echo "&lt;/pre&gt;";<br>?&gt;</pre>
docs/docs-adodb.htm:<pre>	$conn = &amp;ADONewConnection('ibase'); <br>	$conn-&gt;PConnect('localhost:c:\ibase\employee.gdb','sysdba','masterkey');<br></pre>
docs/docs-adodb.htm:<pre>	$conn = &amp;ADONewConnection('sqlite'); <br>	$conn-&gt;PConnect('c:\path\to\sqlite.db'); # sqlite will create if does not exist<br></pre>
docs/docs-adodb.htm:<pre>	$conn-&gt;Connect(false, 'scott', 'tiger');</pre>
docs/docs-adodb.htm:<pre>	$conn-&gt;PConnect(false, 'scott', 'tiger', 'myTNS');</pre>
docs/docs-adodb.htm:<pre> 	$conn-&gt;PConnect('myTNS', 'scott', 'tiger');</pre>
docs/docs-adodb.htm:<pre>	$conn-&gt;Connect('192.168.0.1', 'scott', 'tiger', 'SID');</pre>
docs/docs-adodb.htm:<pre>	$conn-&gt;Connect('192.168.0.1', 'scott', 'tiger', 'servicename');</pre>
docs/docs-adodb.htm:</p><pre>	$cstr = "(DESCRIPTION=(ADDRESS=(PROTOCOL=TCP)(HOST=$host)(PORT=$port))<br>			(CONNECT_DATA=(SID=$sid)))";<br>	$conn-&gt;Connect($cstr, 'scott', 'tiger');<br></pre>
docs/docs-adodb.htm:	$conn->charSet = 'we8iso8859p1';
docs/docs-adodb.htm:	$conn->Connect(...);
docs/docs-adodb.htm:<h4>DSN-less ODBC ( Access, MSSQL and DB2 examples)</h4>
docs/docs-adodb.htm:<p>ODBC DSN's can be created in the ODBC control panel, or you can use a DSN-less 
docs/docs-adodb.htm:  connection.To use DSN-less connections with ODBC you need PHP 4.3 or later. 
docs/docs-adodb.htm:	$db-&gt;Connect($dsn);
docs/docs-adodb.htm:<pre>	$db =&amp; ADONewConnection('odbc_mssql');<br>	$dsn = <strong>"Driver={SQL Server};Server=localhost;Database=northwind;"</strong>;<br>	$db-&gt;Connect($dsn,'userid','password');<br></pre>
docs/docs-adodb.htm:<pre>	$db =&amp; ADONewConnection('mssql');<br>	$db-&gt;Execute("localhost', 'userid', 'password', 'northwind');<br></pre>
docs/docs-adodb.htm:<pre>	$db =&amp; ADONewConnection('db2');<br>	$dsn = "driver={IBM db2 odbc DRIVER};Database=sample;hostname=localhost;port=50000;protocol=TCPIP;".<br>			"uid=root; pwd=secret";<br>	$db-&gt;Connect($dsn);<br></pre>
docs/docs-adodb.htm:<b>DSN-less Connections with ADO</b><br>
docs/docs-adodb.htm:If you are using versions of PHP earlier than PHP 4.3.0, DSN-less connections 
docs/docs-adodb.htm:<pre>&lt;?php<br>	include('adodb.inc.php'); <br>	$db = &amp;ADONewConnection("ado_mssql");<br>	print "&lt;h1&gt;Connecting DSN-less $db-&gt;databaseType...&lt;/h1&gt;";<br>		<br>	<b>$myDSN="PROVIDER=MSDASQL;DRIVER={SQL Server};"<br>		. "SERVER=flipper;DATABASE=ai;UID=sa;PWD=;"  ;</b>
docs/docs-adodb.htm:	$db-&gt;Connect($myDSN);
docs/docs-adodb.htm:	$rs = $db-&gt;Execute("select * from table");
docs/docs-adodb.htm:	$arr = $rs-&gt;GetArray();
docs/docs-adodb.htm:<h2>High Speed ADOdb - tuning tips</h2>
docs/docs-adodb.htm:<p>The fastest way to access the field data is by accessing the array $recordset-&gt;fields 
docs/docs-adodb.htm:<pre>$rs =&amp; $rs-&gt;Execute($sql);<br>while (!$rs-&gt;EOF) {<br>	var_dump($rs-&gt;fields);<br>	$rs-&gt;MoveNext();<br>}</pre></td><td>
docs/docs-adodb.htm:<pre>$rs =&amp; $rs-&gt;Execute($sql);<br>$array = adodb_getall($rs);<br>var_dump($array);<br><br><br></pre></td></tr></tbody></table>
docs/docs-adodb.htm: you can replace your calls to $rs-&gt;MoveNext() with adodb_movenext($rs). 
docs/docs-adodb.htm: </p><p>Execute() is the default way to run queries. You can use the low-level functions _Execute() and _query()
docs/docs-adodb.htm:the resultid, true or false are returned by _query(). </p><p>For Informix, you can disable scrollable cursors with $db-&gt;cursorType = 0.
docs/docs-adodb.htm:still maintain backward compatibility by sub-classing ADOdb and using the $ADODB_NEWCONNECTION
docs/docs-adodb.htm:the function-name stored in this variable if it is defined.
docs/docs-adodb.htm:<pre>	$ADODB_FETCH_MODE = ADODB_FETCH_NUM;<br>	$rs = $db-&gt;Execute($sql);<br>	foreach($rs as $k =&gt; $row) {<br>		echo "r1=".$row[0]." r2=".$row[1]."&lt;br&gt;";<br>	}<br></pre>
docs/docs-adodb.htm:</p></li><li><b>Exceptions</b>: Just include <i>adodb-exceptions.inc.php</i> and you can now 
docs/docs-adodb.htm:<pre>	<b>include("../adodb-exceptions.inc.php");</b> <br>	include("../adodb.inc.php");	 <br>	try { <br>		$db = NewADOConnection("oci8"); <br>		$db-&gt;Connect('','scott','bad-password'); <br>	} catch (exception $e) { <br>		var_dump($e); <br>		adodb_backtrace($e-&gt;gettrace());<br>	} <br></pre>
docs/docs-adodb.htm:        DSN-less connections. For best performance, use an OLEDB provider. This 
docs/docs-adodb.htm:      <p><font size="2">You can set $db-&gt;codePage before connecting.</font></p></td>
docs/docs-adodb.htm:    <td><font size="2">Microsoft Access/Jet using ADO. Allows DSN-less connections. 
docs/docs-adodb.htm:    <td><font size="2">Microsoft SQL Server using ADO. Allows DSN-less connections. 
docs/docs-adodb.htm:      $db-&gt;PConnect('localhost:c:/ibase/employee.gdb', "sysdba", "masterkey") 
docs/docs-adodb.htm:      You can set $db-&gt;dialect, $db-&gt;buffers and $db-&gt;charSet before connecting.</font></td>
docs/docs-adodb.htm:    <td><font size="2">MySQL without transaction support. You can also set $db-&gt;clientFlags 
docs/docs-adodb.htm:        <i>mysqld --ansi</i> or <i>mysqld --sql-mode=PIPES_AS_CONCAT</i></font></p></td>
docs/docs-adodb.htm:        - with server IP and service name: <br>
docs/docs-adodb.htm:    <td height="34"><font size="2">Netezza driver. Netezza is based on postgres code-base.</font></td>
docs/docs-adodb.htm:    <td height="54"><font size="2">-</font></td>
docs/docs-adodb.htm:    <td height="54"><font size="2">-</font></td>
docs/docs-adodb.htm:  return the number of rows, or returns -1 when a SELECT statement is executed. 
docs/docs-adodb.htm:  speed penalty of 40-50% if emulation is required. This is emulated in most databases 
docs/docs-adodb.htm:</p><pre>&lt;?<br><font face="Courier New, Courier, mono"><b>include</b>('adodb.inc.php');	   # load code common to ADOdb<br>$<font color="#660000">conn</font> = &amp;ADONewConnection('access');	# create a connection<br>$<font color="#660000">conn</font>-&gt;PConnect('northwind');   # connect to MS-Access, northwind DSN<br>$<font color="#660000">recordSet</font> = &amp;$<font color="#660000">conn</font>-&gt;Execute('select * from products');<br>if (!$<font color="#660000">recordSet</font>) <br>	print $<font color="#660000">conn</font>-&gt;ErrorMsg();<br>else<br><b>while</b> (!$<font color="#660000">recordSet</font>-&gt;EOF) {<br>	<b>print</b> $<font color="#660000">recordSet</font>-&gt;fields[0].' '.$<font color="#660000">recordSet</font>-&gt;fields[1].'&lt;BR&gt;';<br>	$<font color="#660000">recordSet</font>-&gt;MoveNext();<br>}</font><font face="Courier New, Courier, mono">
docs/docs-adodb.htm:$<font color="#660000">recordSet</font>-&gt;Close(); # optional<br>$<font color="#660000">conn</font>-&gt;Close(); # optional<br></font>
docs/docs-adodb.htm:  the current row in the <font face="Courier New, Courier, mono">$recordSet-&gt;fields</font> 
docs/docs-adodb.htm:  property is set to true when end-of-file is reached. If an error occurs in Execute(), 
docs/docs-adodb.htm:<p>The <code>$recordSet-&gt;fields[]</code> array is generated by the PHP database 
docs/docs-adodb.htm:  array by field name. To force indexing by name - that is associative arrays 
docs/docs-adodb.htm:  - use the SetFetchMode function. Each recordset saves and uses whatever fetch 
docs/docs-adodb.htm:</p><pre>	$db-&gt;SetFetchMode(ADODB_FETCH_NUM);<br>	$rs1 = $db-&gt;Execute('select * from table');<br>	$db-&gt;SetFetchMode(ADODB_FETCH_ASSOC);<br>	$rs2 = $db-&gt;Execute('select * from table');<br>	print_r($rs1-&gt;fields); # shows <i>array([0]=&gt;'v0',[1] =&gt;'v1')</i>
docs/docs-adodb.htm:	print_r($rs2-&gt;fields); # shows <i>array(['col1']=&gt;'v0',['col2'] =&gt;'v1')</i>
docs/docs-adodb.htm:<p>To get the number of rows in the select statement, you can use <font face="Courier New, Courier, mono">$recordSet-&gt;<a href="#recordcount">RecordCount</a>()</font>. 
docs/docs-adodb.htm:  Note that it can return -1 if the number of rows returned cannot be determined.</p>
docs/docs-adodb.htm:<pre>&lt;?<br><font face="Courier New, Courier, mono"><b>include</b>('adodb.inc.php');	   # load code common to ADOdb<br>$<font color="#660000">conn</font> = &amp;ADONewConnection('access');	# create a connection<br>$<font color="#660000">conn</font>-&gt;PConnect('northwind');   # connect to MS-Access, northwind dsn<br>$<font color="#660000">recordSet</font> = &amp;$<font color="#660000">conn</font>-&gt;Execute('select CustomerID,OrderDate from Orders');<br>if (!$<font color="#660000">recordSet</font>) <br>	print $<font color="#660000">conn</font>-&gt;ErrorMsg();<br>else<br><b>while</b> (!$<font color="#660000">recordSet</font>-&gt;EOF) {<br>	$<font color="#660000">fld</font> = <font color="#336600"><b>$</b><font color="#660000">recordSet</font><b>-&gt;FetchField</b></font><font color="#006600">(</font>1<font color="#006600">);</font>
docs/docs-adodb.htm:	$<font color="#660000">type</font> = <font color="#336600"><b>$</b><font color="#660000">recordSet</font><b>-&gt;MetaType</b></font>($fld-&gt;type);<br><br>	<b>if</b> ( $<font color="#660000">type</font> == 'D' || $<font color="#660000">type</font> == 'T') <br>		<b>print</b> $<font color="#660000">recordSet</font>-&gt;fields[0].' '.<br>			<b><font color="#336600">$</font></b><font color="#660000">recordSet</font><b><font color="#336600">-&gt;UserDate</font></b>($<font color="#660000">recordSet</font>-&gt;fields[1],'<b>m/d/Y</b>').'&lt;BR&gt;';<br>	<b>else </b>
docs/docs-adodb.htm:		<b>print</b> $<font color="#660000">recordSet</font>-&gt;fields[0].' '.$<font color="#660000">recordSet</font>-&gt;fields[1].'&lt;BR&gt;';<br><br>	$<font color="#660000">recordSet</font>-&gt;MoveNext();<br>}</font><font face="Courier New, Courier, mono">
docs/docs-adodb.htm:$<font color="#660000">recordSet</font>-&gt;Close(); # optional<br>$<font color="#660000">conn</font>-&gt;Close(); # optional<br></font>
docs/docs-adodb.htm:    will be set to -1.</li>
docs/docs-adodb.htm:  <li><b>L</b>: Logical field (boolean or bit-field)</li>
docs/docs-adodb.htm:  be quoted before they can be accepted by the database, eg: the single-quote 
docs/docs-adodb.htm:<pre>&lt;?<br><b>include</b>('adodb.inc.php');	   # load code common to ADOdb<br>$<font color="#660000">conn</font> = &amp;ADONewConnection('access');	# create a connection<br><br>$<font color="#660000">conn</font>-&gt;PConnect('northwind');   # connect to MS-Access, northwind dsn<br>$<font color="#660000">shipto</font> = <font color="#006600"><b>$conn-&gt;qstr</b></font>("<i>John's Old Shoppe</i>");<br><br>$<font color="#660000">sql</font> = "insert into orders (customerID,EmployeeID,OrderDate,ShipName) ";<br>$<font color="#660000">sql</font> .= "values ('ANATR',2,".<b><font color="#006600">$conn-&gt;DBDate(</font>time()<font color="#006600">)</font></b><font color="#006600">.</font>",$<font color="#660000">shipto</font>)";<br><br><b>if</b> ($<font color="#660000">conn</font>-&gt;Execute($<font color="#660000">sql</font>) <font color="#336600"><b>=== false</b></font>) {<br>	<b>print</b> 'error inserting: '.<font color="#336600"><b>$conn-&gt;ErrorMsg()</b></font>.'&lt;BR&gt;';<br>}<br>?&gt;<br></pre>
docs/docs-adodb.htm:<p>Observe the error-handling of the Execute statement. False is returned by<font face="Courier New, Courier, mono"> 
docs/docs-adodb.htm:<pre>&lt;?<br><b>include</b>('adodb.inc.php');	   # load code common to ADOdb<br>$<font color="#663300">conn</font> = &amp;ADONewConnection('access');	# create a connection<br>$<font color="#663300">conn</font>-&gt;PConnect('northwind');   # connect to MS-Access, northwind dsn<br><font color="#000000">$<font color="#663300">shipto</font> = <b>$conn-&gt;qstr</b>("John's Old Shoppe");<br>$<font color="#663300">sql</font> = "insert into orders (customerID,EmployeeID,OrderDate,ShipName) ";<br>$<font color="#663300">sql</font> .= "values ('ANATR',2,".$<font color="#663300">conn</font>-&gt;FormatDate(time()).",$shipto)";<br><b><font color="#336600">$<font color="#663300">conn</font>-&gt;debug = true;</font></b>
docs/docs-adodb.htm:<b>if</b> ($<font color="#663300">conn</font>-&gt;Execute($sql) <b>=== false</b>) <b>print</b> 'error inserting';</font>
docs/docs-adodb.htm:<pre>&lt;?<br><b>include</b>('adodb.inc.php'); # load code common to ADOdb<br>$<font color="#663300">conn</font> = &amp;ADONewConnection('mysql');  # create a connection<br>$<font color="#663300">conn</font>-&gt;PConnect('localhost','userid','','agora');# connect to MySQL, agora db<br><font color="#000000">$<font color="#663300">sql</font> = 'select CustomerName, CustomerID from customers';<br>$<font color="#663300">rs</font> = $<font color="#663300">conn</font>-&gt;Execute($sql);<br><b>print</b> <b><font color="#336600">$<font color="#663300">rs</font>-&gt;GetMenu('GetCust','Mary Rosli');<br>?&gt;</font></b></font></pre>
docs/docs-adodb.htm:<pre>&lt;?<br><b>include</b>('adodb.inc.php');	 # load code common to ADOdb<br>$<font color="#663300">conn1</font> = &amp;ADONewConnection('mysql');  # create a mysql connection<br>$<font color="#663300">conn2</font> = &amp;ADONewConnection('oracle');  # create a oracle connection<br><br>$conn1-&gt;PConnect($server, $userid, $password, $database);<br>$conn2-&gt;PConnect(false, $ora_userid, $ora_pwd, $oraname);<br><br>$conn1-&gt;Execute('insert ...');<br>$conn2-&gt;Execute('update ...');<br>?&gt;</pre>
docs/docs-adodb.htm:make a copy of the $rs-&gt;fields, modify the fields, and then generate the SQL to 
docs/docs-adodb.htm:</p><pre>&lt;?<br>#==============================================<br># SAMPLE GetUpdateSQL() and GetInsertSQL() code<br>#==============================================<br>include('adodb.inc.php');<br>include('tohtml.inc.php');<br><br>#==========================<br># This code tests an insert<br><br>$sql = "SELECT * FROM ADOXYZ WHERE id = -1"; <br># Select an empty record from the database<br><br>$conn = &amp;ADONewConnection("mysql");  # create a connection<br>$conn-&gt;debug=1;<br>$conn-&gt;PConnect("localhost", "admin", "", "test"); # connect to MySQL, testdb<br>$rs = $conn-&gt;Execute($sql); # Execute the query and get the empty recordset<br><br>$record = array(); # Initialize an array to hold the record data to insert<br><br># Set the values for the fields in the record<br># Note that field names are case-insensitive<br>$record["firstname"] = "Bob";<br>$record["lastNamE"] = "Smith";<br>$record["creaTed"] = time();<br><br># Pass the empty recordset and the array containing the data to insert<br># into the GetInsertSQL function. The function will process the data and return<br># a fully formatted insert sql statement.<br>$insertSQL = $conn-&gt;GetInsertSQL($rs, $record);<br><br>$conn-&gt;Execute($insertSQL); # Insert the record into the database<br><br>#==========================<br># This code tests an update<br><br>$sql = "SELECT * FROM ADOXYZ WHERE id = 1"; <br># Select a record to update<br><br>$rs = $conn-&gt;Execute($sql); # Execute the query and get the existing record to update<br><br>$record = array(); # Initialize an array to hold the record data to update<br><br># Set the values for the fields in the record<br># Note that field names are case-insensitive<br>$record["firstname"] = "Caroline";<br>$record["LasTnAme"] = "Smith"; # Update Caroline's lastname from Miranda to Smith<br><br># Pass the single record recordset and the array containing the data to update<br># into the GetUpdateSQL function. The function will process the data and return<br># a fully formatted update sql statement with the correct WHERE clause.<br># If the data has not changed, no recordset is returned<br>$updateSQL = $conn-&gt;GetUpdateSQL($rs, $record);<br><br>$conn-&gt;Execute($updateSQL); # Update the record in the database<br>$conn-&gt;Close();<br>?&gt;<br></pre>
docs/docs-adodb.htm:<pre>include_once('../adodb.inc.php');<br>include_once('../adodb-pager.inc.php');<br>session_start();<br><br>$db = NewADOConnection('mysql');<br><br>$db-&gt;Connect('localhost','root','','xphplens');<br><br>$sql = "select * from adoxyz ";<br><br>$pager = new ADODB_Pager($db,$sql);<br>$pager-&gt;Render($rows_per_page=5);</pre>
docs/docs-adodb.htm:    <td><font size="-1">Page 8/10</font></td>
docs/docs-adodb.htm:  included with this release, and the class ADODB_Pager in <i>adodb/adodb-pager.inc.php</i>. 
docs/docs-adodb.htm:</p><p>You can also allow display of html by setting $pager-&gt;htmlSpecialChars = false. 
docs/docs-adodb.htm:<h3><a name="ex9"></a>Example 9: Exporting in CSV or Tab-Delimited Format</h3>
docs/docs-adodb.htm:<p>We provide some helper functions to export in comma-separated-value (CSV) and 
docs/docs-adodb.htm:  tab-delimited formats:</p>
docs/docs-adodb.htm:$db = &amp;NewADOConnection('mysql');<br>$db-&gt;Connect($server, $userid, $password, $database);<br><br>$rs = $db-&gt;Execute('select fname as "First Name", surname as "Surname" from table');<br><br>print "&lt;pre&gt;";<br>print <b>rs2csv</b>($rs); # return a string, CSV format<p>print '&lt;hr&gt;';<br><br>$rs-&gt;MoveFirst(); # note, some databases do not support MoveFirst<br>print <b>rs2tab</b>($rs,<i>false</i>); # return a string, tab-delimited<br>						 # false == suppress field names in first line</p>print '&lt;hr&gt;';<br>$rs-&gt;MoveFirst();<br><b>rs2tabout</b>($rs); # send to stdout directly (there is also an rs2csvout function)<br>print "&lt;/pre&gt;";<br><br>$rs-&gt;MoveFirst();<br><b></b>$fp = fopen($path, "w");<br>if ($fp) {<br>  <b>rs2csvfile</b>($rs, $fp); # write to file (there is also an rs2tabfile function)<br>  fclose($fp);<br>}<br></pre>
docs/docs-adodb.htm:<p> Carriage-returns or newlines are converted to spaces. Field names are returned 
docs/docs-adodb.htm:  with double-quotes. Double-quotes are double-quoted again. This conforms to 
docs/docs-adodb.htm:  Excel import and export guide-lines. 
docs/docs-adodb.htm:<p>Sometimes we want to pre-process all rows in a recordset before we use it. 
docs/docs-adodb.htm:</p><pre>include_once('adodb/rsfilter.inc.php');<br>include_once('adodb/adodb.inc.php');<br><br>// ucwords() every element in the recordset<br>function do_ucwords(&amp;$arr,$rs)<br>{<br>	foreach($arr as $k =&gt; $v) {<br>		$arr[$k] = ucwords($v);<br>	}<br>}<br><br>$db = NewADOConnection('mysql');<br>$db-&gt;PConnect('server','user','pwd','db');<br><br>$rs = $db-&gt;Execute('select ... from table');<br>$rs = <b>RSFilter</b>($rs,'do_ucwords');<br></pre>
docs/docs-adodb.htm:<pre>$conn-&gt;<b>BeginTrans</b>();<br>$ok = $conn-&gt;Execute($sql);<br>if ($ok) $ok = $conn-&gt;Execute($sql2);<br>if (!$ok) $conn-&gt;<b>RollbackTrans</b>();<br>else $conn-&gt;<b>CommitTrans</b>();<br></pre>
docs/docs-adodb.htm:<pre>$conn-&gt;<b>StartTrans</b>();<br>$conn-&gt;Execute($sql);<br>$conn-&gt;Execute($Sql2);<br>$conn-&gt;<b>CompleteTrans</b>();<br></pre>
docs/docs-adodb.htm:<pre>$conn-&gt;<b>StartTrans</b>();<br>$conn-&gt;Execute($sql);<br>if (!CheckRecords()) $conn-&gt;<strong>FailTrans</strong>();<br>$conn-&gt;Execute($Sql2);<br>$conn-&gt;<b>CompleteTrans</b>();<br></pre>
docs/docs-adodb.htm:</p><pre>$conn-&gt;<strong>StartTrans</strong>();<br>$conn-&gt;Execute($sql);<br>  $conn-&gt;<strong>StartTrans</strong>();    <font color="#006600"># ignored</font>
docs/docs-adodb.htm:  if (!CheckRecords()) $conn-&gt;FailTrans();
docs/docs-adodb.htm:  $conn-&gt;<strong>CompleteTrans</strong>(); <font color="#006600"># ignored</font>
docs/docs-adodb.htm:$conn-&gt;Execute($Sql2);
docs/docs-adodb.htm:$conn-&gt;<strong>CompleteTrans</strong>();<br></pre>
docs/docs-adodb.htm:<p>ADOdb supports PHP5 exceptions.  Just include <i>adodb-exceptions.inc.php</i> and you can now 
docs/docs-adodb.htm:</p><pre>	<b>include("../adodb-exceptions.inc.php");</b> <br>	include("../adodb.inc.php");	 <br>	try { <br>		$db = NewADOConnection("oci8://scott:bad-password@mytns/"); <br>	} catch (exception $e) { <br>		var_dump($e); <br>		adodb_backtrace($e-&gt;gettrace());<br>	} <br></pre>
docs/docs-adodb.htm:  first one is in the <b>adodb-errorhandler.inc.php</b> file. This makes use of 
docs/docs-adodb.htm:  similar to the error.log data generated below. This file adodb-errorhandler.inc.php 
docs/docs-adodb.htm:</p><pre>&lt;?php<br><b>error_reporting(E_ALL); # pass any error messages triggered to error handler<br>include('adodb-errorhandler.inc.php');</b>
docs/docs-adodb.htm:$c-&gt;PConnect('localhost','root','','northwind');
docs/docs-adodb.htm:$rs=$c-&gt;Execute('select * from productsz'); #invalid table productsz');
docs/docs-adodb.htm:</p><pre>&lt;?php<br><b>error_reporting(E_ALL); # report all errors<br>ini_set("display_errors", "0"); # but do not echo the errors<br>define('ADODB_ERROR_LOG_TYPE',3);<br>define('ADODB_ERROR_LOG_DEST','C:/errors.log');<br>include('adodb-errorhandler.inc.php');</b>
docs/docs-adodb.htm:$c-&gt;PConnect('localhost','root','','northwind');
docs/docs-adodb.htm:$rs=$c-&gt;Execute('select * from productsz'); ## invalid table productsz
docs/docs-adodb.htm:<pre>(2001-10-28 14:20:38) mysql error: [1146: Table 'northwind.productsz' doesn't exist] in<br> EXECUTE("select * from productsz")<br></pre>
docs/docs-adodb.htm:The second error handler is <b>adodb-errorpear.inc.php</b>. This will create a 
docs/docs-adodb.htm:<pre>&lt;?php<br><b>include('adodb-errorpear.inc.php');</b>
docs/docs-adodb.htm:$c-&gt;PConnect('localhost','root','','northwind');
docs/docs-adodb.htm:$rs=$c-&gt;Execute('select * from productsz'); #invalid table productsz');
docs/docs-adodb.htm:	<b>$e = ADODB_Pear_Error();<br>	echo '&lt;p&gt;',$e-&gt;message,'&lt;/p&gt;';</b>
docs/docs-adodb.htm:  before the adodb-errorpear.inc.php file is included. For easy debugging, you 
docs/docs-adodb.htm:  error-logging. 
docs/docs-adodb.htm:<pre>   $username = 'root';<br>   $password = '';<br>   $hostname = 'localhost';<br>   $databasename = 'xphplens';<br>   $driver = 'mysql';<br>   $dsn = "$driver://$username:$password@$hostname/$databasename"<br>   $db = NewADOConnection(); <br>   # DB::Connect($dsn) also works if you include 'adodb/adodb-pear.inc.php' at the top<br>   $rs = $db-&gt;query('select firstname,lastname from adoxyz');<br>   $cnt = 0;<br>   while ($arr = $rs-&gt;fetchRow()) {<br>		print_r($arr); print "&lt;br&gt;";<br>   }</pre>
docs/docs-adodb.htm: 	query - returns PEAR_Error on error
docs/docs-adodb.htm:	limitQuery - return PEAR_Error on error
docs/docs-adodb.htm:	prepare - does not return PEAR_Error on error
docs/docs-adodb.htm:	execute - does not return PEAR_Error on error
docs/docs-adodb.htm:	setFetchMode - supports ASSOC and ORDERED
docs/docs-adodb.htm: 	numRows - returns -1 if not supported
docs/docs-adodb.htm:	fetchInto - does not support passing of fetchmode
docs/docs-adodb.htm:	fetchRows - does not support passing of fetchmode
docs/docs-adodb.htm:  ) and CacheSelectLimit( ) functions. There are similar to the non-cache functions, 
docs/docs-adodb.htm:</p><pre><b>include</b>('adodb.inc.php'); # load code common to ADOdb<br>$ADODB_CACHE_DIR = '/usr/ADODB_cache';<br>$<font color="#663300">conn</font> = &amp;ADONewConnection('mysql');  # create a connection<br>$<font color="#663300">conn</font>-&gt;PConnect('localhost','userid','','agora');# connect to MySQL, agora db<br><font color="#000000">$<font color="#663300">sql</font> = 'select CustomerName, CustomerID from customers';<br>$<font color="#663300">rs</font> = $<font color="#663300">conn</font>-&gt;CacheExecute(15,$sql);</font></pre>
docs/docs-adodb.htm:  and CacheExecute(). If you leave it out, it will use the $connection-&gt;cacheSecs 
docs/docs-adodb.htm:</p><pre>	$conn-&gt;Connect(...);<br>	$conn-&gt;cacheSecs = 3600*24; # cache 24 hours<br>	$rs = $conn-&gt;CacheExecute('select * from table');<br></pre>
docs/docs-adodb.htm:SQL to create pivot tables, also known as cross-tabulations. For further explanation 
docs/docs-adodb.htm:read this DevShed <a href="http://www.devshed.com/Server_Side/MySQL/MySQLWiz/">Cross-Tabulation 
docs/docs-adodb.htm:tutorial</a>. We assume that your database supports the SQL case-when expression. </font></p> 
docs/docs-adodb.htm:  pivot on categories. So from the table on the left, we generate the pivot-table 
docs/docs-adodb.htm:	<td> <font face="Courier New, Courier, mono">--&gt;</font></td>
docs/docs-adodb.htm:</font><p><font color="#000000">The following code will generate the SQL for a cross-tabulation: 
docs/docs-adodb.htm:<p>chown -R apache /path/to/adodb/cache<br>
docs/docs-adodb.htm:  chgrp -R apache /path/to/adodb/cache </p>
docs/docs-adodb.htm:in adodb/lang/adodb-$lang.inc.php, where $lang is the supported langauge.
docs/docs-adodb.htm:</font></p><pre><font color="#000000">	$ADODB_<b>FETCH_MODE</b> = ADODB_FETCH_NUM;<br>	$rs1 = $db-&gt;Execute('select * from table');<br>	$ADODB_<b>FETCH_MODE</b> = ADODB_FETCH_ASSOC;<br>	$rs2 = $db-&gt;Execute('select * from table');<br>	print_r($rs1-&gt;fields); # shows <i>array([0]=&gt;'v0',[1] =&gt;'v1')</i>
docs/docs-adodb.htm:	print_r($rs2-&gt;fields); # shows <i>array(['col1']=&gt;'v0',['col2'] =&gt;'v1')</i>
docs/docs-adodb.htm:<p><font color="#000000">Some programmers prefer to use a more object-oriented solution, where the fetch 
docs/docs-adodb.htm:<pre><font color="#000000">	$db-&gt;SetFetchMode(ADODB_FETCH_NUM);<br>	$rs1 = $db-&gt;Execute('select * from table');<br>	$db-&gt;SetFetchMode(ADODB_FETCH_ASSOC);<br>	$rs2 = $db-&gt;Execute('select * from table');<br>	print_r($rs1-&gt;fields); # shows <i>array([0]=&gt;'v0',[1] =&gt;'v1')</i>
docs/docs-adodb.htm:	print_r($rs2-&gt;fields); # shows <i>array(['col1']=&gt;'v0',['col2'] =&gt;'v1')</i></font></pre>
docs/docs-adodb.htm:<p><font color="#000000">To retrieve the previous fetch mode, you can use check the $db-&gt;fetchMode 
docs/docs-adodb.htm:	where the field name keys are lower-cased. Use the constant ADODB_ASSOC_CASE 
docs/docs-adodb.htm:<p><font color="#000000">0 = assoc lowercase field names. $rs-&gt;fields['orderid']<br>
docs/docs-adodb.htm:	1 = assoc uppercase field names. $rs-&gt;fields['ORDERID']<br>
docs/docs-adodb.htm:	2 = use native-case field names. $rs-&gt;fields['OrderID'] -- this is the 
docs/docs-adodb.htm:<p><font color="#000000">define('ADODB_ASSOC_CASE', 2); # use native-case for ADODB_FETCH_ASSOC<br>
docs/docs-adodb.htm:<p><font color="#000000"><b>raiseErrorFn</b>: Allows you to define an error handling function. See adodb-errorhandler.inc.php 
docs/docs-adodb.htm:	function to send dates to the database. is '#Y-m-d#' for Microsoft Access, 
docs/docs-adodb.htm:	and ''Y-m-d'' for MySQL.</font></p>
docs/docs-adodb.htm:<p><font color="#000000"><b>replaceQuote</b>: The string used to escape quotes. Eg. double single-quotes 
docs/docs-adodb.htm:	for Microsoft SQL, and backslash-quote for MySQL. Used by <a href="#qstr">qstr</a>.</font></p>
docs/docs-adodb.htm:<p><font color="#000000"><b>autoRollback</b>: Persistent connections are auto-rollbacked in PConnect( 
docs/docs-adodb.htm:<p><font color="#000000">Non-persistent connect to data source or server $<b>host</b>, using userid 
docs/docs-adodb.htm:</font></p><pre><font color="#000000"> # $oraname in tnsnames.ora/ONAMES/HOSTNAMES<br> $conn-&gt;Connect(false, 'scott', 'tiger', $oraname); <br> $conn-&gt;Connect('server:1521', 'scott', 'tiger', 'ServiceName'); # bypass tnsnames.ora</font></pre>
docs/docs-adodb.htm:<pre> $conn = &amp;NewADOConnection('mysql');<br> $conn-&gt;autoRollback = true; # default is false<br> $conn-&gt;PConnect(...); # rollback here</pre>
docs/docs-adodb.htm:</p><p>Since ADOdb 3.11, you can force non-persistent 
docs/docs-adodb.htm:	or later), postgresql and oci8-derived drivers. For other drivers, NConnect() works like 
docs/docs-adodb.htm:<pre><font color="#000000"> $conn-&gt;Execute("SELECT * FROM TABLE WHERE COND=:val", array('val'=&gt; $val));<br> </font></pre>
docs/docs-adodb.htm:<pre><font color="#000000">  $conn-&gt;Execute("SELECT * FROM TABLE WHERE COND=?", array($val));<br></font></pre>
docs/docs-adodb.htm:</font></p><pre><font color="#000000">$rs = $db-&gt;Execute('select * from table where val=?', array('10'));<br></font></pre>
docs/docs-adodb.htm:</font><pre><font color="#000000">$rs = $db-&gt;Execute('select name from table where val=:key', <br>  array('key' =&gt; 10));<br></font></pre>
docs/docs-adodb.htm:</font><p><font color="#000000">Since ADOdb 3.80, we support bulk binding in Execute(), in which you pass in a 2-dimensional array to
docs/docs-adodb.htm:</font></p><pre><font color="#000000">$arr = array(<br>	array('Ahmad',32),<br>	array('Zulkifli', 24),<br>	array('Rosnah', 21)<br>	);<br>$ok = $db-&gt;Execute('insert into table (name,age) values (?,?)',$arr);<br></font></pre>
docs/docs-adodb.htm:	in the $ADODB_CACHE_DIR directory, and $inputarr only accepts 1-dimensional arrays. 
docs/docs-adodb.htm:</font></p><pre><font color="#000000">  include('adodb.inc.php'); <br>  include('tohtml.inc.php');<br>  $ADODB_<b>CACHE_DIR</b> = '/usr/local/ADOdbcache';<br>  $conn = &amp;ADONewConnection('mysql'); <br>  $conn-&gt;PConnect('localhost','userid','password','database');<br>  $rs = $conn-&gt;<b>CacheExecute</b>(15, 'select * from table'); # cache 15 secs<br>  rs2html($rs); /* recordset to html table */  <br></font></pre>
docs/docs-adodb.htm:<pre><font color="#000000">	$conn-&gt;Connect(...);<br>   	$conn-&gt;cacheSecs = 3600*24; // cache 24 hours<br>	$rs = $conn-&gt;CacheExecute('select * from table');<br></font></pre>
docs/docs-adodb.htm:in $connection-&gt;cacheSecs (default is 3600 seconds, or 1 hour). Use CacheExecute() 
docs/docs-adodb.htm:</font></p><pre><font color="#000000">    $db = ADONewConnection("oci8"); <br>    $db-&gt;Connect("foo.com:1521", "uid", "pwd", "FOO"); <br>    $rs = $db-&gt;ExecuteCursor("begin :cursorvar := getdata(:param1); end;", <br>					'cursorvar',<br>					array('param1'=&gt;10)); <br>    # $rs is now just like any other ADOdb recordset object<br>    rs2html($rs);</font></pre>
docs/docs-adodb.htm:</font></p><pre><font color="#000000">	$stmt = $db-&gt;Prepare("begin :cursorvar := getdata(:param1); end;", true); <br>	$db-&gt;Parameter($stmt, $cur, 'cursorvar', false, -1, OCI_B_CURSOR);<br>	$rs = $db-&gt;Execute($stmt,$bindarr);<br></font></pre>
docs/docs-adodb.htm:</font></p><pre><font color="#000000">	$vv = 'A%';<br>	$stmt = $db-&gt;PrepareSP("BEGIN list_tabs(:crsr,:tt); END;");<br>	$db-&gt;OutParameter($stmt, $cur, 'crsr', -1, OCI_B_CURSOR);<br>	$db-&gt;OutParameter($stmt, $vv, 'tt', 32); # return varchar(32)<br>	$arr = $db-&gt;GetArray($stmt);<br>	print_r($arr);<br>	echo " val = $vv"; ## outputs 'TEST'<br></font></pre>
docs/docs-adodb.htm:<p><font color="#000000"><b>SelectLimit<a name="selectlimit"></a>($sql,$numrows=-1,$offset=-1,$inputarr=false)</b></font></p>
docs/docs-adodb.htm:	only. The equivalent is <code>$connection-&gt;SelectLimit('SELECT * FROM TABLE',3)</code>. 
docs/docs-adodb.htm:	after record 2, return 3 rows). The equivalent in ADOdb is <code>$connection-&gt;SelectLimit('SELECT 
docs/docs-adodb.htm:	set <code>$connection-&gt;SelectLimit('SELECT * FROM TABLE',-1,10)</code> to 
docs/docs-adodb.htm:<pre><font color="#000000"> $conn-&gt;SelectLimit("SELECT * FROM TABLE WHERE COND=:val", 100,-1,array('val'=&gt; $val));<br> </font></pre>
docs/docs-adodb.htm:</font></p><pre><font color="#000000"> $conn-&gt;SelectLimit("SELECT * FROM TABLE WHERE COND=?", 100,-1,array('val'=&gt; $val));<br></font></pre>
docs/docs-adodb.htm:</font></p><p><font color="#000000"><b>CacheSelectLimit<a name="cacheselectlimit"></a>([$secs2cache,] $sql, $numrows=-1,$offset=-1,$inputarr=false)</b></font></p>
docs/docs-adodb.htm:	in $connection-&gt;cacheSecs.</font></p>
docs/docs-adodb.htm:<pre><font color="#000000">	$conn-&gt;Connect(...);<br>   $conn-&gt;cacheSecs = 3600*24; // cache 24 hours<br>	$rs = $conn-&gt;CacheSelectLimit('select * from table',10);</font></pre>
docs/docs-adodb.htm:	<code> &nbsp; system("rm -f `find ".$ADODB_CACHE_DIR." -name 
docs/docs-adodb.htm:	#------------------------------------------------------ <br>
docs/docs-adodb.htm:	#------------------------------------------------------ <br>
docs/docs-adodb.htm:	find ${TMPPATH} -mtime +$AGED | grep "\.cache" | xargs rm -f <br>
docs/docs-adodb.htm:need to include adodb-error.inc.php before you call this function. The parameter $errno
docs/docs-adodb.htm:will return -1 (DB_ERROR).</font></p>
docs/docs-adodb.htm:	it in $db-&gt;fetchMode. Legal modes are ADODB_FETCH_ASSOC and ADODB_FETCH_NUM. 
docs/docs-adodb.htm:	you need something larger - numeric(16). 
docs/docs-adodb.htm:</font></p><pre><font color="#000000">	# for oracle<br>	$conn-&gt;Execute('INSERT INTO blobtable (id, blobcol) VALUES (1, empty_blob())');<br>	$conn-&gt;UpdateBlob('blobtable','blobcol',$blobvalue,'id=1');<br>	<br>	# non oracle databases<br>	$conn-&gt;Execute('INSERT INTO blobtable (id, blobcol) VALUES (1, null)');<br>	$conn-&gt;UpdateBlob('blobtable','blobcol',$blobvalue,'id=1');<br></font></pre>
docs/docs-adodb.htm:	to be decoded using $connection-&gt;DecodeBlob($blob); to derive the original 
docs/docs-adodb.htm:</font></p><pre><font color="#000000">	# for oracle<br>	$conn-&gt;Execute('INSERT INTO clobtable (id, clobcol) VALUES (1, empty_clob())');<br>	$conn-&gt;UpdateBlob('clobtable','clobcol',$clobvalue,'id=1');<br>	<br>	# non oracle databases<br>	$conn-&gt;Execute('INSERT INTO clobtable (id, clobcol) VALUES (1, null)');<br>	$conn-&gt;UpdateBlob('clobtable','clobcol',$clobvalue,'id=1');<br></font></pre>
docs/docs-adodb.htm:</font></p><p><font color="#000000">false - no need to perform encoding or decoding.<br>
docs/docs-adodb.htm:	'I' - blob encoding required, and returned encoded blob is a numeric value 
docs/docs-adodb.htm:	'C' - blob encoding required, and returned encoded blob is a character value 
docs/docs-adodb.htm:	we auto-decode for you).</font> The default maxblobsize is set in $connection->maxblobsize, which 
docs/docs-adodb.htm:</font></p><pre><font color="#000000">$rs = $db-&gt;Execute("select bloboid from postgres_table where id=$key");<br>$blob = $db-&gt;BlobDecode( reset($rs-&gt;fields) );</font></pre>
docs/docs-adodb.htm:	$autoQuote is set to true, then Replace() will quote all values that are non-numeric; 
docs/docs-adodb.htm:	auto-quoting will not quote nulls. Note that auto-quoting will not work if 
docs/docs-adodb.htm:</font></p><pre><font color="#000000"># single field primary key<br>$ret = $db-&gt;Replace('atable', <br>	array('id'=&gt;1000,'firstname'=&gt;'Harun','lastname'=&gt;'Al-Rashid'),<br>	'id',$autoquote = true);	<br># generates UPDATE atable SET firstname='Harun',lastname='Al-Rashid' WHERE id=1000<br># or INSERT INTO atable (id,firstname,lastname) VALUES (1000,'Harun','Al-Rashid')<br><br># compound key<br>$ret = $db-&gt;Replace('atable2', <br>	array('firstname'=&gt;'Harun','lastname'=&gt;'Al-Rashid', 'age' =&gt; 33, 'birthday' =&gt; 'null'),<br>	array('lastname','firstname'),<br>	$autoquote = true);<br><br># no auto-quoting<br>$ret = $db-&gt;Replace('atable2', <br>	array('firstname'=&gt;"'Harun'",'lastname'=&gt;"'Al-Rashid'", 'age' =&gt; 'null'),<br>	array('lastname','firstname'));	<br></font></pre>
docs/docs-adodb.htm:	$rs-&gt;fields. Requires the recordset to be associative. $magicq is used 
docs/docs-adodb.htm:	are case-insensitive.</font></p>
docs/docs-adodb.htm:	(for qstr()). The field names in the array are case-insensitive.</font></p>
docs/docs-adodb.htm:</font></p><p><font color="#000000">Used for pagination of recordset. $page is 1-based. See <a href="#ex8">Example 
docs/docs-adodb.htm:<p><font color="#000000">Used for pagination of recordset. $page is 1-based. See 
docs/docs-adodb.htm:  for SQL errors, and if any are detected, when CompleteTrans() is called, we auto-rollback.
docs/docs-adodb.htm:</font></p><pre><font color="#000000">$DB-&gt;BeginTrans();<br>$DB-&gt;Execute("update table1 set val=$val1 where id=$id");<br>$DB-&gt;Execute("update table2 set val=$val2 where id=$id");<br>$DB-&gt;CommitTrans();<br></font></pre>
docs/docs-adodb.htm:</font></p><pre><font color="#000000">$DB-&gt;BeginTrans();<br>$ok = $DB-&gt;Execute("update table1 set val=$val1 where id=$id");<br>if ($ok) $ok = $DB-&gt;Execute("update table2 set val=$val2 where id=$id");<br>if ($ok) $DB-&gt;CommitTrans();<br>else $DB-&gt;RollbackTrans();<br></font></pre>
docs/docs-adodb.htm:</font></p><pre><font color="#000000">$DB-&gt;BeginTrans();<br>$ok = $DB-&gt;Execute("update table1 set val=$val1 where id=$id");<br>if ($ok) $ok = $DB-&gt;Execute("update table2 set val=$val2 where id=$id");<br>$DB-&gt;CommitTrans($ok);<br></font></pre>
docs/docs-adodb.htm:useful if you are calling black-box functions in which SQL queries might be executed.
docs/docs-adodb.htm:</font></p><pre><font color="#000000">$DB-&gt;StartTrans();<br>CallBlackBox();<br>$DB-&gt;Execute("update table1 set val=$val1 where id=$id");<br>$DB-&gt;Execute("update table2 set val=$val2 where id=$id");<br>$DB-&gt;CompleteTrans($ok);<br></font></pre>
docs/docs-adodb.htm:  do a $DB-&gt;RollbackTrans() in your error handler for safety. 
docs/docs-adodb.htm: that $connection-&gt;transCnt &gt; 0. This variable is incremented whenever BeginTrans() is called,
docs/docs-adodb.htm:  in $inputarr. If the number of columns returned is greater to two, a 2-dimensional 
docs/docs-adodb.htm:  to the rest of the rows. If the columns is equal to two, a 1-dimensional array 
docs/docs-adodb.htm:<p><font color="#000000">GetAssoc will generate the following 2-dimensional associative 
docs/docs-adodb.htm:  1-dimensional associative array (with $force_array==false):</font></font></p>
docs/docs-adodb.htm:<p><font color="#000000">Executes the SQL and returns the all the rows as a 2-dimensional 
docs/docs-adodb.htm:1-dimensional array. The recordset is discarded for you automatically. If an error occurs, 
docs/docs-adodb.htm:  If omitted, we use the value in $connection-&gt;cacheSecs (default is 3600 seconds, 
docs/docs-adodb.htm:  $sql string. This is because all error-handling has been centralized in Execute( 
docs/docs-adodb.htm:<pre><font color="#000000">$stmt = $DB-&gt;Prepare('insert into table (col1,col2) values (?,?)');<br>for ($i=0; $i &lt; $max; $i++)<br></font>	$DB-&gt;<font color="#000000">Execute($stmt,array((string) rand(), $i));<br></font></pre>
docs/docs-adodb.htm:  oci8 and selected ODBC-based drivers, otherwise it is emulated. There is no 
docs/docs-adodb.htm:<pre><font color="#000000">$sql = <font color="#993300">'SELECT '</font>.$db-&gt;IfNull('name', <font color="#993300">"'- unknown -'"</font>).<font color="#993300"> ' FROM table'</font>;</font></pre>
docs/docs-adodb.htm:</font></p><pre><font color="#000000">  $sql = <font color="#993300">"SELECT "</font>.$db-&gt;length.<font color="#993300">"(field) from table"</font>;<br>  $rs = $db-&gt;Execute($sql);<br></font></pre>
docs/docs-adodb.htm:as the function to retrieve a sub-string. To use this property:
docs/docs-adodb.htm:</font></p><pre><font color="#000000">  $sql = <font color="#993300">"SELECT "</font>.$db-&gt;substr.<font color="#993300">"(field, $offset, $length) from table"</font>;<br>  $rs = $db-&gt;Execute($sql);<br></font></pre>
docs/docs-adodb.htm:offset (1-based) to the beginning of the sub-string, and the 3rd is the length of the sub-string.
docs/docs-adodb.htm:</font></p><pre><font color="#000000"><font color="#000000">$sql = <font color="#993300">'insert into table (col1,col2) values ('</font>.$DB-&gt;Param('a').<font color="#993300">','</font>.$DB-&gt;Param('b').<font color="#993300">')'</font>;<br><font color="#006600"># generates 'insert into table (col1,col2) values (?,?)'<br># or        'insert into table (col1,col2) values (:a,:b)</font>'<br>$stmt = $DB-&gt;Prepare($sql);<br>$stmt = $DB-&gt;Execute($stmt,array('one','two'));<br></font></font></pre>
docs/docs-adodb.htm:The advantage of this function is that it is self-documenting, because
docs/docs-adodb.htm:$stmt = $db-&gt;PrepareSP(
docs/docs-adodb.htm:	<font color="#993300">"declare RETVAL integer; <br>	begin<br>	:RETVAL := </font><font color="#993300">SP_RUNSOMETHING</font><font color="#993300">(:myid,:group);<br>	end;"</font>);<br>$db-&gt;InParameter($stmt,$id,'myid');<br>$db-&gt;InParameter($stmt,$group,'group',64);<br>$db-&gt;OutParameter($stmt,$ret,'RETVAL');<br>$db-&gt;Execute($stmt);<br></font></font></pre>
docs/docs-adodb.htm:$stmt = $db-&gt;PrepareSP(<font color="#993333">'<font color="#993300">SP_RUNSOMETHING</font>'</font>); <br><font color="green"># note that the parameter name does not have @ in front!</font>
docs/docs-adodb.htm:$db-&gt;InParameter($stmt,$id,'myid');
docs/docs-adodb.htm:$db-&gt;InParameter($stmt,$group,'group',64);
docs/docs-adodb.htm:<font color="green"># return value in mssql - RETVAL is hard-coded name</font> <br>$db-&gt;OutParameter($stmt,$ret,'RETVAL');<br>$db-&gt;Execute($stmt); </font></font></pre>
docs/docs-adodb.htm:In oci8, $type can be set to OCI_B_FILE (Binary-File), OCI_B_CFILE (Character-File), 
docs/docs-adodb.htm:OCI_B_CLOB (Character-LOB), OCI_B_BLOB (Binary-LOB) and OCI_B_ROWID (ROWID). To 
docs/docs-adodb.htm:pass in a null, use<font face="Courier New, Courier, mono"> $db-&gt;Parameter($stmt, 
docs/docs-adodb.htm:  The advantage of this function is that it is self-documenting, because
docs/docs-adodb.htm:These are superior because they are self-documenting, unlike Parameter().
docs/docs-adodb.htm:  $<i><b>var</b></i> PHP variable to bind to. Make sure you pre-initialize it!<br>
docs/docs-adodb.htm:  2= IN/OUT. This is ignored in oci8 as this driver auto-detects the direction.<br>
docs/docs-adodb.htm:<pre><font color="#000000">$id = 0; $i = 0;<br>$stmt = $db-&gt;PrepareSP( <font color="#993300">"update table set val=:i where id=:id"</font>);<br>$db-&gt;Parameter($stmt,$id,'id');<br>$db-&gt;Parameter($stmt,$i, 'i');<br>for ($cnt=0; $cnt &lt; 1000; $cnt++) {<br>	$id = $cnt; <br>	$i = $cnt * $cnt; <font color="green"># works with oci8!</font>
docs/docs-adodb.htm:	$db-&gt;Execute($stmt); <br>}</font></pre>
docs/docs-adodb.htm:<p><font color="#000000">This is a low-level function supported only by the oci8 
docs/docs-adodb.htm:  the optional descriptor type OCI_B_FILE (Binary-File), OCI_B_CFILE (Character-File), 
docs/docs-adodb.htm:  OCI_B_CLOB (Character-LOB), OCI_B_BLOB (Binary-LOB) and OCI_B_ROWID (ROWID). 
docs/docs-adodb.htm:  own bind-name using $name. 
docs/docs-adodb.htm:<pre>$stmt = $DB-&gt;Prepare("insert into table (col0, col1, col2) values (:0, :1, :2)");<br>$DB-&gt;Bind($stmt, $p1);<br>$DB-&gt;Bind($stmt, $p2);<br>$DB-&gt;Bind($stmt, $p3);<br>for ($i = 0; $i &lt; $max; $i++) { <br>   $p1 = ?; $p2 = ?; $p3 = ?;<br>   $DB-&gt;Execute($stmt);<br>}</pre>
docs/docs-adodb.htm:<pre>$stmt = $DB-&gt;Prepare("insert into table (col0, col1, col2) values (:name0, :name1, :name2)");<br>$DB-&gt;Bind($stmt, $p1, "name0");<br>$DB-&gt;Bind($stmt, $p2, "name1");<br>$DB-&gt;Bind($stmt, $p3, "name2");<br>for ($i = 0; $i &lt; $max; $i++) { <br>   $p1 = ?; $p2 = ?; $p3 = ?;<br>   $DB-&gt;Execute($stmt);<br>}</pre>
docs/docs-adodb.htm:<pre>	$conn-&gt;LogSQL(); // turn on logging<br>	  :<br>	$conn-&gt;Execute(...);<br>	  :<br>	$conn-&gt;LogSQL(false); // turn off logging<br>	<br>	# output summary of SQL logging results<br>	$perf = NewPerfMonitor($conn);<br>	echo $perf-&gt;SuspiciousSQL();<br>	echo $perf-&gt;ExpensiveSQL();<br></pre>
docs/docs-adodb.htm:</p><pre>	include('adodb.inc.php');<br>	include('adodb-perf.inc.php');<br>	adodb_perf::table('my_logsql_table');<br></pre>
docs/docs-adodb.htm:Also see <a href="docs-perf.htm">Performance Monitor</a>. 
docs/docs-adodb.htm:  processed by ADOdb. This allows you to perform statistical analysis and query-rewriting 
docs/docs-adodb.htm:<p>Here is an example of using fnExecute, to count all cached queries and non-cached 
docs/docs-adodb.htm:<font color="#006600"># handle 2-dimensional input arrays</font>
docs/docs-adodb.htm:{<br>global $CACHED; $CACHED++;<br>}<br><br>$db = NewADOConnection('mysql');<br>$db-&gt;Connect(...);<br>$db-&gt;<strong>fnExecute</strong> = 'CountExecs';<br>$db-&gt;<strong>fnCacheExecute</strong> = 'CountCachedExecs';<br> :<br> :<br><font color="#006600"># After many sql statements:</font>`<br>printf("&lt;p&gt;Total queries=%d; total cached=%d&lt;/p&gt;",$EXECS+$CACHED, $CACHED);<br></pre>
docs/docs-adodb.htm:<p><font color="#000000">No longer available - removed since 1.99.</font></p>
docs/docs-adodb.htm:  Y-m-d. Uses the fmtDate field, which holds the format to use. If null or false 
docs/docs-adodb.htm:  be a Unix integer timestamp or an ISO format Y-m-d H:i:s. Uses the fmtTimeStamp 
docs/docs-adodb.htm:<p><font color="#000000">Eg.<font face="Courier New, Courier, mono"> $s = $db-&gt;qstr(HTTP_GET_VARS['name'],get_magic_quotes_gpc());</font></font></p>
docs/docs-adodb.htm:<p><font color="#000000">Only supported by databases that support auto-increment or object id's, such 
docs/docs-adodb.htm:</font></p><pre><font color="#000000">	$DB-&gt;StartTrans();<br>	$DB-&gt;RowLock("table1","rowid=$id");<br>	$DB-&gt;Execute($sql1);<br>	$DB-&gt;Execute($sql2);<br>	$DB-&gt;CompleteTrans();<br></font></pre>
docs/docs-adodb.htm:  use $db-&gt;MetaTables('TABLES'). To show only views, use $db-&gt;MetaTables('VIEWS'). 
docs/docs-adodb.htm:</font></p><pre><font color="#000000">// In this example: dbtype = 'oci8', $db = 'mydb', $view = 'dataView', $owner = false <br>function ADODB_View_PrimaryKeys($dbtype,$db,$view,$owner)<br>{<br>	switch(strtoupper($view)) {<br>	case 'DATAVIEW': return array('DATAID');<br>	default: return false;<br>	}<br>}<br><br>$db = NewADOConnection('oci8');<br>$db-&gt;Connect('localhost','root','','mydb'); <br>$db-&gt;MetaPrimaryKeys('dataView');<br></font></pre>
docs/docs-adodb.htm:  then $conn-&gt;MetaForeignKeys('employee') will return 
docs/docs-adodb.htm:  the table names (array keys) are upper-cased. 
docs/docs-adodb.htm:<p><font color="#000000">When an SQL statement successfully is executed by <font face="Courier New, Courier, mono">ADOConnection-&gt;Execute($sql),</font>an 
docs/docs-adodb.htm:  is an indexed array from 0 to columns-1. See also the function <b><a href="#fields">Fields</a></b>, 
docs/docs-adodb.htm:<p><font color="#000000"><font color="#000000">Generate a 2-dimensional array of records from the current cursor position, 
docs/docs-adodb.htm:  indexed from 0 to $number_of_rows - 1. If $number_of_rows is undefined, till 
docs/docs-adodb.htm:<font color="#000000"><font color="#000000">Generate a 2-dimensional array of records from the current cursor position. Synonym 
docs/docs-adodb.htm:<p><font color="#000000"><font color="#000000">To get a listbox, set the $<i>size</i> to a non-zero value (or pass $default_str 
docs/docs-adodb.htm:<p><font color="#000000"><font color="#000000">Converts the date string $<i>str</i> to another format. The date format is Y-m-d,
docs/docs-adodb.htm:or Unix timestamp format. The default $<i>fmt</i> is Y-m-d.</font></font></p>
docs/docs-adodb.htm:  format is Y-m-d H:i:s, as in '2002-02-28 23:00:12', or Unix timestamp format.
docs/docs-adodb.htm:   UserTimeStamp calls UnixTimeStamp to parse $<i>str</i>, and $<i>fmt</i> defaults to Y-m-d H:i:s if not defined. 
docs/docs-adodb.htm:  be in Y-m-d H:i:s format, except for Sybase and Microsoft SQL Server, where 
docs/docs-adodb.htm:seconds after January 1st, 1970). Expects the date to be in "Y-m-d,
docs/docs-adodb.htm:H:i:s" (1970-12-24, 00:00:00) or "Y-m-d H:i:s" (1970-12-24 00:00:00) or
docs/docs-adodb.htm:<pre><font color="#000000"><font color="#000000"># get date one week from now<br>$fld = $conn-&gt;OffsetDate(7); // returns "(trunc(sysdate)+7")</font></font></pre>
docs/docs-adodb.htm:<pre><font color="#000000"><font color="#000000"># get date and time that is 60 hours from current date and time<br>$fld = $conn-&gt;OffsetDate(2.5, $conn-&gt;sysTimeStamp);	// returns "(sysdate+2.5)"</font>
docs/docs-adodb.htm:$conn-&gt;Execute("UPDATE TABLE SET dodate=$fld WHERE ID=$id");</font></pre>
docs/docs-adodb.htm:use <a href="#dbdate">DBDate</a>. It uses a case-sensitive $dateFormat, which 
docs/docs-adodb.htm:</font></font><pre><font color="#000000"><font color="#000000"> Y: 4-digit Year<br> Q: Quarter (1-4)<br> M: Month (Jan-Dec)<br> m: Month (01-12)<br> d: Day (01-31)<br> H: Hour (00-23)<br> h: Hour (1-12)<br> i: Minute (00-59)<br> s: Second (00-60)<br> A: AM/PM indicator</font></font></pre>
docs/docs-adodb.htm:</font></font></p><pre><font color="#000000"><font color="#000000"> $sqlfn = $db-&gt;SQLDate('Y-\QQ','postdate'); # get sql that formats postdate to output 2002-Q1<br> $sql = "SELECT $sqlfn,SUM(cogs) FROM table GROUP BY $sqlfn ORDER BY 1 desc";<br> </font></font></pre>
docs/docs-adodb.htm:<p><font color="#000000"><font color="#000000">Move the internal cursor to the next row. The <i>$this-&gt;fields</i> array is 
docs/docs-adodb.htm:</font></font></p><p><font color="#000000"><font color="#000000"> If EOF is reached, then the $this-&gt;fields array is set to false (this was 
docs/docs-adodb.htm:  only implemented consistently in ADOdb 3.30). For the pre-3.30 behaviour of 
docs/docs-adodb.htm:  $this-&gt;fields (at EOF), set the global variable $ADODB_COMPAT_FETCH = true.</font></font></p>
docs/docs-adodb.htm:<pre><font color="#000000"><font color="#000000">$rs = $db-&gt;Execute($sql);<br>if ($rs) <br>	while (!$rs-&gt;EOF) {<br> 		ProcessArray($rs-&gt;fields);	<br>		$rs-&gt;MoveNext();<br>	} </font></font></pre>
docs/docs-adodb.htm:<p><font color="#000000"><font color="#000000">Moves the internal cursor to a specific row $<b>to</b>. Rows are zero-based 
docs/docs-adodb.htm:<p><font color="#000000"><font color="#000000">Internally calls Move(RecordCount()-1). Note that some databases do not support 
docs/docs-adodb.htm:  are the column names. The column names are upper-cased for easy access. To get 
docs/docs-adodb.htm:  2001-07-05 ) </font></font></p>
docs/docs-adodb.htm:</font><p><font color="#000000"><font color="#000000"><b>AbsolutePage<a name="absolutepage"></a>($page=-1) 
docs/docs-adodb.htm:<p>Returns true if at first page (1-based). Requires PageExecute()/CachePageExecute() 
docs/docs-adodb.htm:<p>Returns true if at last page (1-based). Requires PageExecute()/CachePageExecute() 
docs/docs-adodb.htm:  associated column $<b>colname</b> for the current row. The column name is case-insensitive.</p>
docs/docs-adodb.htm:<pre><font color="#000000"><font color="#000000">$rs = $db-&gt;Execute($sql);<br>if ($rs)<br>	while ($arr = $rs-&gt;FetchRow()) {<br>	   &nbsp;&nbsp;# process $arr	<br></font><font color="#000000">	}</font></font></pre>
docs/docs-adodb.htm:  will be set to -1. The column numbers are zero-based. See <a href="#ex2">example 
docs/docs-adodb.htm:  = false. When disabled, RecordCount( ) will return -1 for certain databases. 
docs/docs-adodb.htm:<p><font color="#000000"><font color="#000000">$numrows = $rs-&gt;PO_RecordCount("articles_table", "group=$group");</font></font></p>
docs/docs-adodb.htm:<pre><font color="#000000"><font color="#000000">$rs = $db-&gt;Execute('execute return_multiple_rs');<br>$arr1 = $rs-&gt;GetArray();<br>$rs-&gt;NextRecordSet();<br>$arr2 = $rs-&gt;GetArray();</font></font></pre>
docs/docs-adodb.htm:  object fields are set to upper-case. Note: The newer FetchNextObject() is the 
docs/docs-adodb.htm:  Returns false if at end-of-file. If you set $toupper to true, then the object 
docs/docs-adodb.htm:  fields are set to upper-case.</font></font></p>
docs/docs-adodb.htm:<pre><font color="#000000"><font color="#000000">$rs = $db-&gt;Execute('select firstname,lastname from table');<br>if ($rs) {<br>	while ($o = $rs-&gt;FetchNextObject()) {<br>		print "$o-&gt;FIRSTNAME, $o-&gt;LASTNAME&lt;BR&gt;";<br>	}<br>}<br></font></font></pre>
docs/docs-adodb.htm:<p><font color="#000000"><font color="#000000">There is some trade-off in speed in using FetchNextObject(). If performance 
docs/docs-adodb.htm:</font></font></p><p><font color="#000000"><font color="#000000">Returns the current record as an object. Fields are not upper-cased, unlike 
docs/docs-adodb.htm:  the next record. If EOF, false is returned. Fields are not upper-cased, unlike 
docs/docs-adodb.htm:  Note that field_max_length can be -1 if it is not known. The field object returned 
docs/docs-adodb.htm:For example, $db-&gt;MetaType('char') will return 'C'. 
docs/docs-adodb.htm:  <li><b>L</b>: Logical field (boolean or bit-field)</li>
docs/docs-adodb.htm:<pre><font color="#000000"><font color="#000000"><b><font color="#336600">&lt;?<br>include('tohtml.inc.php')</font></b>; # load code common to ADOdb <br><b>include</b>('adodb.inc.php'); # load code common to ADOdb <br>$<font color="#663300">conn</font> = &amp;ADONewConnection('mysql');   # create a connection <br>$<font color="#663300">conn</font>-&gt;PConnect('localhost','userid','','agora');# connect to MySQL, agora db<br>$<font color="#663300">sql</font> = 'select CustomerName, CustomerID from customers'; <br>$<font color="#663300">rs</font>   = $<font color="#663300">conn</font>-&gt;Execute($sql); <br><font color="#336600"><b>rs2html</b></font><b>($<font color="#663300">rs</font>,'<i>border=2 cellpadding=3</i>',array('<i>Customer Name','Customer ID</i>'));<br>?&gt;</b></font></font></pre>
docs/docs-adodb.htm:  <li>ADOdb's <font face="Courier New, Courier, mono">ADORecordSet-&gt;Move()</font> 
docs/docs-adodb.htm:  <li><font face="Courier New, Courier, mono">ADORecordSet-&gt;AbsolutePosition() 
docs/docs-adodb.htm:  file adodb-xbase.inc.php.</font></font></p>
docs/docs-adodb.htm:  adodb-vfp.inc.php</b> as an example.</font></font></p>
docs/docs-adodb.htm:  few stub functions. See <b>adodb-mysql.inc.php</b> for example.</font></font></p>
docs/docs-adodb.htm:<p><font color="#000000"><font color="#000000">The default date format of ADOdb internally is YYYY-MM-DD (Ansi-92). All dates 
docs/docs-adodb.htm:<p><font color="#000000"><font color="#000000">_<b>close: </b>Close the connection -- PHP should clean up all recordsets. 
docs/docs-adodb.htm:  and _<b>numOfFields</b> fields -- called by the constructor.</font></font></p>
docs/docs-adodb.htm:  one, you will have to override this. See adodb-odbc.inc.php for an example. 
docs/docs-adodb.htm:<p><font color="#000000"><font color="#000000">See the <a href="http://php.weblogs.com/adodb-todo-roadmap">RoadMap</a> article.</font></font></p>
docs/docs-adodb.htm:  and read this article on <a href="http://phplens.com/lens/php-book/optimizing-debugging-php.php">Optimizing 
docs/docs-adodb.htm:Now you can set $db->charSet = ?? before doing a Connect() in oci8.
docs/docs-adodb.htm:of sending it to stdout - make sure to mention that as a compat warning.
docs/docs-adodb.htm:Also added $db->IsOID($oid) function; uses a heuristic, not guaranteed to work 100%.
docs/docs-adodb.htm:Contributed arabic language file by "El-Shamaa, Khaled" k.el-shamaa#cgiar.org
docs/docs-adodb.htm:Type-cast $row parameter in ifx_fetch_row() to int. Thx stefan bodgan.
docs/docs-adodb.htm:- MySql and Postgres MetaType was reporting every int column which was 
docs/docs-adodb.htm:- Postgres was not reporting the scale of decimal types<br>
docs/docs-adodb.htm:- MaxDB was padding the defaults of none-string types with spaces<br>
docs/docs-adodb.htm:- MySql now correctly converts enum columns to varchar
docs/docs-adodb.htm:- you cant add NOT NULL columns in postgres in one go, they need to be 
docs/docs-adodb.htm:- AlterColumnSQL could not change a varchar column with numbers into an 
docs/docs-adodb.htm:- a re-created sequence was not set to the correct value, if the name 
docs/docs-adodb.htm:in $rs-&gt;adodbFetchMode if it differs from the db's fetchMode.
docs/docs-adodb.htm:</font></p><p><font color="#000000">SetDateLocale() never worked till now ;-) Thx david#tomato.it
docs/docs-adodb.htm:</font></p><p><font color="#000000">Fixed some PEAR::DB emulation issues with isError() and isWarning. Thx to Gert-Rainer Bitterlich.
docs/docs-adodb.htm:</font></p><p><font color="#000000">Improved fieldname-type formatting of datadict SQL generated (adding $widespacing parameter to _GenField).
docs/docs-adodb.htm:</font></p><p><font color="#000000">ChangeTableSQL() fixes to datadict-db2.inc.php by Mark Newnham.
docs/docs-adodb.htm:So we added exception handling to ado in PHP5 by creating new adodb-ado5.inc.php driver.
docs/docs-adodb.htm:RalfBecker#digitalROCK.de contributed new sapdb data-dictionary driver
docs/docs-adodb.htm:</font></p><p><font color="#000000">Changed oci8 datadict to use MODIFY for $dd-&gt;alterCol. Thx Mark Newnham.
docs/docs-adodb.htm:</font></p><p><font color="#000000">Added adodb-xmlschema 1.0.2. Thx dan and richard.
docs/docs-adodb.htm:</font></p><p><font color="#000000">Added normalize support for postgresql (true=lowercase table name, or false=case-sensitive table names) 
docs/docs-adodb.htm:</font></p><p><font color="#000000">PHP5 variant dates in ADO not working. Fixed in adodb-ado.inc.php.
docs/docs-adodb.htm:Also GetUpdateSQL strips off ORDER BY now - thx Elieser Le&atilde;o.
docs/docs-adodb.htm:</font></p><p><font color="#000000">Moved debugging code _adodb_debug_execute() to adodb-lib.inc.php.
docs/docs-adodb.htm:</font></p><p><font color="#000000">Changed mysql GetOne() to work with mysql 3.23 when using with non-select stmts (e.g. SHOW TABLES).
docs/docs-adodb.htm:</font></p><p><font color="#000000">Changed TRIG_ prefix to a variable in datadict-oci8.inc.php. Thx to Luca.Gioppo#csi.it.
docs/docs-adodb.htm:</font></p><p><font color="#000000">New to adodb-time code. We allow you to define your own daylights savings function, 
docs/docs-adodb.htm:adodb_daylight_sv for pre-1970 dates. If the function is defined 
docs/docs-adodb.htm:</font></p><p><font color="#000000">Fixed adodb-csvlib.inc.php problem when reading stream from socket. We need to poll stream continiously.
docs/docs-adodb.htm:mode, because we do not create sub-directories in the $ADODB_CACHE_DIR
docs/docs-adodb.htm:in safe mode. In non-safe mode we still create sub-directories. Done by
docs/docs-adodb.htm:Added _GetSize() to datadict-mssql.inc.php.
docs/docs-adodb.htm:</font></p><pre><font color="#000000">   $this-&gt;_transactionID = $this-&gt;_connectionID;</font></pre>
docs/docs-adodb.htm:</font><pre><font color="#000000">   $this-&gt;_transactionID = ibase_trans($this-&gt;ibasetrans, $this-&gt;_connectionID);</font></pre>
docs/docs-adodb.htm:</font></p><p><font color="#000000">Postgres: made errorno() handling more consistent. Thx to Michael Jahn, Michael.Jahn#mailbox.tu-dresden.de.
docs/docs-adodb.htm:</font></p><p><font color="#000000">Added informix patch to better support metatables, metacolumns by "Cecilio Albero" c-albero#eos-i.com
docs/docs-adodb.htm:</font></p><pre><font color="#000000">	$text = 'test test test';<br>	$sql = "declare rs clob; begin :rs := lobinout(:sa0); end;";<br>	$stmt = $conn -&gt; PrepareSP($sql);<br>	$conn -&gt; InParameter($stmt,$text,'sa0', -1, OCI_B_CLOB);<br>	$rs = '';<br>	$conn -&gt; OutParameter($stmt,$rs,'rs', -1, OCI_B_CLOB);<br>	$conn -&gt; Execute($stmt);<br>	echo "return = ".$rs."&lt;br&gt;";<br></font></pre>
docs/docs-adodb.htm:</font><pre><font color="#000000"> - use OCINewDescriptor before binding<br> - if Param is IN, uses save() before each execute. This is done automatically for you.<br> - if Param is OUT, uses load() after each execute. This is done automatically for you.<br> - when we bind $var as LOB, we create new descriptor and return it as a<br>   Bind Result, so if we want to use OUT parameters, we have to store<br>   somewhere &amp;$var to load() data from LOB to it.<br> - IN OUT params are not working now (should not be a big problem to fix it)<br> - now mass binding not working too (I've wrote about it before)<br></font></pre>
docs/docs-adodb.htm:</font></p><p><font color="#000000">Changed postgres64 driver, MetaColumns() to not strip off quotes in default value if :: detected (type-casting of default).
docs/docs-adodb.htm:</font></p><p><font color="#000000">Suggested fix to adodb-ado.inc.php affected_rows to support PHP5 variants. Thx to Alexios Fakos.
docs/docs-adodb.htm:table automatically. Contributed by Walt Boring. Also added OCI_B_BLOB in bind on Walt's request - hope
docs/docs-adodb.htm:it doesn't break anything :-)
docs/docs-adodb.htm:</font></p><p><font color="#000000">Pim Koeman contributed dutch language file adodb-nl.inc.php.
docs/docs-adodb.htm:</font></p><p><font color="#000000">Fixed month calculation error in adodb-time.inc.php. 2102-June-01 appeared as 2102-May-32.
docs/docs-adodb.htm:</font></p><p><font color="#000000">Carl-Christian Salvesen added patch to mssql _query to support binds greater than 4000 chars.
docs/docs-adodb.htm:</font></p><p><font color="#000000">Table misspelt in perf-oci8.inc.php. Changed v$conn_cache_advice to v$db_cache_advice. Reported by Steve W.
docs/docs-adodb.htm:</font></p><p><font color="#000000">Changed oci8 Prepare(). Does not auto-allocate OCINewCursor automatically, unless 2nd param is set to true.
docs/docs-adodb.htm:are self-documenting.
docs/docs-adodb.htm:</font></p><p><font color="#000000">Added 'R' handling in ActualType() to datadict-mysql.inc.php
docs/docs-adodb.htm:</font></p><p><font color="#000000">Misc spelling corrections in adodb-mysqli.inc.php, adodb-oci8.inc.php and datadict-oci8.inc.php, from Heinz Hombergs.
docs/docs-adodb.htm:</font></p><p><font color="#000000">Informix added cursorType property. Default remains IFX_SCROLL, but you can change to 0 (non-scrollable cursor) for performance.
docs/docs-adodb.htm:</font></p><p><font color="#000000">Simplified chinese file, adodb-cn.inc.php from cysoft.
docs/docs-adodb.htm:</font></p><p><font color="#000000">Added check for ctype_alnum in adodb-datadict.inc.php. Thx to Jason Judge.
docs/docs-adodb.htm:</font></p><p><font color="#000000">Fixed paths in ADODB_DIR for session files, and back-ported it to 4.05 (15 Dec 2003)
docs/docs-adodb.htm:</font></p><p><font color="#000000">Modified adodb_pr() and adodb_backtrace() to support command-line usage (eg. no html).
docs/docs-adodb.htm:</font></p><p><font color="#000000">Added MetaIndexes - thx to Dan Cech.
docs/docs-adodb.htm:</font></p><p><font color="#000000">Added $db-&gt;length, which holds name of function that returns strlen.
docs/docs-adodb.htm:</font></p><p><font color="#000000">Fixed error handling for bad driver in ADONewConnection - passed too few params to error-handler.
docs/docs-adodb.htm:</font></p><p><font color="#000000">MetaTables/MetaColumns return ref bug with PHP5 fixed in adodb-datadict.inc.php.
docs/docs-adodb.htm:</font></p><p><font color="#000000">$ADODB_SESSION_TBL not declared as global var. Not available if adodb-session.inc.php included in function. Fixed.
docs/docs-adodb.htm:</font></p><p><font color="#000000">Switched back to foreach - faster than list-each.
docs/docs-adodb.htm:</font></p><p><font color="#000000">Fixed bug in ado driver - wiping out $this-&gt;fields with date fields.
docs/docs-adodb.htm:</font></p><p><font color="#000000">The path to adodb-php4.inc.php and adodb-iterators.inc.php was not setup properly.
docs/docs-adodb.htm:</font></p><p><font color="#000000">Force autorollback for pgsql persistent connections - 
docs/docs-adodb.htm:</font></p><p><font color="#000000">Heinz Hombergs contributed patches for mysql MetaColumns - adding scale, made
docs/docs-adodb.htm:interbase MetaColumns work with firebird/interbase, and added lang/adodb-de.inc.php.
docs/docs-adodb.htm:</font></p><p><font color="#000000">Upgraded adodb-xmlschema to 1 Oct 2003 snapshot.
docs/docs-adodb.htm:</font></p><p><font color="#000000">Create trigger in datadict-oci8.inc.php did not work, because all cr/lf's must be removed. 
docs/docs-adodb.htm:Same patch applied to  _insertid and _affectedrows for adodb-postgres64.inc.php.
docs/docs-adodb.htm:</font></p><p><font color="#000000">Extensive improvements in $perf-&gt;UI(), eg. Explain now opens in new window, we show scripts
docs/docs-adodb.htm:  added new $conn-&gt;datetime field to oci8, controls whether MetaType() returns 
docs/docs-adodb.htm:  'D' ($this-&gt;datetime==false) or 'T' ($this-&gt;datetime == true) for DATE type. 
docs/docs-adodb.htm:</font></p><p><font color="#000000">Fixed bugs in adodb-cryptsession.inc.php and adodb-session-clob.inc.php. 
docs/docs-adodb.htm:</font></p><p><font color="#000000">Tuned include_once handling to reduce file-system checking overhead. 
docs/docs-adodb.htm:</font></p><p><font color="#000000">Fixed key_exists() bug in adodb-lib.inc.php 
docs/docs-adodb.htm:</font></p><p><font color="#000000">Added swedish language file - Christian Tiberg" christian#commsoft.nu 
docs/docs-adodb.htm:</font></p><p><font color="#000000">Bug in drop index for mssql data dict fixed. Thx to Gert-Rainer Bitterlich. 
docs/docs-adodb.htm:</font></p><p><font color="#000000">Execute() now accepts 2-d array as $inputarray. Also changed docs of fnExecute() 
docs/docs-adodb.htm:  to note change in sql query counting with 2-d arrays. 
docs/docs-adodb.htm:</font></p><p><font color="#000000">Added qmagic($str), which is a qstr($str) that auto-checks for magic quotes 
docs/docs-adodb.htm:</font></p><p><font color="#000000">Fixed CacheFlush() bug - Thx to martin#gmx.de 
docs/docs-adodb.htm:</font></p><p><font color="#000000">Error handling in oci8 bugfix - if there was an error in Execute(), then when 
docs/docs-adodb.htm:</font></p><p><font color="#000000">Added limited "sapdb" driver support - mainly date support. 
docs/docs-adodb.htm:</font></p><p><font color="#000000">Changed OS check for MS-Windows to prevent confusion with darWIN (MacOS) 
docs/docs-adodb.htm:</font></p><p><font color="#000000">Timestamp format for db2 was wrong. Changed to yyyy-mm-dd-hh.mm.ss.nnnnnn. 
docs/docs-adodb.htm:</font></p><p><font color="#000000">adodb-cryptsession.php includes wrong. Fixed. 
docs/docs-adodb.htm:</font></p><p><font color="#000000">Upgraded to adodb-xmlschema.inc.php 0.0.2. 
docs/docs-adodb.htm:</font></p><p><font color="#000000">ADOdb speedup optimization - we now return all arrays by reference. 
docs/docs-adodb.htm:</font></p><h3><font color="#000000"><strong>Old changelog history moved to <a href="old-changelog.htm">old-changelog.htm</a>. 
docs/docs-perf.htm:<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
docs/docs-perf.htm:/*font-family: Arial, Helvetica, sans-serif;*/
docs/docs-perf.htm:font-size: 11pt;
docs/docs-perf.htm:font-size: 9pt;
docs/docs-perf.htm:background-color: #EEEEEE; padding: .5em; margin: 0px;
docs/docs-perf.htm:font-size: 8pt;
docs/docs-perf.htm:<p>V4.54 5 Nov 2004 (c) 2000-2004 John Lim (jlim#natsoft.com.my)</p>
docs/docs-perf.htm:<p><font size="1">This software is dual licensed using BSD-Style and
docs/docs-perf.htm:  <li>A quick health check of your database server using <code>$perf-&gt;HealthCheck()</code>
docs/docs-perf.htm:or <code>$perf-&gt;HealthCheckCLI()</code>. </li>
docs/docs-perf.htm:  <li>User interface for performance monitoring, <code>$perf-&gt;UI()</code>.
docs/docs-perf.htm:farm, for example calling <code>$perf-&gt;DBParameter('data cache hit
docs/docs-perf.htm: href="docs-adodb.htm#logsql">LogSQL</a>. All SQL logged can be
docs/docs-perf.htm:  <li><b>data cache size</b> - The amount of memory allocated to the
docs/docs-perf.htm:  <li><b>data cache hit ratio</b> - A measure of how effective the
docs/docs-perf.htm:  <li><b>current connections</b> - The number of sessions currently
docs/docs-perf.htm: color="#006600"># session variables required for monitoring</font><br>$conn = ADONewConnection($driver);<br>$conn-&gt;Connect($server,$user,$pwd,$db);<br>$perf =&amp; NewPerfMonitor($conn);<br>$perf-&gt;UI($pollsecs=5);<br>?&gt;<br></pre>
docs/docs-perf.htm:<pre>$size = $perf-&gt;DBParameter('data cache size');<br></pre>
docs/docs-perf.htm:<p>Creates a web-based user interface for performance monitoring. When
docs/docs-perf.htm:constant before calling $perf-&gt;UI(). </p>
docs/docs-perf.htm:      <font size="-1">PostgreSQL 7.3.2 on i686-pc-cygwin, compiled by
docs/docs-perf.htm:<pre>-- Ratios -- <br>          MyISAM cache hit ratio =&gt; 56.5635738832 <br>          InnoDB cache hit ratio =&gt; 0 <br>             sql cache hit ratio =&gt; 0 <br> -- IO -- <br>                      data reads =&gt; 2622 <br>                     data writes =&gt; 2415.5 <br> -- Data Cache -- <br>          MyISAM data cache size =&gt; 512K <br>             BDB data cache size =&gt; 8388600<br>          InnoDB data cache size =&gt; 8M<br> -- Memory Pools -- <br>                read buffer size =&gt; 131072 <br>                sort buffer size =&gt; 65528 <br>                     table cache =&gt; 4 <br> -- Connections -- <br>             current connections =&gt; 3<br>                 max connections =&gt; 100</pre>
docs/docs-perf.htm:<pre>Accumulating statistics...<br> Time   WS-CPU%   Hit%   Sess        Reads/s          Writes/s<br>11:08:30    0.7  56.56      1         0.0000            0.0000<br>11:08:33    1.8  56.56      2         0.0000            0.0000<br>11:08:36   11.1  56.55      3         2.5000            0.0000<br>11:08:39    9.8  56.55      2         3.1121            0.0000<br>11:08:42    2.8  56.55      1         0.0000            0.0000<br>11:08:45    7.4  56.55      2         0.0000            1.5000<br></pre>
docs/docs-perf.htm:<p><b>WS-CPU%</b> is the Web Server CPU load of the server that PHP is
docs/docs-perf.htm:$connection-&gt;LogSQL(true) is enabled. The adodb_logsql table is
docs/docs-perf.htm:populated using <a href="docs-adodb.htm#logsql">$conn-&gt;LogSQL</a>.
docs/docs-perf.htm:$connection-&gt;LogSQL(true) is enabled. The adodb_logsql table is
docs/docs-perf.htm:populated using <a href="docs-adodb.htm#logsql">$conn-&gt;LogSQL</a>.
docs/docs-perf.htm:$connection-&gt;LogSQL(true) is enabled.
docs/docs-perf.htm:postgresql, the information is up-to-date since the last <i>vacuum</i>.
docs/docs-perf.htm:$this-&gt;DBParameter("data cache size").</p>
docs/docs-perf.htm:$rs-&gt;fields[$index] to use (otherwise $index=1), and optional 4th
docs/docs-perf.htm:invoked, e.g. to invoke $this-&gt;GetIndexValue(), set this array
docs/docs-perf.htm:will invoke $this-&gt;GetIndexDescription($val). This is useful for
docs/docs-perf.htm:      <td>Taken from high-water-mark</td>
docs/docs-perf.htm:is 20-80. Default is 0. See <a
docs/docs-perf.htm: href="http://www.dba-oracle.com/oracle_tips_cbo_part1.htm">optimizer_index_caching</a>.</td>
docs/docs-perf.htm:      <td>Recommended is 10-50 for TP, and 50 for data warehouses.
docs/docs-perf.htm: href="http://www.dba-oracle.com/oracle_tips_cost_adj.htm">optimizer_index_cost_adj</a>.
docs/docs-datadict.htm:<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
docs/docs-datadict.htm:  <meta http-equiv="Content-Type"
docs/docs-datadict.htm: content="text/html; charset=iso-8859-1">
docs/docs-datadict.htm:        /*font-family: Arial, Helvetica, sans-serif;*/
docs/docs-datadict.htm:        font-size: 11pt;
docs/docs-datadict.htm:        font-size: 9pt;
docs/docs-datadict.htm:         background-color: #EEEEEE; padding: .5em; margin: 0px; 
docs/docs-datadict.htm:        font-size: 8pt;
docs/docs-datadict.htm:<body style="background-color: rgb(255, 255, 255);">
docs/docs-datadict.htm:<p>V4.54 5 Nov 2004 (c) 2000-2004 John Lim (<a
docs/docs-datadict.htm:<p><font size="1">This software is dual licensed using BSD-Style and
docs/docs-datadict.htm:multiple databases. Richard Tango-Lowy and Dan Cech have been kind
docs/docs-datadict.htm:<p> <b>Well-tested:</b> PostgreSQL, MySQL, Oracle, MSSQL.<br>
docs/docs-datadict.htm:<b>Beta-quality:</b> DB2, Informix, Sybase, Interbase, Firebird.<br>
docs/docs-datadict.htm:<b>Alpha-quality:</b> MS Access (does not support DEFAULT values) and
docs/docs-datadict.htm:<pre>  include_once('adodb.inc.php');<br>  <font color="#006600"># First create a normal connection</font><br>  $db-&gt;NewADOConnection('mysql');<br>  $db-&gt;Connect(...);<br><br>  <font
docs/docs-datadict.htm: color="#006600"># We demonstrate creating tables and indexes</font><br>  $sqlarray = $dict-&gt;<strong>CreateTableSQL</strong>($tabname, $flds, $taboptarray);<br>  $dict-&gt;<strong>ExecuteSQLArray</strong>($sqlarray);<br><br>  $idxflds = 'co11, col2';<br>  $sqlarray = $dict-&gt;<strong>CreateIndexSQL</strong>($idxname, $tabname, $idxflds);<br>  $dict-&gt;<strong>ExecuteSQLArray</strong>($sqlarray);<br></pre>
docs/docs-datadict.htm:field is comma-delimited.
docs/docs-datadict.htm:2-dimensional array, where each row in the 1st dimension represents one
docs/docs-datadict.htm:<pre>  C:  varchar<br>  X:  Largest varchar size <br>  XL: For Oracle, returns CLOB, otherwise same as 'X' above<br><br>  C2: Multibyte varchar<br>  X2: Multibyte varchar (largest size)<br><br>  B:  BLOB (binary large object)<br><br>  D:  Date (some databases do not support this, and we return a datetime type)<br>  T:  Datetime or Timestamp<br>  L:  Integer field suitable for storing booleans (0 or 1)<br>  I:  Integer (mapped to I4)<br>  I1: 1-byte integer<br>  I2: 2-byte integer<br>  I4: 4-byte integer<br>  I8: 8-byte integer<br>  F:  Floating point number<br>  N:  Numeric or decimal number<br></pre>
docs/docs-datadict.htm:<p>The $otheroptions include the following keywords (case-insensitive):</p>
docs/docs-datadict.htm:<pre>  AUTO            For autoincrement number. Emulated with triggers if not available.<br>                  Sets NOTNULL also.<br>  AUTOINCREMENT   Same as auto.<br>  KEY             Primary key field. Sets NOTNULL also. Compound keys are supported.<br>  PRIMARY         Same as KEY.<br>  DEF             Synonym for DEFAULT for lazy typists.<br>  DEFAULT         The default value. Character strings are auto-quoted unless<br>                  the string begins and ends with spaces, eg ' SYSDATE '.<br>  NOTNULL         If field is not null.<br>  DEFDATE         Set default value to call function to get today's date.<br>  DEFTIMESTAMP    Set default to call function to get today's datetime.<br>  NOQUOTE         Prevents autoquoting of default string values.<br>  CONSTRAINTS     Additional constraints defined at the end of the field<br>                  definition.<br></pre>
docs/docs-datadict.htm:Date), you should enclose it in back-quotes. Normally field names are
docs/docs-datadict.htm:not case-sensitive, but if you enclose it in back-quotes, some
docs/docs-datadict.htm:databases will treat the names as case-sensitive (eg. Oracle) , and
docs/docs-datadict.htm:<p>Rename a table field. Returns the an array of strings, which is the SQL required to rename a column. The optional $flds is a complete column-defintion-string like for AddColumnSQL, only used by mysql at the moment. Since ADOdb 4.53. Contributed by Ralf Becker.</p>
docs/docs-datadict.htm:<h4>function MetaType($t,$len=-1,$fieldobj=false)</h4>
docs/docs-datadict.htm:<p>Convert between database-independent 'Meta' and database-specific
docs/docs-datadict.htm:<p>This is a class contributed by Richard Tango-Lowy and Dan Cech that
docs/docs-datadict.htm:You can <a href="http://sourceforge.net/projects/adodb-xmlschema/">download
docs/docs-datadict.htm:<p>Adodb-xmlschema, or AXMLS, is a set of classes that allow the user
docs/docs-datadict.htm:<span style="font-weight: bold;"> Installing axmls</span>
docs/docs-datadict.htm:manually, simply copy the adodb-xmlschema.inc.php file and the xsl
docs/docs-datadict.htm:<span style="font-weight: bold;"> Using AXMLS in Your Application</span>
docs/docs-datadict.htm:<pre class="listing"><pre>&lt;?PHP<br>/* You must tell the script where to find the ADOdb and<br> * the AXMLS libraries.<br> */<br>require( "path_to_adodb/adodb.inc.php");<br>require( "path_to_adodb/adodb-xmlschema.inc.php" );<br><br>/* Configuration information. Define the schema filename,<br> * RDBMS platform (see the ADODB documentation for valid<br> * platform names), and database connection information here.<br> */<br>$schemaFile = 'example.xml';<br>$platform = 'mysql';<br>$dbHost = 'localhost';<br>$dbName = 'database';<br>$dbUser = 'username';<br>$dbPassword = 'password';<br><br>/* Start by creating a normal ADODB connection.<br> */<br>$db = ADONewConnection( $platform );<br>$db-&gt;Connect( $dbHost, $dbUser, $dbPassword, $dbName );<br><br>/* Use the database connection to create a new adoSchema object.<br> */<br>$schema = new adoSchema( $db );<br><br>/* Call ParseSchema() to build SQL from the XML schema file.<br> * Then call ExecuteSchema() to apply the resulting SQL to <br> * the database.<br> */<br>$sql = $schema-&gt;ParseSchema( $schemaFile );<br>$result = $schema-&gt;ExecuteSchema();<br>?&gt;<br></pre></pre>
docs/docs-datadict.htm:<pre class="listing"><pre>$db = ADONewConnection( 'mysql' );<br>$db-&gt;Connect( 'host', 'user', 'password', 'database' );<br></pre></pre>
docs/docs-datadict.htm:<pre class="listing"><pre><br>$schema-&gt;ParseSchema( $schemaFile ); <br>$schema-&gt;ExecuteSchema(); <br></pre></pre>
docs/docs-session.htm:<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
docs/docs-session.htm:  <meta http-equiv="Content-Type"
docs/docs-session.htm: content="text/html; charset=iso-8859-1">
docs/docs-session.htm:/*font-family: Arial, Helvetica, sans-serif;*/
docs/docs-session.htm:font-size: 11pt;
docs/docs-session.htm:font-size: 9pt;
docs/docs-session.htm:background-color: #EEEEEE; padding: .5em; margin: 0px;
docs/docs-session.htm:font-size: 8pt;
docs/docs-session.htm:<body style="background-color: rgb(255, 255, 255);">
docs/docs-session.htm:V4.54 5 Nov 2004 (c) 2000-2004 John Lim (jlim#natsoft.com.my)
docs/docs-session.htm:<p> <font size="1">This software is dual licensed using BSD-Style and
docs/docs-session.htm:adodb-session-clob.php). Useful
docs/docs-session.htm:adodb-cryptsession.inc.php. Enabling encryption is simply a matter of
docs/docs-session.htm:including adodb-cryptsession.inc.php instead of adodb-session.inc.php. </li>
docs/docs-session.htm:<pre>adodb-session.php        : The default<br>adodb-session-clob.php   : Use this if you are storing DATA in clobs<br>adodb-cryptsession.php   : Use this if you want to store encrypted session data in the database<br><br>
docs/docs-session.htm: color="#004040">    include('adodb/adodb.inc.php');<br>    <br><b>    $ADODB_SESSION_DRIVER='mysql';<br>    $ADODB_SESSION_CONNECT='localhost';<br>    $ADODB_SESSION_USER ='scott';<br>    $ADODB_SESSION_PWD ='tiger';<br>    $ADODB_SESSION_DB ='sessiondb';</b><br>    <br>    <b>include('adodb/session/adodb-session.php');</b><br>    session_start();<br>    <br>    #<br>    # Test session vars, the following should increment on refresh<br>    #<br>    $_SESSION['AVAR'] += 1;<br>    print "&lt;p&gt;\$_SESSION['AVAR']={$_SESSION['AVAR']}&lt;/p&gt;";<br></font></pre>
docs/docs-session.htm:<p>To force non-persistent connections, call adodb_session_open() first before session_start():
docs/docs-session.htm: <font color="#004040"><br>    include('adodb/adodb.inc.php');<br>    <br><b>    $ADODB_SESSION_DRIVER='mysql';<br>    $ADODB_SESSION_CONNECT='localhost';<br>    $ADODB_SESSION_USER ='scott';<br>    $ADODB_SESSION_PWD ='tiger';<br>    $ADODB_SESSION_DB ='sessiondb';</b><br>    <br>    <b>include('adodb/session/adodb-session.php');<br>    adodb_sess_open(false,false,false);</b><br>    session_start();<br> </font>
docs/docs-session.htm:<p>To use a encrypted sessions, simply replace the file adodb-session.php:</p>
docs/docs-session.htm: color="#004040"><br>    include('adodb/adodb.inc.php');<br>    <br><b>    $ADODB_SESSION_DRIVER='mysql';<br>    $ADODB_SESSION_CONNECT='localhost';<br>    $ADODB_SESSION_USER ='scott';<br>    $ADODB_SESSION_PWD ='tiger';<br>    $ADODB_SESSION_DB ='sessiondb';<br>    <br>    include('adodb/session/adodb-cryptsession.php');</b><br>    session_start();</font><br>
docs/docs-session.htm: <p>And the same technique for adodb-session-clob.php:</p>
docs/docs-session.htm: color="#004040"><br>    include('adodb/adodb.inc.php');<br>    <br><b>    $ADODB_SESSION_DRIVER='mysql';<br>    $ADODB_SESSION_CONNECT='localhost';<br>    $ADODB_SESSION_USER ='scott';<br>    $ADODB_SESSION_PWD ='tiger';<br>    $ADODB_SESSION_DB ='sessiondb';<br>    <br>    include('adodb/session/adodb-session-clob.php');</b><br>    session_start();</font>
docs/docs-session.htm: <p> For the adodb-session-clob.php version, create this:
docs/docs-session.htm:<pre><font color="#004040"><br>        function NotifyFn($expireref, $sesskey)<br>        {<br>        global $ADODB_SESS_CONN; # the session connection object<br><br>          $user = $ADODB_SESS_CONN-&gt;qstr($expireref);<br>          $ADODB_SESS_CONN-&gt;Execute("delete from shopping_cart where user=$user");<br>          system("rm /work/tmpfiles/$expireref/*");<br>        }</font><br>    </pre>
docs/docs-session.htm:<p>Also see the <a href="docs-adodb.htm">core ADOdb documentation</a>.
docs/docs-oracle.htm:<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
docs/docs-oracle.htm:  background-color: #eee;
docs/docs-oracle.htm:  font-size: 12px;
docs/docs-oracle.htm:  background-color: #eee;
docs/docs-oracle.htm:  font-size: 12px;
docs/docs-oracle.htm:<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
docs/docs-oracle.htm:<p>First we have the C extensions which provide low-level access to Oracle functionality. These C extensions are precompiled into PHP, or linked in dynamically when the web server starts up. Just in case you need it, here's a <a href=http://www.oracle.com/technology/tech/opensource/php/apache/inst_php_apache_linux.html>guide to installing Oracle and PHP on Linux</a>.</p>
docs/docs-oracle.htm:    <td>Has multi-tier design. Simple high-level design for beginners, and also lower-level advanced Oracle functionality.</td>
docs/docs-oracle.htm:    <td>Yes. Provides great speedups for SQL involving complex <i>where, group-by </i>and <i>order-by</i> clauses.</td>
docs/docs-oracle.htm:$db->Connect($tnsName, "scott", "tiger");
docs/docs-oracle.htm:$rs = $db->Execute("select * from emp where empno>:emp order by empno", 
docs/docs-oracle.htm:while ($arr = $rs->FetchRow()) {
docs/docs-oracle.htm:<p>The Execute( ) function returns a recordset object, and you can retrieve the rows returned using $recordset-&gt;FetchRow( ). </p>
docs/docs-oracle.htm:    <td><pre><font size="1">$recordset = $db-><b>Execute</b>("select * from emp where empno>:emp", 
docs/docs-oracle.htm:while ($arr = $recordset-><b>FetchRow</b>()) {
docs/docs-oracle.htm:$rs = $db->Execute("select * from emp where empno>:emp", array('emp' => 7900));
docs/docs-oracle.htm:while (!$rs->EOF) {
docs/docs-oracle.htm:	print_r($rs->fields);
docs/docs-oracle.htm:	$rs->MoveNext();
docs/docs-oracle.htm:<p>And if you are interested in having the data returned in a 2-dimensional array, you can use:
docs/docs-oracle.htm:$arr = $db->GetArray("select * from emp where empno>:emp", array('emp' => 7900));
docs/docs-oracle.htm:$arr = $db->GetRow("select * from emp where empno=:emp", array('emp' => 7900));
docs/docs-oracle.htm:$arr = $db->GetOne("select ename from emp where empno=:emp", array('emp' => 7900));
docs/docs-oracle.htm:$rs = $db->SelectLimit('select * from table', $offset, $limitrows);
docs/docs-oracle.htm:  <li> Numeric indexes - use <font size="2" face="Courier New, Courier, mono">$connection-&gt;SetFetchMode(ADODB_FETCH_NUM).</font></li>
docs/docs-oracle.htm:  <li>Associative indexes - the keys of the array are the names of the fields (in upper-case). Use <font size="2" face="Courier New, Courier, mono">$connection-&gt;SetFetchMode(ADODB_FETCH_ASSOC)</font><font face="Courier New, Courier, mono">.</font></li>
docs/docs-oracle.htm:  <li>Both numeric and associative indexes - use <font size="2" face="Courier New, Courier, mono">$connection-&gt;SetFetchMode(ADODB_FETCH_BOTH).</font></li>
docs/docs-oracle.htm:<p>You can define a database cache directory using $ADODB_CACHE_DIR, and cache the results of frequently used queries that rarely change. This is particularly useful for SQL with complex where clauses and group-by's and order-by's. It is also good for relieving heavily-loaded database servers.</p>
docs/docs-oracle.htm:$rs = $db->CacheExecute(3600, "select names from allcountries order by 1");
docs/docs-oracle.htm:$connection->cacheSecs = 3600;
docs/docs-oracle.htm:$rs = $connection->CacheExecute($sql, array('id' => 1));
docs/docs-oracle.htm:<p>Prepare( ) is  for compiling frequently used  SQL statement for reuse. For example, suppose we have a large array which needs to be inserted into an Oracle database. The following will result in a massive speedup in query execution (at least 20-40%), as the SQL statement only needs to be compiled once:</p>
docs/docs-oracle.htm:$stmt = $db->Prepare('insert into table (field1, field2) values (:f1, :f2)');
docs/docs-oracle.htm:	$db->Execute($stmt, array('f1' => $key, 'f2' => $val);
docs/docs-oracle.htm:<p>For updating records with LOBs, the functions UpdateBlob( ) and UpdateClob( ) are provided. Here's a BLOB example. The parameters should be self-explanatory:
docs/docs-oracle.htm:$ok = $db->Execute("insert into aTable (id, name, ablob) 
docs/docs-oracle.htm:if (!$ok) return LogError($db-&gt;ErrorMsg());
docs/docs-oracle.htm:$db->UpdateBlob('aTable', 'ablob', $blobValue, 'id=aSequence.currVal');
docs/docs-oracle.htm:$ok = $db->Execute("insert into aTable (id, name, aclob) 
docs/docs-oracle.htm:if (!$ok) return LogError($db-&gt;ErrorMsg());
docs/docs-oracle.htm:$db->UpdateClob('aTable', 'aclob', $clobValue, 'id=aSequence.currVal');
docs/docs-oracle.htm:<p>Note that LogError( ) is a user-defined function, and not part of ADOdb.
docs/docs-oracle.htm:$rs = $db->ExecuteCursor("BEGIN open_tab(:refc,'A%'); END;",'refc');
docs/docs-oracle.htm:while ($arr = $rs->FetchRow()) print_r($arr);
docs/docs-oracle.htm:$stmt = $db->PrepareSP("BEGIN adodb.data_out(:a1, :a2); END;");
docs/docs-oracle.htm:$db->InParameter($stmt,$input,'a1');
docs/docs-oracle.htm:$db->OutParameter($stmt,$output,'a2');
docs/docs-oracle.htm:$ok = $db->Execute($stmt);
docs/docs-oracle.htm:$stmt = $db->PrepareSP("BEGIN adodb.open_tab(:refc,:tabname); END;");
docs/docs-oracle.htm:$db->InParameter($stmt,$input,'tabname');
docs/docs-oracle.htm:$rs = $db->ExecuteCursor($stmt,'refc');
docs/docs-oracle.htm:while ($arr = $rs->FetchRow()) print_r($arr);
docs/docs-oracle.htm:	$stmt = $conn -> PrepareSP($sql);
docs/docs-oracle.htm:	$conn -> InParameter($stmt,$text,'sa0', -1, OCI_B_CLOB); # -1 means variable length
docs/docs-oracle.htm:	$conn -> OutParameter($stmt,$rs,'rs', -1, OCI_B_CLOB);
docs/docs-oracle.htm:	$conn -> Execute($stmt);
docs/docs-oracle.htm:$arr = $db->GetArray("select * from emp where empno>:emp", array('emp' => 7900));
docs/docs-oracle.htm:$arr = $db->GetArray("select * from emp where empno>7900");
docs/docs-oracle.htm:<p>First, to ensure cross-database compability, ADOdb assumes that dates are returned in ISO format (YYYY-MM-DD H24:MI:SS).</p>
docs/docs-oracle.htm:<p>Secondly, since Oracle treats dates and datetime as the same data type, we decided not to display the time in the default date format. So on login, ADOdb will set the NLS_DATE_FORMAT to 'YYYY-MM-DD'. If you prefer to show the date and time by default, do this:</p>
docs/docs-oracle.htm:$db->NLS_DATE_FORMAT =  'RRRR-MM-DD HH24:MI:SS';
docs/docs-oracle.htm:$db->Connect($tns, $user, $pwd);
docs/docs-oracle.htm:<pre>$sql = &quot;ALTER SESSION SET NLS_DATE_FORMAT = 'RRRR-MM-DD HH24:MI:SS'&quot;;
docs/docs-oracle.htm:$db-&gt;Execute($sql);
docs/docs-oracle.htm:  <tr><td>$db->sysDate</td><td>Property that holds the SQL function that returns today's date</td>
docs/docs-oracle.htm:<tr><td>$db->sysTimeStamp</td><td>Property that holds the SQL function that returns the current
docs/docs-oracle.htm:<td>$db->concat_operator</td><td>Property that holds the concatenation operator
docs/docs-oracle.htm:<tr><td>$db->length</td><td>Property that holds the name of the SQL strlen function.
docs/docs-oracle.htm:<tr><td>$db->upperCase</td><td>Property that holds the name of the SQL strtoupper function.
docs/docs-oracle.htm:<tr><td>$db->random</td><td>Property that holds the SQL to generate a random number between 0.00 and 1.00.
docs/docs-oracle.htm:<tr><td>$db->substr</td><td>Property that holds the name of the SQL substring function.
docs/docs-oracle.htm:    <td>The default high performance driver. The keys of associative arrays returned in a recordset are upper-case.</td>
docs/docs-oracle.htm:    <td> The portable Oracle driver. Slightly slower than oci8. This driver uses ? instead of :<i>bindvar</i> for binding variables, which is the standard for  other databases. Also the keys of associative arrays are in lower-case like other databases.</td>
docs/docs-oracle.htm:<p>Here's an example of calling the <i>oci8po</i> driver. Note that the bind variables use question-mark:</p>
docs/docs-oracle.htm:$db-&gt;Connect($tns, $user, $pwd);
docs/docs-oracle.htm:$db-&gt;Execute(&quot;insert into atable (f1, f2) values (?,?)&quot;, array(12, 'abc'));</pre>
docs/docs-oracle.htm:<p>Before you can use ADOdb, you need to have the Oracle client installed and setup the oci8 extension. This extension comes pre-compiled for Windows (but you still need to enable it in the php.ini file). For information on compiling the oci8 extension for PHP and Apache on Unix, there is an excellent guide at <a href="http://www.oracle.com/technology/tech/opensource/php/apache/inst_php_apache_linux.html">oracle.com</a>. </p>
docs/docs-oracle.htm:<p>One question that is frequently asked is should you use persistent connections to Oracle. Persistent connections allow PHP to recycle existing connections, reusing them after the previous web pages have completed. Non-persistent connections close automatically after the web page has completed. Persistent connections are faster because the cost of reconnecting is expensive, but there is additional resource overhead. As an alternative, Oracle allows you to pool and reuse server processes; this is called  <a href="http://www.cise.ufl.edu/help/database/oracle-docs/server.920/a96521/manproc.htm#13132">Shared Server</a> (also known as MTS).</p>
docs/docs-oracle.htm:<p>The author's benchmarks suggest that using non-persistent connections and the  Shared Server configuration offer the best performance. If Shared Server is not an option, only then consider using persistent connections.</p>
docs/docs-oracle.htm:<p>a. PHP and Oracle reside on the same machine, use default SID, with non-persistent connections:</p>
docs/docs-oracle.htm:	$conn-&gt;Connect(false, 'scott', 'tiger');</pre>
docs/docs-oracle.htm:	$conn-&gt;PConnect(false, 'scott', 'tiger', 'myTNS');</pre>
docs/docs-oracle.htm:<pre> 	$conn-&gt;PConnect('myTNS', 'scott', 'tiger');</pre>
docs/docs-oracle.htm:<pre>	$conn-&gt;Connect('192.168.0.1', 'scott', 'tiger', 'SID');</pre>
docs/docs-oracle.htm:<pre>	$conn-&gt;Connect('192.168.0.1', 'scott', 'tiger', 'servicename');</pre>
docs/docs-oracle.htm:	$conn-&gt;Connect($cstr, 'scott', 'tiger');
docs/docs-oracle.htm:<p>The examples in this article are easy to read but a bit simplistic because we ignore error-handling. Execute( ) and Connect( ) will return false on error. So a more realistic way to call Connect( ) and Execute( ) is:
docs/docs-oracle.htm:    MyLogFunction($db-&gt;ErrorNo(), $db-&gt;ErrorMsg());
docs/docs-oracle.htm:if (!$db-&gt;Connect($tns, $usr, $pwd)) InvokeErrorHandler();
docs/docs-oracle.htm:$rs = $db->Execute("select * from emp where empno>:emp order by empno", 
docs/docs-oracle.htm:while ($arr = $rs->FetchRow()) {
docs/docs-oracle.htm:<p><a href="http://phplens.com/lens/adodb/docs-datadict.htm">Schema generation</a>. This allows you to define a schema using XML and import it into different RDBMS systems portably.</p>
docs/docs-oracle.htm:<p><a href="http://phplens.com/lens/adodb/docs-perf.htm">Performance monitoring and tracing</a>. Highlights of performance monitoring include identification of poor and suspicious SQL, with explain plan support, and identifying which web pages the SQL ran on.</p>
docs/tips_portable_sql.htm:<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
docs/tips_portable_sql.htm:<p>Most database vendors practice product lock-in. The best or fastest way to 
docs/tips_portable_sql.htm:  Even though ANSI-92 SQL has codified much more, we still have to implement portability 
docs/tips_portable_sql.htm:<pre>$connection-&gt;SelectLimit('select * from table', 10);
docs/tips_portable_sql.htm:  the arrays indexed by field name or number. However different low-level PHP 
docs/tips_portable_sql.htm:<pre>$rs = $db-&gt;Execute(&quot;select * from table where state=$state&quot;);
docs/tips_portable_sql.htm:$numrows = $rs-&gt;PO_RecordCount('table', &quot;state=$state&quot;);</pre>
docs/tips_portable_sql.htm:<p>SELECT statements are commonly used to implement row-level locking of tables. 
docs/tips_portable_sql.htm:  do not require row-level locking because they use versioning to display data 
docs/tips_portable_sql.htm:<p>Currently, I recommend encapsulating the row-level locking in a separate function, 
docs/tips_portable_sql.htm:<pre>$connection-&gt;BeginTrans( );
docs/tips_portable_sql.htm:$connection-&gt;RowLock($table, $where); </pre>
docs/tips_portable_sql.htm:<pre>if ($ok) $connection-&gt;CommitTrans( );
docs/tips_portable_sql.htm:else $connection-&gt;RollbackTrans( );
docs/tips_portable_sql.htm:<p>For example, an ANSI-92 left outer join between two tables t1 and t2 could 
docs/tips_portable_sql.htm:<p><font face="Courier New, Courier, mono">$conn-&gt;leftOuter</font>: holds the 
docs/tips_portable_sql.htm:  <font face="Courier New, Courier, mono">$conn-&gt;rightOuter</font>: holds the 
docs/tips_portable_sql.htm:  <font face="Courier New, Courier, mono">$conn-&gt;ansiOuter</font>: boolean 
docs/tips_portable_sql.htm:  that if true means that ANSI-92 style outer joins are supported, or false if 
docs/tips_portable_sql.htm:  There are two common techniques: (1) auto-incrementing columns and (2) sequences. 
docs/tips_portable_sql.htm:<p>Auto-incrementing columns are supported by MySQL, Sybase and Microsoft Access 
docs/tips_portable_sql.htm:<pre>$id = $connection-&gt;GenID('sequence_name');<br>$connection-&gt;Execute(&quot;insert into table (id, firstname, lastname) <br>			   values ($id, $firstname, $lastname)&quot;);</pre>
docs/tips_portable_sql.htm:  useful because it allows pre-compilation of SQL. When inserting multiple records 
docs/tips_portable_sql.htm:<pre>$stmt = $db-&gt;Prepare('select * from customers where custid=? and state=?');
docs/tips_portable_sql.htm:$rs = $db-&gt;Execute($stmt, array($id,'New York'));</pre>
docs/tips_portable_sql.htm:<pre><font color="#000000">$sql = <font color="#993300">'insert into table (col1,col2) values ('</font>.$DB-&gt;Param('a').<font color="#993300">','</font>.$DB-&gt;Param('b').<font color="#993300">')'</font>;
docs/tips_portable_sql.htm:$stmt = $DB-&gt;Prepare($sql);
docs/tips_portable_sql.htm:$stmt = $DB-&gt;Execute($stmt,array('one','two'));
docs/tips_portable_sql.htm:  <tr><td>$db->sysDate</td><td>Property that holds the SQL function that returns today's date</td>
docs/tips_portable_sql.htm:<tr><td>$db->sysTimeStamp</td><td>Property that holds the SQL function that returns the current
docs/tips_portable_sql.htm:<td>$db->concat_operator</td><td>Property that holds the concatenation operator
docs/tips_portable_sql.htm:<tr><td>$db->length</td><td>Property that holds the name of the SQL strlen function.
docs/tips_portable_sql.htm:<tr><td>$db->upperCase</td><td>Property that holds the name of the SQL strtoupper function.
docs/tips_portable_sql.htm:<tr><td>$db->random</td><td>Property that holds the SQL to generate a random number between 0.00 and 1.00.
docs/tips_portable_sql.htm:<tr><td>$db->substr</td><td>Property that holds the name of the SQL substring function.
docs/tips_portable_sql.htm:There are database design tools such as ERWin or Dezign that allow you to generate data definition language commands such as ALTER TABLE or CREATE INDEX from Entity-Relationship diagrams. 
docs/tips_portable_sql.htm:However if you prefer to use a PHP-based table creation scheme, adodb provides you with this feature. Here is the code to generate the SQL to create a table with: 
docs/tips_portable_sql.htm:	<li> Auto-increment primary key 'ID', </li>
docs/tips_portable_sql.htm:$sql1 = $datadict-><strong>CreateTableSQL</strong>('tabname', $flds);
docs/tips_portable_sql.htm:$sql2 = $datadict-><strong>CreateIndexSQL</strong>('idx_name_age', 'tabname', 'NAME,AGE');
docs/tips_portable_sql.htm:  ADOdb attempts to display all dates in ISO (YYYY-MM-DD) format. ADOdb also provides 
docs/tips_portable_sql.htm:<pre>$date1 = $connection-&gt;DBDate(time( ));<br>$date2 = $connection-&gt;DBTimeStamp('2002-02-23 13:03:33');</pre>
docs/tips_portable_sql.htm:<pre>$unixts = $recordset-&gt;UnixDate('#2002-02-30#'); <font color="green"># MS Access date =&gt; unix timestamp</font></pre>
docs/tips_portable_sql.htm:$conn->Execute('INSERT INTO blobtable (id, blobcol) VALUES (1,empty_blob())'); 
docs/tips_portable_sql.htm:$conn->UpdateBlob('blobtable','blobcol',$blobvalue,'id=1'); 
docs/tips_portable_sql.htm:<font color=green># non-oracle databases</font>
docs/tips_portable_sql.htm:$conn->Execute('INSERT INTO blobtable (id, blobcol) VALUES (1, null)'); 
docs/tips_portable_sql.htm:$conn->UpdateBlob('blobtable','blobcol',$blobvalue,'id=1');
docs/tips_portable_sql.htm:<p>Null handling is another area where differences can occur. This is a mine-field, 
docs/tips_portable_sql.htm:  because 3-value logic is tricky.
docs/tips_portable_sql.htm:<pre>	switch ($db->databaseType) {
docs/tips_portable_sql.htm:	$stmt = $db-&gt;PrepareSP($sql);	<br>	$db-&gt;Parameter($stmt,$id,'<font color="#993300">myid</font>'); 
docs/tips_portable_sql.htm:	$db-&gt;Parameter($stmt,$group,'<font color="#993300">group</font>');
docs/tips_portable_sql.htm:	<font color="green"># true indicates output parameter<br>	</font>$db-&gt;Parameter($stmt,$ret,'<font color="#993300">RETVAL</font>',true); 
docs/tips_portable_sql.htm:	$db-&gt;Execute($stmt); </font></pre>
docs/tips_portable_sql.htm:  stored in a separate variable, in a file called 'mysql-lang.inc.php'.</p>
docs/tips_portable_sql.htm:include_once(&quot;<font color="#993300">$database-lang.inc.php</font>&quot;);</b>
docs/tips_portable_sql.htm:$db->PConnect(...) or die('<font color="#993300">Failed to connect to database</font>');
docs/tips_portable_sql.htm:$rs = $db-&gt;Execute(sprintf($sqlSearchKeyWord,$db-&gt;qstr($word)));</pre>
docs/tips_portable_sql.htm:sound principles. Learn the theory of normalization and entity-relationship diagrams and model 
docs/tips_portable_sql.htm:  Also read this article on <a href=http://phplens.com/lens/php-book/optimizing-debugging-php.php>Optimizing PHP</a>.
docs/tips_portable_sql.htm:<font size=1>(c) 2002-2003 John Lim.</font>
docs/readme.htm:<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
docs/readme.htm:	body,td {font-family:Arial,Helvetica,sans-serif;font-size:11pt}
docs/readme.htm:	pre {font-size:9pt}
docs/readme.htm:	.toplink {font-size:8pt}
docs/readme.htm:<ul><li>The ADOdb documentation has moved to <a href=docs-adodb.htm>docs-adodb.htm</a> 
docs/readme.htm:<p><li>The ADOdb data dictionary docs are at <a href=docs-datadict.htm>docs-datadict.htm</a>. 
docs/readme.htm:<p><li>The ADOdb database performance monitoring docs are at <a href=docs-perf.htm>docs-perf.htm</a>. 
docs/readme.htm:<p><li>The ADOdb database-backed session docs are at <a href=docs-session.htm>docs-session.htm</a>. 
docs/readme.htm:$db->debug = true;
docs/readme.htm:$db-><b>Connect</b>($server, $user, $password, $database);
docs/readme.htm:$rs = $db-><b>Execute</b>('select * from some_small_table');
docs/readme.htm:print_r($rs-><b>GetRows</b>());
docs/readme.htm:	<li> <strong>Analysis Console for Intrusion Databases (ACID)</strong>: PHP-based 
docs/readme.htm:		generated by security-related software such as IDSes and firewalls (e.g. 
docs/readme.htm:		compliance throughout, an advanced blocks system, and is fully multi-lingual 
docs/readme.htm:		for managing information and integrated modules on your internet, intranet- 
docs/readme.htm:		and extranet-sites. From Norway. </li>
docs/tute.htm:<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
docs/tute.htm:		Eether, eyether, neether, nyther - 
docs/tute.htm:		You like potato and I like po-tah-to, 
docs/tute.htm:		You like tomato and I like to-mah-to; 
docs/tute.htm:		Potato, po-tah-to, tomato, to-mah-to - 
docs/tute.htm:<p>PHP is all about creating dynamic web-sites with the least fuss and the most 
docs/tute.htm:  connect functions are different also.. One database says po-tato, the other 
docs/tute.htm:  database says pota-to. Oh-oh. 
docs/tute.htm:<p>The above code has been color-coded by section. The first section is the connection 
docs/tute.htm: $db-&gt;<b>Connect</b>(&quot;localhost&quot;, &quot;root&quot;, &quot;password&quot;, &quot;mydb&quot;);</font>
docs/tute.htm: <font color="#663300">$result = $db-&gt;<b>Execute</b>(&quot;SELECT * FROM employees&quot;);
docs/tute.htm: <font color="#006666"><b>while</b> (!$result-&gt;EOF) &#123;
docs/tute.htm:	<b>for</b> ($i=0, $max=$result-&gt;<b>FieldCount</b>(); $i &lt; $max; $i++)
docs/tute.htm:		   <b>print</b> $result-&gt;fields[$i].' ';
docs/tute.htm:	$result-&gt;<b>MoveNext</b>();
docs/tute.htm:$db-&gt;<b>Connect</b>(&quot;localhost&quot;, &quot;root&quot;, &quot;password&quot;, &quot;mydb&quot;);</font></pre>
docs/tute.htm:  are more sophisticated. In ADODB, we use an object-oriented approach to managing 
docs/tute.htm:  handle different databases. If you aren't familiar with object-oriented programing, 
docs/tute.htm:  don't worry -- the complexity is all hidden away in the<code> NewADOConnection()</code> 
docs/tute.htm:  Finally we connect to the database using <code>$db-&gt;Connect(). </code></p>
docs/tute.htm:<p><code><font color="#663300">$result = $db-&gt;<b>Execute</b>(&quot;SELECT * 
docs/tute.htm:<pre><font color="#006666"><b>while</b> (!$result-&gt;EOF) &#123;
docs/tute.htm:   <b>for</b> ($i=0, $max=$result-&gt;<b>FieldCount</b>(); $i &lt; $max; $i++)
docs/tute.htm:	   <b>print</b> $result-&gt;fields[$i].' ';
docs/tute.htm:   $result-&gt;<b>MoveNext</b>();
docs/tute.htm:  line, we check first whether we have reached the end-of-file (EOF). While not 
docs/tute.htm:  end-of-file, loop through each field in the row. Then move to the next line 
docs/tute.htm:<p>The <code>$result-&gt;fields[]</code> array is generated by the PHP database 
docs/tute.htm:  To force indexing by name - that is associative arrays - 
docs/tute.htm:	$rs1 = $db->Execute('select * from table');
docs/tute.htm:	$rs2 = $db->Execute('select * from table');
docs/tute.htm:	print_r($rs1->fields); // shows <i>array([0]=>'v0',[1] =>'v1')</i>
docs/tute.htm:	print_r($rs2->fields); // shows <i>array(['col1']=>'v0',['col2'] =>'v1')</i>
docs/tute.htm:<p><code>$recordset-&gt;Move($pos)</code> scrolls to that particular row. ADODB supports forward 
docs/tute.htm:<p><code>$recordset-&gt;RecordCount()</code> returns the number of records accessed by the 
docs/tute.htm:  SQL statement. Some databases will return -1 because it is not supported. 
docs/tute.htm:<p><code>$recordset-&gt;GetArray()</code> returns the result as an array. 
docs/tute.htm:   $conn-&gt;PConnect('localhost','userid','password','database');
docs/tute.htm:   $rs = $conn-&gt;Execute('select * from table');
docs/tute.htm:  MySQL expects YYYY-MM-DD format, while other databases have different defaults. 
docs/tute.htm:   . $db-&gt;DBDate($<b>TheDate</b>) .','
docs/tute.htm:   . $db-&gt;qstr($<b>Note</b>).&quot;)&quot;;
docs/tute.htm:$db-&gt;Execute($sql);</pre>
docs/tute.htm:<p>ADODB also supports <code>$connection-&gt;Affected_Rows()</code> (returns the 
docs/tute.htm:  number of rows affected by last update or delete) and <code>$recordset-&gt;Insert_ID()</code> 
docs/tute.htm:<pre>$recordset = $conn-&gt;Execute(&quot;select adate from table&quot;);<br>$f0 = $recordset-&gt;FetchField(0);
docs/tute.htm:<p>Then <code>$f0-&gt;name</code> will hold <i>'adata'</i>, <code>$f0-&gt;type</code> 
docs/tute.htm:  -1. 
docs/tute.htm:<p><code>$recordset = $conn-&gt;Execute(&quot;select adate from table&quot;);<br>
docs/tute.htm:  $f0 = $recordset-&gt;FetchField(0);<br>
docs/tute.htm:  $type = $recordset-&gt;MetaType($f0-&gt;type, $f0-&gt;max_length);<br>
docs/tute.htm:<p>ADODB has a function called $connection->SelectLimit($sql,$nrows,$offset) that allows
docs/tute.htm:server after a certain timeout period with $connection->CacheExecute($secs2cache,$sql) and 
docs/tute.htm:$connection->CacheSelectLimit($secs2cache,$sql,$nrows,$offset).
docs/tute.htm:  <a href="http://php.weblogs.com/adodb-sessions"></a><a href="http://php.weblogs.com/adodb-sessions">http://php.weblogs.com/adodb-sessions</a>
docs/tute.htm:		Eether, eyether, neether, nyther - 
docs/tute.htm:		You like potato and I like po-tah-to, 
docs/tute.htm:		You like tomato and I like to-mah-to; 
docs/tute.htm:		Potato, po-tah-to, tomato, to-mah-to - 
docs/tute.htm:		So, if you like pajamas and I like pa-jah-mas, 
docs/tute.htm:		I'll wear pajamas and give up pa-jah-mas. 
docs/tute.htm:		Laughter, lawfter, after, awfter - 
docs/tute.htm:		Vanilla, vanella, choc'late, strawb'ry - 
docs/tute.htm:(c)2001-2002 John Lim.
drivers/adodb-odbtp.inc.php:  V4.54 5 Nov 2004  (c) 2000-2004 John Lim (jlim@natsoft.com.my). All rights reserved.
drivers/adodb-odbtp.inc.php:// security - hide paths
drivers/adodb-odbtp.inc.php:	var $fmtDate = "'Y-m-d'";
drivers/adodb-odbtp.inc.php:	var $fmtTimeStamp = "'Y-m-d, h:i:sA'";
drivers/adodb-odbtp.inc.php:		return array('description' => @odbtp_get_attr( ODB_ATTR_DBMSNAME, $this->_connectionID),
drivers/adodb-odbtp.inc.php:		             'version' => @odbtp_get_attr( ODB_ATTR_DBMSVER, $this->_connectionID));
drivers/adodb-odbtp.inc.php:		if (empty($this->_connectionID)) return @odbtp_last_error();
drivers/adodb-odbtp.inc.php:		return @odbtp_last_error($this->_connectionID);
drivers/adodb-odbtp.inc.php:		if (empty($this->_connectionID)) return @odbtp_last_error_state();
drivers/adodb-odbtp.inc.php:			return @odbtp_last_error_state($this->_connectionID);
drivers/adodb-odbtp.inc.php:	// the same scope. A scope is a module -- a stored procedure, trigger,
drivers/adodb-odbtp.inc.php:			return $this->GetOne($this->identitySQL);
drivers/adodb-odbtp.inc.php:		if ($this->_queryID) {
drivers/adodb-odbtp.inc.php:			return @odbtp_affected_rows ($this->_queryID);
drivers/adodb-odbtp.inc.php:		$num = $this->GetOne("select seq_value from adodb_seq");
drivers/adodb-odbtp.inc.php:		if( $this->odbc_driver == ODB_DRIVER_FOXPRO ) {
drivers/adodb-odbtp.inc.php:			$path = @odbtp_get_attr( ODB_ATTR_DATABASENAME, $this->_connectionID );
drivers/adodb-odbtp.inc.php:			if (empty($this->_genSeqSQL)) return false;
drivers/adodb-odbtp.inc.php:			$ok = $this->Execute(sprintf($this->_genSeqSQL ,$seqtab));
drivers/adodb-odbtp.inc.php:		$num = $this->GetOne("select seq_value from adodb_seq where seq_name='$seqname'");
drivers/adodb-odbtp.inc.php:		$start -= 1;
drivers/adodb-odbtp.inc.php:		return $this->Execute("insert into adodb_seq values('$seqname',$start)");
drivers/adodb-odbtp.inc.php:		if (empty($this->_dropSeqSQL)) return false;
drivers/adodb-odbtp.inc.php:		return $this->Execute(sprintf($this->_dropSeqSQL,$seqname));
drivers/adodb-odbtp.inc.php:		if( $this->odbc_driver == ODB_DRIVER_FOXPRO) {
drivers/adodb-odbtp.inc.php:			$path = @odbtp_get_attr( ODB_ATTR_DATABASENAME, $this->_connectionID );
drivers/adodb-odbtp.inc.php:		while (--$MAXLOOPS>=0) {
drivers/adodb-odbtp.inc.php:			$num = $this->GetOne("select seq_value from adodb_seq where seq_name='$seq'");
drivers/adodb-odbtp.inc.php:				$ok = $this->GetOne("select seq_value from adodb_seq ");
drivers/adodb-odbtp.inc.php:					$this->Execute(sprintf($this->_genSeqSQL ,$seqtab));
drivers/adodb-odbtp.inc.php:				$start -= 1;
drivers/adodb-odbtp.inc.php:				$ok = $this->Execute("insert into adodb_seq values('$seq',$start)");
drivers/adodb-odbtp.inc.php:			$ok = $this->Execute("update adodb_seq set seq_value=seq_value+1 where seq_name='$seq'");
drivers/adodb-odbtp.inc.php:				$this->genID = $num;
drivers/adodb-odbtp.inc.php:	if ($fn = $this->raiseErrorFn) {
drivers/adodb-odbtp.inc.php:		$fn($this->databaseType,'GENID',-32000,"Unable to generate unique id after $MAXLOOPS attempts",$seq,$num);
drivers/adodb-odbtp.inc.php:		$this->_connectionID = @odbtp_connect($HostOrInterface,$UserOrDSN,$argPassword,$argDatabase);
drivers/adodb-odbtp.inc.php:		if ($this->_connectionID === false) {
drivers/adodb-odbtp.inc.php:			$this->_errorMsg = $this->ErrorMsg() ;
drivers/adodb-odbtp.inc.php:		if ($this->_dontPoolDBC) {
drivers/adodb-odbtp.inc.php:				@odbtp_dont_pool_dbc($this->_connectionID);
drivers/adodb-odbtp.inc.php:			$this->_dontPoolDBC = true;
drivers/adodb-odbtp.inc.php:		$this->odbc_driver = @odbtp_get_attr(ODB_ATTR_DRIVER, $this->_connectionID);
drivers/adodb-odbtp.inc.php:		$dbms = strtolower(@odbtp_get_attr(ODB_ATTR_DBMSNAME, $this->_connectionID));
drivers/adodb-odbtp.inc.php:		$this->odbc_name = $dbms;
drivers/adodb-odbtp.inc.php:		if( $this->odbc_driver == ODB_DRIVER_ORACLE )
drivers/adodb-odbtp.inc.php:		else if( $this->odbc_driver == ODB_DRIVER_SYBASE )
drivers/adodb-odbtp.inc.php:				$this->databaseType = 'odbtp_mssql';
drivers/adodb-odbtp.inc.php:				$this->fmtDate = "'Y-m-d'";
drivers/adodb-odbtp.inc.php:				$this->fmtTimeStamp = "'Y-m-d h:i:sA'";
drivers/adodb-odbtp.inc.php:				$this->sysDate = 'convert(datetime,convert(char,GetDate(),102),102)';
drivers/adodb-odbtp.inc.php:				$this->sysTimeStamp = 'GetDate()';
drivers/adodb-odbtp.inc.php:				$this->ansiOuter = true;
drivers/adodb-odbtp.inc.php:				$this->leftOuter = '*=';
drivers/adodb-odbtp.inc.php:				$this->rightOuter = '=*';
drivers/adodb-odbtp.inc.php:                $this->hasTop = 'top';
drivers/adodb-odbtp.inc.php:				$this->hasInsertID = true;
drivers/adodb-odbtp.inc.php:				$this->hasTransactions = true;
drivers/adodb-odbtp.inc.php:				$this->_bindInputArray = true;
drivers/adodb-odbtp.inc.php:				$this->_canSelectDb = true;
drivers/adodb-odbtp.inc.php:				$this->substr = "substring";
drivers/adodb-odbtp.inc.php:				$this->length = 'len';
drivers/adodb-odbtp.inc.php:				$this->identitySQL = 'select @@IDENTITY';
drivers/adodb-odbtp.inc.php:				$this->metaDatabasesSQL = "select name from master..sysdatabases where name <> 'master'";
drivers/adodb-odbtp.inc.php:				$this->_canPrepareSP = true;
drivers/adodb-odbtp.inc.php:				$this->databaseType = 'odbtp_access';
drivers/adodb-odbtp.inc.php:				$this->fmtDate = "#Y-m-d#";
drivers/adodb-odbtp.inc.php:				$this->fmtTimeStamp = "#Y-m-d h:i:sA#";
drivers/adodb-odbtp.inc.php:				$this->sysDate = "FORMAT(NOW,'yyyy-mm-dd')";
drivers/adodb-odbtp.inc.php:				$this->sysTimeStamp = 'NOW';
drivers/adodb-odbtp.inc.php:                $this->hasTop = 'top';
drivers/adodb-odbtp.inc.php:				$this->hasTransactions = false;
drivers/adodb-odbtp.inc.php:				$this->_canPrepareSP = true;  // For MS Access only.
drivers/adodb-odbtp.inc.php:				$this->databaseType = 'odbtp_vfp';
drivers/adodb-odbtp.inc.php:				$this->fmtDate = "{^Y-m-d}";
drivers/adodb-odbtp.inc.php:				$this->fmtTimeStamp = "{^Y-m-d, h:i:sA}";
drivers/adodb-odbtp.inc.php:				$this->sysDate = 'date()';
drivers/adodb-odbtp.inc.php:				$this->sysTimeStamp = 'datetime()';
drivers/adodb-odbtp.inc.php:				$this->ansiOuter = true;
drivers/adodb-odbtp.inc.php:                $this->hasTop = 'top';
drivers/adodb-odbtp.inc.php:				$this->hasTransactions = false;
drivers/adodb-odbtp.inc.php:				$this->replaceQuote = "'+chr(39)+'";
drivers/adodb-odbtp.inc.php:				$this->true = '.T.';
drivers/adodb-odbtp.inc.php:				$this->false = '.F.';
drivers/adodb-odbtp.inc.php:				$this->databaseType = 'odbtp_oci8';
drivers/adodb-odbtp.inc.php:				$this->fmtDate = "'Y-m-d 00:00:00'";
drivers/adodb-odbtp.inc.php:				$this->fmtTimeStamp = "'Y-m-d h:i:sA'";
drivers/adodb-odbtp.inc.php:				$this->sysDate = 'TRUNC(SYSDATE)';
drivers/adodb-odbtp.inc.php:				$this->sysTimeStamp = 'SYSDATE';
drivers/adodb-odbtp.inc.php:				$this->hasTransactions = true;
drivers/adodb-odbtp.inc.php:				$this->_bindInputArray = true;
drivers/adodb-odbtp.inc.php:				$this->concat_operator = '||';
drivers/adodb-odbtp.inc.php:				$this->databaseType = 'odbtp_sybase';
drivers/adodb-odbtp.inc.php:				$this->fmtDate = "'Y-m-d'";
drivers/adodb-odbtp.inc.php:				$this->fmtTimeStamp = "'Y-m-d H:i:s'";
drivers/adodb-odbtp.inc.php:				$this->sysDate = 'GetDate()';
drivers/adodb-odbtp.inc.php:				$this->sysTimeStamp = 'GetDate()';
drivers/adodb-odbtp.inc.php:				$this->leftOuter = '*=';
drivers/adodb-odbtp.inc.php:				$this->rightOuter = '=*';
drivers/adodb-odbtp.inc.php:				$this->hasInsertID = true;
drivers/adodb-odbtp.inc.php:				$this->hasTransactions = true;
drivers/adodb-odbtp.inc.php:				$this->identitySQL = 'select @@IDENTITY';
drivers/adodb-odbtp.inc.php:				$this->databaseType = 'odbtp';
drivers/adodb-odbtp.inc.php:				if( @odbtp_get_attr(ODB_ATTR_TXNCAPABLE, $this->_connectionID) )
drivers/adodb-odbtp.inc.php:					$this->hasTransactions = true;
drivers/adodb-odbtp.inc.php:					$this->hasTransactions = false;
drivers/adodb-odbtp.inc.php:        @odbtp_set_attr(ODB_ATTR_FULLCOLINFO, TRUE, $this->_connectionID );
drivers/adodb-odbtp.inc.php:		if ($this->_useUnicodeSQL )
drivers/adodb-odbtp.inc.php:			@odbtp_set_attr(ODB_ATTR_UNICODESQL, TRUE, $this->_connectionID);
drivers/adodb-odbtp.inc.php:		$this->_dontPoolDBC = false;
drivers/adodb-odbtp.inc.php:  		return $this->_connect($HostOrInterface, $UserOrDSN, $argPassword, $argDatabase);
drivers/adodb-odbtp.inc.php:		if (!@odbtp_select_db($dbName, $this->_connectionID)) {
drivers/adodb-odbtp.inc.php:		$this->databaseName = $dbName;
drivers/adodb-odbtp.inc.php:		if ($this->fetchMode !== false) $savefm = $this->SetFetchMode(false);
drivers/adodb-odbtp.inc.php:		$arr =& $this->GetArray("||SQLTables||||$ttype");
drivers/adodb-odbtp.inc.php:		if (isset($savefm)) $this->SetFetchMode($savefm);
drivers/adodb-odbtp.inc.php:		$this->_findschema($table,$schema);
drivers/adodb-odbtp.inc.php:		if ($this->fetchMode !== false) $savefm = $this->SetFetchMode(false);
drivers/adodb-odbtp.inc.php:		$rs = $this->Execute( "||SQLColumns||$schema|$table" );
drivers/adodb-odbtp.inc.php:		if (isset($savefm)) $this->SetFetchMode($savefm);
drivers/adodb-odbtp.inc.php:		if (!$rs || $rs->EOF) {
drivers/adodb-odbtp.inc.php:		while (!$rs->EOF) {
drivers/adodb-odbtp.inc.php:			//print_r($rs->fields);
drivers/adodb-odbtp.inc.php:			if (strtoupper($rs->fields[2]) == $table) {
drivers/adodb-odbtp.inc.php:				$fld->name = $rs->fields[3];
drivers/adodb-odbtp.inc.php:				$fld->type = $rs->fields[5];
drivers/adodb-odbtp.inc.php:				$fld->max_length = $rs->fields[6];
drivers/adodb-odbtp.inc.php:    			$fld->not_null = !empty($rs->fields[9]);
drivers/adodb-odbtp.inc.php: 				$fld->scale = $rs->fields[7];
drivers/adodb-odbtp.inc.php: 				if (!is_null($rs->fields[12])) {
drivers/adodb-odbtp.inc.php: 					$fld->has_default = true;
drivers/adodb-odbtp.inc.php: 					$fld->default_value = $rs->fields[12];
drivers/adodb-odbtp.inc.php:				$retarr[strtoupper($fld->name)] = $fld;
drivers/adodb-odbtp.inc.php:			$rs->MoveNext();
drivers/adodb-odbtp.inc.php:		$rs->Close();
drivers/adodb-odbtp.inc.php:		$arr =& $this->GetArray("||SQLPrimaryKeys||$owner|$table");
drivers/adodb-odbtp.inc.php:		$constraints =& $this->GetArray("||SQLForeignKeys|||||$owner|$table");
drivers/adodb-odbtp.inc.php:		if (!$this->hasTransactions) return false;
drivers/adodb-odbtp.inc.php:		if ($this->transOff) return true;
drivers/adodb-odbtp.inc.php:		$this->transCnt += 1;
drivers/adodb-odbtp.inc.php:		$this->autoCommit = false;
drivers/adodb-odbtp.inc.php:		$rs = @odbtp_set_attr(ODB_ATTR_TRANSACTIONS,$txn,$this->_connectionID);
drivers/adodb-odbtp.inc.php:		if ($this->transOff) return true;
drivers/adodb-odbtp.inc.php:		if (!$ok) return $this->RollbackTrans();
drivers/adodb-odbtp.inc.php:		if ($this->transCnt) $this->transCnt -= 1;
drivers/adodb-odbtp.inc.php:		$this->autoCommit = true;
drivers/adodb-odbtp.inc.php:		if( ($ret = @odbtp_commit($this->_connectionID)) )
drivers/adodb-odbtp.inc.php:			$ret = @odbtp_set_attr(ODB_ATTR_TRANSACTIONS, ODB_TXN_NONE, $this->_connectionID);//set transaction off
drivers/adodb-odbtp.inc.php:		if ($this->transOff) return true;
drivers/adodb-odbtp.inc.php:		if ($this->transCnt) $this->transCnt -= 1;
drivers/adodb-odbtp.inc.php:		$this->autoCommit = true;
drivers/adodb-odbtp.inc.php:		if( ($ret = @odbtp_rollback($this->_connectionID)) )
drivers/adodb-odbtp.inc.php:			$ret = @odbtp_set_attr(ODB_ATTR_TRANSACTIONS, ODB_TXN_NONE, $this->_connectionID);//set transaction off
drivers/adodb-odbtp.inc.php:	function &SelectLimit($sql,$nrows=-1,$offset=-1, $inputarr=false,$secs2cache=0)
drivers/adodb-odbtp.inc.php:		if( $this->odbc_driver == ODB_DRIVER_FOXPRO ) {
drivers/adodb-odbtp.inc.php:		if (! $this->_bindInputArray) return $sql; // no binding
drivers/adodb-odbtp.inc.php:		$stmt = @odbtp_prepare($sql,$this->_connectionID);
drivers/adodb-odbtp.inc.php:		//	print "Prepare Error for ($sql) ".$this->ErrorMsg()."<br>";
drivers/adodb-odbtp.inc.php:		if (!$this->_canPrepareSP) return $sql; // Can't prepare procedures
drivers/adodb-odbtp.inc.php:		$stmt = @odbtp_prepare_proc($sql,$this->_connectionID);
drivers/adodb-odbtp.inc.php:		$stmt = $db->PrepareSP('SP_RUNSOMETHING'); -- takes 2 params, @myid and @group
drivers/adodb-odbtp.inc.php:		$db->Parameter($stmt,$id,'myid');
drivers/adodb-odbtp.inc.php:		$db->Parameter($stmt,$group,'group',false,64);
drivers/adodb-odbtp.inc.php:		$db->Parameter($stmt,$group,'photo',false,100000,ODB_BINARY);
drivers/adodb-odbtp.inc.php:		$db->Execute($stmt);
drivers/adodb-odbtp.inc.php:		if ( $this->odbc_driver == ODB_DRIVER_JET ) {
drivers/adodb-odbtp.inc.php:			if( !$type && $this->_useUnicodeSQL
drivers/adodb-odbtp.inc.php:		$conn->Execute('INSERT INTO blobtable (id, blobcol) VALUES (1, null)');
drivers/adodb-odbtp.inc.php:		$conn->UpdateBlob('blobtable','blobcol',$blob,'id=1');
drivers/adodb-odbtp.inc.php:		if( !($stmt = @odbtp_prepare($sql, $this->_connectionID)) )
drivers/adodb-odbtp.inc.php:		switch( $this->odbc_driver ) {
drivers/adodb-odbtp.inc.php:				$stmtid = @odbtp_prepare($sql,$this->_connectionID);
drivers/adodb-odbtp.inc.php:					$this->_errorMsg = $php_errormsg;
drivers/adodb-odbtp.inc.php:				@odbtp_set( $stmtid, $param, $inputarr[$param-1] );
drivers/adodb-odbtp.inc.php:			$stmtid = @odbtp_query($sql,$this->_connectionID);
drivers/adodb-odbtp.inc.php:		$this->_lastAffectedRows = 0;
drivers/adodb-odbtp.inc.php:				$this->_lastAffectedRows = @odbtp_affected_rows($stmtid);
drivers/adodb-odbtp.inc.php:		$ret = @odbtp_close($this->_connectionID);
drivers/adodb-odbtp.inc.php:		$this->_connectionID = false;
drivers/adodb-odbtp.inc.php:		$this->fetchMode = $mode;
drivers/adodb-odbtp.inc.php:		$this->ADORecordSet($queryID);
drivers/adodb-odbtp.inc.php:		$this->_numOfFields = @odbtp_num_fields($this->_queryID);
drivers/adodb-odbtp.inc.php:		if (!($this->_numOfRows = @odbtp_num_rows($this->_queryID)))
drivers/adodb-odbtp.inc.php:			$this->_numOfRows = -1;
drivers/adodb-odbtp.inc.php:		if (!$this->connection->_useUnicodeSQL) return;
drivers/adodb-odbtp.inc.php:		if ($this->connection->odbc_driver == ODB_DRIVER_JET) {
drivers/adodb-odbtp.inc.php:			                     $this->connection->_connectionID))
drivers/adodb-odbtp.inc.php:				for ($f = 0; $f < $this->_numOfFields; $f++) {
drivers/adodb-odbtp.inc.php:					if (@odbtp_field_bindtype($this->_queryID, $f) == ODB_CHAR)
drivers/adodb-odbtp.inc.php:						@odbtp_bind_field($this->_queryID, $f, ODB_WCHAR);
drivers/adodb-odbtp.inc.php:		$o->name = @odbtp_field_name($this->_queryID,$off);
drivers/adodb-odbtp.inc.php:		$o->type = @odbtp_field_type($this->_queryID,$off);
drivers/adodb-odbtp.inc.php:        $o->max_length = @odbtp_field_length($this->_queryID,$off);
drivers/adodb-odbtp.inc.php:		if (ADODB_ASSOC_CASE == 0) $o->name = strtolower($o->name);
drivers/adodb-odbtp.inc.php:		else if (ADODB_ASSOC_CASE == 1) $o->name = strtoupper($o->name);
drivers/adodb-odbtp.inc.php:		return @odbtp_data_seek($this->_queryID, $row);
drivers/adodb-odbtp.inc.php:		if ($this->fetchMode & ADODB_FETCH_ASSOC) return $this->fields[$colname];
drivers/adodb-odbtp.inc.php:		if (!$this->bind) {
drivers/adodb-odbtp.inc.php:			$this->bind = array();
drivers/adodb-odbtp.inc.php:			for ($i=0; $i < $this->_numOfFields; $i++) {
drivers/adodb-odbtp.inc.php:				$name = @odbtp_field_name( $this->_queryID, $i );
drivers/adodb-odbtp.inc.php:				$this->bind[strtoupper($name)] = $i;
drivers/adodb-odbtp.inc.php:		return $this->fields[$this->bind[strtoupper($colname)]];
drivers/adodb-odbtp.inc.php:		switch ($this->fetchMode) {
drivers/adodb-odbtp.inc.php:				$this->fields = @odbtp_fetch_row($this->_queryID, $type);
drivers/adodb-odbtp.inc.php:				$this->fields = @odbtp_fetch_assoc($this->_queryID, $type);
drivers/adodb-odbtp.inc.php:				$this->fields = @odbtp_fetch_array($this->_queryID, $type);
drivers/adodb-odbtp.inc.php:		return is_array($this->fields);
drivers/adodb-odbtp.inc.php:		return $this->_fetch_odbtp();
drivers/adodb-odbtp.inc.php:		if (!$this->_fetch_odbtp(ODB_FETCH_FIRST)) return false;
drivers/adodb-odbtp.inc.php:		$this->EOF = false;
drivers/adodb-odbtp.inc.php:		$this->_currentRow = 0;
drivers/adodb-odbtp.inc.php:		if (!$this->_fetch_odbtp(ODB_FETCH_LAST)) return false;
drivers/adodb-odbtp.inc.php:		$this->EOF = false;
drivers/adodb-odbtp.inc.php:		$this->_currentRow = $this->_numOfRows - 1;
drivers/adodb-odbtp.inc.php:		if (!@odbtp_next_result($this->_queryID)) return false;
drivers/adodb-odbtp.inc.php:		$this->_inited = false;
drivers/adodb-odbtp.inc.php:		$this->bind = false;
drivers/adodb-odbtp.inc.php:		$this->_currentRow = -1;
drivers/adodb-odbtp.inc.php:		$this->Init();
drivers/adodb-odbtp.inc.php:		return @odbtp_free_query($this->_queryID);
drivers/adodb-odbtp.inc.php:		return $this->ADORecordSet_odbtp($id,$mode);
drivers/adodb-odbtp.inc.php:		return $this->ADORecordSet_odbtp($id,$mode);
drivers/adodb-odbtp.inc.php:		return $this->ADORecordSet_odbtp($id,$mode);
drivers/adodb-odbtp.inc.php:		return $this->ADORecordSet_odbtp($id,$mode);
drivers/adodb-odbtp.inc.php:		return $this->ADORecordSet_odbtp($id,$mode);
drivers/adodb-ado5.inc.php:V4.54 5 Nov 2004  (c) 2000-2004 John Lim (jlim@natsoft.com.my). All rights reserved.
drivers/adodb-ado5.inc.php:// security - hide paths
drivers/adodb-ado5.inc.php:/*--------------------------------------------------------------------------------------
drivers/adodb-ado5.inc.php:--------------------------------------------------------------------------------------*/
drivers/adodb-ado5.inc.php:	var $fmtDate = "'Y-m-d'";
drivers/adodb-ado5.inc.php:	var $fmtTimeStamp = "'Y-m-d, h:i:sA'";
drivers/adodb-ado5.inc.php:	var $_lock_type = -1;
drivers/adodb-ado5.inc.php:	var $_execute_option = -1;
drivers/adodb-ado5.inc.php:		$this->_affectedRows = new VARIANT;
drivers/adodb-ado5.inc.php:		if (!empty($this->_connectionID)) $desc = $this->_connectionID->provider;
drivers/adodb-ado5.inc.php:		if (PHP_VERSION >= 5) return $this->_affectedRows;
drivers/adodb-ado5.inc.php:		return $this->_affectedRows->value;
drivers/adodb-ado5.inc.php:	// $DB->Connect('USER ID=sa;PASSWORD=pwd;SERVER=mangrove;DATABASE=ai',false,false,'SQLOLEDB');
drivers/adodb-ado5.inc.php:		if (!empty($this->charPage))
drivers/adodb-ado5.inc.php:			$dbc = new COM('ADODB.Connection',null,$this->charPage);
drivers/adodb-ado5.inc.php:		if ($argProvider) $dbc->Provider = $argProvider;	
drivers/adodb-ado5.inc.php:		if ($this->debug) ADOConnection::outp( "Host=".$argHostname."<BR>\n version=$dbc->version");
drivers/adodb-ado5.inc.php:		@$dbc->Open((string) $argHostname);
drivers/adodb-ado5.inc.php:		$this->_connectionID = $dbc;
drivers/adodb-ado5.inc.php:		$dbc->CursorLocation = $this->_cursor_location;
drivers/adodb-ado5.inc.php:		return  $dbc->State > 0;
drivers/adodb-ado5.inc.php:		return $this->_connect($argHostname,$argUsername,$argPassword,$argProvider);
drivers/adodb-ado5.inc.php:		$dbc = $this->_connectionID;
drivers/adodb-ado5.inc.php:		$adors=@$dbc->OpenSchema(20);//tables
drivers/adodb-ado5.inc.php:			$f = $adors->Fields(2);//table/view name
drivers/adodb-ado5.inc.php:			$t = $adors->Fields(3);//table type
drivers/adodb-ado5.inc.php:			while (!$adors->EOF){
drivers/adodb-ado5.inc.php:				$tt=substr($t->value,0,6);
drivers/adodb-ado5.inc.php:					$arr[]=$f->value;
drivers/adodb-ado5.inc.php:				//print $f->value . ' ' . $t->value.'<br>';
drivers/adodb-ado5.inc.php:				$adors->MoveNext();
drivers/adodb-ado5.inc.php:			$adors->Close();
drivers/adodb-ado5.inc.php:		$dbc = $this->_connectionID;
drivers/adodb-ado5.inc.php:		$adors=@$dbc->OpenSchema(4);//tables
drivers/adodb-ado5.inc.php:			$t = $adors->Fields(2);//table/view name
drivers/adodb-ado5.inc.php:			while (!$adors->EOF){
drivers/adodb-ado5.inc.php:				if (strtoupper($t->Value) == $table) {
drivers/adodb-ado5.inc.php:					$c = $adors->Fields(3);
drivers/adodb-ado5.inc.php:					$fld->name = $c->Value;
drivers/adodb-ado5.inc.php:					$fld->type = 'CHAR'; // cannot discover type in ADO!
drivers/adodb-ado5.inc.php:					$fld->max_length = -1;
drivers/adodb-ado5.inc.php:					$arr[strtoupper($fld->name)]=$fld;
drivers/adodb-ado5.inc.php:				$adors->MoveNext();
drivers/adodb-ado5.inc.php:			$adors->Close();
drivers/adodb-ado5.inc.php:		$dbc = $this->_connectionID;
drivers/adodb-ado5.inc.php:			if (!empty($this->charPage))
drivers/adodb-ado5.inc.php:				$oCmd = new COM('ADODB.Command',null,$this->charPage);
drivers/adodb-ado5.inc.php:			$oCmd->ActiveConnection = $dbc;
drivers/adodb-ado5.inc.php:			$oCmd->CommandText = $sql;
drivers/adodb-ado5.inc.php:			$oCmd->CommandType = 1;
drivers/adodb-ado5.inc.php:				$this->adoParameterType = 130;
drivers/adodb-ado5.inc.php:				$p = $oCmd->CreateParameter('name',$this->adoParameterType,1,strlen($val),$val);
drivers/adodb-ado5.inc.php:				//print $p->Type.' '.$p->value;
drivers/adodb-ado5.inc.php:				$oCmd->Parameters->Append($p);
drivers/adodb-ado5.inc.php:			$rs = $oCmd->Execute();
drivers/adodb-ado5.inc.php:			$e = $dbc->Errors;
drivers/adodb-ado5.inc.php:			if ($dbc->Errors->Count > 0) return false;
drivers/adodb-ado5.inc.php:		$rs = @$dbc->Execute($sql,$this->_affectedRows, $this->_execute_option);
drivers/adodb-ado5.inc.php:		if ($dbc->Errors->Count > 0) return false;
drivers/adodb-ado5.inc.php:		if ($rs->State == 0) return true; // 0 = adStateClosed means no records returned
drivers/adodb-ado5.inc.php:		if ($this->transOff) return true;
drivers/adodb-ado5.inc.php:		if (isset($this->_thisTransactions))
drivers/adodb-ado5.inc.php:			if (!$this->_thisTransactions) return false;
drivers/adodb-ado5.inc.php:			$o = $this->_connectionID->Properties("Transaction DDL");
drivers/adodb-ado5.inc.php:			$this->_thisTransactions = $o ? true : false;
drivers/adodb-ado5.inc.php:		@$this->_connectionID->BeginTrans();
drivers/adodb-ado5.inc.php:		$this->transCnt += 1;
drivers/adodb-ado5.inc.php:		if (!$ok) return $this->RollbackTrans();
drivers/adodb-ado5.inc.php:		if ($this->transOff) return true;
drivers/adodb-ado5.inc.php:		@$this->_connectionID->CommitTrans();
drivers/adodb-ado5.inc.php:		if ($this->transCnt) @$this->transCnt -= 1;
drivers/adodb-ado5.inc.php:		if ($this->transOff) return true;
drivers/adodb-ado5.inc.php:		@$this->_connectionID->RollbackTrans();
drivers/adodb-ado5.inc.php:		if ($this->transCnt) @$this->transCnt -= 1;
drivers/adodb-ado5.inc.php:		$errc = $this->_connectionID->Errors;
drivers/adodb-ado5.inc.php:		if ($errc->Count == 0) return '';
drivers/adodb-ado5.inc.php:		$err = $errc->Item($errc->Count-1);
drivers/adodb-ado5.inc.php:		return $err->Description;
drivers/adodb-ado5.inc.php:		$errc = $this->_connectionID->Errors;
drivers/adodb-ado5.inc.php:		if ($errc->Count == 0) return 0;
drivers/adodb-ado5.inc.php:		$err = $errc->Item($errc->Count-1);
drivers/adodb-ado5.inc.php:		return $err->NativeError;
drivers/adodb-ado5.inc.php:		if ($this->_connectionID) $this->_connectionID->Close();
drivers/adodb-ado5.inc.php:		$this->_connectionID = false;
drivers/adodb-ado5.inc.php:/*--------------------------------------------------------------------------------------
drivers/adodb-ado5.inc.php:--------------------------------------------------------------------------------------*/
drivers/adodb-ado5.inc.php:		$this->fetchMode = $mode;
drivers/adodb-ado5.inc.php:		return $this->ADORecordSet($id,$mode);
drivers/adodb-ado5.inc.php:	function FetchField($fieldOffset = -1) {
drivers/adodb-ado5.inc.php:		$rs = $this->_queryID;
drivers/adodb-ado5.inc.php:		$f = $rs->Fields($fieldOffset);
drivers/adodb-ado5.inc.php:		$o->name = $f->Name;
drivers/adodb-ado5.inc.php:		$t = $f->Type;
drivers/adodb-ado5.inc.php:		$o->type = $this->MetaType($t);
drivers/adodb-ado5.inc.php:		$o->max_length = $f->DefinedSize;
drivers/adodb-ado5.inc.php:		$o->ado_type = $t;
drivers/adodb-ado5.inc.php:		//print "off=$off name=$o->name type=$o->type len=$o->max_length<br>";
drivers/adodb-ado5.inc.php:		if ($this->fetchMode & ADODB_FETCH_ASSOC) return $this->fields[$colname];
drivers/adodb-ado5.inc.php:		if (!$this->bind) {
drivers/adodb-ado5.inc.php:			$this->bind = array();
drivers/adodb-ado5.inc.php:			for ($i=0; $i < $this->_numOfFields; $i++) {
drivers/adodb-ado5.inc.php:				$o = $this->FetchField($i);
drivers/adodb-ado5.inc.php:				$this->bind[strtoupper($o->name)] = $i;
drivers/adodb-ado5.inc.php:		 return $this->fields[$this->bind[strtoupper($colname)]];
drivers/adodb-ado5.inc.php:		$rs = $this->_queryID;
drivers/adodb-ado5.inc.php:		$this->_numOfRows = $rs->RecordCount;
drivers/adodb-ado5.inc.php:		$f = $rs->Fields;
drivers/adodb-ado5.inc.php:		$this->_numOfFields = $f->Count;
drivers/adodb-ado5.inc.php:	 // should only be used to move forward as we normally use forward-only cursors
drivers/adodb-ado5.inc.php:	   $rs = $this->_queryID; 
drivers/adodb-ado5.inc.php:		// absoluteposition doesn't work -- my maths is wrong ?
drivers/adodb-ado5.inc.php:		//	$rs->AbsolutePosition->$row-2;
drivers/adodb-ado5.inc.php:		if ($this->_currentRow > $row) return false;
drivers/adodb-ado5.inc.php:		@$rs->Move((integer)$row - $this->_currentRow-1); //adBookmarkFirst
drivers/adodb-ado5.inc.php:	function MetaType($t,$len=-1,$fieldobj=false)
drivers/adodb-ado5.inc.php:			$t = $fieldobj->type;
drivers/adodb-ado5.inc.php:			$len = $fieldobj->max_length;
drivers/adodb-ado5.inc.php:			if ($len <= $this->blobSize) return 'C';
drivers/adodb-ado5.inc.php:		$rs = $this->_queryID;
drivers/adodb-ado5.inc.php:		if (!$rs or $rs->EOF) {
drivers/adodb-ado5.inc.php:			$this->fields = false;
drivers/adodb-ado5.inc.php:		$this->fields = array();
drivers/adodb-ado5.inc.php:		if (!$this->_tarr) {
drivers/adodb-ado5.inc.php:			for ($i=0,$max = $this->_numOfFields; $i < $max; $i++) {
drivers/adodb-ado5.inc.php:				$f = $rs->Fields($i);
drivers/adodb-ado5.inc.php:				$tarr[] = $f->Type;
drivers/adodb-ado5.inc.php:			$this->_tarr = $tarr; 
drivers/adodb-ado5.inc.php:			$this->_flds = $flds;
drivers/adodb-ado5.inc.php:		$t = reset($this->_tarr);
drivers/adodb-ado5.inc.php:		$f = reset($this->_flds);
drivers/adodb-ado5.inc.php:		if ($this->hideErrors)  $olde = error_reporting(E_ERROR|E_CORE_ERROR);// sometimes $f->value be null
drivers/adodb-ado5.inc.php:		for ($i=0,$max = $this->_numOfFields; $i < $max; $i++) {
drivers/adodb-ado5.inc.php:			//echo "<p>",$t,' ';var_dump($f->value); echo '</p>';
drivers/adodb-ado5.inc.php:				if (!strlen((string)$f->value)) $this->fields[] = false;
drivers/adodb-ado5.inc.php:					if (!is_numeric($f->value)) $val = variant_date_to_timestamp($f->value);
drivers/adodb-ado5.inc.php:					else $val = $f->value;
drivers/adodb-ado5.inc.php:					$this->fields[] = adodb_date('Y-m-d H:i:s',$val);
drivers/adodb-ado5.inc.php:				if ($val = $f->value) {
drivers/adodb-ado5.inc.php:					$this->fields[] = substr($val,0,4).'-'.substr($val,4,2).'-'.substr($val,6,2);
drivers/adodb-ado5.inc.php:					$this->fields[] = false;
drivers/adodb-ado5.inc.php:				if (!strlen((string)$f->value)) $this->fields[] = false;
drivers/adodb-ado5.inc.php:					if (!is_numeric($f->value)) $val = variant_date_to_timestamp($f->value);
drivers/adodb-ado5.inc.php:					else $val = $f->value;
drivers/adodb-ado5.inc.php:					if (($val % 86400) == 0) $this->fields[] = adodb_date('Y-m-d',$val);
drivers/adodb-ado5.inc.php:					else $this->fields[] = adodb_date('Y-m-d H:i:s',$val);
drivers/adodb-ado5.inc.php:				$this->fields[] = false;
drivers/adodb-ado5.inc.php:				ADOConnection::outp( '<b>'.$f->Name.': currency type not supported by PHP</b>');
drivers/adodb-ado5.inc.php:				$this->fields[] = (float) $f->value;
drivers/adodb-ado5.inc.php:				$this->fields[] = $f->value; 
drivers/adodb-ado5.inc.php:			//print " $f->value $t, ";
drivers/adodb-ado5.inc.php:			$f = next($this->_flds);
drivers/adodb-ado5.inc.php:			$t = next($this->_tarr);
drivers/adodb-ado5.inc.php:		if ($this->hideErrors) error_reporting($olde);
drivers/adodb-ado5.inc.php:		@$rs->MoveNext(); // @ needed for some versions of PHP!
drivers/adodb-ado5.inc.php:		if ($this->fetchMode & ADODB_FETCH_ASSOC) {
drivers/adodb-ado5.inc.php:			$this->fields = &$this->GetRowAssoc(ADODB_ASSOC_CASE);
drivers/adodb-ado5.inc.php:			$rs = $this->_queryID;
drivers/adodb-ado5.inc.php:			$this->_queryID = $rs->NextRecordSet();
drivers/adodb-ado5.inc.php:			//$this->_queryID = $this->_QueryId->NextRecordSet();
drivers/adodb-ado5.inc.php:			if ($this->_queryID == null) return false;
drivers/adodb-ado5.inc.php:			$this->_currentRow = -1;
drivers/adodb-ado5.inc.php:			$this->_currentPage = -1;
drivers/adodb-ado5.inc.php:			$this->bind = false;
drivers/adodb-ado5.inc.php:			$this->fields = false;
drivers/adodb-ado5.inc.php:			$this->_flds = false;
drivers/adodb-ado5.inc.php:			$this->_tarr = false;
drivers/adodb-ado5.inc.php:			$this->_inited = false;
drivers/adodb-ado5.inc.php:			$this->Init();
drivers/adodb-ado5.inc.php:		$this->_flds = false;
drivers/adodb-ado5.inc.php:		@$this->_queryID->Close();// by Pete Dishman (peterd@telephonetics.co.uk)
drivers/adodb-ado5.inc.php:		$this->_queryID = false;	
drivers/adodb-oci805.inc.php: * @version V4.54 5 Nov 2004 (c) 2000-2004 John Lim (jlim@natsoft.com.my). All rights reserved.
drivers/adodb-oci805.inc.php:// security - hide paths
drivers/adodb-oci805.inc.php:include_once(ADODB_DIR.'/drivers/adodb-oci8.inc.php');
drivers/adodb-oci805.inc.php:		$this->ADODB_oci8();
drivers/adodb-oci805.inc.php:	function &SelectLimit($sql,$nrows=-1,$offset=-1, $inputarr=false,$secs2cache=0)
drivers/adodb-oci805.inc.php:			$nrows = -1;
drivers/adodb-oci805.inc.php:		$this->ADORecordset_oci8($id,$mode);
drivers/adodb-fbsql.inc.php: @version V4.54 5 Nov 2004 (c) 2000-2004 John Lim (jlim@natsoft.com.my). All rights reserved.
drivers/adodb-fbsql.inc.php:// security - hide paths
drivers/adodb-fbsql.inc.php:	var $fmtTimeStamp = "'Y-m-d H:i:s'";
drivers/adodb-fbsql.inc.php:			return fbsql_insert_id($this->_connectionID);
drivers/adodb-fbsql.inc.php:			return fbsql_affected_rows($this->_connectionID);
drivers/adodb-fbsql.inc.php:		$qid = fbsql_list_dbs($this->_connectionID);
drivers/adodb-fbsql.inc.php:		$this->_connectionID = fbsql_connect($argHostname,$argUsername,$argPassword);
drivers/adodb-fbsql.inc.php:		if ($this->_connectionID === false) return false;
drivers/adodb-fbsql.inc.php:		if ($argDatabasename) return $this->SelectDB($argDatabasename);
drivers/adodb-fbsql.inc.php:		$this->_connectionID = fbsql_pconnect($argHostname,$argUsername,$argPassword);
drivers/adodb-fbsql.inc.php:		if ($this->_connectionID === false) return false;
drivers/adodb-fbsql.inc.php:		if ($argDatabasename) return $this->SelectDB($argDatabasename);
drivers/adodb-fbsql.inc.php:		if ($this->metaColumnsSQL) {
drivers/adodb-fbsql.inc.php:			$rs = $this->Execute(sprintf($this->metaColumnsSQL,$table));
drivers/adodb-fbsql.inc.php:			while (!$rs->EOF){
drivers/adodb-fbsql.inc.php:				$fld->name = $rs->fields[0];
drivers/adodb-fbsql.inc.php:				$fld->type = $rs->fields[1];
drivers/adodb-fbsql.inc.php:				if (preg_match("/^(.+)\((\d+)\)$/", $fld->type, $query_array)) {
drivers/adodb-fbsql.inc.php:					$fld->type = $query_array[1];
drivers/adodb-fbsql.inc.php:					$fld->max_length = $query_array[2];
drivers/adodb-fbsql.inc.php:					$fld->max_length = -1;
drivers/adodb-fbsql.inc.php:				$fld->not_null = ($rs->fields[2] != 'YES');
drivers/adodb-fbsql.inc.php:				$fld->primary_key = ($rs->fields[3] == 'PRI');
drivers/adodb-fbsql.inc.php:				$fld->auto_increment = (strpos($rs->fields[5], 'auto_increment') !== false);
drivers/adodb-fbsql.inc.php:				$fld->binary = (strpos($fld->type,'blob') !== false);
drivers/adodb-fbsql.inc.php:				$retarr[strtoupper($fld->name)] = $fld;	
drivers/adodb-fbsql.inc.php:				$rs->MoveNext();
drivers/adodb-fbsql.inc.php:			$rs->Close();
drivers/adodb-fbsql.inc.php:		$this->databaseName = $dbName;
drivers/adodb-fbsql.inc.php:		if ($this->_connectionID) {
drivers/adodb-fbsql.inc.php:			return @fbsql_select_db($dbName,$this->_connectionID);		
drivers/adodb-fbsql.inc.php:		return fbsql_query("$sql;",$this->_connectionID);
drivers/adodb-fbsql.inc.php:		$this->_errorMsg = @fbsql_error($this->_connectionID);
drivers/adodb-fbsql.inc.php:			return $this->_errorMsg;
drivers/adodb-fbsql.inc.php:		return @fbsql_errno($this->_connectionID);
drivers/adodb-fbsql.inc.php:		return @fbsql_close($this->_connectionID);
drivers/adodb-fbsql.inc.php:/*--------------------------------------------------------------------------------------
drivers/adodb-fbsql.inc.php:--------------------------------------------------------------------------------------*/
drivers/adodb-fbsql.inc.php:		case ADODB_FETCH_NUM: $this->fetchMode = FBSQL_NUM; break;
drivers/adodb-fbsql.inc.php:		case ADODB_FETCH_BOTH: $this->fetchMode = FBSQL_BOTH; break;
drivers/adodb-fbsql.inc.php:		case ADODB_FETCH_ASSOC: $this->fetchMode = FBSQL_ASSOC; break;
drivers/adodb-fbsql.inc.php:		return $this->ADORecordSet($queryID);
drivers/adodb-fbsql.inc.php:		$this->_numOfRows = ($ADODB_COUNTRECS) ? @fbsql_num_rows($this->_queryID):-1;
drivers/adodb-fbsql.inc.php:		$this->_numOfFields = @fbsql_num_fields($this->_queryID);
drivers/adodb-fbsql.inc.php:	function &FetchField($fieldOffset = -1) {
drivers/adodb-fbsql.inc.php:		if ($fieldOffset != -1) {
drivers/adodb-fbsql.inc.php:			$o =  @fbsql_fetch_field($this->_queryID, $fieldOffset);
drivers/adodb-fbsql.inc.php:			//$o->max_length = -1; // fbsql returns the max length less spaces -- so it is unrealiable
drivers/adodb-fbsql.inc.php:			$f = @fbsql_field_flags($this->_queryID,$fieldOffset);
drivers/adodb-fbsql.inc.php:			$o->binary = (strpos($f,'binary')!== false);
drivers/adodb-fbsql.inc.php:		else if ($fieldOffset == -1) {	/*	The $fieldOffset argument is not provided thus its -1 	*/
drivers/adodb-fbsql.inc.php:			$o = @fbsql_fetch_field($this->_queryID);// fbsql returns the max length less spaces -- so it is unrealiable
drivers/adodb-fbsql.inc.php:			//$o->max_length = -1;
drivers/adodb-fbsql.inc.php:		return @fbsql_data_seek($this->_queryID,$row);
drivers/adodb-fbsql.inc.php:		$this->fields = @fbsql_fetch_array($this->_queryID,$this->fetchMode);
drivers/adodb-fbsql.inc.php:		return ($this->fields == true);
drivers/adodb-fbsql.inc.php:		return @fbsql_free_result($this->_queryID);		
drivers/adodb-fbsql.inc.php:	function MetaType($t,$len=-1,$fieldobj=false)
drivers/adodb-fbsql.inc.php:			$t = $fieldobj->type;
drivers/adodb-fbsql.inc.php:			$len = $fieldobj->max_length;
drivers/adodb-fbsql.inc.php:		$len = -1; // fbsql max_length is not accurate
drivers/adodb-fbsql.inc.php:			if ($len <= $this->blobSize) return 'C';
drivers/adodb-fbsql.inc.php:			return !empty($fieldobj->binary) ? 'B' : 'X';
drivers/adodb-fbsql.inc.php:			if (!empty($fieldobj->primary_key)) return 'R';
drivers/adodb-netezza.inc.php:  V4.54 5 Nov 2004  (c) 2000-2004 John Lim (jlim#natsoft.com.my). All rights reserved.
drivers/adodb-netezza.inc.php:    Removed non-working keys code (Netezza has no concept of keys)
drivers/adodb-netezza.inc.php:// security - hide paths
drivers/adodb-netezza.inc.php:include_once(ADODB_DIR.'/drivers/adodb-postgres64.inc.php');
drivers/adodb-netezza.inc.php:	var $fmtDate = "'Y-m-d'";	// used by DBDate() as the default date format used by the database
drivers/adodb-netezza.inc.php:	var $fmtTimeStamp = "'Y-m-d G:i:s'"; // used by DBTimeStamp as the default timestamp fmt.
drivers/adodb-netezza.inc.php:		if ($this->fetchMode !== false) $savem = $this->SetFetchMode(false);
drivers/adodb-netezza.inc.php:		$rs =& $this->Execute(sprintf($this->metaColumnsSQL,$table,$table));
drivers/adodb-netezza.inc.php:		if (isset($savem)) $this->SetFetchMode($savem);
drivers/adodb-netezza.inc.php:		while (!$rs->EOF) { 	
drivers/adodb-netezza.inc.php:			$fld->name = $rs->fields[0];
drivers/adodb-netezza.inc.php:			if ($first = strstr($rs->fields[1], "(")) {
drivers/adodb-netezza.inc.php:			 $fld->max_length = trim($first, "()");
drivers/adodb-netezza.inc.php:			 $fld->max_length = -1;
drivers/adodb-netezza.inc.php:			if ($first = strpos($rs->fields[1], "(")) {
drivers/adodb-netezza.inc.php:			 $fld->type = substr($rs->fields[1], 0, $first);
drivers/adodb-netezza.inc.php:			 $fld->type = $rs->fields[1];
drivers/adodb-netezza.inc.php:			switch ($fld->type) {
drivers/adodb-netezza.inc.php:			 $fld->max_length = 1;
drivers/adodb-netezza.inc.php:			 $fld->max_length = 2;
drivers/adodb-netezza.inc.php:			 $fld->max_length = 4;
drivers/adodb-netezza.inc.php:			 $fld->max_length = 8;
drivers/adodb-netezza.inc.php:			 $fld->max_length = 12;
drivers/adodb-netezza.inc.php:			else $retarr[($upper) ? strtoupper($fld->name) : $fld->name] = $fld;
drivers/adodb-netezza.inc.php:			$rs->MoveNext();
drivers/adodb-netezza.inc.php:		$rs->Close();
drivers/adodb-netezza.inc.php:/*--------------------------------------------------------------------------------------
drivers/adodb-netezza.inc.php:--------------------------------------------------------------------------------------*/
drivers/adodb-netezza.inc.php:		case ADODB_FETCH_NUM: $this->fetchMode = PGSQL_NUM; break;
drivers/adodb-netezza.inc.php:		case ADODB_FETCH_ASSOC:$this->fetchMode = PGSQL_ASSOC; break;
drivers/adodb-netezza.inc.php:		case ADODB_FETCH_BOTH:$this->fetchMode = PGSQL_BOTH; break;
drivers/adodb-netezza.inc.php:		$this->ADORecordSet($queryID);
drivers/adodb-netezza.inc.php:		$this->_numOfRows = ($ADODB_COUNTRECS)? @pg_numrows($this->_queryID):-1;
drivers/adodb-netezza.inc.php:		$this->_numOfFields = @pg_numfields($this->_queryID);
drivers/adodb-mssql.inc.php:V4.54 5 Nov 2004  (c) 2000-2004 John Lim (jlim@natsoft.com.my). All rights reserved.
drivers/adodb-mssql.inc.php:// security - hide paths
drivers/adodb-mssql.inc.php://----------------------------------------------------------------
drivers/adodb-mssql.inc.php:// settings - Ugh.
drivers/adodb-mssql.inc.php:// ----------------------
drivers/adodb-mssql.inc.php://	 http://support.microsoft.com/default.aspx?scid=kb;EN-US;q220918
drivers/adodb-mssql.inc.php://----------------------------------------------------------------
drivers/adodb-mssql.inc.php:// has datetime converstion to YYYY-MM-DD format, and also mssql_fetch_assoc
drivers/adodb-mssql.inc.php:global $ADODB_mssql_mths;		// array, months must be upper-case
drivers/adodb-mssql.inc.php://---------------------------------------------------------------------------
drivers/adodb-mssql.inc.php:	$adate = $conn->GetOne('select getdate()');
drivers/adodb-mssql.inc.php:				//ADOConnection::outp( "MSSQL: YYYY-MM-DD date format not supported currently");
drivers/adodb-mssql.inc.php:	var $fmtDate = "'Y-m-d'";
drivers/adodb-mssql.inc.php:	var $fmtTimeStamp = "'Y-m-d h:i:sA'";
drivers/adodb-mssql.inc.php:		$this->_has_mssql_init = (strnatcmp(PHP_VERSION,'4.1.0')>=0);
drivers/adodb-mssql.inc.php:		$stmt = $this->PrepareSP('sp_server_info');
drivers/adodb-mssql.inc.php:		if ($this->fetchMode === false) {
drivers/adodb-mssql.inc.php:			$savem = $this->SetFetchMode(ADODB_FETCH_NUM);
drivers/adodb-mssql.inc.php:		$this->Parameter($stmt,$val,'attribute_id');
drivers/adodb-mssql.inc.php:		$row = $this->GetRow($stmt);
drivers/adodb-mssql.inc.php:		//$row = $this->GetRow("execute sp_server_info 2");
drivers/adodb-mssql.inc.php:		if ($this->fetchMode === false) {
drivers/adodb-mssql.inc.php:			$this->SetFetchMode($savem);
drivers/adodb-mssql.inc.php:	// the same scope. A scope is a module -- a stored procedure, trigger, 
drivers/adodb-mssql.inc.php:			return $this->GetOne($this->identitySQL);
drivers/adodb-mssql.inc.php:		return $this->GetOne('select @@rowcount');
drivers/adodb-mssql.inc.php:		$start -= 1;
drivers/adodb-mssql.inc.php:		$this->Execute("create table $seq (id float(53))");
drivers/adodb-mssql.inc.php:		$ok = $this->Execute("insert into $seq with (tablock,holdlock) values($start)");
drivers/adodb-mssql.inc.php:				$this->Execute('ROLLBACK TRANSACTION adodbseq');
drivers/adodb-mssql.inc.php:		$this->Execute('COMMIT TRANSACTION adodbseq'); 
drivers/adodb-mssql.inc.php:		//$this->debug=1;
drivers/adodb-mssql.inc.php:		$this->Execute('BEGIN TRANSACTION adodbseq');
drivers/adodb-mssql.inc.php:		$ok = $this->Execute("update $seq with (tablock,holdlock) set id = id + 1");
drivers/adodb-mssql.inc.php:			$this->Execute("create table $seq (id float(53))");
drivers/adodb-mssql.inc.php:			$ok = $this->Execute("insert into $seq with (tablock,holdlock) values($start)");
drivers/adodb-mssql.inc.php:				$this->Execute('ROLLBACK TRANSACTION adodbseq');
drivers/adodb-mssql.inc.php:			$this->Execute('COMMIT TRANSACTION adodbseq'); 
drivers/adodb-mssql.inc.php:		$num = $this->GetOne("select id from $seq");
drivers/adodb-mssql.inc.php:		$this->Execute('COMMIT TRANSACTION adodbseq'); 
drivers/adodb-mssql.inc.php:		//return $this->GetOne("SELECT CONVERT(varchar(255), NEWID()) AS 'Char'");
drivers/adodb-mssql.inc.php:	function &SelectLimit($sql,$nrows=-1,$offset=-1, $inputarr=false,$secs2cache=0)
drivers/adodb-mssql.inc.php:				'/(^\s*select\s+(distinctrow|distinct)?)/i','\\1 '.$this->hasTop." $nrows ",$sql);
drivers/adodb-mssql.inc.php:			$rs =& $this->Execute($sql,$inputarr);
drivers/adodb-mssql.inc.php:		if (!$col) $col = $this->sysTimeStamp;
drivers/adodb-mssql.inc.php:				$s .= $this->qstr($ch);
drivers/adodb-mssql.inc.php:		if ($this->transOff) return true; 
drivers/adodb-mssql.inc.php:		$this->transCnt += 1;
drivers/adodb-mssql.inc.php:	   	$this->Execute('BEGIN TRAN');
drivers/adodb-mssql.inc.php:		if ($this->transOff) return true; 
drivers/adodb-mssql.inc.php:		if (!$ok) return $this->RollbackTrans();
drivers/adodb-mssql.inc.php:		if ($this->transCnt) $this->transCnt -= 1;
drivers/adodb-mssql.inc.php:		$this->Execute('COMMIT TRAN');
drivers/adodb-mssql.inc.php:		if ($this->transOff) return true; 
drivers/adodb-mssql.inc.php:		if ($this->transCnt) $this->transCnt -= 1;
drivers/adodb-mssql.inc.php:		$this->Execute('ROLLBACK TRAN');
drivers/adodb-mssql.inc.php:		$this->BeginTrans();
drivers/adodb-mssql.inc.php:		$this->RowLock('table1,table2','table1.id=33 and table2.id=table1.id'); # lock row 33 for both tables
drivers/adodb-mssql.inc.php:		$this->CommitTrans();
drivers/adodb-mssql.inc.php:		if (!$this->transCnt) $this->BeginTrans();
drivers/adodb-mssql.inc.php:		return $this->GetOne("select top 1 null as ignore from $tables with (ROWLOCK,HOLDLOCK) where $where");
drivers/adodb-mssql.inc.php:		$table = $this->qstr($table);
drivers/adodb-mssql.inc.php:        if ($this->fetchMode !== FALSE) {
drivers/adodb-mssql.inc.php:        	$savem = $this->SetFetchMode(FALSE);
drivers/adodb-mssql.inc.php:        $rs = $this->Execute($sql);
drivers/adodb-mssql.inc.php:        	$this->SetFetchMode($savem);
drivers/adodb-mssql.inc.php:		while ($row = $rs->FetchRow()) {
drivers/adodb-mssql.inc.php:		$table = $this->qstr(strtoupper($table));
drivers/adodb-mssql.inc.php:		$constraints =& $this->GetArray($sql);
drivers/adodb-mssql.inc.php:				 $qry=$this->metaDatabasesSQL; 
drivers/adodb-mssql.inc.php:						@mssql_select_db($this->databaseName); 
drivers/adodb-mssql.inc.php:						 @mssql_select_db($this->databaseName); 
drivers/adodb-mssql.inc.php:	// "Stein-Aksel Basma" <basma@accelero.no>
drivers/adodb-mssql.inc.php:		$this->_findschema($table,$schema);
drivers/adodb-mssql.inc.php:		if (!$schema) $schema = $this->database;
drivers/adodb-mssql.inc.php:		$a = $this->GetCol($sql);
drivers/adodb-mssql.inc.php:			$save = $this->metaTablesSQL;
drivers/adodb-mssql.inc.php:			$mask = $this->qstr(($mask));
drivers/adodb-mssql.inc.php:			$this->metaTablesSQL .= " AND name like $mask";
drivers/adodb-mssql.inc.php:			$this->metaTablesSQL = $save;
drivers/adodb-mssql.inc.php:		$this->databaseName = $dbName;
drivers/adodb-mssql.inc.php:		if ($this->_connectionID) {
drivers/adodb-mssql.inc.php:		if (empty($this->_errorMsg)){
drivers/adodb-mssql.inc.php:			$this->_errorMsg = mssql_get_last_message();
drivers/adodb-mssql.inc.php:		return $this->_errorMsg;
drivers/adodb-mssql.inc.php:		if ($this->_logsql && $this->_errorCode !== false) return $this->_errorCode;
drivers/adodb-mssql.inc.php:		if (empty($this->_errorMsg)) {
drivers/adodb-mssql.inc.php:			$this->_errorMsg = mssql_get_last_message();
drivers/adodb-mssql.inc.php:		$id = @mssql_query("select @@ERROR",$this->_connectionID);
drivers/adodb-mssql.inc.php:	   else return -1;
drivers/adodb-mssql.inc.php:		$this->_connectionID = mssql_connect($argHostname,$argUsername,$argPassword);
drivers/adodb-mssql.inc.php:		if ($this->_connectionID === false) return false;
drivers/adodb-mssql.inc.php:		if ($argDatabasename) return $this->SelectDB($argDatabasename);
drivers/adodb-mssql.inc.php:		$this->_connectionID = mssql_pconnect($argHostname,$argUsername,$argPassword);
drivers/adodb-mssql.inc.php:		if ($this->_connectionID === false) return false;
drivers/adodb-mssql.inc.php:		if ($this->autoRollback) {
drivers/adodb-mssql.inc.php:			$cnt = $this->GetOne('select @@TRANCOUNT');
drivers/adodb-mssql.inc.php:			while (--$cnt >= 0) $this->Execute('ROLLBACK TRAN'); 
drivers/adodb-mssql.inc.php:		if ($argDatabasename) return $this->SelectDB($argDatabasename);
drivers/adodb-mssql.inc.php:			$sql2 .=  '@P'.($i-1) . $sqlarr[$i];
drivers/adodb-mssql.inc.php:		return array($sql,$this->qstr($sql2),$max);
drivers/adodb-mssql.inc.php:		if (!$this->_has_mssql_init) {
drivers/adodb-mssql.inc.php:		$stmt = mssql_init($sql,$this->_connectionID);
drivers/adodb-mssql.inc.php:		$stmt = $db->PrepareSP('SP_RUNSOMETHING'); -- takes 2 params, @myid and @group
drivers/adodb-mssql.inc.php:		$db->Parameter($stmt,$id,'myid');
drivers/adodb-mssql.inc.php:		$db->Parameter($stmt,$group,'group',false,64);
drivers/adodb-mssql.inc.php:		$db->Execute($stmt);
drivers/adodb-mssql.inc.php:		if (!$this->_has_mssql_init) {
drivers/adodb-mssql.inc.php:		if  ($this->debug) {
drivers/adodb-mssql.inc.php:			see how it works. - type: one of this new supported PHP constants. 
drivers/adodb-mssql.inc.php:		; Valid range 0 - 2147483647. Default = 4096. 
drivers/adodb-mssql.inc.php:		; Valid range 0 - 2147483647. Default = 4096. 
drivers/adodb-mssql.inc.php:			return $this->Execute($sql) != false;
drivers/adodb-mssql.inc.php:		return $this->Execute($sql) != false;
drivers/adodb-mssql.inc.php:		$this->_errorMsg = false;
drivers/adodb-mssql.inc.php:			# see http://www.quest-pipelines.com/newsletter-v3/0402_F.htm
drivers/adodb-mssql.inc.php:			if (!is_array($sql)) $sql = $this->Prepare($sql);
drivers/adodb-mssql.inc.php:					$params .= "@P$i=N". (strncmp($v,"'",1)==0? $v : $this->qstr($v));
drivers/adodb-mssql.inc.php:			$decl = $this->qstr($decl);
drivers/adodb-mssql.inc.php:			if ($this->debug) ADOConnection::outp("<font size=-1>sp_executesql N{$sql[1]},N$decl,$params</font>");
drivers/adodb-mssql.inc.php:			$rez = mssql_query($sql,$this->_connectionID);
drivers/adodb-mssql.inc.php:		if ($this->transCnt) $this->RollbackTrans();
drivers/adodb-mssql.inc.php:		$rez = @mssql_close($this->_connectionID);
drivers/adodb-mssql.inc.php:		$this->_connectionID = false;
drivers/adodb-mssql.inc.php:/*--------------------------------------------------------------------------------------
drivers/adodb-mssql.inc.php:--------------------------------------------------------------------------------------*/
drivers/adodb-mssql.inc.php:	// _mths works only in non-localised system
drivers/adodb-mssql.inc.php:		$this->hasFetchAssoc = function_exists('mssql_fetch_assoc');
drivers/adodb-mssql.inc.php:		$this->fetchMode = $mode;
drivers/adodb-mssql.inc.php:		return $this->ADORecordSet($id,$mode);
drivers/adodb-mssql.inc.php:		$this->_numOfRows = ($ADODB_COUNTRECS)? @mssql_num_rows($this->_queryID):-1;
drivers/adodb-mssql.inc.php:		$this->_numOfFields = @mssql_num_fields($this->_queryID);
drivers/adodb-mssql.inc.php:	// get next resultset - requires PHP 4.0.5 or later
drivers/adodb-mssql.inc.php:		if (!mssql_next_result($this->_queryID)) return false;
drivers/adodb-mssql.inc.php:		$this->_inited = false;
drivers/adodb-mssql.inc.php:		$this->bind = false;
drivers/adodb-mssql.inc.php:		$this->_currentRow = -1;
drivers/adodb-mssql.inc.php:		$this->Init();
drivers/adodb-mssql.inc.php:		if ($this->fetchMode != ADODB_FETCH_NUM) return $this->fields[$colname];
drivers/adodb-mssql.inc.php:		if (!$this->bind) {
drivers/adodb-mssql.inc.php:			$this->bind = array();
drivers/adodb-mssql.inc.php:			for ($i=0; $i < $this->_numOfFields; $i++) {
drivers/adodb-mssql.inc.php:				$o = $this->FetchField($i);
drivers/adodb-mssql.inc.php:				$this->bind[strtoupper($o->name)] = $i;
drivers/adodb-mssql.inc.php:		 return $this->fields[$this->bind[strtoupper($colname)]];
drivers/adodb-mssql.inc.php:	function FetchField($fieldOffset = -1) 
drivers/adodb-mssql.inc.php:		if ($fieldOffset != -1) {
drivers/adodb-mssql.inc.php:			return @mssql_fetch_field($this->_queryID, $fieldOffset);
drivers/adodb-mssql.inc.php:		else if ($fieldOffset == -1) {	/*	The $fieldOffset argument is not provided thus its -1 	*/
drivers/adodb-mssql.inc.php:			return @mssql_fetch_field($this->_queryID);
drivers/adodb-mssql.inc.php:		return @mssql_data_seek($this->_queryID, $row);
drivers/adodb-mssql.inc.php:		if ($this->EOF) return false;
drivers/adodb-mssql.inc.php:		$this->_currentRow++;
drivers/adodb-mssql.inc.php:		if ($this->fetchMode & ADODB_FETCH_ASSOC) {
drivers/adodb-mssql.inc.php:			if ($this->fetchMode & ADODB_FETCH_NUM) {
drivers/adodb-mssql.inc.php:				$this->fields = @mssql_fetch_array($this->_queryID);
drivers/adodb-mssql.inc.php:				if ($this->hasFetchAssoc) {// only for PHP 4.2.0 or later
drivers/adodb-mssql.inc.php:					 $this->fields = @mssql_fetch_assoc($this->_queryID);
drivers/adodb-mssql.inc.php:					$flds = @mssql_fetch_array($this->_queryID);
drivers/adodb-mssql.inc.php:						$this->fields = $fassoc;
drivers/adodb-mssql.inc.php:						$this->fields = false;
drivers/adodb-mssql.inc.php:			if (is_array($this->fields)) {
drivers/adodb-mssql.inc.php:					foreach($this->fields as $k=>$v) {
drivers/adodb-mssql.inc.php:						$this->fields[strtolower($k)] = $v;
drivers/adodb-mssql.inc.php:					foreach($this->fields as $k=>$v) {
drivers/adodb-mssql.inc.php:						$this->fields[strtoupper($k)] = $v;
drivers/adodb-mssql.inc.php:			$this->fields = @mssql_fetch_row($this->_queryID);
drivers/adodb-mssql.inc.php:		if ($this->fields) return true;
drivers/adodb-mssql.inc.php:		$this->EOF = true;
drivers/adodb-mssql.inc.php:	// also the date format has been changed from YYYY-mm-dd to dd MMM YYYY in 4.0.4. Idiot!
drivers/adodb-mssql.inc.php:		if ($this->fetchMode & ADODB_FETCH_ASSOC) {
drivers/adodb-mssql.inc.php:			if ($this->fetchMode & ADODB_FETCH_NUM) {
drivers/adodb-mssql.inc.php:				$this->fields = @mssql_fetch_array($this->_queryID);
drivers/adodb-mssql.inc.php:				if ($this->hasFetchAssoc) // only for PHP 4.2.0 or later
drivers/adodb-mssql.inc.php:					$this->fields = @mssql_fetch_assoc($this->_queryID);
drivers/adodb-mssql.inc.php:					$this->fields = @mssql_fetch_array($this->_queryID);
drivers/adodb-mssql.inc.php:					if (@is_array($$this->fields)) {
drivers/adodb-mssql.inc.php:						foreach($$this->fields as $k => $v) {
drivers/adodb-mssql.inc.php:						$this->fields = $fassoc;
drivers/adodb-mssql.inc.php:			if (!$this->fields) {
drivers/adodb-mssql.inc.php:				foreach($this->fields as $k=>$v) {
drivers/adodb-mssql.inc.php:					$this->fields[strtolower($k)] = $v;
drivers/adodb-mssql.inc.php:				foreach($this->fields as $k=>$v) {
drivers/adodb-mssql.inc.php:					$this->fields[strtoupper($k)] = $v;
drivers/adodb-mssql.inc.php:			$this->fields = @mssql_fetch_row($this->_queryID);
drivers/adodb-mssql.inc.php:		return $this->fields;
drivers/adodb-mssql.inc.php:		$rez = mssql_free_result($this->_queryID);	
drivers/adodb-mssql.inc.php:		$this->_queryID = false;
drivers/adodb-mssql.inc.php:	function ADORecordSet_array_mssql($id=-1,$mode=false) 
drivers/adodb-mssql.inc.php:		$this->ADORecordSet_array($id,$mode);
drivers/adodb-mssql.inc.php:			if (!preg_match( "|^([0-9]{1,2})[-/\. ]+([A-Za-z]{3})[-/\. ]+([0-9]{4})|" ,$v, $rr)) {
drivers/adodb-mssql.inc.php:			if (!preg_match( "|^([A-Za-z]{3})[-/\. ]+([0-9]{1,2})[-/\. ]+([0-9]{4})|" ,$v, $rr)) {
drivers/adodb-mssql.inc.php:		// h-m-s-MM-DD-YY
drivers/adodb-mssql.inc.php:			 if (!preg_match( "|^([0-9]{1,2})[-/\. ]+([A-Za-z]{3})[-/\. ]+([0-9]{4}) +([0-9]{1,2}):([0-9]{1,2}) *([apAP]{0,1})|"
drivers/adodb-mssql.inc.php:			if (!preg_match( "|^([A-Za-z]{3})[-/\. ]+([0-9]{1,2})[-/\. ]+([0-9]{4}) +([0-9]{1,2}):([0-9]{1,2}) *([apAP]{0,1})|"
drivers/adodb-mssql.inc.php:		// h-m-s-MM-DD-YY
drivers/adodb-sybase.inc.php:V4.54 5 Nov 2004  (c) 2000-2004 John Lim. All rights reserved.
drivers/adodb-sybase.inc.php:  - MSSQL date patch applied.
drivers/adodb-sybase.inc.php: // security - hide paths
drivers/adodb-sybase.inc.php:	var $fmtDate = "'Y-m-d'";
drivers/adodb-sybase.inc.php:	var $fmtTimeStamp = "'Y-m-d H:i:s'";
drivers/adodb-sybase.inc.php:	// see http://sybooks.sybase.com/onlinebooks/group-aw/awg0800e/dbrfen8/@ebt-link;pt=5981;uf=0?target=0;window=new;showtoc=true;book=dbrfen8
drivers/adodb-sybase.inc.php:	// might require begintrans -- committrans
drivers/adodb-sybase.inc.php:		return $this->GetOne('select @@identity');
drivers/adodb-sybase.inc.php:	  // might require begintrans -- committrans
drivers/adodb-sybase.inc.php:	   return $this->GetOne('select @@rowcount');
drivers/adodb-sybase.inc.php:		if ($this->transOff) return true;
drivers/adodb-sybase.inc.php:		$this->transCnt += 1;
drivers/adodb-sybase.inc.php:		$this->Execute('BEGIN TRAN');
drivers/adodb-sybase.inc.php:		if ($this->transOff) return true;
drivers/adodb-sybase.inc.php:		if (!$ok) return $this->RollbackTrans();
drivers/adodb-sybase.inc.php:		$this->transCnt -= 1;
drivers/adodb-sybase.inc.php:		$this->Execute('COMMIT TRAN');
drivers/adodb-sybase.inc.php:		if ($this->transOff) return true;
drivers/adodb-sybase.inc.php:		$this->transCnt -= 1;
drivers/adodb-sybase.inc.php:		$this->Execute('ROLLBACK TRAN');
drivers/adodb-sybase.inc.php:		if (!$this->_hastrans) $this->BeginTrans();
drivers/adodb-sybase.inc.php:		return $this->GetOne("select top 1 null as ignore from $tables HOLDLOCK where $where");
drivers/adodb-sybase.inc.php:		$this->databaseName = $dbName;
drivers/adodb-sybase.inc.php:		if ($this->_connectionID) {
drivers/adodb-sybase.inc.php:		if ($this->_logsql) return $this->_errorMsg;
drivers/adodb-sybase.inc.php:			$this->_errorMsg = sybase_get_last_message();
drivers/adodb-sybase.inc.php:			$this->_errorMsg = isset($php_errormsg) ? $php_errormsg : 'SYBASE error messages not supported on this platform';
drivers/adodb-sybase.inc.php:		return $this->_errorMsg;
drivers/adodb-sybase.inc.php:		$this->_connectionID = sybase_connect($argHostname,$argUsername,$argPassword);
drivers/adodb-sybase.inc.php:		if ($this->_connectionID === false) return false;
drivers/adodb-sybase.inc.php:		if ($argDatabasename) return $this->SelectDB($argDatabasename);
drivers/adodb-sybase.inc.php:		$this->_connectionID = sybase_pconnect($argHostname,$argUsername,$argPassword);
drivers/adodb-sybase.inc.php:		if ($this->_connectionID === false) return false;
drivers/adodb-sybase.inc.php:		if ($argDatabasename) return $this->SelectDB($argDatabasename);
drivers/adodb-sybase.inc.php:			return sybase_unbuffered_query($sql,$this->_connectionID);
drivers/adodb-sybase.inc.php:			return sybase_query($sql,$this->_connectionID);
drivers/adodb-sybase.inc.php:	function &SelectLimit($sql,$nrows=-1,$offset=-1,$inputarr=false,$secs2cache=0) 
drivers/adodb-sybase.inc.php:		$this->Execute("set rowcount $cnt"); 
drivers/adodb-sybase.inc.php:		$this->Execute("set rowcount 0");
drivers/adodb-sybase.inc.php:		return @sybase_close($this->_connectionID);
drivers/adodb-sybase.inc.php:	# Added 2003-10-05 by Chris Phillipson
drivers/adodb-sybase.inc.php:    # Used ASA SQL Reference Manual -- http://sybooks.sybase.com/onlinebooks/group-aw/awg0800e/dbrfen8/@ebt-link;pt=16756?target=%25N%15_12018_START_RESTART_N%25
drivers/adodb-sybase.inc.php:        if (!$col) $col = $this->sysTimeStamp;
drivers/adodb-sybase.inc.php:                $s .= $this->qstr($ch);
drivers/adodb-sybase.inc.php:	# Added 2003-10-07 by Chris Phillipson
drivers/adodb-sybase.inc.php:    # Used ASA SQL Reference Manual -- http://sybooks.sybase.com/onlinebooks/group-aw/awg0800e/dbrfen8/@ebt-link;pt=5981;uf=0?target=0;window=new;showtoc=true;book=dbrfen8
drivers/adodb-sybase.inc.php:        $a = $this->GetCol($sql);
drivers/adodb-sybase.inc.php:/*--------------------------------------------------------------------------------------
drivers/adodb-sybase.inc.php:--------------------------------------------------------------------------------------*/
drivers/adodb-sybase.inc.php:	// _mths works only in non-localised system
drivers/adodb-sybase.inc.php:		if (!$mode) $this->fetchMode = ADODB_FETCH_ASSOC;
drivers/adodb-sybase.inc.php:		else $this->fetchMode = $mode;
drivers/adodb-sybase.inc.php:		return $this->ADORecordSet($id,$mode);
drivers/adodb-sybase.inc.php:	function &FetchField($fieldOffset = -1) 
drivers/adodb-sybase.inc.php:		if ($fieldOffset != -1) {
drivers/adodb-sybase.inc.php:			$o = @sybase_fetch_field($this->_queryID, $fieldOffset);
drivers/adodb-sybase.inc.php:		else if ($fieldOffset == -1) {	/*	The $fieldOffset argument is not provided thus its -1 	*/
drivers/adodb-sybase.inc.php:			$o = @sybase_fetch_field($this->_queryID);
drivers/adodb-sybase.inc.php:		if ($o && !isset($o->type)) $o->type = ($o->numeric) ? 'float' : 'varchar';
drivers/adodb-sybase.inc.php:		$this->_numOfRows = ($ADODB_COUNTRECS)? @sybase_num_rows($this->_queryID):-1;
drivers/adodb-sybase.inc.php:		$this->_numOfFields = @sybase_num_fields($this->_queryID);
drivers/adodb-sybase.inc.php:		return @sybase_data_seek($this->_queryID, $row);
drivers/adodb-sybase.inc.php:		if ($this->fetchMode == ADODB_FETCH_NUM) {
drivers/adodb-sybase.inc.php:			$this->fields = @sybase_fetch_row($this->_queryID);
drivers/adodb-sybase.inc.php:		} else if ($this->fetchMode == ADODB_FETCH_ASSOC) {
drivers/adodb-sybase.inc.php:			$this->fields = @sybase_fetch_row($this->_queryID);
drivers/adodb-sybase.inc.php:			if (is_array($this->fields)) {
drivers/adodb-sybase.inc.php:				$this->fields = $this->GetRowAssoc(ADODB_ASSOC_CASE);
drivers/adodb-sybase.inc.php:			$this->fields = @sybase_fetch_array($this->_queryID);
drivers/adodb-sybase.inc.php:		if ( is_array($this->fields)) {
drivers/adodb-sybase.inc.php:		return @sybase_free_result($this->_queryID);		
drivers/adodb-sybase.inc.php:	function ADORecordSet_array_sybase($id=-1)
drivers/adodb-sybase.inc.php:		$this->ADORecordSet_array($id);
drivers/adodb-sybase.inc.php:		if (!ereg( "([A-Za-z]{3})[-/\. ]+([0-9]{1,2})[-/\. ]+([0-9]{4})"
drivers/adodb-sybase.inc.php:		// h-m-s-MM-DD-YY
drivers/adodb-sybase.inc.php:		//Changed [0-9] to [0-9 ] in day conversion
drivers/adodb-sybase.inc.php:		if (!ereg( "([A-Za-z]{3})[-/\. ]([0-9 ]{1,2})[-/\. ]([0-9]{4}) +([0-9]{1,2}):([0-9]{1,2}) *([apAP]{0,1})"
drivers/adodb-sybase.inc.php:		// h-m-s-MM-DD-YY
drivers/adodb-postgres64.inc.php: V4.54 5 Nov 2004  (c) 2000-2004 John Lim (jlim@natsoft.com.my). All rights reserved.
drivers/adodb-postgres64.inc.php:  Original version derived from Alberto Cerezal (acerezalp@dbnet.es) - DBNet Informatica & Comunicaciones. 
drivers/adodb-postgres64.inc.php:  08 Nov 2000 jlim - Minor corrections, removing mysql stuff
drivers/adodb-postgres64.inc.php:  09 Nov 2000 jlim - added insertid support suggested by "Christopher Kings-Lynne" <chriskl@familyhealth.com.au>
drivers/adodb-postgres64.inc.php:					jlim - changed concat operator to || and data types to MetaType to match documented pgsql types 
drivers/adodb-postgres64.inc.php:		 	see http://www.postgresql.org/devel-corner/docs/postgres/datatype.htm  
drivers/adodb-postgres64.inc.php:  22 Nov 2000 jlim - added changes to FetchField() and MetaTables() contributed by "raser" <raser@mail.zen.com.tw>
drivers/adodb-postgres64.inc.php:  27 Nov 2000 jlim - added changes to _connect/_pconnect from ideas by "Lennie" <leen@wirehub.nl>
drivers/adodb-postgres64.inc.php:  15 Dec 2000 jlim - added changes suggested by Additional code changes by "Eric G. Werk" egw@netguide.dk. 
drivers/adodb-postgres64.inc.php:  31 Jan 2002 jlim - finally installed postgresql. testing
drivers/adodb-postgres64.inc.php:  01 Mar 2001 jlim - Freek Dijkstra changes, also support for text type
drivers/adodb-postgres64.inc.php:	-- What indexes are on my table?
drivers/adodb-postgres64.inc.php:	-- What triggers are on my table?
drivers/adodb-postgres64.inc.php:	-- What constraints are on my table?
drivers/adodb-postgres64.inc.php:// security - hide paths
drivers/adodb-postgres64.inc.php:	if (strncmp($s,"'",1) === 0 && substr(s,$len-1) == "'") return $s; // already quoted
drivers/adodb-postgres64.inc.php:	// get primary key etc -- from Freek Dijkstra
drivers/adodb-postgres64.inc.php:	var $fmtDate = "'Y-m-d'";	// used by DBDate() as the default date format used by the database
drivers/adodb-postgres64.inc.php:	var $fmtTimeStamp = "'Y-m-d G:i:s'"; // used by DBTimeStamp as the default timestamp fmt.
drivers/adodb-postgres64.inc.php:	// and writes these time in this format: "2001-03-01 18:59:26+02". 
drivers/adodb-postgres64.inc.php:	// -- Freek Dijkstra 
drivers/adodb-postgres64.inc.php:		if (isset($this->version)) return $this->version;
drivers/adodb-postgres64.inc.php:		$arr['description'] = $this->GetOne("select version()");
drivers/adodb-postgres64.inc.php:		$this->version = $arr;
drivers/adodb-postgres64.inc.php:	// get the last id - never tested
drivers/adodb-postgres64.inc.php:		$result=pg_exec($this->_connectionID, "SELECT last_value FROM ${tablename}_${fieldname}_seq");
drivers/adodb-postgres64.inc.php:/* Warning from http://www.php.net/manual/function.pg-getlastoid.php:
drivers/adodb-postgres64.inc.php:		if (!is_resource($this->_resultid) || get_resource_type($this->_resultid) !== 'pgsql result') return false;
drivers/adodb-postgres64.inc.php:		$oid = pg_getlastoid($this->_resultid);
drivers/adodb-postgres64.inc.php:		// to really return the id, we need the table and column-name, else we can only return the oid != id
drivers/adodb-postgres64.inc.php:		return empty($table) || empty($column) ? $oid : $this->GetOne("SELECT $column FROM $table WHERE oid=".(int)$oid);
drivers/adodb-postgres64.inc.php:// I get this error with PHP before 4.0.6 - jlim
drivers/adodb-postgres64.inc.php:// Warning: This compilation does not support pg_cmdtuples() in d:/inetpub/wwwroot/php/adodb/adodb-postgres.inc.php on line 44
drivers/adodb-postgres64.inc.php:   		if (!is_resource($this->_resultid) || get_resource_type($this->_resultid) !== 'pgsql result') return false;
drivers/adodb-postgres64.inc.php:	   	return pg_cmdtuples($this->_resultid);
drivers/adodb-postgres64.inc.php:		if ($this->transOff) return true;
drivers/adodb-postgres64.inc.php:		$this->transCnt += 1;
drivers/adodb-postgres64.inc.php:		return @pg_Exec($this->_connectionID, "begin");
drivers/adodb-postgres64.inc.php:		if (!$this->transCnt) $this->BeginTrans();
drivers/adodb-postgres64.inc.php:		return $this->GetOne("select 1 as ignore from $tables where $where for update");
drivers/adodb-postgres64.inc.php:		if ($this->transOff) return true;
drivers/adodb-postgres64.inc.php:		if (!$ok) return $this->RollbackTrans();
drivers/adodb-postgres64.inc.php:		$this->transCnt -= 1;
drivers/adodb-postgres64.inc.php:		return @pg_Exec($this->_connectionID, "commit");
drivers/adodb-postgres64.inc.php:		if ($this->transOff) return true;
drivers/adodb-postgres64.inc.php:		$this->transCnt -= 1;
drivers/adodb-postgres64.inc.php:		return @pg_Exec($this->_connectionID, "rollback");
drivers/adodb-postgres64.inc.php:		$info = $this->ServerInfo();
drivers/adodb-postgres64.inc.php:	    	$this->metaTablesSQL = "select tablename,'T' from pg_tables where tablename not like 'pg\_%'
drivers/adodb-postgres64.inc.php:			$save = $this->metaTablesSQL;
drivers/adodb-postgres64.inc.php:			$mask = $this->qstr(strtolower($mask));
drivers/adodb-postgres64.inc.php:				$this->metaTablesSQL = "
drivers/adodb-postgres64.inc.php:				$this->metaTablesSQL = "
drivers/adodb-postgres64.inc.php:			$this->metaTablesSQL = $save;
drivers/adodb-postgres64.inc.php:			if ($this->replaceQuote[0] == '\\'){
drivers/adodb-postgres64.inc.php:			return  "'".str_replace("'",$this->replaceQuote,$s)."'"; 
drivers/adodb-postgres64.inc.php:		if (!$col) $col = $this->sysTimeStamp;
drivers/adodb-postgres64.inc.php:				if (strpos('-/.:;, ',$ch) !== false) $s .= $ch;
drivers/adodb-postgres64.inc.php:	* - the procedure stores the object id in the table and imports the object using 
drivers/adodb-postgres64.inc.php:		pg_exec ($this->_connectionID, "begin"); 
drivers/adodb-postgres64.inc.php:		$oid = pg_lo_create($this->_connectionID);
drivers/adodb-postgres64.inc.php:		$handle = pg_lo_open($this->_connectionID, $oid, 'w');
drivers/adodb-postgres64.inc.php:		pg_exec($this->_connectionID, "commit"); 
drivers/adodb-postgres64.inc.php:		Hueristic - not guaranteed to work.
drivers/adodb-postgres64.inc.php:	* added maxsize parameter, which defaults to $db->maxblobsize if not defined.
drivers/adodb-postgres64.inc.php:		if (!$this->GuessOID($blob)) return $blob;
drivers/adodb-postgres64.inc.php:		if ($hastrans) @pg_exec($this->_connectionID,"begin"); 
drivers/adodb-postgres64.inc.php:		$fd = @pg_lo_open($this->_connectionID,$blob,"r");
drivers/adodb-postgres64.inc.php:			if ($hastrans) @pg_exec($this->_connectionID,"commit");
drivers/adodb-postgres64.inc.php:		if (!$maxsize) $maxsize = $this->maxblobsize;
drivers/adodb-postgres64.inc.php:		if ($hastrans) @pg_exec($this->_connectionID,"commit"); 
drivers/adodb-postgres64.inc.php:		See http://www.postgresql.org/idocs/index.php?datatype-binary.html
drivers/adodb-postgres64.inc.php:		/*92=backslash, 0=null, 39=single-quote*/
drivers/adodb-postgres64.inc.php:		return $this->Execute("UPDATE $table SET $column='".$this->BlobEncode($val)."'::bytea WHERE $where");
drivers/adodb-postgres64.inc.php:		if (!$date) $date = $this->sysDate;
drivers/adodb-postgres64.inc.php:		$this->_findschema($table,$schema);
drivers/adodb-postgres64.inc.php:		if ($this->fetchMode !== false) $savem = $this->SetFetchMode(false);
drivers/adodb-postgres64.inc.php:		if ($schema) $rs =& $this->Execute(sprintf($this->metaColumnsSQL1,$table,$table,$schema));
drivers/adodb-postgres64.inc.php:		else $rs =& $this->Execute(sprintf($this->metaColumnsSQL,$table,$table));
drivers/adodb-postgres64.inc.php:		if (isset($savem)) $this->SetFetchMode($savem);
drivers/adodb-postgres64.inc.php:		if (!empty($this->metaKeySQL)) {
drivers/adodb-postgres64.inc.php:			$rskey = $this->Execute(sprintf($this->metaKeySQL,($table)));
drivers/adodb-postgres64.inc.php:			$keys =& $rskey->GetArray();
drivers/adodb-postgres64.inc.php:			if (isset($savem)) $this->SetFetchMode($savem);
drivers/adodb-postgres64.inc.php:			$rskey->Close();
drivers/adodb-postgres64.inc.php:		if (!empty($this->metaDefaultsSQL)) {
drivers/adodb-postgres64.inc.php:			$sql = sprintf($this->metaDefaultsSQL, ($table));
drivers/adodb-postgres64.inc.php:			$rsdef = $this->Execute($sql);
drivers/adodb-postgres64.inc.php:			if (isset($savem)) $this->SetFetchMode($savem);
drivers/adodb-postgres64.inc.php:				while (!$rsdef->EOF) {
drivers/adodb-postgres64.inc.php:					$num = $rsdef->fields['num'];
drivers/adodb-postgres64.inc.php:					$s = $rsdef->fields['def'];
drivers/adodb-postgres64.inc.php:						$s = substr($s, 0, strlen($s) - 1);
drivers/adodb-postgres64.inc.php:					$rsdef->MoveNext();
drivers/adodb-postgres64.inc.php:		while (!$rs->EOF) { 	
drivers/adodb-postgres64.inc.php:			$fld->name = $rs->fields[0];
drivers/adodb-postgres64.inc.php:			$fld->type = $rs->fields[1];
drivers/adodb-postgres64.inc.php:			$fld->max_length = $rs->fields[2];
drivers/adodb-postgres64.inc.php:			if ($fld->max_length <= 0) $fld->max_length = $rs->fields[3]-4;
drivers/adodb-postgres64.inc.php:			if ($fld->max_length <= 0) $fld->max_length = -1;
drivers/adodb-postgres64.inc.php:			if ($fld->type == 'numeric') {
drivers/adodb-postgres64.inc.php:				$fld->scale = $fld->max_length & 0xFFFF;
drivers/adodb-postgres64.inc.php:				$fld->max_length >>= 16;
drivers/adodb-postgres64.inc.php:			// 5 hasdefault; 6 num-of-column
drivers/adodb-postgres64.inc.php:			$fld->has_default = ($rs->fields[5] == 't');
drivers/adodb-postgres64.inc.php:			if ($fld->has_default) {
drivers/adodb-postgres64.inc.php:				$fld->default_value = $rsdefa[$rs->fields[6]];
drivers/adodb-postgres64.inc.php:			if ($rs->fields[4] == $this->true) {
drivers/adodb-postgres64.inc.php:				$fld->not_null = true;
drivers/adodb-postgres64.inc.php:					if ($fld->name == $key['column_name'] AND $key['primary_key'] == $this->true) 
drivers/adodb-postgres64.inc.php:						$fld->primary_key = true;
drivers/adodb-postgres64.inc.php:					if ($fld->name == $key['column_name'] AND $key['unique_key'] == $this->true) 
drivers/adodb-postgres64.inc.php:						$fld->unique = true; // What name is more compatible?
drivers/adodb-postgres64.inc.php:			else $retarr[($normalize) ? strtoupper($fld->name) : $fld->name] = $fld;
drivers/adodb-postgres64.inc.php:			$rs->MoveNext();
drivers/adodb-postgres64.inc.php:		$rs->Close();
drivers/adodb-postgres64.inc.php:				$this->_findschema($table,$schema);
drivers/adodb-postgres64.inc.php:				if ($schema) { // requires pgsql 7.3+ - pg_namespace used.
drivers/adodb-postgres64.inc.php:                if ($this->fetchMode !== FALSE) {
drivers/adodb-postgres64.inc.php:                        $savem = $this->SetFetchMode(FALSE);
drivers/adodb-postgres64.inc.php:                $rs = $this->Execute(sprintf($sql,$table,$table,$schema));
drivers/adodb-postgres64.inc.php:                        $this->SetFetchMode($savem);
drivers/adodb-postgres64.inc.php:                $col_names = $this->MetaColumnNames($table,true);
drivers/adodb-postgres64.inc.php:                while ($row = $rs->FetchRow()) {
drivers/adodb-postgres64.inc.php:                                $columns[] = $col_names[$col - 1];
drivers/adodb-postgres64.inc.php:	// 	$db->Connect("host=host1 user=user1 password=secret port=4341");
drivers/adodb-postgres64.inc.php:	// 	$db->Connect('host1','user1','secret');
drivers/adodb-postgres64.inc.php:		$this->_errorMsg = false;
drivers/adodb-postgres64.inc.php:			$this->_connectionID = pg_pconnect($str);
drivers/adodb-postgres64.inc.php:			if ($ctype === -1) { // nconnect, we trick pgsql ext by changing the connection str
drivers/adodb-postgres64.inc.php:			$this->_connectionID = pg_connect($str);
drivers/adodb-postgres64.inc.php:		if ($this->_connectionID === false) return false;
drivers/adodb-postgres64.inc.php:		$this->Execute("set datestyle='ISO'");
drivers/adodb-postgres64.inc.php:	 	return $this->_connect($argHostname, $argUsername, $argPassword, $argDatabaseName,-1);
drivers/adodb-postgres64.inc.php:	// 	$db->PConnect("host=host1 user=user1 password=secret port=4341");
drivers/adodb-postgres64.inc.php:	// 	$db->PConnect('host1','user1','secret');
drivers/adodb-postgres64.inc.php:		return $this->_connect($str,$user,$pwd,$db,1);
drivers/adodb-postgres64.inc.php:					if (strncmp($v,"'",1) !== 0) $execp .= $this->qstr($v);
drivers/adodb-postgres64.inc.php:			$rez = @pg_exec($this->_connectionID,$exsql);
drivers/adodb-postgres64.inc.php:				$s = "PREPARE $plan ($params) AS ".substr($sql,0,strlen($sql)-2);		
drivers/adodb-postgres64.inc.php:				pg_exec($this->_connectionID,$s);
drivers/adodb-postgres64.inc.php:				echo $this->ErrorMsg();
drivers/adodb-postgres64.inc.php:			$rez = pg_exec($this->_connectionID,$exsql);
drivers/adodb-postgres64.inc.php:			$this->_errorMsg = false;
drivers/adodb-postgres64.inc.php:			$rez = pg_exec($this->_connectionID,$sql);
drivers/adodb-postgres64.inc.php:			if (is_resource($this->_resultid) && get_resource_type($this->_resultid) === 'pgsql result') {
drivers/adodb-postgres64.inc.php:				pg_freeresult($this->_resultid);
drivers/adodb-postgres64.inc.php:			$this->_resultid = $rez;
drivers/adodb-postgres64.inc.php:		if ($this->_errorMsg !== false) return $this->_errorMsg;
drivers/adodb-postgres64.inc.php:			if (!empty($this->_resultid)) {
drivers/adodb-postgres64.inc.php:				$this->_errorMsg = @pg_result_error($this->_resultid);
drivers/adodb-postgres64.inc.php:				if ($this->_errorMsg) return $this->_errorMsg;
drivers/adodb-postgres64.inc.php:			if (!empty($this->_connectionID)) {
drivers/adodb-postgres64.inc.php:				$this->_errorMsg = @pg_last_error($this->_connectionID);
drivers/adodb-postgres64.inc.php:			} else $this->_errorMsg = @pg_last_error();
drivers/adodb-postgres64.inc.php:			if (empty($this->_connectionID)) $this->_errorMsg = @pg_errormessage();
drivers/adodb-postgres64.inc.php:			else $this->_errorMsg = @pg_errormessage($this->_connectionID);
drivers/adodb-postgres64.inc.php:		return $this->_errorMsg;
drivers/adodb-postgres64.inc.php:		$e = $this->ErrorMsg();
drivers/adodb-postgres64.inc.php:		if ($this->transCnt) $this->RollbackTrans();
drivers/adodb-postgres64.inc.php:		if ($this->_resultid) {
drivers/adodb-postgres64.inc.php:			@pg_freeresult($this->_resultid);
drivers/adodb-postgres64.inc.php:			$this->_resultid = false;
drivers/adodb-postgres64.inc.php:		@pg_close($this->_connectionID);
drivers/adodb-postgres64.inc.php:		$this->_connectionID = false;
drivers/adodb-postgres64.inc.php:/*--------------------------------------------------------------------------------------
drivers/adodb-postgres64.inc.php:--------------------------------------------------------------------------------------*/
drivers/adodb-postgres64.inc.php:		case ADODB_FETCH_NUM: $this->fetchMode = PGSQL_NUM; break;
drivers/adodb-postgres64.inc.php:		case ADODB_FETCH_ASSOC:$this->fetchMode = PGSQL_ASSOC; break;
drivers/adodb-postgres64.inc.php:		case ADODB_FETCH_BOTH:$this->fetchMode = PGSQL_BOTH; break;
drivers/adodb-postgres64.inc.php:		$this->adodbFetchMode = $mode;
drivers/adodb-postgres64.inc.php:		$this->ADORecordSet($queryID);
drivers/adodb-postgres64.inc.php:		if ($this->fetchMode == PGSQL_ASSOC && !$upper) return $this->fields;
drivers/adodb-postgres64.inc.php:		$qid = $this->_queryID;
drivers/adodb-postgres64.inc.php:		$this->_numOfRows = ($ADODB_COUNTRECS)? @pg_numrows($qid):-1;
drivers/adodb-postgres64.inc.php:		$this->_numOfFields = @pg_numfields($qid);
drivers/adodb-postgres64.inc.php:		for ($i=0, $max = $this->_numOfFields; $i < $max; $i++) {  
drivers/adodb-postgres64.inc.php:				$this->_blobArr[$i] = pg_fieldname($qid,$i);
drivers/adodb-postgres64.inc.php:		if ($this->fetchMode != PGSQL_NUM) return @$this->fields[$colname];
drivers/adodb-postgres64.inc.php:		if (!$this->bind) {
drivers/adodb-postgres64.inc.php:			$this->bind = array();
drivers/adodb-postgres64.inc.php:			for ($i=0; $i < $this->_numOfFields; $i++) {
drivers/adodb-postgres64.inc.php:				$o = $this->FetchField($i);
drivers/adodb-postgres64.inc.php:				$this->bind[strtoupper($o->name)] = $i;
drivers/adodb-postgres64.inc.php:		 return $this->fields[$this->bind[strtoupper($colname)]];
drivers/adodb-postgres64.inc.php:		$o->name = @pg_fieldname($this->_queryID,$off);
drivers/adodb-postgres64.inc.php:		$o->type = @pg_fieldtype($this->_queryID,$off);
drivers/adodb-postgres64.inc.php:		$o->max_length = @pg_fieldsize($this->_queryID,$off);
drivers/adodb-postgres64.inc.php:		return @pg_fetch_row($this->_queryID,$row);
drivers/adodb-postgres64.inc.php:		if ($this->fetchMode == PGSQL_NUM || $this->fetchMode == PGSQL_BOTH) {
drivers/adodb-postgres64.inc.php:			foreach($this->_blobArr as $k => $v) {
drivers/adodb-postgres64.inc.php:				$this->fields[$k] = ADORecordSet_postgres64::_decode($this->fields[$k]);
drivers/adodb-postgres64.inc.php:		if ($this->fetchMode == PGSQL_ASSOC || $this->fetchMode == PGSQL_BOTH) {
drivers/adodb-postgres64.inc.php:			foreach($this->_blobArr as $k => $v) {
drivers/adodb-postgres64.inc.php:				$this->fields[$v] = ADORecordSet_postgres64::_decode($this->fields[$v]);
drivers/adodb-postgres64.inc.php:		if (!$this->EOF) {
drivers/adodb-postgres64.inc.php:			$this->_currentRow++;
drivers/adodb-postgres64.inc.php:			if ($this->_numOfRows < 0 || $this->_numOfRows > $this->_currentRow) {
drivers/adodb-postgres64.inc.php:				$this->fields = @pg_fetch_array($this->_queryID,$this->_currentRow,$this->fetchMode);
drivers/adodb-postgres64.inc.php:				if (is_array($this->fields) && $this->fields) {
drivers/adodb-postgres64.inc.php:					if (isset($this->_blobArr)) $this->_fixblobs();
drivers/adodb-postgres64.inc.php:			$this->fields = false;
drivers/adodb-postgres64.inc.php:			$this->EOF = true;
drivers/adodb-postgres64.inc.php:		if ($this->_currentRow >= $this->_numOfRows && $this->_numOfRows >= 0)
drivers/adodb-postgres64.inc.php:		$this->fields = @pg_fetch_array($this->_queryID,$this->_currentRow,$this->fetchMode);
drivers/adodb-postgres64.inc.php:	if ($this->fields && isset($this->_blobArr)) $this->_fixblobs();
drivers/adodb-postgres64.inc.php:		return (is_array($this->fields));
drivers/adodb-postgres64.inc.php:		return @pg_freeresult($this->_queryID);
drivers/adodb-postgres64.inc.php:	function MetaType($t,$len=-1,$fieldobj=false)
drivers/adodb-postgres64.inc.php:			$t = $fieldobj->type;
drivers/adodb-postgres64.inc.php:			$len = $fieldobj->max_length;
drivers/adodb-postgres64.inc.php:					if ($len <= $this->blobSize) return 'C';
drivers/adodb-postgres64.inc.php:				empty($fieldobj->primary_key) && empty($fieldobj->unique)) return 'I';
drivers/adodb-odbtp_unicode.inc.php:	V4.54 5 Nov 2004  (c) 2000-2004 John Lim (jlim@natsoft.com.my). All rights reserved.
drivers/adodb-odbtp_unicode.inc.php:// security - hide paths
drivers/adodb-odbtp_unicode.inc.php:    Because the ODBTP server sends and reads UNICODE text data using UTF-8
drivers/adodb-odbtp_unicode.inc.php:    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
drivers/adodb-odbtp_unicode.inc.php:    Also, all SQL query strings must be submitted as UTF-8 encoded text.
drivers/adodb-odbtp_unicode.inc.php:	include(ADODB_DIR."/drivers/adodb-odbtp.inc.php");
drivers/adodb-odbtp_unicode.inc.php:		$this->ADODB_odbtp();
drivers/adodb-mssqlpo.inc.php:* @version V4.54 5 Nov 2004 (c) 2000-2004 John Lim (jlim@natsoft.com.my). All rights reserved.
drivers/adodb-mssqlpo.inc.php:// security - hide paths
drivers/adodb-mssqlpo.inc.php:include_once(ADODB_DIR.'/drivers/adodb-mssql.inc.php');
drivers/adodb-mssqlpo.inc.php:		if (!$this->_has_mssql_init) {
drivers/adodb-mssqlpo.inc.php:		$stmt = mssql_init($sql,$this->_connectionID);
drivers/adodb-mssqlpo.inc.php:		$this->ADORecordset_mssql($id,$mode);
drivers/adodb-ado.inc.php:V4.54 5 Nov 2004  (c) 2000-2004 John Lim (jlim@natsoft.com.my). All rights reserved.
drivers/adodb-ado.inc.php:// security - hide paths
drivers/adodb-ado.inc.php:/*--------------------------------------------------------------------------------------
drivers/adodb-ado.inc.php:--------------------------------------------------------------------------------------*/
drivers/adodb-ado.inc.php:	var $fmtDate = "'Y-m-d'";
drivers/adodb-ado.inc.php:	var $fmtTimeStamp = "'Y-m-d, h:i:sA'";
drivers/adodb-ado.inc.php:	var $_lock_type = -1;
drivers/adodb-ado.inc.php:	var $_execute_option = -1;
drivers/adodb-ado.inc.php:		$this->_affectedRows = new VARIANT;
drivers/adodb-ado.inc.php:		if (!empty($this->_connectionID)) $desc = $this->_connectionID->provider;
drivers/adodb-ado.inc.php:		if (PHP_VERSION >= 5) return $this->_affectedRows;
drivers/adodb-ado.inc.php:		return $this->_affectedRows->value;
drivers/adodb-ado.inc.php:	// $DB->Connect('USER ID=sa;PASSWORD=pwd;SERVER=mangrove;DATABASE=ai',false,false,'SQLOLEDB');
drivers/adodb-ado.inc.php:		if (!empty($this->charPage))
drivers/adodb-ado.inc.php:			$dbc = new COM('ADODB.Connection',null,$this->charPage);
drivers/adodb-ado.inc.php:		if ($argProvider) $dbc->Provider = $argProvider;	
drivers/adodb-ado.inc.php:		if ($this->debug) ADOConnection::outp( "Host=".$argHostname."<BR>\n version=$dbc->version");
drivers/adodb-ado.inc.php:		@$dbc->Open((string) $argHostname);
drivers/adodb-ado.inc.php:		$this->_connectionID = $dbc;
drivers/adodb-ado.inc.php:		$dbc->CursorLocation = $this->_cursor_location;
drivers/adodb-ado.inc.php:		return  $dbc->State > 0;
drivers/adodb-ado.inc.php:		return $this->_connect($argHostname,$argUsername,$argPassword,$argProvider);
drivers/adodb-ado.inc.php:		$dbc = $this->_connectionID;
drivers/adodb-ado.inc.php:		$adors=@$dbc->OpenSchema(20);//tables
drivers/adodb-ado.inc.php:			$f = $adors->Fields(2);//table/view name
drivers/adodb-ado.inc.php:			$t = $adors->Fields(3);//table type
drivers/adodb-ado.inc.php:			while (!$adors->EOF){
drivers/adodb-ado.inc.php:				$tt=substr($t->value,0,6);
drivers/adodb-ado.inc.php:					$arr[]=$f->value;
drivers/adodb-ado.inc.php:				//print $f->value . ' ' . $t->value.'<br>';
drivers/adodb-ado.inc.php:				$adors->MoveNext();
drivers/adodb-ado.inc.php:			$adors->Close();
drivers/adodb-ado.inc.php:		$dbc = $this->_connectionID;
drivers/adodb-ado.inc.php:		$adors=@$dbc->OpenSchema(4);//tables
drivers/adodb-ado.inc.php:			$t = $adors->Fields(2);//table/view name
drivers/adodb-ado.inc.php:			while (!$adors->EOF){
drivers/adodb-ado.inc.php:				if (strtoupper($t->Value) == $table) {
drivers/adodb-ado.inc.php:					$c = $adors->Fields(3);
drivers/adodb-ado.inc.php:					$fld->name = $c->Value;
drivers/adodb-ado.inc.php:					$fld->type = 'CHAR'; // cannot discover type in ADO!
drivers/adodb-ado.inc.php:					$fld->max_length = -1;
drivers/adodb-ado.inc.php:					$arr[strtoupper($fld->name)]=$fld;
drivers/adodb-ado.inc.php:				$adors->MoveNext();
drivers/adodb-ado.inc.php:			$adors->Close();
drivers/adodb-ado.inc.php:		$dbc = $this->_connectionID;
drivers/adodb-ado.inc.php:			if (!empty($this->charPage))
drivers/adodb-ado.inc.php:				$oCmd = new COM('ADODB.Command',null,$this->charPage);
drivers/adodb-ado.inc.php:			$oCmd->ActiveConnection = $dbc;
drivers/adodb-ado.inc.php:			$oCmd->CommandText = $sql;
drivers/adodb-ado.inc.php:			$oCmd->CommandType = 1;
drivers/adodb-ado.inc.php:				$this->adoParameterType = 130;
drivers/adodb-ado.inc.php:				$p = $oCmd->CreateParameter('name',$this->adoParameterType,1,strlen($val),$val);
drivers/adodb-ado.inc.php:				//print $p->Type.' '.$p->value;
drivers/adodb-ado.inc.php:				$oCmd->Parameters->Append($p);
drivers/adodb-ado.inc.php:			$rs = $oCmd->Execute();
drivers/adodb-ado.inc.php:			$e = $dbc->Errors;
drivers/adodb-ado.inc.php:			if ($dbc->Errors->Count > 0) return $false;
drivers/adodb-ado.inc.php:		$rs = @$dbc->Execute($sql,$this->_affectedRows, $this->_execute_option);
drivers/adodb-ado.inc.php:		if ($dbc->Errors->Count > 0) return $false;
drivers/adodb-ado.inc.php:		if ($rs->State == 0) {
drivers/adodb-ado.inc.php:		if ($this->transOff) return true;
drivers/adodb-ado.inc.php:		if (isset($this->_thisTransactions))
drivers/adodb-ado.inc.php:			if (!$this->_thisTransactions) return false;
drivers/adodb-ado.inc.php:			$o = $this->_connectionID->Properties("Transaction DDL");
drivers/adodb-ado.inc.php:			$this->_thisTransactions = $o ? true : false;
drivers/adodb-ado.inc.php:		@$this->_connectionID->BeginTrans();
drivers/adodb-ado.inc.php:		$this->transCnt += 1;
drivers/adodb-ado.inc.php:		if (!$ok) return $this->RollbackTrans();
drivers/adodb-ado.inc.php:		if ($this->transOff) return true;
drivers/adodb-ado.inc.php:		@$this->_connectionID->CommitTrans();
drivers/adodb-ado.inc.php:		if ($this->transCnt) @$this->transCnt -= 1;
drivers/adodb-ado.inc.php:		if ($this->transOff) return true;
drivers/adodb-ado.inc.php:		@$this->_connectionID->RollbackTrans();
drivers/adodb-ado.inc.php:		if ($this->transCnt) @$this->transCnt -= 1;
drivers/adodb-ado.inc.php:		$errc = $this->_connectionID->Errors;
drivers/adodb-ado.inc.php:		if ($errc->Count == 0) return '';
drivers/adodb-ado.inc.php:		$err = $errc->Item($errc->Count-1);
drivers/adodb-ado.inc.php:		return $err->Description;
drivers/adodb-ado.inc.php:		$errc = $this->_connectionID->Errors;
drivers/adodb-ado.inc.php:		if ($errc->Count == 0) return 0;
drivers/adodb-ado.inc.php:		$err = $errc->Item($errc->Count-1);
drivers/adodb-ado.inc.php:		return $err->NativeError;
drivers/adodb-ado.inc.php:		if ($this->_connectionID) $this->_connectionID->Close();
drivers/adodb-ado.inc.php:		$this->_connectionID = false;
drivers/adodb-ado.inc.php:/*--------------------------------------------------------------------------------------
drivers/adodb-ado.inc.php:--------------------------------------------------------------------------------------*/
drivers/adodb-ado.inc.php:		$this->fetchMode = $mode;
drivers/adodb-ado.inc.php:		return $this->ADORecordSet($id,$mode);
drivers/adodb-ado.inc.php:	function FetchField($fieldOffset = -1) {
drivers/adodb-ado.inc.php:		$rs = $this->_queryID;
drivers/adodb-ado.inc.php:		$f = $rs->Fields($fieldOffset);
drivers/adodb-ado.inc.php:		$o->name = $f->Name;
drivers/adodb-ado.inc.php:		$t = $f->Type;
drivers/adodb-ado.inc.php:		$o->type = $this->MetaType($t);
drivers/adodb-ado.inc.php:		$o->max_length = $f->DefinedSize;
drivers/adodb-ado.inc.php:		$o->ado_type = $t;
drivers/adodb-ado.inc.php:		//print "off=$off name=$o->name type=$o->type len=$o->max_length<br>";
drivers/adodb-ado.inc.php:		if ($this->fetchMode & ADODB_FETCH_ASSOC) return $this->fields[$colname];
drivers/adodb-ado.inc.php:		if (!$this->bind) {
drivers/adodb-ado.inc.php:			$this->bind = array();
drivers/adodb-ado.inc.php:			for ($i=0; $i < $this->_numOfFields; $i++) {
drivers/adodb-ado.inc.php:				$o = $this->FetchField($i);
drivers/adodb-ado.inc.php:				$this->bind[strtoupper($o->name)] = $i;
drivers/adodb-ado.inc.php:		 return $this->fields[$this->bind[strtoupper($colname)]];
drivers/adodb-ado.inc.php:		$rs = $this->_queryID;
drivers/adodb-ado.inc.php:		$this->_numOfRows = $rs->RecordCount;
drivers/adodb-ado.inc.php:		$f = $rs->Fields;
drivers/adodb-ado.inc.php:		$this->_numOfFields = $f->Count;
drivers/adodb-ado.inc.php:	 // should only be used to move forward as we normally use forward-only cursors
drivers/adodb-ado.inc.php:	   $rs = $this->_queryID; 
drivers/adodb-ado.inc.php:		// absoluteposition doesn't work -- my maths is wrong ?
drivers/adodb-ado.inc.php:		//	$rs->AbsolutePosition->$row-2;
drivers/adodb-ado.inc.php:		if ($this->_currentRow > $row) return false;
drivers/adodb-ado.inc.php:		@$rs->Move((integer)$row - $this->_currentRow-1); //adBookmarkFirst
drivers/adodb-ado.inc.php:	function MetaType($t,$len=-1,$fieldobj=false)
drivers/adodb-ado.inc.php:			$t = $fieldobj->type;
drivers/adodb-ado.inc.php:			$len = $fieldobj->max_length;
drivers/adodb-ado.inc.php:			if ($len <= $this->blobSize) return 'C';
drivers/adodb-ado.inc.php:		$rs = $this->_queryID;
drivers/adodb-ado.inc.php:		if (!$rs or $rs->EOF) {
drivers/adodb-ado.inc.php:			$this->fields = false;
drivers/adodb-ado.inc.php:		$this->fields = array();
drivers/adodb-ado.inc.php:		if (!$this->_tarr) {
drivers/adodb-ado.inc.php:			for ($i=0,$max = $this->_numOfFields; $i < $max; $i++) {
drivers/adodb-ado.inc.php:				$f = $rs->Fields($i);
drivers/adodb-ado.inc.php:				$tarr[] = $f->Type;
drivers/adodb-ado.inc.php:			$this->_tarr = $tarr; 
drivers/adodb-ado.inc.php:			$this->_flds = $flds;
drivers/adodb-ado.inc.php:		$t = reset($this->_tarr);
drivers/adodb-ado.inc.php:		$f = reset($this->_flds);
drivers/adodb-ado.inc.php:		if ($this->hideErrors)  $olde = error_reporting(E_ERROR|E_CORE_ERROR);// sometimes $f->value be null
drivers/adodb-ado.inc.php:		for ($i=0,$max = $this->_numOfFields; $i < $max; $i++) {
drivers/adodb-ado.inc.php:			//echo "<p>",$t,' ';var_dump($f->value); echo '</p>';
drivers/adodb-ado.inc.php:				if (!strlen((string)$f->value)) $this->fields[] = false;
drivers/adodb-ado.inc.php:					if (!is_numeric($f->value)) $val = variant_date_to_timestamp($f->value);
drivers/adodb-ado.inc.php:					else $val = $f->value;
drivers/adodb-ado.inc.php:					$this->fields[] = adodb_date('Y-m-d H:i:s',$val);
drivers/adodb-ado.inc.php:				if ($val = $f->value) {
drivers/adodb-ado.inc.php:					$this->fields[] = substr($val,0,4).'-'.substr($val,4,2).'-'.substr($val,6,2);
drivers/adodb-ado.inc.php:					$this->fields[] = false;
drivers/adodb-ado.inc.php:				if (!strlen((string)$f->value)) $this->fields[] = false;
drivers/adodb-ado.inc.php:					if (!is_numeric($f->value)) $val = variant_date_to_timestamp($f->value);
drivers/adodb-ado.inc.php:					else $val = $f->value;
drivers/adodb-ado.inc.php:					if (($val % 86400) == 0) $this->fields[] = adodb_date('Y-m-d',$val);
drivers/adodb-ado.inc.php:					else $this->fields[] = adodb_date('Y-m-d H:i:s',$val);
drivers/adodb-ado.inc.php:				$this->fields[] = false;
drivers/adodb-ado.inc.php:				ADOConnection::outp( '<b>'.$f->Name.': currency type not supported by PHP</b>');
drivers/adodb-ado.inc.php:				$this->fields[] = (float) $f->value;
drivers/adodb-ado.inc.php:				$this->fields[] = $f->value; 
drivers/adodb-ado.inc.php:			//print " $f->value $t, ";
drivers/adodb-ado.inc.php:			$f = next($this->_flds);
drivers/adodb-ado.inc.php:			$t = next($this->_tarr);
drivers/adodb-ado.inc.php:		if ($this->hideErrors) error_reporting($olde);
drivers/adodb-ado.inc.php:		@$rs->MoveNext(); // @ needed for some versions of PHP!
drivers/adodb-ado.inc.php:		if ($this->fetchMode & ADODB_FETCH_ASSOC) {
drivers/adodb-ado.inc.php:			$this->fields = &$this->GetRowAssoc(ADODB_ASSOC_CASE);
drivers/adodb-ado.inc.php:			$rs = $this->_queryID;
drivers/adodb-ado.inc.php:			$this->_queryID = $rs->NextRecordSet();
drivers/adodb-ado.inc.php:			//$this->_queryID = $this->_QueryId->NextRecordSet();
drivers/adodb-ado.inc.php:			if ($this->_queryID == null) return false;
drivers/adodb-ado.inc.php:			$this->_currentRow = -1;
drivers/adodb-ado.inc.php:			$this->_currentPage = -1;
drivers/adodb-ado.inc.php:			$this->bind = false;
drivers/adodb-ado.inc.php:			$this->fields = false;
drivers/adodb-ado.inc.php:			$this->_flds = false;
drivers/adodb-ado.inc.php:			$this->_tarr = false;
drivers/adodb-ado.inc.php:			$this->_inited = false;
drivers/adodb-ado.inc.php:			$this->Init();
drivers/adodb-ado.inc.php:		$this->_flds = false;
drivers/adodb-ado.inc.php:		@$this->_queryID->Close();// by Pete Dishman (peterd@telephonetics.co.uk)
drivers/adodb-ado.inc.php:		$this->_queryID = false;	
drivers/adodb-oci8po.inc.php:V4.54 5 Nov 2004  (c) 2000-2004 John Lim. All rights reserved.
drivers/adodb-oci8po.inc.php:// security - hide paths
drivers/adodb-oci8po.inc.php:include_once(ADODB_DIR.'/drivers/adodb-oci8.inc.php');
drivers/adodb-oci8po.inc.php:		$this->_hasOCIFetchStatement = ADODB_PHPVER >= 0x4200;
drivers/adodb-oci8po.inc.php:			$sql .=  ':'.($i-1) . $sqlarr[$i];
drivers/adodb-oci8po.inc.php:/*--------------------------------------------------------------------------------------
drivers/adodb-oci8po.inc.php:--------------------------------------------------------------------------------------*/
drivers/adodb-oci8po.inc.php:		$this->ADORecordset_oci8($queryID,$mode);
drivers/adodb-oci8po.inc.php:		if ($this->fetchMode & OCI_ASSOC) return $this->fields[$colname];
drivers/adodb-oci8po.inc.php:		if (!$this->bind) {
drivers/adodb-oci8po.inc.php:			$this->bind = array();
drivers/adodb-oci8po.inc.php:			for ($i=0; $i < $this->_numOfFields; $i++) {
drivers/adodb-oci8po.inc.php:				$o = $this->FetchField($i);
drivers/adodb-oci8po.inc.php:				$this->bind[strtoupper($o->name)] = $i;
drivers/adodb-oci8po.inc.php:		 return $this->fields[$this->bind[strtoupper($colname)]];
drivers/adodb-oci8po.inc.php:	function &_FetchField($fieldOffset = -1)
drivers/adodb-oci8po.inc.php:		 $fld->name = strtolower(OCIcolumnname($this->_queryID, $fieldOffset));
drivers/adodb-oci8po.inc.php:		 $fld->type = OCIcolumntype($this->_queryID, $fieldOffset);
drivers/adodb-oci8po.inc.php:		 $fld->max_length = OCIcolumnsize($this->_queryID, $fieldOffset);
drivers/adodb-oci8po.inc.php:		 if ($fld->type == 'NUMBER') {
drivers/adodb-oci8po.inc.php:		 	//$p = OCIColumnPrecision($this->_queryID, $fieldOffset);
drivers/adodb-oci8po.inc.php:			$sc = OCIColumnScale($this->_queryID, $fieldOffset);
drivers/adodb-oci8po.inc.php:			if ($sc == 0) $fld->type = 'INT';
drivers/adodb-oci8po.inc.php:		if (@OCIfetchinto($this->_queryID,$this->fields,$this->fetchMode)) {
drivers/adodb-oci8po.inc.php:			$this->_currentRow += 1;
drivers/adodb-oci8po.inc.php:		if (!$this->EOF) {
drivers/adodb-oci8po.inc.php:			$this->_currentRow += 1;
drivers/adodb-oci8po.inc.php:			$this->EOF = true;
drivers/adodb-oci8po.inc.php:		if(@OCIfetchinto($this->_queryID,$this->fields,$this->fetchMode)) {
drivers/adodb-oci8po.inc.php:			$this->_currentRow++;
drivers/adodb-oci8po.inc.php:			if ($this->fetchMode & OCI_ASSOC) $this->_updatefields();
drivers/adodb-oci8po.inc.php:				foreach($this->fields as $k => $v) {
drivers/adodb-oci8po.inc.php:					if (is_string($v)) $this->fields[$k] = rtrim($v);
drivers/adodb-oci8po.inc.php:		if (!$this->EOF) {
drivers/adodb-oci8po.inc.php:			$this->EOF = true;
drivers/adodb-oci8po.inc.php:			$this->_currentRow++;
drivers/adodb-oci8po.inc.php:	function &GetArrayLimit($nrows,$offset=-1) 
drivers/adodb-oci8po.inc.php:		if ($offset <= 0) return $this->GetArray($nrows);
drivers/adodb-oci8po.inc.php:			if (!@OCIFetch($this->_queryID)) return array();
drivers/adodb-oci8po.inc.php:		if (!@OCIfetchinto($this->_queryID,$this->fields,$this->fetchMode)) return array();
drivers/adodb-oci8po.inc.php:		if ($this->fetchMode & OCI_ASSOC) $this->_updatefields();
drivers/adodb-oci8po.inc.php:		while (!$this->EOF && $nrows != $cnt) {
drivers/adodb-oci8po.inc.php:			$results[$cnt++] = $this->fields;
drivers/adodb-oci8po.inc.php:			$this->MoveNext();
drivers/adodb-oci8po.inc.php:		foreach($this->fields as $k => $v) {
drivers/adodb-oci8po.inc.php:		$this->fields = $arr;
drivers/adodb-oci8po.inc.php:		$ret = @OCIfetchinto($this->_queryID,$this->fields,$this->fetchMode);
drivers/adodb-oci8po.inc.php:				if ($this->fetchMode & OCI_ASSOC) $this->_updatefields();
drivers/adodb-oci8po.inc.php:					foreach($this->fields as $k => $v) {
drivers/adodb-oci8po.inc.php:						if (is_string($v)) $this->fields[$k] = rtrim($v);
drivers/adodb-pdo.inc.php:V4.54 5 Nov 2004  (c) 2000-2004 John Lim (jlim#natsoft.com.my). All rights reserved.
drivers/adodb-pdo.inc.php:// security - hide paths
drivers/adodb-pdo.inc.php:/*--------------------------------------------------------------------------------------
drivers/adodb-pdo.inc.php:--------------------------------------------------------------------------------------*/
drivers/adodb-pdo.inc.php:	var $fmtDate = "'Y-m-d'";
drivers/adodb-pdo.inc.php:	var $fmtTimeStamp = "'Y-m-d, h:i:sA'";
drivers/adodb-pdo.inc.php:		$this->_connectionID = new PDO($argDSN, $argUsername, $argPassword);
drivers/adodb-pdo.inc.php:		if ($this->_connectionID) {
drivers/adodb-pdo.inc.php:			//$this->_connectionID->setAttribute(PDO_ATTR_ERRMODE,PDO_ERRMODE_SILENT );
drivers/adodb-pdo.inc.php:			$this->_connectionID->setAttribute(PDO_ATTR_CASE,$m);
drivers/adodb-pdo.inc.php:			//$this->_connectionID->setAttribute(PDO_ATTR_AUTOCOMMIT,true);
drivers/adodb-pdo.inc.php:		return $this->_connect($argDSN, $argUsername, $argPassword, $argDatabasename, true);
drivers/adodb-pdo.inc.php:		if ($this->_stmt) $arr = $this->_stmt->errorInfo();
drivers/adodb-pdo.inc.php:		else $arr = $this->_connectionID->errorInfo();
drivers/adodb-pdo.inc.php:		} else return '-1';
drivers/adodb-pdo.inc.php:		if ($type) $obj->bindParam($name,$var,$type,$maxLen);
drivers/adodb-pdo.inc.php:		else $obj->bindParam($name, $var);
drivers/adodb-pdo.inc.php:		if ($this->_stmt) return $this->_stmt->errorCode();
drivers/adodb-pdo.inc.php:		else return $this->_connectionID->errorInfo();
drivers/adodb-pdo.inc.php:		if (!$this->hasTransactions) return false;
drivers/adodb-pdo.inc.php:		if ($this->transOff) return true; 
drivers/adodb-pdo.inc.php:		$this->transCnt += 1;
drivers/adodb-pdo.inc.php:		$this->_autocommit = false;
drivers/adodb-pdo.inc.php:		$this->_connectionID->setAttribute(PDO_ATTR_AUTOCOMMIT,false);
drivers/adodb-pdo.inc.php:		return $this->_connectionID->beginTransaction();
drivers/adodb-pdo.inc.php:		if ($this->transOff) return true; 
drivers/adodb-pdo.inc.php:		if (!$ok) return $this->RollbackTrans();
drivers/adodb-pdo.inc.php:		if ($this->transCnt) $this->transCnt -= 1;
drivers/adodb-pdo.inc.php:		$this->_autocommit = true;
drivers/adodb-pdo.inc.php:		$ret = $this->_connectionID->commit();
drivers/adodb-pdo.inc.php:		$this->_connectionID->setAttribute(PDO_ATTR_AUTOCOMMIT,true);
drivers/adodb-pdo.inc.php:		if ($this->transOff) return true; 
drivers/adodb-pdo.inc.php:		if ($this->transCnt) $this->transCnt -= 1;
drivers/adodb-pdo.inc.php:		$this->_autocommit = true;
drivers/adodb-pdo.inc.php:		$ret = $this->_connectionID->rollback();
drivers/adodb-pdo.inc.php:		$this->_connectionID->setAttribute(PDO_ATTR_AUTOCOMMIT,true);
drivers/adodb-pdo.inc.php:		$this->_stmt = $this->_connectionID->prepare($sql);
drivers/adodb-pdo.inc.php:		if ($this->_stmt) return array($sql,$this->_stmt);
drivers/adodb-pdo.inc.php:		$stmt = $this->_connectionID->prepare($sql);
drivers/adodb-pdo.inc.php:			$stmt = $this->_connectionID->prepare($sql);		
drivers/adodb-pdo.inc.php:			if ($inputarr) $stmt->execute($inputarr);
drivers/adodb-pdo.inc.php:			else $stmt->execute();
drivers/adodb-pdo.inc.php:		$this->_stmt = $stmt;
drivers/adodb-pdo.inc.php:		$this->_stmt = false;
drivers/adodb-pdo.inc.php:		return ($this->_stmt) ? $this->_stmt->rowCount() : 0;
drivers/adodb-pdo.inc.php:		return ($this->_connectionID) ? $this->_connectionID->lastInsertId() : 0;
drivers/adodb-pdo.inc.php:		$this->_stmt = $stmt;
drivers/adodb-pdo.inc.php:		$this->_connectionID = $connection;
drivers/adodb-pdo.inc.php:		$savestmt = $this->_connectionID->_stmt;
drivers/adodb-pdo.inc.php:		$rs = $this->_connectionID->Execute(array(false,$this->_stmt),$inputArr);
drivers/adodb-pdo.inc.php:		$this->_connectionID->_stmt = $savestmt;
drivers/adodb-pdo.inc.php:		if ($type) $this->_stmt->bindParam($name,$var,$type,$maxLen);
drivers/adodb-pdo.inc.php:		else $this->_stmt->bindParam($name, $var);
drivers/adodb-pdo.inc.php:		return ($this->_stmt) ? $this->_stmt->rowCount() : 0;
drivers/adodb-pdo.inc.php:		if ($this->_stmt) $arr = $this->_stmt->errorInfo();
drivers/adodb-pdo.inc.php:		else $arr = $this->_connectionID->errorInfo();
drivers/adodb-pdo.inc.php:		} else return '-1';
drivers/adodb-pdo.inc.php:		if ($this->_stmt) return $this->_stmt->errorCode();
drivers/adodb-pdo.inc.php:		else return $this->_connectionID->errorInfo();
drivers/adodb-pdo.inc.php:/*--------------------------------------------------------------------------------------
drivers/adodb-pdo.inc.php:--------------------------------------------------------------------------------------*/
drivers/adodb-pdo.inc.php:		$this->fetchMode = $mode;
drivers/adodb-pdo.inc.php:		$this->_queryID = $id;
drivers/adodb-pdo.inc.php:		$this->ADORecordSet($id);
drivers/adodb-pdo.inc.php:	function &FetchField($fieldOffset = -1) 
drivers/adodb-pdo.inc.php:		$o->name = @odbc_field_name($this->_queryID,$off);
drivers/adodb-pdo.inc.php:		$o->type = @odbc_field_type($this->_queryID,$off);
drivers/adodb-pdo.inc.php:		$o->max_length = @odbc_field_len($this->_queryID,$off);
drivers/adodb-pdo.inc.php:		if (ADODB_ASSOC_CASE == 0) $o->name = strtolower($o->name);
drivers/adodb-pdo.inc.php:		else if (ADODB_ASSOC_CASE == 1) $o->name = strtoupper($o->name);
drivers/adodb-pdo.inc.php:		if ($this->_inited) return;
drivers/adodb-pdo.inc.php:		$this->_inited = true;
drivers/adodb-pdo.inc.php:		if ($this->_queryID) @$this->_initrs();
drivers/adodb-pdo.inc.php:			$this->_numOfRows = 0;
drivers/adodb-pdo.inc.php:			$this->_numOfFields = 0;
drivers/adodb-pdo.inc.php:		if ($this->_numOfRows != 0 && $this->_currentRow == -1) {
drivers/adodb-pdo.inc.php:			$this->_currentRow = 0;
drivers/adodb-pdo.inc.php:			if ($this->EOF = ($this->_fetch() === false)) {
drivers/adodb-pdo.inc.php:				$this->_numOfRows = 0; // _numOfRows could be -1
drivers/adodb-pdo.inc.php:			$this->_numOfFields = sizeof($this->fields);
drivers/adodb-pdo.inc.php:			$this->EOF = true;
drivers/adodb-pdo.inc.php:		$this->_numOfRows = ($ADODB_COUNTRECS) ? @$this->_queryID->rowCount() : -1;
drivers/adodb-pdo.inc.php:		if (!$this->_numOfRows) $this->_numOfRows = -1;
drivers/adodb-pdo.inc.php:		$this->_numOfFields =0;
drivers/adodb-pdo.inc.php:		$this->fields = $this->_queryID->fetch($this->fetchMode);
drivers/adodb-pdo.inc.php:		return !empty($this->fields);
drivers/adodb-pdo.inc.php:		$this->_queryID = false;
drivers/adodb-ibase.inc.php:V4.54 5 Nov 2004  (c) 2000-2004 John Lim (jlim@natsoft.com.my). All rights reserved.  
drivers/adodb-ibase.inc.php:  3 Jan 2002 -- suggestions by Hans-Peter Oeri <kampfcaspar75@oeri.ch>
drivers/adodb-ibase.inc.php:   $rs = $conn->Execute('select gen_id(adodb,1) from rdb$database');
drivers/adodb-ibase.inc.php:   $id = $rs->fields[0];
drivers/adodb-ibase.inc.php:   $conn->Execute("insert into table (id, col1,...) values ($id, $val1,...)");
drivers/adodb-ibase.inc.php:// security - hide paths
drivers/adodb-ibase.inc.php:	var $ibase_datefmt = '%Y-%m-%d'; // For hours,mins,secs change to '%Y-%m-%d %H:%M:%S';
drivers/adodb-ibase.inc.php:	var $fmtDate = "'Y-m-d'";
drivers/adodb-ibase.inc.php:	var $ibase_timestampfmt = "%Y-%m-%d %H:%M:%S";
drivers/adodb-ibase.inc.php:	var $fmtTimeStamp = "'Y-m-d, H:i:s'";
drivers/adodb-ibase.inc.php:		 if (defined('IBASE_DEFAULT')) $this->ibasetrans = IBASE_DEFAULT;
drivers/adodb-ibase.inc.php:		$this->_connectionID = $fn($argHostname,$argUsername,$argPassword,
drivers/adodb-ibase.inc.php:					$this->charSet,$this->buffers,$this->dialect);
drivers/adodb-ibase.inc.php:		if ($this->dialect != 1) { // http://www.ibphoenix.com/ibp_60_del_id_ds.html
drivers/adodb-ibase.inc.php:			$this->replaceQuote = "''";
drivers/adodb-ibase.inc.php:		if ($this->_connectionID === false) {
drivers/adodb-ibase.inc.php:			$this->_handleerror();
drivers/adodb-ibase.inc.php:			ibase_timefmt($this->ibase_datefmt,IBASE_DATE );
drivers/adodb-ibase.inc.php:			if ($this->dialect == 1) ibase_timefmt($this->ibase_datefmt,IBASE_TIMESTAMP );
drivers/adodb-ibase.inc.php:			else ibase_timefmt($this->ibase_timestampfmt,IBASE_TIMESTAMP );
drivers/adodb-ibase.inc.php:			ibase_timefmt($this->ibase_timefmt,IBASE_TIME );
drivers/adodb-ibase.inc.php:			ini_set("ibase.timestampformat", $this->ibase_timestampfmt);
drivers/adodb-ibase.inc.php:			ini_set("ibase.dateformat", $this->ibase_datefmt);
drivers/adodb-ibase.inc.php:			ini_set("ibase.timeformat", $this->ibase_timefmt);
drivers/adodb-ibase.inc.php:		return $this->_connect($argHostname, $argUsername, $argPassword, $argDatabasename,true);
drivers/adodb-ibase.inc.php:		$a = $this->GetCol($sql,false,true);
drivers/adodb-ibase.inc.php:		$arr['dialect'] = $this->dialect;
drivers/adodb-ibase.inc.php:		if ($this->transOff) return true;
drivers/adodb-ibase.inc.php:		$this->transCnt += 1;
drivers/adodb-ibase.inc.php:		$this->autoCommit = false;
drivers/adodb-ibase.inc.php:	 	$this->_transactionID = $this->_connectionID;//ibase_trans($this->ibasetrans, $this->_connectionID);
drivers/adodb-ibase.inc.php:		return $this->_transactionID;
drivers/adodb-ibase.inc.php:		if (!$ok) return $this->RollbackTrans();
drivers/adodb-ibase.inc.php:		if ($this->transOff) return true;
drivers/adodb-ibase.inc.php:		if ($this->transCnt) $this->transCnt -= 1;
drivers/adodb-ibase.inc.php:		$this->autoCommit = true;
drivers/adodb-ibase.inc.php:		if ($this->_transactionID) {
drivers/adodb-ibase.inc.php:			$ret = ibase_commit($this->_transactionID);
drivers/adodb-ibase.inc.php:		$this->_transactionID = false;
drivers/adodb-ibase.inc.php:	// there are some compat problems with ADODB_COUNTRECS=false and $this->_logsql currently.
drivers/adodb-ibase.inc.php:		if ($this->_logsql) {
drivers/adodb-ibase.inc.php:		if ($this->transOff) return true;
drivers/adodb-ibase.inc.php:		if ($this->transCnt) $this->transCnt -= 1;
drivers/adodb-ibase.inc.php:		$this->autoCommit = true;
drivers/adodb-ibase.inc.php:		if ($this->_transactionID) 
drivers/adodb-ibase.inc.php:				  $ret = ibase_rollback($this->_transactionID);
drivers/adodb-ibase.inc.php:		$this->_transactionID = false;   
drivers/adodb-ibase.inc.php:        if ($this->fetchMode !== FALSE) {
drivers/adodb-ibase.inc.php:               $savem = $this->SetFetchMode(FALSE);
drivers/adodb-ibase.inc.php:        $rs = $this->Execute($sql);
drivers/adodb-ibase.inc.php:	            $this->SetFetchMode($savem);
drivers/adodb-ibase.inc.php:		while ($row = $rs->FetchRow()) {
drivers/adodb-ibase.inc.php:			$rs1 = $this->Execute($sql);
drivers/adodb-ibase.inc.php:            while ($row1 = $rs1->FetchRow()) {
drivers/adodb-ibase.inc.php:            $this->SetFetchMode($savem);
drivers/adodb-ibase.inc.php:		if ($this->autoCommit) $this->BeginTrans();
drivers/adodb-ibase.inc.php:		$this->Execute("UPDATE $table SET $col=$col WHERE $where "); // is this correct - jlim?
drivers/adodb-ibase.inc.php:		$ok = $this->Execute(("INSERT INTO RDB\$GENERATORS (RDB\$GENERATOR_NAME) VALUES (UPPER('$seqname'))" ));
drivers/adodb-ibase.inc.php:		return $this->Execute("SET GENERATOR $seqname TO ".($startID-1).';');
drivers/adodb-ibase.inc.php:		$this->Execute("delete from RDB\$GENERATORS where RDB\$GENERATOR_NAME='$seqname'");
drivers/adodb-ibase.inc.php:		$rs = @$this->Execute($getnext);
drivers/adodb-ibase.inc.php:			$this->Execute(("INSERT INTO RDB\$GENERATORS (RDB\$GENERATOR_NAME) VALUES (UPPER('$seqname'))" ));
drivers/adodb-ibase.inc.php:			$this->Execute("SET GENERATOR $seqname TO ".($startID-1).';');
drivers/adodb-ibase.inc.php:			$rs = $this->Execute($getnext);
drivers/adodb-ibase.inc.php:		if ($rs && !$rs->EOF) $this->genID = (integer) reset($rs->fields);
drivers/adodb-ibase.inc.php:		else $this->genID = 0; // false
drivers/adodb-ibase.inc.php:		if ($rs) $rs->Close();
drivers/adodb-ibase.inc.php:		return $this->genID;
drivers/adodb-ibase.inc.php:		$this->_errorMsg = ibase_errmsg();
drivers/adodb-ibase.inc.php:		if (preg_match('/error code = ([\-0-9]*)/i', $this->_errorMsg,$arr)) return (integer) $arr[1];
drivers/adodb-ibase.inc.php:			return $this->_errorMsg;
drivers/adodb-ibase.inc.php:		$stmt = ibase_prepare($this->_connectionID,$sql);
drivers/adodb-ibase.inc.php:	   // there have been reports of problems with nested queries - the code is probably not re-entrant?
drivers/adodb-ibase.inc.php:		if (!$this->autoCommit && $this->_transactionID) {
drivers/adodb-ibase.inc.php:			$conn = $this->_transactionID;
drivers/adodb-ibase.inc.php:			$conn = $this->_connectionID;
drivers/adodb-ibase.inc.php:		if ($docommit && $ret === true) ibase_commit($this->_connectionID);
drivers/adodb-ibase.inc.php:		$this->_handleerror();
drivers/adodb-ibase.inc.php:		if (!$this->autoCommit) @ibase_rollback($this->_connectionID);
drivers/adodb-ibase.inc.php:		return @ibase_close($this->_connectionID);
drivers/adodb-ibase.inc.php:		$fld->max_length = $flen;
drivers/adodb-ibase.inc.php:		$fld->scale = null;
drivers/adodb-ibase.inc.php:				    		$fld->type = ($ftype == 7 ? 'smallint' : 'integer');
drivers/adodb-ibase.inc.php:				    		$fld->type = 'numeric';
drivers/adodb-ibase.inc.php:							$fld->max_length = $fprecision;
drivers/adodb-ibase.inc.php:							$fld->scale = $fscale;
drivers/adodb-ibase.inc.php:				    		$fld->type = 'decimal';
drivers/adodb-ibase.inc.php:							$fld->max_length = $fprecision;
drivers/adodb-ibase.inc.php:							$fld->scale = $fscale;
drivers/adodb-ibase.inc.php:					    $fld->type = 'decimal';
drivers/adodb-ibase.inc.php:						$fld->scale = $fscale;
drivers/adodb-ibase.inc.php:						$fld->max_length = ($ftype == 7 ? 4 : 9);
drivers/adodb-ibase.inc.php:						$fld->type = ($ftype == 7 ? 'smallint' : 'integer');
drivers/adodb-ibase.inc.php:				    		$fld->type = 'decimal';
drivers/adodb-ibase.inc.php:							$fld->max_length = 18;
drivers/adodb-ibase.inc.php:							$fld->scale = 0;
drivers/adodb-ibase.inc.php:				    		$fld->type = 'numeric';
drivers/adodb-ibase.inc.php:							$fld->max_length = $fprecision;
drivers/adodb-ibase.inc.php:							$fld->scale = $fscale;
drivers/adodb-ibase.inc.php:				    		$fld->type = 'decimal';
drivers/adodb-ibase.inc.php:							$fld->max_length = $fprecision;
drivers/adodb-ibase.inc.php:							$fld->scale = $fscale;
drivers/adodb-ibase.inc.php:				$fld->type = 'float';
drivers/adodb-ibase.inc.php:				$fld->type = 'char';
drivers/adodb-ibase.inc.php:				    $fld->type = 'decimal';
drivers/adodb-ibase.inc.php:					$fld->max_length = 15;
drivers/adodb-ibase.inc.php:					$fld->scale = 5;
drivers/adodb-ibase.inc.php:					$fld->type = 'double';
drivers/adodb-ibase.inc.php:				    $fld->type = 'timestamp';
drivers/adodb-ibase.inc.php:					$fld->type = 'date';
drivers/adodb-ibase.inc.php:				$fld->type = 'date';
drivers/adodb-ibase.inc.php:				$fld->type = 'time';
drivers/adodb-ibase.inc.php:				$fld->type = 'varchar';
drivers/adodb-ibase.inc.php:				$fld->type = 'cstring';
drivers/adodb-ibase.inc.php:				$fld->type = 'blob';
drivers/adodb-ibase.inc.php:				$fld->max_length = -1;
drivers/adodb-ibase.inc.php:		$rs = $this->Execute(sprintf($this->metaColumnsSQL,strtoupper($table)));
drivers/adodb-ibase.inc.php:		$dialect3 = ($this->dialect==3 ? true : false);
drivers/adodb-ibase.inc.php:		while (!$rs->EOF) { //print_r($rs->fields);
drivers/adodb-ibase.inc.php:			$fld->name = trim($rs->fields[0]);
drivers/adodb-ibase.inc.php:			$this->_ConvertFieldType($fld, $rs->fields[7], $rs->fields[3], $rs->fields[4], $rs->fields[5], $rs->fields[6], $dialect3);
drivers/adodb-ibase.inc.php:			if (isset($rs->fields[1]) && $rs->fields[1]) {
drivers/adodb-ibase.inc.php:				$fld->not_null = true;
drivers/adodb-ibase.inc.php:			if (isset($rs->fields[2])) {
drivers/adodb-ibase.inc.php:				$fld->has_default = true;
drivers/adodb-ibase.inc.php:				$d = substr($rs->fields[2],strlen('default '));
drivers/adodb-ibase.inc.php:				switch ($fld->type)
drivers/adodb-ibase.inc.php:				case 'integer': $fld->default_value = (int) $d; break;
drivers/adodb-ibase.inc.php:				case 'varchar': $fld->default_value = (string) substr($d,1,strlen($d)-2); break;
drivers/adodb-ibase.inc.php:				case 'float': $fld->default_value = (float) $d; break;
drivers/adodb-ibase.inc.php:				default: $fld->default_value = $d; break;
drivers/adodb-ibase.inc.php:			if ((isset($rs->fields[5])) && ($fld->type == 'blob')) {
drivers/adodb-ibase.inc.php:				$fld->sub_type = $rs->fields[5];
drivers/adodb-ibase.inc.php:				$fld->sub_type = null;
drivers/adodb-ibase.inc.php:			else $retarr[strtoupper($fld->name)] = $fld;
drivers/adodb-ibase.inc.php:			$rs->MoveNext();
drivers/adodb-ibase.inc.php:		$rs->Close();
drivers/adodb-ibase.inc.php:		$blobid = ibase_blob_create( $this->_connectionID);
drivers/adodb-ibase.inc.php:	// since we auto-decode all blob's since 2.42, 
drivers/adodb-ibase.inc.php:	// still used to auto-decode all blob's
drivers/adodb-ibase.inc.php:		$realblob = ibase_blob_get( $blobid,$this->maxblobsize); // 2nd param is max size of blob -- Kevin Boillet <kevinboillet@yahoo.fr>
drivers/adodb-ibase.inc.php:		$blob_id = ibase_blob_create($this->_connectionID); 
drivers/adodb-ibase.inc.php:		return $this->Execute("UPDATE $table SET $column=(?) WHERE $where",array($blob_id_str)) != false; 
drivers/adodb-ibase.inc.php:		$conn->Execute('INSERT INTO blobtable (id, blobcol) VALUES (1, null)');
drivers/adodb-ibase.inc.php:		$conn->UpdateBlob('blobtable','blobcol',$blob,'id=1');
drivers/adodb-ibase.inc.php:	$blob_id = ibase_blob_create($this->_connectionID); 
drivers/adodb-ibase.inc.php:	$n_chunks = ($len - $tail_size) / $chunk_size; 
drivers/adodb-ibase.inc.php:	return $this->Execute("UPDATE $table SET $column=(?) WHERE $where",array($blob_id_str)) != false; 
drivers/adodb-ibase.inc.php:		$blob_id = ibase_blob_create($this->_connectionID);
drivers/adodb-ibase.inc.php:		return $this->Execute("UPDATE $table SET $column=(?) WHERE $where",array($blob_id_str)) != false;
drivers/adodb-ibase.inc.php:	// Only since Interbase 6.0 - uses EXTRACT
drivers/adodb-ibase.inc.php:	// problem - does not zero-fill the day and month yet
drivers/adodb-ibase.inc.php:		if (!$col) $col = $this->sysDate;
drivers/adodb-ibase.inc.php:				$s .= $this->qstr($ch);
drivers/adodb-ibase.inc.php:/*--------------------------------------------------------------------------------------
drivers/adodb-ibase.inc.php:--------------------------------------------------------------------------------------*/
drivers/adodb-ibase.inc.php:			$this->fetchMode = ($mode === false) ? $ADODB_FETCH_MODE : $mode;
drivers/adodb-ibase.inc.php:			$this->ADORecordSet($id);
drivers/adodb-ibase.inc.php:	function &FetchField($fieldOffset = -1)
drivers/adodb-ibase.inc.php:			 $ibf = ibase_field_info($this->_queryID,$fieldOffset);
drivers/adodb-ibase.inc.php:			 	$fld->name = ($ibf['alias']);
drivers/adodb-ibase.inc.php:				 if (empty($fld->name)) $fld->name = ($ibf['name']);
drivers/adodb-ibase.inc.php:				 $fld->name = strtoupper($ibf['alias']);
drivers/adodb-ibase.inc.php:				 if (empty($fld->name)) $fld->name = strtoupper($ibf['name']);
drivers/adodb-ibase.inc.php:			 	$fld->name = strtolower($ibf['alias']);
drivers/adodb-ibase.inc.php:				 if (empty($fld->name)) $fld->name = strtolower($ibf['name']);
drivers/adodb-ibase.inc.php:			 $fld->type = $ibf['type'];
drivers/adodb-ibase.inc.php:			 $fld->max_length = $ibf['length'];
drivers/adodb-ibase.inc.php:			 $fld->not_null = false;
drivers/adodb-ibase.inc.php:			 $fld->has_default = false;
drivers/adodb-ibase.inc.php:			 $fld->default_value = 'null';
drivers/adodb-ibase.inc.php:		$this->_numOfRows = -1;
drivers/adodb-ibase.inc.php:		$this->_numOfFields = @ibase_num_fields($this->_queryID);
drivers/adodb-ibase.inc.php:		for ($i=0, $max = $this->_numOfFields; $i < $max; $i++) { 
drivers/adodb-ibase.inc.php:			$f1 = $this->FetchField($i); 
drivers/adodb-ibase.inc.php:			$this->_cacheType[] = $f1->type;
drivers/adodb-ibase.inc.php:		$f = @ibase_fetch_row($this->_queryID); 
drivers/adodb-ibase.inc.php:			$this->fields = false;
drivers/adodb-ibase.inc.php:		// OPN stuff start - optimized
drivers/adodb-ibase.inc.php:		for ($i=0, $max = $this->_numOfFields; $i < $max; $i++) { 
drivers/adodb-ibase.inc.php:			if ($this->_cacheType[$i]=="BLOB") {
drivers/adodb-ibase.inc.php:					$f[$i] = $this->connection->_BlobDecode($f[$i]); 
drivers/adodb-ibase.inc.php:		$this->fields = $f;
drivers/adodb-ibase.inc.php:		if ($this->fetchMode == ADODB_FETCH_ASSOC) {
drivers/adodb-ibase.inc.php:			$this->fields = &$this->GetRowAssoc(ADODB_ASSOC_CASE);
drivers/adodb-ibase.inc.php:		} else if ($this->fetchMode == ADODB_FETCH_BOTH) {
drivers/adodb-ibase.inc.php:			$this->fields =& array_merge($this->fields,$this->GetRowAssoc(ADODB_ASSOC_CASE));
drivers/adodb-ibase.inc.php:		if ($this->fetchMode & ADODB_FETCH_ASSOC) return $this->fields[$colname];
drivers/adodb-ibase.inc.php:		if (!$this->bind) {
drivers/adodb-ibase.inc.php:			$this->bind = array();
drivers/adodb-ibase.inc.php:			for ($i=0; $i < $this->_numOfFields; $i++) {
drivers/adodb-ibase.inc.php:				$o = $this->FetchField($i);
drivers/adodb-ibase.inc.php:				$this->bind[strtoupper($o->name)] = $i;
drivers/adodb-ibase.inc.php:		return $this->fields[$this->bind[strtoupper($colname)]];
drivers/adodb-ibase.inc.php:			return @ibase_free_result($this->_queryID);
drivers/adodb-ibase.inc.php:	function MetaType($t,$len=-1,$fieldobj=false)
drivers/adodb-ibase.inc.php:			$t = $fieldobj->type;
drivers/adodb-ibase.inc.php:			$len = $fieldobj->max_length;
drivers/adodb-ibase.inc.php:		if ($len <= $this->blobSize) return 'C';
drivers/adodb-ado_mssql.inc.php:V4.54 5 Nov 2004  (c) 2000-2004 John Lim (jlim@natsoft.com.my). All rights reserved.
drivers/adodb-ado_mssql.inc.php:// security - hide paths
drivers/adodb-ado_mssql.inc.php:	if (PHP_VERSION >= 5) include(ADODB_DIR."/drivers/adodb-ado5.inc.php");
drivers/adodb-ado_mssql.inc.php:	else include(ADODB_DIR."/drivers/adodb-ado.inc.php");
drivers/adodb-ado_mssql.inc.php:	        $this->ADODB_ado();
drivers/adodb-ado_mssql.inc.php:	        return $this->GetOne('select @@identity');
drivers/adodb-ado_mssql.inc.php:	        return $this->GetOne('select @@rowcount');
drivers/adodb-ado_mssql.inc.php:        $dbc = $this->_connectionID;
drivers/adodb-ado_mssql.inc.php:        $adors=@$dbc->OpenSchema(4, $osoptions);//tables
drivers/adodb-ado_mssql.inc.php:                while (!$adors->EOF){
drivers/adodb-ado_mssql.inc.php:                        $c = $adors->Fields(3);
drivers/adodb-ado_mssql.inc.php:                        $fld->name = $c->Value;
drivers/adodb-ado_mssql.inc.php:                        $fld->type = 'CHAR'; // cannot discover type in ADO!
drivers/adodb-ado_mssql.inc.php:                        $fld->max_length = -1;
drivers/adodb-ado_mssql.inc.php:                        $arr[strtoupper($fld->name)]=$fld;
drivers/adodb-ado_mssql.inc.php:                        $adors->MoveNext();
drivers/adodb-ado_mssql.inc.php:                $adors->Close();
drivers/adodb-ado_mssql.inc.php:	        return $this->ADORecordSet_ado($id,$mode);
drivers/adodb-informix72.inc.php:V4.54 5 Nov 2004  (c) 2000-2004 John Lim. All rights reserved.
drivers/adodb-informix72.inc.php:// security - hide paths
drivers/adodb-informix72.inc.php:	var $fmtDate = "'Y-m-d'";
drivers/adodb-informix72.inc.php:	var $fmtTimeStamp = "'Y-m-d H:i:s'";
drivers/adodb-informix72.inc.php://	var $metaTablesSQL="select tabname from systables where tabtype!=' ' and owner!='informix'"; //Don't get informix tables and pseudo-tables
drivers/adodb-informix72.inc.php:		//putenv("DBDATE=Y4MD-");
drivers/adodb-informix72.inc.php:		putenv('GL_DATE=%Y-%m-%d');
drivers/adodb-informix72.inc.php:        	ifx_blobinfile_mode(0); // Mode "0" means save Byte-Blobs in memory, and mode "1" means save Byte-Blobs in a file.
drivers/adodb-informix72.inc.php:	    if (isset($this->version)) return $this->version;
drivers/adodb-informix72.inc.php:	    $arr['description'] = $this->GetOne("select DBINFO('version','full') from systables where tabid = 1");
drivers/adodb-informix72.inc.php:	    $arr['version'] = $this->GetOne("select DBINFO('version','major') || DBINFO('version','minor') from systables where tabid = 1");
drivers/adodb-informix72.inc.php:	    $this->version = $arr;
drivers/adodb-informix72.inc.php:		$sqlca =ifx_getsqlca($this->lastQuery);
drivers/adodb-informix72.inc.php:		if ($this->lastQuery) {
drivers/adodb-informix72.inc.php:		   return @ifx_affected_rows ($this->lastQuery);
drivers/adodb-informix72.inc.php:		if ($this->transOff) return true;
drivers/adodb-informix72.inc.php:		$this->transCnt += 1;
drivers/adodb-informix72.inc.php:		$this->Execute('BEGIN');
drivers/adodb-informix72.inc.php:		$this->_autocommit = false;
drivers/adodb-informix72.inc.php:		if (!$ok) return $this->RollbackTrans();
drivers/adodb-informix72.inc.php:		if ($this->transOff) return true;
drivers/adodb-informix72.inc.php:		if ($this->transCnt) $this->transCnt -= 1;
drivers/adodb-informix72.inc.php:		$this->Execute('COMMIT');
drivers/adodb-informix72.inc.php:		$this->_autocommit = true;
drivers/adodb-informix72.inc.php:		if ($this->transOff) return true;
drivers/adodb-informix72.inc.php:		if ($this->transCnt) $this->transCnt -= 1;
drivers/adodb-informix72.inc.php:		$this->Execute('ROLLBACK');
drivers/adodb-informix72.inc.php:		$this->_autocommit = true;
drivers/adodb-informix72.inc.php:		if ($this->_autocommit) $this->BeginTrans();
drivers/adodb-informix72.inc.php:		return $this->GetOne("select 1 as ignore from $tables where $where for update");
drivers/adodb-informix72.inc.php:		if (!empty($this->_logsql)) return $this->_errorMsg;
drivers/adodb-informix72.inc.php:		$this->_errorMsg = ifx_errormsg();
drivers/adodb-informix72.inc.php:		return $this->_errorMsg;
drivers/adodb-informix72.inc.php:		if (!empty($this->metaColumnsSQL)) {
drivers/adodb-informix72.inc.php:			if ($this->fetchMode !== false) $savem = $this->SetFetchMode(false);
drivers/adodb-informix72.inc.php:          		$rs = $this->Execute(sprintf($this->metaColumnsSQL,$table));
drivers/adodb-informix72.inc.php:			if (isset($savem)) $this->SetFetchMode($savem);
drivers/adodb-informix72.inc.php:			$rspkey = $this->Execute(sprintf($this->metaPrimaryKeySQL,$table)); //Added to get primary key colno items
drivers/adodb-informix72.inc.php:			while (!$rs->EOF) { //print_r($rs->fields);
drivers/adodb-informix72.inc.php:				$fld->name = $rs->fields[0];
drivers/adodb-informix72.inc.php:				$fld->type = $rs->fields[1];
drivers/adodb-informix72.inc.php:				$fld->primary_key=$rspkey->fields && array_search($rs->fields[4],$rspkey->fields); //Added to set primary key flag
drivers/adodb-informix72.inc.php:				$fld->max_length = $rs->fields[2];
drivers/adodb-informix72.inc.php:				if (trim($rs->fields[3]) != "AAAAAA 0") {
drivers/adodb-informix72.inc.php:	                    		$fld->has_default = 1;
drivers/adodb-informix72.inc.php:	                    		$fld->default_value = $rs->fields[3];
drivers/adodb-informix72.inc.php:					$fld->has_default = 0;
drivers/adodb-informix72.inc.php:                $retarr[strtolower($fld->name)] = $fld;	
drivers/adodb-informix72.inc.php:				$rs->MoveNext();
drivers/adodb-informix72.inc.php:			$rs->Close();
drivers/adodb-informix72.inc.php:		return $this->Execute("UPDATE $table SET $column=(?) WHERE $where",array($blobid));
drivers/adodb-informix72.inc.php:		$this->_connectionID = ifx_connect($dbs,$argUsername,$argPassword);
drivers/adodb-informix72.inc.php:		if ($this->_connectionID === false) return false;
drivers/adodb-informix72.inc.php:		#if ($argDatabasename) return $this->SelectDB($argDatabasename);
drivers/adodb-informix72.inc.php:		$this->_connectionID = ifx_pconnect($dbs,$argUsername,$argPassword);
drivers/adodb-informix72.inc.php:		if ($this->_connectionID === false) return false;
drivers/adodb-informix72.inc.php:		#if ($argDatabasename) return $this->SelectDB($argDatabasename);
drivers/adodb-informix72.inc.php:	// ifx_do does not accept bind parameters - weird ???
drivers/adodb-informix72.inc.php:			$this->lastQuery = ifx_query($sql,$this->_connectionID, $this->cursorType, $tab);
drivers/adodb-informix72.inc.php:			$this->lastQuery = ifx_query($sql,$this->_connectionID, $this->cursorType);
drivers/adodb-informix72.inc.php:			$this->lastQuery = ifx_query($sql,$this->_connectionID, $tab);
drivers/adodb-informix72.inc.php:			$this->lastQuery = ifx_query($sql,$this->_connectionID);
drivers/adodb-informix72.inc.php:	  //if ($this->_autocommit) ifx_query('COMMIT',$this->_connectionID);
drivers/adodb-informix72.inc.php:		return $this->lastQuery;
drivers/adodb-informix72.inc.php:		$this->lastQuery = false;
drivers/adodb-informix72.inc.php:		return ifx_close($this->_connectionID);
drivers/adodb-informix72.inc.php:/*--------------------------------------------------------------------------------------
drivers/adodb-informix72.inc.php:--------------------------------------------------------------------------------------*/
drivers/adodb-informix72.inc.php:		$this->fetchMode = $mode;
drivers/adodb-informix72.inc.php:		return $this->ADORecordSet($id);
drivers/adodb-informix72.inc.php:	function &FetchField($fieldOffset = -1)
drivers/adodb-informix72.inc.php:		if (empty($this->_fieldprops)) {
drivers/adodb-informix72.inc.php:			$fp = ifx_fieldproperties($this->_queryID);
drivers/adodb-informix72.inc.php:				$o->name = $k;
drivers/adodb-informix72.inc.php:				$o->type = $arr[0];
drivers/adodb-informix72.inc.php:				$o->max_length = $arr[1];
drivers/adodb-informix72.inc.php:				$this->_fieldprops[] = $o;
drivers/adodb-informix72.inc.php:				$o->not_null = $arr[4]=="N";
drivers/adodb-informix72.inc.php:		return $this->_fieldprops[$fieldOffset];
drivers/adodb-informix72.inc.php:		$this->_numOfRows = -1; // ifx_affected_rows not reliable, only returns estimate -- ($ADODB_COUNTRECS)? ifx_affected_rows($this->_queryID):-1;
drivers/adodb-informix72.inc.php:		$this->_numOfFields = ifx_num_fields($this->_queryID);
drivers/adodb-informix72.inc.php:		return @ifx_fetch_row($this->_queryID, (int) $row);
drivers/adodb-informix72.inc.php:	  $this->fields = @ifx_fetch_row($this->_queryID, "LAST");
drivers/adodb-informix72.inc.php:	  if ($this->fields) $this->EOF = false;
drivers/adodb-informix72.inc.php:	  $this->_currentRow = -1;
drivers/adodb-informix72.inc.php:	  if ($this->fetchMode == ADODB_FETCH_NUM) {
drivers/adodb-informix72.inc.php:		 foreach($this->fields as $v) {
drivers/adodb-informix72.inc.php:		 $this->fields = $arr;
drivers/adodb-informix72.inc.php:	  $this->fields = @ifx_fetch_row($this->_queryID, "FIRST");
drivers/adodb-informix72.inc.php:	  if ($this->fields) $this->EOF = false;
drivers/adodb-informix72.inc.php:	  $this->_currentRow = 0;
drivers/adodb-informix72.inc.php:	  if ($this->fetchMode == ADODB_FETCH_NUM) {
drivers/adodb-informix72.inc.php:		 foreach($this->fields as $v) {
drivers/adodb-informix72.inc.php:		 $this->fields = $arr;
drivers/adodb-informix72.inc.php:		$this->fields = @ifx_fetch_row($this->_queryID);
drivers/adodb-informix72.inc.php:		if (!is_array($this->fields)) return false;
drivers/adodb-informix72.inc.php:		if ($this->fetchMode == ADODB_FETCH_NUM) {
drivers/adodb-informix72.inc.php:			foreach($this->fields as $v) {
drivers/adodb-informix72.inc.php:			$this->fields = $arr;
drivers/adodb-informix72.inc.php:		return ifx_free_result($this->_queryID);
drivers/adodb-proxy.inc.php:V4.54 5 Nov 2004  (c) 2000-2004 John Lim (jlim@natsoft.com.my). All rights reserved.
drivers/adodb-proxy.inc.php:// security - hide paths
drivers/adodb-proxy.inc.php:	 include(ADODB_DIR."/drivers/adodb-csv.inc.php");
drivers/adodb-proxy.inc.php:			$this->ADORecordset($id,$mode);
drivers/adodb-mysqlt.inc.php:V4.54 5 Nov 2004  (c) 2000-2004 John Lim (jlim@natsoft.com.my). All rights reserved.
drivers/adodb-mysqlt.inc.php:// security - hide paths
drivers/adodb-mysqlt.inc.php:include_once(ADODB_DIR."/drivers/adodb-mysql.inc.php");
drivers/adodb-mysqlt.inc.php:	global $ADODB_EXTENSION; if ($ADODB_EXTENSION) $this->rsPrefix .= 'ext_';
drivers/adodb-mysqlt.inc.php:		if ($this->transOff) return true;
drivers/adodb-mysqlt.inc.php:		$this->transCnt += 1;
drivers/adodb-mysqlt.inc.php:		$this->Execute('SET AUTOCOMMIT=0');
drivers/adodb-mysqlt.inc.php:		$this->Execute('BEGIN');
drivers/adodb-mysqlt.inc.php:		if ($this->transOff) return true; 
drivers/adodb-mysqlt.inc.php:		if (!$ok) return $this->RollbackTrans();
drivers/adodb-mysqlt.inc.php:		if ($this->transCnt) $this->transCnt -= 1;
drivers/adodb-mysqlt.inc.php:		$this->Execute('COMMIT');
drivers/adodb-mysqlt.inc.php:		$this->Execute('SET AUTOCOMMIT=1');
drivers/adodb-mysqlt.inc.php:		if ($this->transOff) return true;
drivers/adodb-mysqlt.inc.php:		if ($this->transCnt) $this->transCnt -= 1;
drivers/adodb-mysqlt.inc.php:		$this->Execute('ROLLBACK');
drivers/adodb-mysqlt.inc.php:		$this->Execute('SET AUTOCOMMIT=1');
drivers/adodb-mysqlt.inc.php:		case ADODB_FETCH_NUM: $this->fetchMode = MYSQL_NUM; break;
drivers/adodb-mysqlt.inc.php:		case ADODB_FETCH_ASSOC:$this->fetchMode = MYSQL_ASSOC; break;
drivers/adodb-mysqlt.inc.php:		case ADODB_FETCH_BOTH:$this->fetchMode = MYSQL_BOTH; break;
drivers/adodb-mysqlt.inc.php:		$this->ADORecordSet($queryID);	
drivers/adodb-mysqlt.inc.php:		if (@$this->fields =& mysql_fetch_array($this->_queryID,$this->fetchMode)) {
drivers/adodb-mysqlt.inc.php:			$this->_currentRow += 1;
drivers/adodb-mysqlt.inc.php:		if (!$this->EOF) {
drivers/adodb-mysqlt.inc.php:			$this->_currentRow += 1;
drivers/adodb-mysqlt.inc.php:			$this->EOF = true;
drivers/adodb-mysqlt.inc.php:		case ADODB_FETCH_NUM: $this->fetchMode = MYSQL_NUM; break;
drivers/adodb-mysqlt.inc.php:		case ADODB_FETCH_ASSOC:$this->fetchMode = MYSQL_ASSOC; break;
drivers/adodb-mysqlt.inc.php:		case ADODB_FETCH_BOTH:$this->fetchMode = MYSQL_BOTH; break;
drivers/adodb-mysqlt.inc.php:		$this->ADORecordSet($queryID);	
drivers/adodb-mysqli.inc.php:V4.54 5 Nov 2004  (c) 2000-2004 John Lim (jlim@natsoft.com.my). All rights reserved.
drivers/adodb-mysqli.inc.php:// security - hide paths
drivers/adodb-mysqli.inc.php: // disable adodb extension - currently incompatible.
drivers/adodb-mysqli.inc.php:	var $fmtTimeStamp = "'Y-m-d H:i:s'";
drivers/adodb-mysqli.inc.php:	    $this->_connectionID = @mysqli_init();
drivers/adodb-mysqli.inc.php:	    if (is_null($this->_connectionID)) {
drivers/adodb-mysqli.inc.php:	      if ($this->debug) 
drivers/adodb-mysqli.inc.php:				ADOConnection::outp("mysqli_init() failed : "  . $this->ErrorMsg());
drivers/adodb-mysqli.inc.php:	    // mysqli_options($this->_connection,,);
drivers/adodb-mysqli.inc.php: 	    if (mysqli_real_connect($this->_connectionID,
drivers/adodb-mysqli.inc.php:					$this->port,
drivers/adodb-mysqli.inc.php:					$this->socket,
drivers/adodb-mysqli.inc.php:					$this->clientFlags))
drivers/adodb-mysqli.inc.php: 		if ($argDatabasename)  return $this->SelectDB($argDatabasename);
drivers/adodb-mysqli.inc.php:			if ($this->debug) 
drivers/adodb-mysqli.inc.php:		  		ADOConnection::outp("Could't connect : "  . $this->ErrorMsg());
drivers/adodb-mysqli.inc.php:		return $this->_connect($argHostname, $argUsername, $argPassword, $argDatabasename, true);
drivers/adodb-mysqli.inc.php:	// In _connect(), check $this->forceNewConnect? 
drivers/adodb-mysqli.inc.php:	    $this->forceNewConnect = true;
drivers/adodb-mysqli.inc.php:	    $this->_connect($argHostname, $argUsername, $argPassword, $argDatabasename);
drivers/adodb-mysqli.inc.php:		$arr['description'] = $this->GetOne("select version()");
drivers/adodb-mysqli.inc.php:		if ($this->transOff) return true;
drivers/adodb-mysqli.inc.php:		$this->transCnt += 1;
drivers/adodb-mysqli.inc.php:		$this->Execute('SET AUTOCOMMIT=0');
drivers/adodb-mysqli.inc.php:		$this->Execute('BEGIN');
drivers/adodb-mysqli.inc.php:		if ($this->transOff) return true; 
drivers/adodb-mysqli.inc.php:		if (!$ok) return $this->RollbackTrans();
drivers/adodb-mysqli.inc.php:		if ($this->transCnt) $this->transCnt -= 1;
drivers/adodb-mysqli.inc.php:		$this->Execute('COMMIT');
drivers/adodb-mysqli.inc.php:		$this->Execute('SET AUTOCOMMIT=1');
drivers/adodb-mysqli.inc.php:		if ($this->transOff) return true;
drivers/adodb-mysqli.inc.php:		if ($this->transCnt) $this->transCnt -= 1;
drivers/adodb-mysqli.inc.php:		$this->Execute('ROLLBACK');
drivers/adodb-mysqli.inc.php:		$this->Execute('SET AUTOCOMMIT=1');
drivers/adodb-mysqli.inc.php:	//Eg. $s = $db->qstr(HTTP_GET_VARS['name'],get_magic_quotes_gpc());
drivers/adodb-mysqli.inc.php:	      		return "'" . mysqli_real_escape_string($this->_connectionID, $s) . "'";   
drivers/adodb-mysqli.inc.php:		if ($this->replaceQuote[0] == '\\')
drivers/adodb-mysqli.inc.php:	    return  "'".str_replace("'",$this->replaceQuote,$s)."'"; 
drivers/adodb-mysqli.inc.php:	  $result = @mysqli_insert_id($this->_connectionID);
drivers/adodb-mysqli.inc.php:	  if ($result == -1){
drivers/adodb-mysqli.inc.php:	      if ($this->debug) ADOConnection::outp("mysqli_insert_id() failed : "  . $this->ErrorMsg());
drivers/adodb-mysqli.inc.php:	  $result =  @mysqli_affected_rows($this->_connectionID);
drivers/adodb-mysqli.inc.php:	  if ($result == -1) {
drivers/adodb-mysqli.inc.php:	      if ($this->debug) ADOConnection::outp("mysqli_affected_rows() failed : "  . $this->ErrorMsg());
drivers/adodb-mysqli.inc.php:		if (empty($this->_genSeqSQL)) return false;
drivers/adodb-mysqli.inc.php:		$ok = $this->Execute(sprintf($this->_genSeqSQL,$seqname));
drivers/adodb-mysqli.inc.php:		return $this->Execute(sprintf($this->_genSeq2SQL,$seqname,$startID-1));
drivers/adodb-mysqli.inc.php:		// post-nuke sets hasGenID to false
drivers/adodb-mysqli.inc.php:		if (!$this->hasGenID) return false;
drivers/adodb-mysqli.inc.php:		$getnext = sprintf($this->_genIDSQL,$seqname);
drivers/adodb-mysqli.inc.php:		$holdtransOK = $this->_transOK; // save the current status
drivers/adodb-mysqli.inc.php:		$rs = @$this->Execute($getnext);
drivers/adodb-mysqli.inc.php:			if ($holdtransOK) $this->_transOK = true; //if the status was ok before reset
drivers/adodb-mysqli.inc.php:			$this->Execute(sprintf($this->_genSeqSQL,$seqname));
drivers/adodb-mysqli.inc.php:			$this->Execute(sprintf($this->_genSeq2SQL,$seqname,$startID-1));
drivers/adodb-mysqli.inc.php:			$rs = $this->Execute($getnext);
drivers/adodb-mysqli.inc.php:		$this->genID = mysqli_insert_id($this->_connectionID);
drivers/adodb-mysqli.inc.php:		if ($rs) $rs->Close();
drivers/adodb-mysqli.inc.php:		return $this->genID;
drivers/adodb-mysqli.inc.php:		$ret =& $this->Execute($query);
drivers/adodb-mysqli.inc.php:		if ($this->fetchMode !== FALSE) {
drivers/adodb-mysqli.inc.php:		       $savem = $this->SetFetchMode(FALSE);
drivers/adodb-mysqli.inc.php:		$rs = $this->Execute(sprintf('SHOW INDEXES FROM %s',$table));
drivers/adodb-mysqli.inc.php:		        $this->SetFetchMode($savem);
drivers/adodb-mysqli.inc.php:		while ($row = $rs->FetchRow()) {
drivers/adodb-mysqli.inc.php:		        $indexes[$row[2]]['columns'][$row[3] - 1] = $row[4];
drivers/adodb-mysqli.inc.php:		if (!$col) $col = $this->sysTimeStamp;
drivers/adodb-mysqli.inc.php:	// much easier to run "mysqld --ansi" or "mysqld --sql-mode=PIPES_AS_CONCAT" and use || operator
drivers/adodb-mysqli.inc.php:		  $date = $this->sysDate;
drivers/adodb-mysqli.inc.php:		if (!$this->metaColumnsSQL)
drivers/adodb-mysqli.inc.php:		if ($this->fetchMode !== false)
drivers/adodb-mysqli.inc.php:			$savem = $this->SetFetchMode(false);
drivers/adodb-mysqli.inc.php:		$rs = $this->Execute(sprintf($this->metaColumnsSQL,$table));
drivers/adodb-mysqli.inc.php:		if (isset($savem)) $this->SetFetchMode($savem);
drivers/adodb-mysqli.inc.php:		while (!$rs->EOF) {
drivers/adodb-mysqli.inc.php:			$fld->name = $rs->fields[0];
drivers/adodb-mysqli.inc.php:			$type = $rs->fields[1];
drivers/adodb-mysqli.inc.php:			$fld->scale = null;
drivers/adodb-mysqli.inc.php:				$fld->type = $query_array[1];
drivers/adodb-mysqli.inc.php:				$fld->max_length = is_numeric($query_array[2]) ? $query_array[2] : -1;
drivers/adodb-mysqli.inc.php:				$fld->scale = is_numeric($query_array[3]) ? $query_array[3] : -1;
drivers/adodb-mysqli.inc.php:				$fld->type = $query_array[1];
drivers/adodb-mysqli.inc.php:				$fld->max_length = is_numeric($query_array[2]) ? $query_array[2] : -1;
drivers/adodb-mysqli.inc.php:				$fld->type = $type;
drivers/adodb-mysqli.inc.php:				$fld->max_length = -1;
drivers/adodb-mysqli.inc.php:			$fld->not_null = ($rs->fields[2] != 'YES');
drivers/adodb-mysqli.inc.php:			$fld->primary_key = ($rs->fields[3] == 'PRI');
drivers/adodb-mysqli.inc.php:			$fld->auto_increment = (strpos($rs->fields[5], 'auto_increment') !== false);
drivers/adodb-mysqli.inc.php:			$fld->binary = (strpos($type,'blob') !== false);
drivers/adodb-mysqli.inc.php:			$fld->unsigned = (strpos($type,'unsigned') !== false);
drivers/adodb-mysqli.inc.php:			if (!$fld->binary) {
drivers/adodb-mysqli.inc.php:				$d = $rs->fields[4];
drivers/adodb-mysqli.inc.php:					$fld->has_default = true;
drivers/adodb-mysqli.inc.php:					$fld->default_value = $d;
drivers/adodb-mysqli.inc.php:					$fld->has_default = false;
drivers/adodb-mysqli.inc.php:				$retarr[strtoupper($fld->name)] = $fld;
drivers/adodb-mysqli.inc.php:			$rs->MoveNext();
drivers/adodb-mysqli.inc.php:		$rs->Close();
drivers/adodb-mysqli.inc.php://	    $this->_connectionID = $this->mysqli_resolve_link($this->_connectionID);
drivers/adodb-mysqli.inc.php:	    $this->databaseName = $dbName;
drivers/adodb-mysqli.inc.php:	    if ($this->_connectionID) {
drivers/adodb-mysqli.inc.php:        	$result = @mysqli_select_db($this->_connectionID, $dbName);
drivers/adodb-mysqli.inc.php:		    	ADOConnection::outp("Select of database " . $dbName . " failed. " . $this->ErrorMsg());
drivers/adodb-mysqli.inc.php:			      $nrows = -1,
drivers/adodb-mysqli.inc.php:			      $offset = -1,
drivers/adodb-mysqli.inc.php:			$rs =& $this->CacheExecute($secs, $sql . " LIMIT $offsetStr$nrows" , $inputarr , $arg3);
drivers/adodb-mysqli.inc.php:			$rs =& $this->Execute($sql . " LIMIT $offsetStr$nrows" , $inputarr , $arg3);
drivers/adodb-mysqli.inc.php:		$stmt = $this->_connectionID->prepare($sql);
drivers/adodb-mysqli.inc.php:			echo $this->ErrorMsg();
drivers/adodb-mysqli.inc.php:		if (!$mysql_res =  mysqli_query($this->_connectionID, $sql, ($ADODB_COUNTRECS) ? MYSQLI_STORE_RESULT : MYSQLI_USE_RESULT)) {
drivers/adodb-mysqli.inc.php:		    if ($this->debug) ADOConnection::outp("Query: " . $sql . " failed. " . $this->ErrorMsg());
drivers/adodb-mysqli.inc.php:	    if (empty($this->_connectionID)) 
drivers/adodb-mysqli.inc.php:	      $this->_errorMsg = @mysqli_error();
drivers/adodb-mysqli.inc.php:	      $this->_errorMsg = @mysqli_error($this->_connectionID);
drivers/adodb-mysqli.inc.php:	    return $this->_errorMsg;
drivers/adodb-mysqli.inc.php:	    if (empty($this->_connectionID))  
drivers/adodb-mysqli.inc.php:	      return @mysqli_errno($this->_connectionID);
drivers/adodb-mysqli.inc.php:	    @mysqli_close($this->_connectionID);
drivers/adodb-mysqli.inc.php:	    $this->_connectionID = false;
drivers/adodb-mysqli.inc.php:/*--------------------------------------------------------------------------------------
drivers/adodb-mysqli.inc.php:--------------------------------------------------------------------------------------*/
drivers/adodb-mysqli.inc.php:	      $this->fetchMode = MYSQLI_NUM; 
drivers/adodb-mysqli.inc.php:	      $this->fetchMode = MYSQLI_ASSOC; 
drivers/adodb-mysqli.inc.php:	      $this->fetchMode = MYSQLI_BOTH; 
drivers/adodb-mysqli.inc.php:	  $this->adodbFetchMode = $mode;
drivers/adodb-mysqli.inc.php:	  $this->ADORecordSet($queryID);	
drivers/adodb-mysqli.inc.php:		$this->_numOfRows = $ADODB_COUNTRECS ? @mysqli_num_rows($this->_queryID) : -1;
drivers/adodb-mysqli.inc.php:		$this->_numOfFields = @mysqli_num_fields($this->_queryID);
drivers/adodb-mysqli.inc.php:	function &FetchField($fieldOffset = -1) 
drivers/adodb-mysqli.inc.php:	  if ($fieldOffset != -1) {
drivers/adodb-mysqli.inc.php:	    $fieldOffset = mysqli_field_seek($this->_queryID, $fieldnr);
drivers/adodb-mysqli.inc.php:	  $o = mysqli_fetch_field($this->_queryID);
drivers/adodb-mysqli.inc.php:	  if ($this->fetchMode == MYSQLI_ASSOC && !$upper) 
drivers/adodb-mysqli.inc.php:	    return $this->fields;
drivers/adodb-mysqli.inc.php:	  if ($this->fetchMode != MYSQLI_NUM) 
drivers/adodb-mysqli.inc.php:	    return @$this->fields[$colname];
drivers/adodb-mysqli.inc.php:	  if (!$this->bind) {
drivers/adodb-mysqli.inc.php:	    $this->bind = array();
drivers/adodb-mysqli.inc.php:	    for ($i = 0; $i < $this->_numOfFields; $i++) {
drivers/adodb-mysqli.inc.php:	      $o = $this->FetchField($i);
drivers/adodb-mysqli.inc.php:	      $this->bind[strtoupper($o->name)] = $i;
drivers/adodb-mysqli.inc.php:	  return $this->fields[$this->bind[strtoupper($colname)]];
drivers/adodb-mysqli.inc.php:	  if ($this->_numOfRows == 0) 
drivers/adodb-mysqli.inc.php:	  mysqli_data_seek($this->_queryID, $row);
drivers/adodb-mysqli.inc.php:	  $this->EOF = false;
drivers/adodb-mysqli.inc.php:	// This is the only implementation that works now (23-10-2003).
drivers/adodb-mysqli.inc.php:		if ($this->EOF) return false;
drivers/adodb-mysqli.inc.php:		$this->_currentRow++;
drivers/adodb-mysqli.inc.php:		$this->fields = @mysqli_fetch_array($this->_queryID,$this->fetchMode);
drivers/adodb-mysqli.inc.php:		if (is_array($this->fields)) return true;
drivers/adodb-mysqli.inc.php:		$this->EOF = true;
drivers/adodb-mysqli.inc.php:		$this->fields = mysqli_fetch_array($this->_queryID,$this->fetchMode);  
drivers/adodb-mysqli.inc.php:	  	return is_array($this->fields);
drivers/adodb-mysqli.inc.php:		mysqli_free_result($this->_queryID); 
drivers/adodb-mysqli.inc.php:	  	$this->_queryID = false;	
drivers/adodb-mysqli.inc.php:	function MetaType($t, $len = -1, $fieldobj = false)
drivers/adodb-mysqli.inc.php:		    $t = $fieldobj->type;
drivers/adodb-mysqli.inc.php:		    $len = $fieldobj->max_length;
drivers/adodb-mysqli.inc.php:		 $len = -1; // mysql max_length is not accurate
drivers/adodb-mysqli.inc.php:		   if ($len <= $this->blobSize) return 'C';
drivers/adodb-mysqli.inc.php:		   return !empty($fieldobj->binary) ? 'B' : 'X';
drivers/adodb-mysqli.inc.php:		   if (!empty($fieldobj->primary_key)) return 'R';
drivers/adodb-mysqli.inc.php:		   // Added floating-point types
drivers/adodb-mysqli.inc.php:		 	if (!is_numeric($t)) echo "<p>--- Error in type matching $t -----</p>"; 
drivers/adodb-postgres.inc.php: V4.54 5 Nov 2004  (c) 2000-2004 John Lim (jlim@natsoft.com.my). All rights reserved.
drivers/adodb-mysql.inc.php:V4.54 5 Nov 2004  (c) 2000-2004 John Lim (jlim@natsoft.com.my). All rights reserved.
drivers/adodb-mysql.inc.php: 28 Feb 2001: MetaColumns bug fix - suggested by  Freek Dijkstra (phpeverywhere@macfreek.com)
drivers/adodb-mysql.inc.php:// security - hide paths
drivers/adodb-mysql.inc.php:	var $fmtTimeStamp = "'Y-m-d H:i:s'";
drivers/adodb-mysql.inc.php:		if (defined('ADODB_EXTENSION')) $this->rsPrefix .= 'ext_';
drivers/adodb-mysql.inc.php:		$save = $this->metaTablesSQL;
drivers/adodb-mysql.inc.php:			$this->metaTablesSQL .= " from $showSchema";
drivers/adodb-mysql.inc.php:			$mask = $this->qstr($mask);
drivers/adodb-mysql.inc.php:			$this->metaTablesSQL .= " like $mask";
drivers/adodb-mysql.inc.php:		$this->metaTablesSQL = $save;
drivers/adodb-mysql.inc.php:        if ($this->fetchMode !== FALSE) {
drivers/adodb-mysql.inc.php:               $savem = $this->SetFetchMode(FALSE);
drivers/adodb-mysql.inc.php:        $rs = $this->Execute(sprintf('SHOW INDEX FROM %s',$table));
drivers/adodb-mysql.inc.php:                $this->SetFetchMode($savem);
drivers/adodb-mysql.inc.php:        while ($row = $rs->FetchRow()) {
drivers/adodb-mysql.inc.php:                $indexes[$row[2]]['columns'][$row[3] - 1] = $row[4];
drivers/adodb-mysql.inc.php:				if (is_resource($this->_connectionID))
drivers/adodb-mysql.inc.php:					return "'".mysql_real_escape_string($s,$this->_connectionID)."'";
drivers/adodb-mysql.inc.php:			if ($this->replaceQuote[0] == '\\'){
drivers/adodb-mysql.inc.php:			return  "'".str_replace("'",$this->replaceQuote,$s)."'"; 
drivers/adodb-mysql.inc.php:		return mysql_insert_id($this->_connectionID);
drivers/adodb-mysql.inc.php:			$rs =& $this->SelectLimit($sql,1,-1,$inputarr);
drivers/adodb-mysql.inc.php:				$rs->Close();
drivers/adodb-mysql.inc.php:				if ($rs->EOF) return false;
drivers/adodb-mysql.inc.php:				return reset($rs->fields);
drivers/adodb-mysql.inc.php:		if ($this->debug) ADOConnection::outp("Transactions not supported in 'mysql' driver. Use 'mysqlt' or 'mysqli' driver");
drivers/adodb-mysql.inc.php:			return mysql_affected_rows($this->_connectionID);
drivers/adodb-mysql.inc.php:		if (empty($this->_genSeqSQL)) return false;
drivers/adodb-mysql.inc.php:		$ok = $this->Execute(sprintf($this->_genSeqSQL,$seqname));
drivers/adodb-mysql.inc.php:		return $this->Execute(sprintf($this->_genSeq2SQL,$seqname,$startID-1));
drivers/adodb-mysql.inc.php:		// post-nuke sets hasGenID to false
drivers/adodb-mysql.inc.php:		if (!$this->hasGenID) return false;
drivers/adodb-mysql.inc.php:		$savelog = $this->_logsql;
drivers/adodb-mysql.inc.php:		$this->_logsql = false;
drivers/adodb-mysql.inc.php:		$getnext = sprintf($this->_genIDSQL,$seqname);
drivers/adodb-mysql.inc.php:		$holdtransOK = $this->_transOK; // save the current status
drivers/adodb-mysql.inc.php:		$rs = @$this->Execute($getnext);
drivers/adodb-mysql.inc.php:			if ($holdtransOK) $this->_transOK = true; //if the status was ok before reset
drivers/adodb-mysql.inc.php:			$this->Execute(sprintf($this->_genSeqSQL,$seqname));
drivers/adodb-mysql.inc.php:			$this->Execute(sprintf($this->_genSeq2SQL,$seqname,$startID-1));
drivers/adodb-mysql.inc.php:			$rs = $this->Execute($getnext);
drivers/adodb-mysql.inc.php:		$this->genID = mysql_insert_id($this->_connectionID);
drivers/adodb-mysql.inc.php:		if ($rs) $rs->Close();
drivers/adodb-mysql.inc.php:		$this->_logsql = $savelog;
drivers/adodb-mysql.inc.php:		return $this->genID;
drivers/adodb-mysql.inc.php:		$qid = mysql_list_dbs($this->_connectionID);
drivers/adodb-mysql.inc.php:		if (!$col) $col = $this->sysTimeStamp;
drivers/adodb-mysql.inc.php:			case '-':
drivers/adodb-mysql.inc.php:	// much easier to run "mysqld --ansi" or "mysqld --sql-mode=PIPES_AS_CONCAT" and use || operator
drivers/adodb-mysql.inc.php:		if (!$date) $date = $this->sysDate;
drivers/adodb-mysql.inc.php:			$this->_connectionID = mysql_connect($argHostname,$argUsername,$argPassword,
drivers/adodb-mysql.inc.php:												$this->forceNewConnect,$this->clientFlags);
drivers/adodb-mysql.inc.php:			$this->_connectionID = mysql_connect($argHostname,$argUsername,$argPassword,
drivers/adodb-mysql.inc.php:												$this->forceNewConnect);
drivers/adodb-mysql.inc.php:			$this->_connectionID = mysql_connect($argHostname,$argUsername,$argPassword);
drivers/adodb-mysql.inc.php:		if ($this->_connectionID === false) return false;
drivers/adodb-mysql.inc.php:		if ($argDatabasename) return $this->SelectDB($argDatabasename);
drivers/adodb-mysql.inc.php:			$this->_connectionID = mysql_pconnect($argHostname,$argUsername,$argPassword,$this->clientFlags);
drivers/adodb-mysql.inc.php:			$this->_connectionID = mysql_pconnect($argHostname,$argUsername,$argPassword);
drivers/adodb-mysql.inc.php:		if ($this->_connectionID === false) return false;
drivers/adodb-mysql.inc.php:		if ($this->autoRollback) $this->RollbackTrans();
drivers/adodb-mysql.inc.php:		if ($argDatabasename) return $this->SelectDB($argDatabasename);
drivers/adodb-mysql.inc.php:		$this->forceNewConnect = true;
drivers/adodb-mysql.inc.php:		return $this->_connect($argHostname, $argUsername, $argPassword, $argDatabasename);
drivers/adodb-mysql.inc.php:		if ($this->fetchMode !== false) $savem = $this->SetFetchMode(false);
drivers/adodb-mysql.inc.php:		$rs = $this->Execute(sprintf($this->metaColumnsSQL,$table));
drivers/adodb-mysql.inc.php:		if (isset($savem)) $this->SetFetchMode($savem);
drivers/adodb-mysql.inc.php:		while (!$rs->EOF){
drivers/adodb-mysql.inc.php:			$fld->name = $rs->fields[0];
drivers/adodb-mysql.inc.php:			$type = $rs->fields[1];
drivers/adodb-mysql.inc.php:			$fld->scale = null;
drivers/adodb-mysql.inc.php:				$fld->type = $query_array[1];
drivers/adodb-mysql.inc.php:				$fld->max_length = is_numeric($query_array[2]) ? $query_array[2] : -1;
drivers/adodb-mysql.inc.php:				$fld->scale = is_numeric($query_array[3]) ? $query_array[3] : -1;
drivers/adodb-mysql.inc.php:				$fld->type = $query_array[1];
drivers/adodb-mysql.inc.php:				$fld->max_length = is_numeric($query_array[2]) ? $query_array[2] : -1;
drivers/adodb-mysql.inc.php:				$fld->type = $type;
drivers/adodb-mysql.inc.php:				$fld->max_length = -1;
drivers/adodb-mysql.inc.php:			$fld->not_null = ($rs->fields[2] != 'YES');
drivers/adodb-mysql.inc.php:			$fld->primary_key = ($rs->fields[3] == 'PRI');
drivers/adodb-mysql.inc.php:			$fld->auto_increment = (strpos($rs->fields[5], 'auto_increment') !== false);
drivers/adodb-mysql.inc.php:			$fld->binary = (strpos($type,'blob') !== false);
drivers/adodb-mysql.inc.php:			$fld->unsigned = (strpos($type,'unsigned') !== false);
drivers/adodb-mysql.inc.php:			if (!$fld->binary) {
drivers/adodb-mysql.inc.php:				$d = $rs->fields[4];
drivers/adodb-mysql.inc.php:					$fld->has_default = true;
drivers/adodb-mysql.inc.php:					$fld->default_value = $d;
drivers/adodb-mysql.inc.php:					$fld->has_default = false;
drivers/adodb-mysql.inc.php:				$retarr[strtoupper($fld->name)] = $fld;
drivers/adodb-mysql.inc.php:				$rs->MoveNext();
drivers/adodb-mysql.inc.php:			$rs->Close();
drivers/adodb-mysql.inc.php:		$this->databaseName = $dbName;
drivers/adodb-mysql.inc.php:		if ($this->_connectionID) {
drivers/adodb-mysql.inc.php:			return @mysql_select_db($dbName,$this->_connectionID);		
drivers/adodb-mysql.inc.php:	function &SelectLimit($sql,$nrows=-1,$offset=-1,$inputarr=false,$secs=0)
drivers/adodb-mysql.inc.php:			$rs =& $this->CacheExecute($secs,$sql." LIMIT $offsetStr$nrows",$inputarr);
drivers/adodb-mysql.inc.php:			$rs =& $this->Execute($sql." LIMIT $offsetStr$nrows",$inputarr);
drivers/adodb-mysql.inc.php:		return mysql_query($sql,$this->_connectionID);
drivers/adodb-mysql.inc.php:		//else return @mysql_unbuffered_query($sql,$this->_connectionID); // requires PHP >= 4.0.6
drivers/adodb-mysql.inc.php:		if ($this->_logsql) return $this->_errorMsg;
drivers/adodb-mysql.inc.php:		if (empty($this->_connectionID)) $this->_errorMsg = @mysql_error();
drivers/adodb-mysql.inc.php:		else $this->_errorMsg = @mysql_error($this->_connectionID);
drivers/adodb-mysql.inc.php:		return $this->_errorMsg;
drivers/adodb-mysql.inc.php:		if ($this->_logsql) return $this->_errorCode;
drivers/adodb-mysql.inc.php:		if (empty($this->_connectionID))  return @mysql_errno();
drivers/adodb-mysql.inc.php:		else return @mysql_errno($this->_connectionID);
drivers/adodb-mysql.inc.php:		@mysql_close($this->_connectionID);
drivers/adodb-mysql.inc.php:		$this->_connectionID = false;
drivers/adodb-mysql.inc.php:/*--------------------------------------------------------------------------------------
drivers/adodb-mysql.inc.php:--------------------------------------------------------------------------------------*/
drivers/adodb-mysql.inc.php:		case ADODB_FETCH_NUM: $this->fetchMode = MYSQL_NUM; break;
drivers/adodb-mysql.inc.php:		case ADODB_FETCH_ASSOC:$this->fetchMode = MYSQL_ASSOC; break;
drivers/adodb-mysql.inc.php:		case ADODB_FETCH_BOTH:$this->fetchMode = MYSQL_BOTH; break;
drivers/adodb-mysql.inc.php:		$this->adodbFetchMode = $mode;
drivers/adodb-mysql.inc.php:		$this->ADORecordSet($queryID);	
drivers/adodb-mysql.inc.php:	//	$this->_numOfRows = ($ADODB_COUNTRECS) ? @mysql_num_rows($this->_queryID):-1;
drivers/adodb-mysql.inc.php:		$this->_numOfRows = @mysql_num_rows($this->_queryID);
drivers/adodb-mysql.inc.php:		$this->_numOfFields = @mysql_num_fields($this->_queryID);
drivers/adodb-mysql.inc.php:	function &FetchField($fieldOffset = -1) 
drivers/adodb-mysql.inc.php:		if ($fieldOffset != -1) {
drivers/adodb-mysql.inc.php:			$o = @mysql_fetch_field($this->_queryID, $fieldOffset);
drivers/adodb-mysql.inc.php:			$f = @mysql_field_flags($this->_queryID,$fieldOffset);
drivers/adodb-mysql.inc.php:			$o->max_length = @mysql_field_len($this->_queryID,$fieldOffset); // suggested by: Jim Nicholson (jnich@att.com)
drivers/adodb-mysql.inc.php:			//$o->max_length = -1; // mysql returns the max length less spaces -- so it is unrealiable
drivers/adodb-mysql.inc.php:			$o->binary = (strpos($f,'binary')!== false);
drivers/adodb-mysql.inc.php:		else if ($fieldOffset == -1) {	/*	The $fieldOffset argument is not provided thus its -1 	*/
drivers/adodb-mysql.inc.php:			$o = @mysql_fetch_field($this->_queryID);
drivers/adodb-mysql.inc.php:			$o->max_length = @mysql_field_len($this->_queryID); // suggested by: Jim Nicholson (jnich@att.com)
drivers/adodb-mysql.inc.php:			//$o->max_length = -1; // mysql returns the max length less spaces -- so it is unrealiable
drivers/adodb-mysql.inc.php:		if ($this->fetchMode == MYSQL_ASSOC && !$upper) return $this->fields;
drivers/adodb-mysql.inc.php:		if ($this->fetchMode != MYSQL_NUM) return @$this->fields[$colname];
drivers/adodb-mysql.inc.php:		if (!$this->bind) {
drivers/adodb-mysql.inc.php:			$this->bind = array();
drivers/adodb-mysql.inc.php:			for ($i=0; $i < $this->_numOfFields; $i++) {
drivers/adodb-mysql.inc.php:				$o = $this->FetchField($i);
drivers/adodb-mysql.inc.php:				$this->bind[strtoupper($o->name)] = $i;
drivers/adodb-mysql.inc.php:		 return $this->fields[$this->bind[strtoupper($colname)]];
drivers/adodb-mysql.inc.php:		if ($this->_numOfRows == 0) return false;
drivers/adodb-mysql.inc.php:		return @mysql_data_seek($this->_queryID,$row);
drivers/adodb-mysql.inc.php:		if (@$this->fields =& mysql_fetch_array($this->_queryID,$this->fetchMode)) {
drivers/adodb-mysql.inc.php:			$this->_currentRow += 1;
drivers/adodb-mysql.inc.php:		if (!$this->EOF) {
drivers/adodb-mysql.inc.php:			$this->_currentRow += 1;
drivers/adodb-mysql.inc.php:			$this->EOF = true;
drivers/adodb-mysql.inc.php:		$this->fields =  @mysql_fetch_array($this->_queryID,$this->fetchMode);
drivers/adodb-mysql.inc.php:		return is_array($this->fields);
drivers/adodb-mysql.inc.php:		@mysql_free_result($this->_queryID);	
drivers/adodb-mysql.inc.php:		$this->_queryID = false;	
drivers/adodb-mysql.inc.php:	function MetaType($t,$len=-1,$fieldobj=false)
drivers/adodb-mysql.inc.php:			$t = $fieldobj->type;
drivers/adodb-mysql.inc.php:			$len = $fieldobj->max_length;
drivers/adodb-mysql.inc.php:		$len = -1; // mysql max_length is not accurate
drivers/adodb-mysql.inc.php:			if ($len <= $this->blobSize) return 'C';
drivers/adodb-mysql.inc.php:			return !empty($fieldobj->binary) ? 'B' : 'X';
drivers/adodb-mysql.inc.php:			if (!empty($fieldobj->primary_key)) return 'R';
drivers/adodb-mysql.inc.php:		case ADODB_FETCH_NUM: $this->fetchMode = MYSQL_NUM; break;
drivers/adodb-mysql.inc.php:		case ADODB_FETCH_ASSOC:$this->fetchMode = MYSQL_ASSOC; break;
drivers/adodb-mysql.inc.php:		case ADODB_FETCH_BOTH:$this->fetchMode = MYSQL_BOTH; break;
drivers/adodb-mysql.inc.php:		$this->adodbFetchMode = $mode;
drivers/adodb-mysql.inc.php:		$this->ADORecordSet($queryID);
drivers/adodb-informix.inc.php:* @version V4.54 5 Nov 2004 (c) 2000-2004 John Lim (jlim@natsoft.com.my). All rights reserved.
drivers/adodb-informix.inc.php:// security - hide paths
drivers/adodb-informix.inc.php:include_once(ADODB_DIR.'/drivers/adodb-informix72.inc.php');
drivers/adodb-informix.inc.php:		$this->ADORecordset_informix72($id,$mode);
drivers/adodb-sqlanywhere.inc.php:version V4.54 5 Nov 2004 (c) 2000-2004  John Lim (jlim@natsoft.com.my).  All rights
drivers/adodb-sqlanywhere.inc.php:  21.02.2002 - Wade Johnson wade@wadejohnson.de
drivers/adodb-sqlanywhere.inc.php:		$dbconn->create_blobvar($blobVarName);
drivers/adodb-sqlanywhere.inc.php:	  $dbcon->load_blobvar_from_file($blobVarName, $filename);
drivers/adodb-sqlanywhere.inc.php:		$recordSet = $dbconn->Execute('INSERT INTO tabname (idcol, blobcol) '
drivers/adodb-sqlanywhere.inc.php:	  $dbcon->load_blobvar_from_var($blobVarName, $varName);
drivers/adodb-sqlanywhere.inc.php:	  $dbconn->drop_blobvar($blobVarName);
drivers/adodb-sqlanywhere.inc.php:// security - hide paths
drivers/adodb-sqlanywhere.inc.php: include(ADODB_DIR."/drivers/adodb-odbc.inc.php");
drivers/adodb-sqlanywhere.inc.php:		$this->ADODB_odbc();
drivers/adodb-sqlanywhere.inc.php:  	   return $this->GetOne('select @@identity');
drivers/adodb-sqlanywhere.inc.php:   $this->Execute("create variable $blobVarName long binary");
drivers/adodb-sqlanywhere.inc.php:   $this->Execute("drop variable $blobVarName");
drivers/adodb-sqlanywhere.inc.php:	$hexstring = $this->qstr($hexstring);
drivers/adodb-sqlanywhere.inc.php:	$this->Execute("set $blobVarName = $blobVarName || " . $hexstring);
drivers/adodb-sqlanywhere.inc.php:	$contents = substr ($varName, (($loop - 1) * $chunk_size), $chunk_size);
drivers/adodb-sqlanywhere.inc.php:	$hexstring = $this->qstr($hexstring);
drivers/adodb-sqlanywhere.inc.php:	$this->Execute("set $blobVarName = $blobVarName || " . $hexstring);
drivers/adodb-sqlanywhere.inc.php:  $conn->Execute('INSERT INTO blobtable (id, blobcol) VALUES (1, null)');
drivers/adodb-sqlanywhere.inc.php:  $conn->UpdateBlob('blobtable','blobcol',$blob,'id=1');
drivers/adodb-sqlanywhere.inc.php:   $this->create_blobvar($blobVarName);
drivers/adodb-sqlanywhere.inc.php:   $this->load_blobvar_from_var($blobVarName, $val);
drivers/adodb-sqlanywhere.inc.php:   $this->Execute("UPDATE $table SET $column=$blobVarName WHERE $where");
drivers/adodb-sqlanywhere.inc.php:   $this->drop_blobvar($blobVarName);
drivers/adodb-sqlanywhere.inc.php:  $this->ADORecordSet_odbc($id,$mode);
drivers/adodb-sapdb.inc.php:V4.54 5 Nov 2004  (c) 2000-2004 John Lim (jlim@natsoft.com.my). All rights reserved.
drivers/adodb-sapdb.inc.php:// security - hide paths
drivers/adodb-sapdb.inc.php:	include(ADODB_DIR."/drivers/adodb-odbc.inc.php");
drivers/adodb-sapdb.inc.php:	var $fmtDate = "'Y-m-d'";	/// used by DBDate() as the default date format used by the database
drivers/adodb-sapdb.inc.php:	var $fmtTimeStamp = "'Y-m-d H:i:s'"; /// used by DBTimeStamp as the default timestamp fmt.
drivers/adodb-sapdb.inc.php:		//if (strncmp(PHP_OS,'WIN',3) === 0) $this->curmode = SQL_CUR_USE_ODBC;
drivers/adodb-sapdb.inc.php:		$this->ADODB_odbc();
drivers/adodb-sapdb.inc.php:		if (!$info['version'] && preg_match('/([0-9.]+)/',$info['description'],$matches)) {
drivers/adodb-sapdb.inc.php:		$table = $this->Quote(strtoupper($table));
drivers/adodb-sapdb.inc.php:		return $this->GetCol("SELECT columnname FROM COLUMNS WHERE tablename=$table AND mode='KEY' ORDER BY pos");
drivers/adodb-sapdb.inc.php:		$table = $this->Quote(strtoupper($table));
drivers/adodb-sapdb.inc.php:        if ($this->fetchMode !== FALSE) {
drivers/adodb-sapdb.inc.php:        	$savem = $this->SetFetchMode(FALSE);
drivers/adodb-sapdb.inc.php:        $rs = $this->Execute($sql);
drivers/adodb-sapdb.inc.php:        	$this->SetFetchMode($savem);
drivers/adodb-sapdb.inc.php:		while ($row = $rs->FetchRow()) {
drivers/adodb-sapdb.inc.php:					'columns' => $this->GetCol("SELECT columnname FROM COLUMNS WHERE tablename=$table AND mode='KEY' ORDER BY pos"),
drivers/adodb-sapdb.inc.php:        if ($this->fetchMode !== FALSE) {
drivers/adodb-sapdb.inc.php:        	$savem = $this->SetFetchMode(FALSE);
drivers/adodb-sapdb.inc.php:		$table = $this->Quote(strtoupper($table));
drivers/adodb-sapdb.inc.php:		foreach($this->GetAll("SELECT COLUMNNAME,DATATYPE,LEN,DEC,NULLABLE,MODE,\"DEFAULT\",CASE WHEN \"DEFAULT\" IS NULL THEN 0 ELSE 1 END AS HAS_DEFAULT FROM COLUMNS WHERE tablename=$table ORDER BY pos") as $column)
drivers/adodb-sapdb.inc.php:			$fld->name = $column[0];
drivers/adodb-sapdb.inc.php:			$fld->type = $column[1];
drivers/adodb-sapdb.inc.php:			$fld->max_length = $fld->type == 'LONG' ? 2147483647 : $column[2];
drivers/adodb-sapdb.inc.php:			$fld->scale = $column[3];
drivers/adodb-sapdb.inc.php:			$fld->not_null = $column[4] == 'NO';
drivers/adodb-sapdb.inc.php:			$fld->primary_key = $column[5] == 'KEY';
drivers/adodb-sapdb.inc.php:			if ($fld->has_default = $column[7]) {
drivers/adodb-sapdb.inc.php:				if ($fld->primary_key && $column[6] == 'DEFAULT SERIAL (1)') {
drivers/adodb-sapdb.inc.php:					$fld->auto_increment = true;
drivers/adodb-sapdb.inc.php:					$fld->has_default = false;
drivers/adodb-sapdb.inc.php:					$fld->default_value = $column[6];
drivers/adodb-sapdb.inc.php:					switch($fld->type) {
drivers/adodb-sapdb.inc.php:							$fld->default_value = $column[6];
drivers/adodb-sapdb.inc.php:							$fld->default_value = trim($column[6]);
drivers/adodb-sapdb.inc.php:			$retarr[$fld->name] = $fld;	
drivers/adodb-sapdb.inc.php:        	$this->SetFetchMode($savem);
drivers/adodb-sapdb.inc.php:		$table = $this->Quote(strtoupper($table));
drivers/adodb-sapdb.inc.php:		return $this->GetCol("SELECT columnname FROM COLUMNS WHERE tablename=$table ORDER BY pos");
drivers/adodb-sapdb.inc.php:	// unlike it seems, this depends on the db-session and works in a multiuser environment
drivers/adodb-sapdb.inc.php:		return empty($table) ? False : $this->GetOne("SELECT $table.CURRVAL FROM DUAL");
drivers/adodb-sapdb.inc.php:		See http://listserv.sap.com/pipermail/sapdb.general/2002-January/010405.html
drivers/adodb-sapdb.inc.php:		$this->ADORecordSet_odbc($id,$mode);
drivers/adodb-firebird.inc.php:V4.54 5 Nov 2004  (c) 2000-2004 John Lim (jlim@natsoft.com.my). All rights reserved.
drivers/adodb-firebird.inc.php:// security - hide paths
drivers/adodb-firebird.inc.php:include_once(ADODB_DIR."/drivers/adodb-ibase.inc.php");
drivers/adodb-firebird.inc.php:		$this->ADODB_ibase();
drivers/adodb-firebird.inc.php:		$arr['dialect'] = $this->dialect;
drivers/adodb-firebird.inc.php:	// Note that Interbase 6.5 uses this ROWS instead - don't you love forking wars!
drivers/adodb-firebird.inc.php:	// 		SELECT col1, col2 FROM table ROWS 5 -- get 5 rows 
drivers/adodb-firebird.inc.php:	//		SELECT col1, col2 FROM TABLE ORDER BY col1 ROWS 3 TO 7 -- first 5 skip 2
drivers/adodb-firebird.inc.php:	function &SelectLimit($sql,$nrows=-1,$offset=-1,$inputarr=false, $secs=0)
drivers/adodb-firebird.inc.php:			$rs =& $this->CacheExecute($secs,$sql,$inputarr);
drivers/adodb-firebird.inc.php:			$rs =& $this->Execute($sql,$inputarr);
drivers/adodb-firebird.inc.php:		$this->ADORecordSet_ibase($id,$mode);
drivers/adodb-csv.inc.php:V4.54 5 Nov 2004  (c) 2000-2004 John Lim (jlim@natsoft.com.my). All rights reserved.
drivers/adodb-csv.inc.php:// security - hide paths
drivers/adodb-csv.inc.php:include_once(ADODB_DIR.'/adodb-csvlib.inc.php');
drivers/adodb-csv.inc.php:	var $fmtTimeStamp = "'Y-m-d H:i:s'";
drivers/adodb-csv.inc.php:			return $this->_insertid;
drivers/adodb-csv.inc.php:			return $this->_affectedrows;
drivers/adodb-csv.inc.php:		$this->_url = $argHostname;
drivers/adodb-csv.inc.php:		$this->_url = $argHostname;
drivers/adodb-csv.inc.php:	function &SelectLimit($sql,$nrows=-1,$offset=-1)
drivers/adodb-csv.inc.php:		$url = $this->_url.'?sql='.urlencode($sql)."&nrows=$nrows&fetch=".
drivers/adodb-csv.inc.php:			(($this->fetchMode !== false)?$this->fetchMode : $ADODB_FETCH_MODE).
drivers/adodb-csv.inc.php:		if ($this->debug) print "$url<br><i>$err</i><br>";
drivers/adodb-csv.inc.php:			$this->_errorMsg = $err;
drivers/adodb-csv.inc.php:			$this->_errorNo = (integer)$err;
drivers/adodb-csv.inc.php:			$this->_errorMsg = substr($err,$at+4,1024);
drivers/adodb-csv.inc.php:			$this->_errorNo = -9999;
drivers/adodb-csv.inc.php:		if ($this->_errorNo) 
drivers/adodb-csv.inc.php:			if ($fn = $this->raiseErrorFn) {
drivers/adodb-csv.inc.php:				$fn($this->databaseType,'EXECUTE',$this->ErrorNo(),$this->ErrorMsg(),$sql,'');
drivers/adodb-csv.inc.php:			$rs->databaseType='csv';		
drivers/adodb-csv.inc.php:			$rs->fetchMode = ($this->fetchMode !== false) ?  $this->fetchMode : $ADODB_FETCH_MODE;
drivers/adodb-csv.inc.php:			$rs->connection = &$this;
drivers/adodb-csv.inc.php:		if (!$this->_bindInputArray && $inputarr) {
drivers/adodb-csv.inc.php:					$sql .= $this->qstr($v);
drivers/adodb-csv.inc.php:		$url =  $this->_url.'?sql='.urlencode($sql)."&fetch=".
drivers/adodb-csv.inc.php:			(($this->fetchMode !== false)?$this->fetchMode : $ADODB_FETCH_MODE);
drivers/adodb-csv.inc.php:		if ($this->debug) print urldecode($url)."<br><i>$err</i><br>";
drivers/adodb-csv.inc.php:			$this->_errorMsg = $err;
drivers/adodb-csv.inc.php:			$this->_errorNo = (integer)$err;
drivers/adodb-csv.inc.php:			$this->_errorMsg = substr($err,$at+4,1024);
drivers/adodb-csv.inc.php:			$this->_errorNo = -9999;
drivers/adodb-csv.inc.php:		if ($this->_errorNo) 
drivers/adodb-csv.inc.php:			if ($fn = $this->raiseErrorFn) {
drivers/adodb-csv.inc.php:				$fn($this->databaseType,'EXECUTE',$this->ErrorNo(),$this->ErrorMsg(),$sql,$inputarr);
drivers/adodb-csv.inc.php:			$rs->fetchMode = ($this->fetchMode !== false) ?  $this->fetchMode : $ADODB_FETCH_MODE;
drivers/adodb-csv.inc.php:			$this->_affectedrows = $rs->affectedrows;
drivers/adodb-csv.inc.php:			$this->_insertid = $rs->insertid;
drivers/adodb-csv.inc.php:			$rs->databaseType='csv';
drivers/adodb-csv.inc.php:			$rs->connection = &$this;
drivers/adodb-csv.inc.php:			return $this->_errorMsg;
drivers/adodb-csv.inc.php:		return $this->_errorNo;
drivers/adodb-csv.inc.php:		$this->ADORecordset($id,$mode);
drivers/adodb-db2.inc.php:V4.54 5 Nov 2004  (c) 2000-2004 John Lim (jlim@natsoft.com.my). All rights reserved.
drivers/adodb-db2.inc.php:After "playing" a little bit with the php-scripts that try
drivers/adodb-db2.inc.php:A 32-bit option specifying how the Driver Manager uses the ODBC cursor
drivers/adodb-db2.inc.php:$db->curMode = SQL_CUR_USE_ODBC;
drivers/adodb-db2.inc.php:$db->Connect($dsn, $userid, $pwd);
drivers/adodb-db2.inc.php:> $connection_object->Connect( $DATABASE_HOST, $DATABASE_AUTH_USER_NAME, $DATABASE_AUTH_PASSWORD, $DATABASE_NAME )
drivers/adodb-db2.inc.php:// security - hide paths
drivers/adodb-db2.inc.php:	include(ADODB_DIR."/drivers/adodb-odbc.inc.php");
drivers/adodb-db2.inc.php:	// yyyy-mm-dd-hh.mm.ss.nnnnnn.
drivers/adodb-db2.inc.php:	var $fmtTimeStamp = "'Y-m-d-H.i.s'";
drivers/adodb-db2.inc.php:		if (strncmp(PHP_OS,'WIN',3) === 0) $this->curmode = SQL_CUR_USE_ODBC;
drivers/adodb-db2.inc.php:		$this->ADODB_odbc();
drivers/adodb-db2.inc.php:		//odbc_setoption($this->_connectionID,1,101 /*SQL_ATTR_ACCESS_MODE*/, 1 /*SQL_MODE_READ_ONLY*/);
drivers/adodb-db2.inc.php:		$vers = $this->GetOne('select versionnumber from sysibm.sysversions');
drivers/adodb-db2.inc.php:		//odbc_setoption($this->_connectionID,1,101, 0 /*SQL_MODE_READ_WRITE*/);
drivers/adodb-db2.inc.php:		return $this->GetOne($this->identitySQL);
drivers/adodb-db2.inc.php:		if ($this->_autocommit) $this->BeginTrans();
drivers/adodb-db2.inc.php:		return $this->GetOne("select 1 as ignore from $tables where $where for update");
drivers/adodb-db2.inc.php:		$qid = odbc_tables($this->_connectionID, "", $qschema, $qtable, "");
drivers/adodb-db2.inc.php:		$rs->_has_stupid_odbc_fetch_api_change = $this->_has_stupid_odbc_fetch_api_change;
drivers/adodb-db2.inc.php:		$arr =& $rs->GetArray();
drivers/adodb-db2.inc.php:		$rs->Close();
drivers/adodb-db2.inc.php:		if (!$col) $col = $this->sysDate;
drivers/adodb-db2.inc.php:				if ($col != $this->sysDate) $s .= "right(digits(hour($col)),2)";	
drivers/adodb-db2.inc.php:				if ($col != $this->sysDate)
drivers/adodb-db2.inc.php:				if ($col != $this->sysDate)
drivers/adodb-db2.inc.php:				$s .= $this->qstr($ch);
drivers/adodb-db2.inc.php:	function &SelectLimit($sql,$nrows=-1,$offset=-1,$inputArr=false)
drivers/adodb-db2.inc.php:			$rs =& $this->Execute($sql,$inputArr);
drivers/adodb-db2.inc.php:			$rs =& ADOConnection::SelectLimit($sql,-1,$offset,$inputArr);
drivers/adodb-db2.inc.php:		$this->ADORecordSet_odbc($id,$mode);
drivers/adodb-db2.inc.php:	function MetaType($t,$len=-1,$fieldobj=false)
drivers/adodb-db2.inc.php:			$t = $fieldobj->type;
drivers/adodb-db2.inc.php:			$len = $fieldobj->max_length;
drivers/adodb-db2.inc.php:			if ($len <= $this->blobSize) return 'C';
drivers/adodb-db2.inc.php:		case 'DBCLOB': // double-byte
drivers/adodb-vfp.inc.php:V4.54 5 Nov 2004  (c) 2000-2004 John Lim (jlim@natsoft.com.my). All rights reserved.
drivers/adodb-vfp.inc.php:// security - hide paths
drivers/adodb-vfp.inc.php:	include(ADODB_DIR."/drivers/adodb-odbc.inc.php");
drivers/adodb-vfp.inc.php:	var $fmtDate = "{^Y-m-d}";
drivers/adodb-vfp.inc.php:	var $fmtTimeStamp = "{^Y-m-d, h:i:sA}";
drivers/adodb-vfp.inc.php:		$this->ADODB_odbc();
drivers/adodb-vfp.inc.php:		if (!$nofixquotes) return  "'".str_replace("\r\n","'+chr(13)+'",str_replace("'",$this->replaceQuote,$s))."'";
drivers/adodb-vfp.inc.php:	function &SelectLimit($sql,$nrows=-1,$offset=-1, $inputarr=false,$secs2cache=0)
drivers/adodb-vfp.inc.php:		$this->hasTop = preg_match('/ORDER[ \t\r\n]+BY/is',$sql) ? 'top' : false;
drivers/adodb-vfp.inc.php:		return $this->ADORecordSet_odbc($id,$mode);
drivers/adodb-vfp.inc.php:	function MetaType($t,$len=-1)
drivers/adodb-vfp.inc.php:			$t = $fieldobj->type;
drivers/adodb-vfp.inc.php:			$len = $fieldobj->max_length;
drivers/adodb-vfp.inc.php:			if ($len <= $this->blobSize) return 'C';
drivers/adodb-oci8.inc.php:  version V4.54 5 Nov 2004 (c) 2000-2004 John Lim. All rights reserved.
drivers/adodb-oci8.inc.php:  13 Nov 2000 jlim - removed all ora_* references.
drivers/adodb-oci8.inc.php:// security - hide paths
drivers/adodb-oci8.inc.php:tests the string to see if it matches the formats of Oracle, SQL-92, or the value
drivers/adodb-oci8.inc.php:For Oracle the default is dd-mon-yy or dd-mon-yyyy, and for SQL-92 the default is
drivers/adodb-oci8.inc.php:yy-mm-dd or yyyy-mm-dd.
drivers/adodb-oci8.inc.php:Using 'RR' in the format forces two-digit years less than or equal to 49 to be
drivers/adodb-oci8.inc.php:the 20th century (19501999). Setting the RR format as the default for all two-digit
drivers/adodb-oci8.inc.php:year entries allows you to become year-2000 compliant. For example:
drivers/adodb-oci8.inc.php:NLS_DATE_FORMAT='RR-MM-DD'
drivers/adodb-oci8.inc.php:	var $_initdate = true; // init date to YYYY-MM-DD
drivers/adodb-oci8.inc.php:	var $NLS_DATE_FORMAT = 'YYYY-MM-DD';  // To include time, use 'RRRR-MM-DD HH24:MI:SS'
drivers/adodb-oci8.inc.php:		$this->_hasOCIFetchStatement = ADODB_PHPVER >= 0x4200;
drivers/adodb-oci8.inc.php:		if (defined('ADODB_EXTENSION')) $this->rsPrefix .= 'ext_';
drivers/adodb-oci8.inc.php:		if ($this->fetchMode !== false) $savem = $this->SetFetchMode(false);
drivers/adodb-oci8.inc.php:		$rs = $this->Execute(sprintf($this->metaColumnsSQL,strtoupper($table)));
drivers/adodb-oci8.inc.php:		if (isset($savem)) $this->SetFetchMode($savem);
drivers/adodb-oci8.inc.php:		while (!$rs->EOF) { //print_r($rs->fields);
drivers/adodb-oci8.inc.php:	   		$fld->name = $rs->fields[0];
drivers/adodb-oci8.inc.php:	   		$fld->type = $rs->fields[1];
drivers/adodb-oci8.inc.php:	   		$fld->max_length = $rs->fields[2];
drivers/adodb-oci8.inc.php:			$fld->scale = $rs->fields[3];
drivers/adodb-oci8.inc.php:			if ($rs->fields[1] == 'NUMBER' && $rs->fields[3] == 0) {
drivers/adodb-oci8.inc.php:				$fld->type ='INT';
drivers/adodb-oci8.inc.php:	     		$fld->max_length = $rs->fields[4];
drivers/adodb-oci8.inc.php:		   	$fld->not_null = (strncmp($rs->fields[5], 'NOT',3) === 0);
drivers/adodb-oci8.inc.php:			$fld->binary = (strpos($fld->type,'BLOB') !== false);
drivers/adodb-oci8.inc.php:			$fld->default_value = $rs->fields[6];
drivers/adodb-oci8.inc.php:			else $retarr[strtoupper($fld->name)] = $fld;
drivers/adodb-oci8.inc.php:			$rs->MoveNext();
drivers/adodb-oci8.inc.php:		$rs->Close();
drivers/adodb-oci8.inc.php:		$rs =& $this->Execute("select TO_CHAR($this->sysTimeStamp,'YYYY-MM-DD HH24:MI:SS') from dual");
drivers/adodb-oci8.inc.php:		if ($rs && !$rs->EOF) return $this->UnixTimeStamp(reset($rs->fields));
drivers/adodb-oci8.inc.php:    $conn->Connect(false,'scott','tiger');
drivers/adodb-oci8.inc.php:    $conn->Connect(false,'scott','tiger',$tnsname); 
drivers/adodb-oci8.inc.php:    $conn->Connect($tnsname,'scott','tiger'); 
drivers/adodb-oci8.inc.php:    $conn->Connect($serveraddress,'scott,'tiger',$service_name);
drivers/adodb-oci8.inc.php:  	$conn->connectSID = true;
drivers/adodb-oci8.inc.php:	$conn->Connect($serveraddress,'scott,'tiger',$SID);
drivers/adodb-oci8.inc.php:---------------
drivers/adodb-oci8.inc.php:  There are 3 connection modes, 0 = non-persistent, 1 = persistent, 2 = force new connection
drivers/adodb-oci8.inc.php:        $this->_errorMsg = false;
drivers/adodb-oci8.inc.php:		$this->_errorCode = false;
drivers/adodb-oci8.inc.php:				if ($this->connectSID) {
drivers/adodb-oci8.inc.php: 		//if ($argHostname) print "<p>Connect: 1st argument should be left blank for $this->databaseType</p>";
drivers/adodb-oci8.inc.php:			$this->_connectionID = ($this->charSet) ? 
drivers/adodb-oci8.inc.php:				OCIPLogon($argUsername,$argPassword, $argDatabasename, $this->charSet)
drivers/adodb-oci8.inc.php:			if ($this->_connectionID && $this->autoRollback)  OCIrollback($this->_connectionID);
drivers/adodb-oci8.inc.php:			$this->_connectionID = ($this->charSet) ? 
drivers/adodb-oci8.inc.php:				OCINLogon($argUsername,$argPassword, $argDatabasename, $this->charSet);
drivers/adodb-oci8.inc.php:			$this->_connectionID = ($this->charSet) ? 
drivers/adodb-oci8.inc.php:				OCILogon($argUsername,$argPassword, $argDatabasename,$this->charSet);
drivers/adodb-oci8.inc.php:		if ($this->_connectionID === false) return false;
drivers/adodb-oci8.inc.php:		if ($this->_initdate) {
drivers/adodb-oci8.inc.php:			$this->Execute("ALTER SESSION SET NLS_DATE_FORMAT='".$this->NLS_DATE_FORMAT."'");
drivers/adodb-oci8.inc.php:		// Oracle8i Enterprise Edition Release 8.1.7.0.0 - Production With the Partitioning option JServer Release 8.1.7.0.0 - Production
drivers/adodb-oci8.inc.php:		// $vers = OCIServerVersion($this->_connectionID);
drivers/adodb-oci8.inc.php:		// if (strpos($vers,'8i') !== false) $this->ansiOuter = true;
drivers/adodb-oci8.inc.php:		$arr['compat'] = $this->GetOne('select value from sys.database_compatible_level');
drivers/adodb-oci8.inc.php:		$arr['description'] = @OCIServerVersion($this->_connectionID);
drivers/adodb-oci8.inc.php:		return $this->_connect($argHostname, $argUsername, $argPassword, $argDatabasename,1);
drivers/adodb-oci8.inc.php:		return $this->_connect($argHostname, $argUsername, $argPassword, $argDatabasename,2);
drivers/adodb-oci8.inc.php:		if (is_resource($this->_stmt)) return @OCIRowCount($this->_stmt);
drivers/adodb-oci8.inc.php:		return "TO_DATE(".adodb_date($this->fmtDate,$d).",'".$this->NLS_DATE_FORMAT."')";
drivers/adodb-oci8.inc.php:		return 'TO_DATE('.adodb_date($this->fmtTimeStamp,$ts).",'RRRR-MM-DD, HH:MI:SS AM')";
drivers/adodb-oci8.inc.php:		if ($this->autoCommit) $this->BeginTrans();
drivers/adodb-oci8.inc.php:		return $this->GetOne("select 1 as ignore from $tables where $where for update");
drivers/adodb-oci8.inc.php:			$save = $this->metaTablesSQL;
drivers/adodb-oci8.inc.php:			$mask = $this->qstr(strtoupper($mask));
drivers/adodb-oci8.inc.php:			$this->metaTablesSQL .= " AND table_name like $mask";
drivers/adodb-oci8.inc.php:			$this->metaTablesSQL = $save;
drivers/adodb-oci8.inc.php:		if ($this->transOff) return true;
drivers/adodb-oci8.inc.php:		$this->transCnt += 1;
drivers/adodb-oci8.inc.php:		$this->autoCommit = false;
drivers/adodb-oci8.inc.php:		$this->_commit = OCI_DEFAULT;
drivers/adodb-oci8.inc.php:		if ($this->transOff) return true;
drivers/adodb-oci8.inc.php:		if (!$ok) return $this->RollbackTrans();
drivers/adodb-oci8.inc.php:		if ($this->transCnt) $this->transCnt -= 1;
drivers/adodb-oci8.inc.php:		$ret = OCIcommit($this->_connectionID);
drivers/adodb-oci8.inc.php:		$this->_commit = OCI_COMMIT_ON_SUCCESS;
drivers/adodb-oci8.inc.php:		$this->autoCommit = true;
drivers/adodb-oci8.inc.php:		if ($this->transOff) return true;
drivers/adodb-oci8.inc.php:		if ($this->transCnt) $this->transCnt -= 1;
drivers/adodb-oci8.inc.php:		$ret = OCIrollback($this->_connectionID);
drivers/adodb-oci8.inc.php:		$this->_commit = OCI_COMMIT_ON_SUCCESS;
drivers/adodb-oci8.inc.php:		$this->autoCommit = true;
drivers/adodb-oci8.inc.php:		if ($this->_errorMsg !== false) return $this->_errorMsg;
drivers/adodb-oci8.inc.php:		if (is_resource($this->_stmt)) $arr = @OCIerror($this->_stmt);
drivers/adodb-oci8.inc.php:			$arr = @OCIerror($this->_connectionID);
drivers/adodb-oci8.inc.php:		$this->_errorMsg = $arr['message'];
drivers/adodb-oci8.inc.php:		$this->_errorCode = $arr['code'];
drivers/adodb-oci8.inc.php:		return $this->_errorMsg;
drivers/adodb-oci8.inc.php:		if ($this->_errorCode !== false) return $this->_errorCode;
drivers/adodb-oci8.inc.php:		if (is_resource($this->_stmt)) $arr = @OCIError($this->_stmt);
drivers/adodb-oci8.inc.php:			$arr = @OCIError($this->_connectionID);
drivers/adodb-oci8.inc.php:		$this->_errorMsg = $arr['message'];
drivers/adodb-oci8.inc.php:		$this->_errorCode = $arr['code'];
drivers/adodb-oci8.inc.php:		if (!$col) $col = $this->sysTimeStamp;
drivers/adodb-oci8.inc.php:				if (strpos('-/.:;, ',$ch) !== false) $s .= $ch;
drivers/adodb-oci8.inc.php:	function &SelectLimit($sql,$nrows=-1,$offset=-1, $inputarr=false,$secs2cache=0)
drivers/adodb-oci8.inc.php:		if ($this->firstrows) {
drivers/adodb-oci8.inc.php:		if ($offset < $this->selectOffsetAlg1) {
drivers/adodb-oci8.inc.php:				if ($this->databaseType == 'oci8po') {
drivers/adodb-oci8.inc.php:				$nrows = -1;
drivers/adodb-oci8.inc.php:			if (! $stmt_arr = $this->Prepare($q_fields)) {
drivers/adodb-oci8.inc.php:						$len = -1;
drivers/adodb-oci8.inc.php:			if ($this->databaseType == 'oci8po') {
drivers/adodb-oci8.inc.php:			if ($secs2cache>0) $rs =& $this->CacheExecute($secs2cache, $sql,$inputarr);
drivers/adodb-oci8.inc.php:			else $rs =& $this->Execute($sql,$inputarr);
drivers/adodb-oci8.inc.php:	*	$conn->Execute('insert into TABLE (id,ablob) values(12,empty_blob())');
drivers/adodb-oci8.inc.php:	*	$conn->UpdateBlob('TABLE', 'ablob', $varHoldingBlob, 'ID=12', 'BLOB');
drivers/adodb-oci8.inc.php:	*	 $db->Execute('ALTER SESSION SET CURSOR_SHARING=EXACT');
drivers/adodb-oci8.inc.php:		//if (strlen($val) < 4000) return $this->Execute("UPDATE $table SET $column=:blob WHERE $where",array('blob'=>$val)) != false;
drivers/adodb-oci8.inc.php:		if ($this->databaseType == 'oci8po') 
drivers/adodb-oci8.inc.php:		$desc = OCINewDescriptor($this->_connectionID, OCI_D_LOB);
drivers/adodb-oci8.inc.php:		$arr['blob'] = array($desc,-1,$type);
drivers/adodb-oci8.inc.php:		if ($this->session_sharing_force_blob) $this->Execute('ALTER SESSION SET CURSOR_SHARING=EXACT');
drivers/adodb-oci8.inc.php:		$commit = $this->autoCommit;
drivers/adodb-oci8.inc.php:		if ($commit) $this->BeginTrans();
drivers/adodb-oci8.inc.php:		$rs = $this->Execute($sql,$arr);
drivers/adodb-oci8.inc.php:		if ($rez = !empty($rs)) $desc->save($val);
drivers/adodb-oci8.inc.php:		$desc->free();
drivers/adodb-oci8.inc.php:		if ($commit) $this->CommitTrans();
drivers/adodb-oci8.inc.php:		if ($this->session_sharing_force_blob) $this->Execute('ALTER SESSION SET CURSOR_SHARING=FORCE');
drivers/adodb-oci8.inc.php:		if ($rez) $rs->Close();
drivers/adodb-oci8.inc.php:		if ($this->databaseType == 'oci8po') 
drivers/adodb-oci8.inc.php:		$desc = OCINewDescriptor($this->_connectionID, OCI_D_LOB);
drivers/adodb-oci8.inc.php:		$arr['blob'] = array($desc,-1,$type);
drivers/adodb-oci8.inc.php:		$this->BeginTrans();
drivers/adodb-oci8.inc.php:		if ($rez = !empty($rs)) $desc->savefile($val);
drivers/adodb-oci8.inc.php:		$desc->free();
drivers/adodb-oci8.inc.php:		$this->CommitTrans();
drivers/adodb-oci8.inc.php:		if ($rez) $rs->Close();
drivers/adodb-oci8.inc.php:		$stmt = $this->Prepare('insert into emp (empno, ename) values (:empno, :ename)');
drivers/adodb-oci8.inc.php:		$stmt = OCIParse($this->_connectionID,$sql);
drivers/adodb-oci8.inc.php:			return array($sql,$stmt,0,$BINDNUM, ($cursor) ? OCINewCursor($this->_connectionID) : false);
drivers/adodb-oci8.inc.php:			$rs = $db->ExecuteCursor("BEGIN adodb.open_tab(:RS2); END;",'RS2');
drivers/adodb-oci8.inc.php:			$rs = $db->ExecuteCursor(
drivers/adodb-oci8.inc.php:			$this->Parameter($stmt, $ignoreCur, $cursorName, false, -1, OCI_B_CURSOR);
drivers/adodb-oci8.inc.php:					$this->Parameter($stmt,$params[$k], $k);
drivers/adodb-oci8.inc.php:		return $this->Execute($stmt);
drivers/adodb-oci8.inc.php:		Bind a variable -- very, very fast for executing repeated statements in oracle. 
drivers/adodb-oci8.inc.php:				$this->Execute("insert into table (col0, col1, col2) values (:0, :1, :2)", 
drivers/adodb-oci8.inc.php:			$stmt = $DB->Prepare("insert into table (col0, col1, col2) values (:0, :1, :2)");
drivers/adodb-oci8.inc.php:			$DB->Bind($stmt, $p1);
drivers/adodb-oci8.inc.php:			$DB->Bind($stmt, $p2);
drivers/adodb-oci8.inc.php:			$DB->Bind($stmt, $p3);
drivers/adodb-oci8.inc.php:				$DB->Execute($stmt);
drivers/adodb-oci8.inc.php:			if ($this->debug) {
drivers/adodb-oci8.inc.php:			$numlob = count($this -> _refLOBs);
drivers/adodb-oci8.inc.php:        	$this -> _refLOBs[$numlob]['LOB'] = OCINewDescriptor($this->_connectionID, oci_lob_desc($type));
drivers/adodb-oci8.inc.php:			$this -> _refLOBs[$numlob]['TYPE'] = $isOutput;
drivers/adodb-oci8.inc.php:			$tmp = &$this -> _refLOBs[$numlob]['LOB'];
drivers/adodb-oci8.inc.php:	        $rez = OCIBindByName($stmt[1], ":".$name, $tmp, -1, $type);
drivers/adodb-oci8.inc.php:			if ($this->debug) {
drivers/adodb-oci8.inc.php:				$var = $this -> BlobEncode($var);
drivers/adodb-oci8.inc.php:				$tmp -> WriteTemporary($var);
drivers/adodb-oci8.inc.php:				if ($this->debug) {
drivers/adodb-oci8.inc.php:				$this -> _refLOBs[$numlob]['VAR'] = &$var;
drivers/adodb-oci8.inc.php:			if ($this->debug) 
drivers/adodb-oci8.inc.php:		$stmt = $db->Prepare('select * from table where id =:myid and group=:group');
drivers/adodb-oci8.inc.php:		$db->Parameter($stmt,$id,'myid');
drivers/adodb-oci8.inc.php:		$db->Parameter($stmt,$group,'group');
drivers/adodb-oci8.inc.php:		$db->Execute($stmt);
drivers/adodb-oci8.inc.php:			if  ($this->debug) {
drivers/adodb-oci8.inc.php:			return $this->Bind($stmt,$var,$maxLen,$type,$name,$isOutput);
drivers/adodb-oci8.inc.php:	   1. $db->execute('select * from table');
drivers/adodb-oci8.inc.php:	   2. $db->prepare('insert into table (a,b,c) values (:0,:1,:2)');
drivers/adodb-oci8.inc.php:		  $db->execute($prepared_statement, array(1,2,3));
drivers/adodb-oci8.inc.php:	   3. $db->execute('insert into table (a,b,c) values (:a,:b,:c)',array('a'=>1,'b'=>2,'c'=>3));
drivers/adodb-oci8.inc.php:	   4. $db->prepare('insert into table (a,b,c) values (:0,:1,:2)');
drivers/adodb-oci8.inc.php:		  $db->bind($stmt,1); $db->bind($stmt,2); $db->bind($stmt,3); 
drivers/adodb-oci8.inc.php:		  $db->execute($stmt);
drivers/adodb-oci8.inc.php:			// and carried out once only - note that max array element size is 4000 chars
drivers/adodb-oci8.inc.php:				if (isset($this->_bind[$bindpos])) {
drivers/adodb-oci8.inc.php:					$bindarr = &$this->_bind[$bindpos];
drivers/adodb-oci8.inc.php:					$this->_bind[$bindpos] = &$bindarr;
drivers/adodb-oci8.inc.php:			$stmt=OCIParse($this->_connectionID,$sql);
drivers/adodb-oci8.inc.php:		$this->_stmt = $stmt;
drivers/adodb-oci8.inc.php:					if ($this->debug==99) echo "name=:$k",' var='.$inputarr[$k][0],' len='.$v[1],' type='.$v[2],'<br>';
drivers/adodb-oci8.inc.php:					$len = -1;
drivers/adodb-oci8.inc.php:        $this->_errorMsg = false;
drivers/adodb-oci8.inc.php:		$this->_errorCode = false;
drivers/adodb-oci8.inc.php:		if (OCIExecute($stmt,$this->_commit)) {
drivers/adodb-oci8.inc.php:			if (count($this -> _refLOBs) > 0) {
drivers/adodb-oci8.inc.php:				foreach ($this -> _refLOBs as $key => $value) {
drivers/adodb-oci8.inc.php:					if ($this -> _refLOBs[$key]['TYPE'] == true) {
drivers/adodb-oci8.inc.php:						$tmp = $this -> _refLOBs[$key]['LOB'] -> load();
drivers/adodb-oci8.inc.php:						if ($this -> debug) {
drivers/adodb-oci8.inc.php:						//$_GLOBALS[$this -> _refLOBs[$key]['VAR']] = $tmp;
drivers/adodb-oci8.inc.php:						$this -> _refLOBs[$key]['VAR'] = $tmp;
drivers/adodb-oci8.inc.php:					$this -> _refLOBs[$key]['LOB'] -> free();
drivers/adodb-oci8.inc.php:					unset($this -> _refLOBs[$key]);
drivers/adodb-oci8.inc.php:					// ociclose -- no because it could be used in a LOB?
drivers/adodb-oci8.inc.php:		if (!$this->_connectionID) return;
drivers/adodb-oci8.inc.php:		if (!$this->autoCommit) OCIRollback($this->_connectionID);
drivers/adodb-oci8.inc.php:		if (count($this -> _refLOBs) > 0) {
drivers/adodb-oci8.inc.php:			foreach ($this -> _refLOBs as $key => $value) {
drivers/adodb-oci8.inc.php:				$this -> _refLOBs[$key] -> free();
drivers/adodb-oci8.inc.php:				unset($this -> _refLOBs[$key]);
drivers/adodb-oci8.inc.php:		OCILogoff($this->_connectionID);
drivers/adodb-oci8.inc.php:		$this->_stmt = false;
drivers/adodb-oci8.inc.php:		$this->_connectionID = false;
drivers/adodb-oci8.inc.php: 		$rs = $this->Execute($sql);
drivers/adodb-oci8.inc.php:		if ($rs && !$rs->EOF) {
drivers/adodb-oci8.inc.php:			$arr =& $rs->GetArray();
drivers/adodb-oci8.inc.php:		$table = $this->qstr(strtoupper($table));
drivers/adodb-oci8.inc.php:			$owner = $this->user;
drivers/adodb-oci8.inc.php:		$owner = ' and owner='.$this->qstr(strtoupper($owner));
drivers/adodb-oci8.inc.php:		$constraints =& $this->GetArray($sql);
drivers/adodb-oci8.inc.php:			$cons = $this->qstr($constr[0]);
drivers/adodb-oci8.inc.php:			$rowner = $this->qstr($constr[1]);
drivers/adodb-oci8.inc.php:			$rcons = $this->qstr($constr[2]);
drivers/adodb-oci8.inc.php:			$cols = $this->GetArray("select column_name from {$tabp}cons_columns where constraint_name=$cons $owner order by position");
drivers/adodb-oci8.inc.php:			$tabcol = $this->GetArray("select table_name,column_name from {$tabp}cons_columns where owner=$rowner and constraint_name=$rcons order by position");
drivers/adodb-oci8.inc.php:	 * An example is  $db->qstr("Don't bother",magic_quotes_runtime());
drivers/adodb-oci8.inc.php:		if ($this->noNullStrings && strlen($s)==0)$s = ' ';
drivers/adodb-oci8.inc.php:			if ($this->replaceQuote[0] == '\\'){
drivers/adodb-oci8.inc.php:			return  "'".str_replace("'",$this->replaceQuote,$s)."'";
drivers/adodb-oci8.inc.php:		return "'".str_replace("\\'",$this->replaceQuote,$s)."'";
drivers/adodb-oci8.inc.php:/*--------------------------------------------------------------------------------------
drivers/adodb-oci8.inc.php:--------------------------------------------------------------------------------------*/
drivers/adodb-oci8.inc.php:		case ADODB_FETCH_NUM: $this->fetchMode = OCI_NUM+OCI_RETURN_NULLS+OCI_RETURN_LOBS; break;
drivers/adodb-oci8.inc.php:		case ADODB_FETCH_ASSOC:$this->fetchMode = OCI_ASSOC+OCI_RETURN_NULLS+OCI_RETURN_LOBS; break;
drivers/adodb-oci8.inc.php:		case ADODB_FETCH_BOTH:$this->fetchMode = OCI_NUM+OCI_ASSOC+OCI_RETURN_NULLS+OCI_RETURN_LOBS; break;
drivers/adodb-oci8.inc.php:		$this->adodbFetchMode = $mode;
drivers/adodb-oci8.inc.php:		$this->_queryID = $queryID;
drivers/adodb-oci8.inc.php:		if ($this->_inited) return;
drivers/adodb-oci8.inc.php:		$this->_inited = true;
drivers/adodb-oci8.inc.php:		if ($this->_queryID) {
drivers/adodb-oci8.inc.php:			$this->_currentRow = 0;
drivers/adodb-oci8.inc.php:			@$this->_initrs();
drivers/adodb-oci8.inc.php:			$this->EOF = !$this->_fetch();
drivers/adodb-oci8.inc.php:			$err = OCIError($this->_queryID);
drivers/adodb-oci8.inc.php:			if ($err && $this->connection->debug) ADOConnection::outp($err);
drivers/adodb-oci8.inc.php:			if (!is_array($this->fields)) {
drivers/adodb-oci8.inc.php:				$this->_numOfRows = 0;
drivers/adodb-oci8.inc.php:				$this->fields = array();
drivers/adodb-oci8.inc.php:			$this->fields = array();
drivers/adodb-oci8.inc.php:			$this->_numOfRows = 0;
drivers/adodb-oci8.inc.php:			$this->_numOfFields = 0;
drivers/adodb-oci8.inc.php:			$this->EOF = true;
drivers/adodb-oci8.inc.php:		$this->_numOfRows = -1;
drivers/adodb-oci8.inc.php:		$this->_numOfFields = OCInumcols($this->_queryID);
drivers/adodb-oci8.inc.php:		if ($this->_numOfFields>0) {
drivers/adodb-oci8.inc.php:			$this->_fieldobjs = array();
drivers/adodb-oci8.inc.php:			$max = $this->_numOfFields;
drivers/adodb-oci8.inc.php:			for ($i=0;$i<$max; $i++) $this->_fieldobjs[] = $this->_FetchField($i);
drivers/adodb-oci8.inc.php:	function &_FetchField($fieldOffset = -1)
drivers/adodb-oci8.inc.php:		$fld->name =OCIcolumnname($this->_queryID, $fieldOffset);
drivers/adodb-oci8.inc.php:		$fld->type = OCIcolumntype($this->_queryID, $fieldOffset);
drivers/adodb-oci8.inc.php:		$fld->max_length = OCIcolumnsize($this->_queryID, $fieldOffset);
drivers/adodb-oci8.inc.php:	 	if ($fld->type == 'NUMBER') {
drivers/adodb-oci8.inc.php:	 		$p = OCIColumnPrecision($this->_queryID, $fieldOffset);
drivers/adodb-oci8.inc.php:			$sc = OCIColumnScale($this->_queryID, $fieldOffset);
drivers/adodb-oci8.inc.php:			if ($p != 0 && $sc == 0) $fld->type = 'INT';
drivers/adodb-oci8.inc.php:			//echo " $this->name ($p.$sc) ";
drivers/adodb-oci8.inc.php:	function &FetchField($fieldOffset = -1)
drivers/adodb-oci8.inc.php:		return $this->_fieldobjs[$fieldOffset];
drivers/adodb-oci8.inc.php:		if ($this->EOF) return false;
drivers/adodb-oci8.inc.php:		$this->_currentRow++;
drivers/adodb-oci8.inc.php:		if(@OCIfetchinto($this->_queryID,$this->fields,$this->fetchMode))
drivers/adodb-oci8.inc.php:		$this->EOF = true;
drivers/adodb-oci8.inc.php:		if (@OCIfetchinto($this->_queryID,$this->fields,$this->fetchMode)) {
drivers/adodb-oci8.inc.php:			$this->_currentRow += 1;
drivers/adodb-oci8.inc.php:		if (!$this->EOF) {
drivers/adodb-oci8.inc.php:			$this->_currentRow += 1;
drivers/adodb-oci8.inc.php:			$this->EOF = true;
drivers/adodb-oci8.inc.php:	function &GetArrayLimit($nrows,$offset=-1) 
drivers/adodb-oci8.inc.php:			$arr =& $this->GetArray($nrows);
drivers/adodb-oci8.inc.php:			if (!@OCIFetch($this->_queryID)) return array();
drivers/adodb-oci8.inc.php:		if (!@OCIfetchinto($this->_queryID,$this->fields,$this->fetchMode)) return array();
drivers/adodb-oci8.inc.php:		while (!$this->EOF && $nrows != $cnt) {
drivers/adodb-oci8.inc.php:			$results[$cnt++] = $this->fields;
drivers/adodb-oci8.inc.php:			$this->MoveNext();
drivers/adodb-oci8.inc.php:		if (!$this->bind) {
drivers/adodb-oci8.inc.php:			$this->bind = array();
drivers/adodb-oci8.inc.php:			for ($i=0; $i < $this->_numOfFields; $i++) {
drivers/adodb-oci8.inc.php:				$o = $this->FetchField($i);
drivers/adodb-oci8.inc.php:				$this->bind[strtoupper($o->name)] = $i;
drivers/adodb-oci8.inc.php:		 return $this->fields[$this->bind[strtoupper($colname)]];
drivers/adodb-oci8.inc.php:		return @OCIfetchinto($this->_queryID,$this->fields,$this->fetchMode);
drivers/adodb-oci8.inc.php:		if ($this->connection->_stmt === $this->_queryID) $this->connection->_stmt = false;
drivers/adodb-oci8.inc.php:		@OCIFreeStatement($this->_queryID);
drivers/adodb-oci8.inc.php: 		$this->_queryID = false;
drivers/adodb-oci8.inc.php:	function MetaType($t,$len=-1)
drivers/adodb-oci8.inc.php:			$t = $fieldobj->type;
drivers/adodb-oci8.inc.php:			$len = $fieldobj->max_length;
drivers/adodb-oci8.inc.php:				 if (isset($this) && $len <= $this->blobSize) return 'C';
drivers/adodb-oci8.inc.php:			return  ($this->connection->datetime) ? 'T' : 'D';
drivers/adodb-oci8.inc.php:		case ADODB_FETCH_NUM: $this->fetchMode = OCI_NUM+OCI_RETURN_NULLS+OCI_RETURN_LOBS; break;
drivers/adodb-oci8.inc.php:		case ADODB_FETCH_ASSOC:$this->fetchMode = OCI_ASSOC+OCI_RETURN_NULLS+OCI_RETURN_LOBS; break;
drivers/adodb-oci8.inc.php:		case ADODB_FETCH_BOTH:$this->fetchMode = OCI_NUM+OCI_ASSOC+OCI_RETURN_NULLS+OCI_RETURN_LOBS; break;
drivers/adodb-oci8.inc.php:		$this->adodbFetchMode = $mode;
drivers/adodb-oci8.inc.php:		$this->_queryID = $queryID;
drivers/adodb-postgres7.inc.php: V4.54 5 Nov 2004  (c) 2000-2004 John Lim (jlim@natsoft.com.my). All rights reserved.
drivers/adodb-postgres7.inc.php:// security - hide paths
drivers/adodb-postgres7.inc.php:include_once(ADODB_DIR."/drivers/adodb-postgres64.inc.php");
drivers/adodb-postgres7.inc.php:	var $charSet = true; //set to true for Postgres 7 and above - PG client supports encodings
drivers/adodb-postgres7.inc.php:		$this->ADODB_postgres64();
drivers/adodb-postgres7.inc.php:			$this->rsPrefix .= 'assoc_';
drivers/adodb-postgres7.inc.php:	 function &SelectLimit($sql,$nrows=-1,$offset=-1,$inputarr=false,$secs2cache=0) 
drivers/adodb-postgres7.inc.php:		  	$rs =& $this->CacheExecute($secs2cache,$sql."$limitStr$offsetStr",$inputarr);
drivers/adodb-postgres7.inc.php:		  	$rs =& $this->Execute($sql."$limitStr$offsetStr",$inputarr);
drivers/adodb-postgres7.inc.php:		$info = $this->ServerInfo();
drivers/adodb-postgres7.inc.php:	// from  Edward Jaramilla, improved version - works on pg 7.4
drivers/adodb-postgres7.inc.php:	$rs = $this->Execute($sql);
drivers/adodb-postgres7.inc.php:	if ($rs && !$rs->EOF) {
drivers/adodb-postgres7.inc.php:		$arr =& $rs->GetArray();
drivers/adodb-postgres7.inc.php:        $rs = $this->Execute($sql);
drivers/adodb-postgres7.inc.php:		if ($rs && !$rs->EOF) {
drivers/adodb-postgres7.inc.php:			$arr =& $rs->GetArray();
drivers/adodb-postgres7.inc.php: 	 // this is a set of functions for managing client encoding - very important if the encodings
drivers/adodb-postgres7.inc.php:	//for instance, you may have UNICODE database and server it on-site as WIN1251 etc.
drivers/adodb-postgres7.inc.php:	// GetCharSet - get the name of the character set the client is using now
drivers/adodb-postgres7.inc.php:	// depends on compile flags of postgres distribution - if no charsets were compiled into the server
drivers/adodb-postgres7.inc.php:		$this->charSet = @pg_client_encoding($this->_connectionID);
drivers/adodb-postgres7.inc.php:		if (!$this->charSet) {
drivers/adodb-postgres7.inc.php:			return $this->charSet;
drivers/adodb-postgres7.inc.php:	// SetCharSet - switch the client encoding
drivers/adodb-postgres7.inc.php:		$this->GetCharSet();
drivers/adodb-postgres7.inc.php:		if ($this->charSet !== $charset_name) {
drivers/adodb-postgres7.inc.php:			$if = pg_set_client_encoding($this->_connectionID, $charset_name);
drivers/adodb-postgres7.inc.php:			if ($if == "0" & $this->GetCharSet() == $charset_name) {
drivers/adodb-postgres7.inc.php:/*--------------------------------------------------------------------------------------
drivers/adodb-postgres7.inc.php:--------------------------------------------------------------------------------------*/
drivers/adodb-postgres7.inc.php:		$this->ADORecordSet_postgres64($queryID,$mode);
drivers/adodb-postgres7.inc.php:		if (!$this->EOF) {
drivers/adodb-postgres7.inc.php:			$this->_currentRow++;
drivers/adodb-postgres7.inc.php:			if ($this->_numOfRows < 0 || $this->_numOfRows > $this->_currentRow) {
drivers/adodb-postgres7.inc.php:				$this->fields = @pg_fetch_array($this->_queryID,$this->_currentRow,$this->fetchMode);
drivers/adodb-postgres7.inc.php:				if (is_array($this->fields)) {
drivers/adodb-postgres7.inc.php:					if ($this->fields && isset($this->_blobArr)) $this->_fixblobs();
drivers/adodb-postgres7.inc.php:			$this->fields = false;
drivers/adodb-postgres7.inc.php:			$this->EOF = true;
drivers/adodb-postgres7.inc.php:		$this->ADORecordSet_postgres64($queryID,$mode);
drivers/adodb-postgres7.inc.php:		if ($this->_currentRow >= $this->_numOfRows && $this->_numOfRows >= 0)
drivers/adodb-postgres7.inc.php:		$this->fields = @pg_fetch_array($this->_queryID,$this->_currentRow,$this->fetchMode);
drivers/adodb-postgres7.inc.php:		if ($this->fields) {
drivers/adodb-postgres7.inc.php:			if (isset($this->_blobArr)) $this->_fixblobs();
drivers/adodb-postgres7.inc.php:			$this->_updatefields();
drivers/adodb-postgres7.inc.php:		return (is_array($this->fields));
drivers/adodb-postgres7.inc.php:		foreach($this->fields as $k => $v) {
drivers/adodb-postgres7.inc.php:		$this->fields = $arr;
drivers/adodb-postgres7.inc.php:		if (!$this->EOF) {
drivers/adodb-postgres7.inc.php:			$this->_currentRow++;
drivers/adodb-postgres7.inc.php:			if ($this->_numOfRows < 0 || $this->_numOfRows > $this->_currentRow) {
drivers/adodb-postgres7.inc.php:				$this->fields = @pg_fetch_array($this->_queryID,$this->_currentRow,$this->fetchMode);
drivers/adodb-postgres7.inc.php:				if (is_array($this->fields)) {
drivers/adodb-postgres7.inc.php:					if ($this->fields) {
drivers/adodb-postgres7.inc.php:						if (isset($this->_blobArr)) $this->_fixblobs();
drivers/adodb-postgres7.inc.php:						$this->_updatefields();
drivers/adodb-postgres7.inc.php:			$this->fields = false;
drivers/adodb-postgres7.inc.php:			$this->EOF = true;
drivers/adodb-odbc_mssql.inc.php:V4.54 5 Nov 2004  (c) 2000-2004 John Lim (jlim@natsoft.com.my). All rights reserved.
drivers/adodb-odbc_mssql.inc.php:// security - hide paths
drivers/adodb-odbc_mssql.inc.php:	include(ADODB_DIR."/drivers/adodb-odbc.inc.php");
drivers/adodb-odbc_mssql.inc.php:	var $fmtDate = "'Y-m-d'";
drivers/adodb-odbc_mssql.inc.php:	var $fmtTimeStamp = "'Y-m-d h:i:sA'";
drivers/adodb-odbc_mssql.inc.php:		$this->ADODB_odbc();
drivers/adodb-odbc_mssql.inc.php:		$this->curmode = SQL_CUR_USE_ODBC;	
drivers/adodb-odbc_mssql.inc.php:		$row = $this->GetRow("execute sp_server_info 2");
drivers/adodb-odbc_mssql.inc.php:	// the same scope. A scope is a module -- a stored procedure, trigger, 
drivers/adodb-odbc_mssql.inc.php:			return $this->GetOne($this->identitySQL);
drivers/adodb-odbc_mssql.inc.php:		$table = $this->qstr(strtoupper($table));
drivers/adodb-odbc_mssql.inc.php:		$constraints =& $this->GetArray($sql);
drivers/adodb-odbc_mssql.inc.php:		if ($mask) {$this->debug=1;
drivers/adodb-odbc_mssql.inc.php:			$save = $this->metaTablesSQL;
drivers/adodb-odbc_mssql.inc.php:			$mask = $this->qstr($mask);
drivers/adodb-odbc_mssql.inc.php:			$this->metaTablesSQL .= " AND name like $mask";
drivers/adodb-odbc_mssql.inc.php:			$this->metaTablesSQL = $save;
drivers/adodb-odbc_mssql.inc.php:	// "Stein-Aksel Basma" <basma@accelero.no>
drivers/adodb-odbc_mssql.inc.php:		$this->_findschema($table,$schema);
drivers/adodb-odbc_mssql.inc.php:		//if (!$schema) $schema = $this->database;
drivers/adodb-odbc_mssql.inc.php:		$a = $this->GetCol($sql);
drivers/adodb-odbc_mssql.inc.php:	function &SelectLimit($sql,$nrows=-1,$offset=-1, $inputarr=false,$secs2cache=0)
drivers/adodb-odbc_mssql.inc.php:				'/(^\s*select\s+(distinctrow|distinct)?)/i','\\1 '.$this->hasTop." $nrows ",$sql);
drivers/adodb-odbc_mssql.inc.php:			$rs =& $this->Execute($sql,$inputarr);
drivers/adodb-odbc_mssql.inc.php:		if (!$col) $col = $this->sysTimeStamp;
drivers/adodb-odbc_mssql.inc.php:				$s .= $this->qstr($ch);
drivers/adodb-odbc_mssql.inc.php:		return $this->ADORecordSet_odbc($id,$mode);
drivers/adodb-ado_access.inc.php:V4.54 5 Nov 2004  (c) 2000-2004 John Lim (jlim@natsoft.com.my). All rights reserved.
drivers/adodb-ado_access.inc.php:// security - hide paths
drivers/adodb-ado_access.inc.php:	if (PHP_VERSION >= 5) include(ADODB_DIR."/drivers/adodb-ado5.inc.php");
drivers/adodb-ado_access.inc.php:	else include(ADODB_DIR."/drivers/adodb-ado.inc.php");
drivers/adodb-ado_access.inc.php:	var $fmtDate = "#Y-m-d#";
drivers/adodb-ado_access.inc.php:	var $fmtTimeStamp = "#Y-m-d h:i:sA#";// note no comma
drivers/adodb-ado_access.inc.php:	var $sysDate = "FORMAT(NOW,'yyyy-mm-dd')";
drivers/adodb-ado_access.inc.php:		$this->ADODB_ado();
drivers/adodb-ado_access.inc.php:		return $this->ADORecordSet_ado($id,$mode);
drivers/adodb-borland_ibase.inc.php:V4.54 5 Nov 2004  (c) 2000-2004 John Lim (jlim@natsoft.com.my). All rights reserved.
drivers/adodb-borland_ibase.inc.php:// security - hide paths
drivers/adodb-borland_ibase.inc.php:include_once(ADODB_DIR."/drivers/adodb-ibase.inc.php");
drivers/adodb-borland_ibase.inc.php:		$this->ADODB_ibase();
drivers/adodb-borland_ibase.inc.php:		if ($this->transOff) return true;
drivers/adodb-borland_ibase.inc.php:		$this->transCnt += 1;
drivers/adodb-borland_ibase.inc.php:		$this->autoCommit = false;
drivers/adodb-borland_ibase.inc.php:	 	$this->_transactionID = ibase_trans($this->ibasetrans, $this->_connectionID);
drivers/adodb-borland_ibase.inc.php:		return $this->_transactionID;
drivers/adodb-borland_ibase.inc.php:		$arr['dialect'] = $this->dialect;
drivers/adodb-borland_ibase.inc.php:	// Note that Interbase 6.5 uses ROWS instead - don't you love forking wars!
drivers/adodb-borland_ibase.inc.php:	// 		SELECT col1, col2 FROM table ROWS 5 -- get 5 rows 
drivers/adodb-borland_ibase.inc.php:	//		SELECT col1, col2 FROM TABLE ORDER BY col1 ROWS 3 TO 7 -- first 5 skip 2
drivers/adodb-borland_ibase.inc.php:	function &SelectLimit($sql,$nrows=-1,$offset=-1,$inputarr=false,$secs2cache=0)
drivers/adodb-borland_ibase.inc.php:				$this->CacheExecute($secs2cache,$sql,$inputarr)
drivers/adodb-borland_ibase.inc.php:				$this->Execute($sql,$inputarr);
drivers/adodb-borland_ibase.inc.php:		$this->ADORecordSet_ibase($id,$mode);
drivers/adodb-sqlite.inc.php.bak:V4.53 14 Sept 2004  (c) 2000-2004 John Lim (jlim@natsoft.com.my). All rights reserved.
drivers/adodb-sqlite.inc.php.bak:// security - hide paths
drivers/adodb-sqlite.inc.php.bak:	var $sysDate = "adodb_date('Y-m-d')";
drivers/adodb-sqlite.inc.php.bak:	var $sysTimeStamp = "adodb_date('Y-m-d H:i:s')";
drivers/adodb-sqlite.inc.php.bak:	var $fmtTimeStamp = "'Y-m-d H:i:s'";
drivers/adodb-sqlite.inc.php.bak:	case 'sysDate': return "'".date($this->fmtDate)."'";
drivers/adodb-sqlite.inc.php.bak:	case 'sysTimeStamp' : return "'".date($this->sysTimeStamp)."'";
drivers/adodb-sqlite.inc.php.bak:		 if ($this->transOff) return true; 
drivers/adodb-sqlite.inc.php.bak:		 $ret = $this->Execute("BEGIN TRANSACTION");
drivers/adodb-sqlite.inc.php.bak:		 $this->transCnt += 1;
drivers/adodb-sqlite.inc.php.bak:		if ($this->transOff) return true; 
drivers/adodb-sqlite.inc.php.bak:		if (!$ok) return $this->RollbackTrans();
drivers/adodb-sqlite.inc.php.bak:		$ret = $this->Execute("COMMIT");
drivers/adodb-sqlite.inc.php.bak:		if ($this->transCnt>0)$this->transCnt -= 1;
drivers/adodb-sqlite.inc.php.bak:		if ($this->transOff) return true; 
drivers/adodb-sqlite.inc.php.bak:		$ret = $this->Execute("ROLLBACK");
drivers/adodb-sqlite.inc.php.bak:		if ($this->transCnt>0)$this->transCnt -= 1;
drivers/adodb-sqlite.inc.php.bak:		return sqlite_last_insert_rowid($this->_connectionID);
drivers/adodb-sqlite.inc.php.bak:        return sqlite_changes($this->_connectionID);
drivers/adodb-sqlite.inc.php.bak:		if ($this->_logsql) return $this->_errorMsg;
drivers/adodb-sqlite.inc.php.bak:		return ($this->_errorNo) ? sqlite_error_string($this->_errorNo) : '';
drivers/adodb-sqlite.inc.php.bak:		return $this->_errorNo;
drivers/adodb-sqlite.inc.php.bak:		$fmt = $this->qstr($fmt);
drivers/adodb-sqlite.inc.php.bak:		$rs = $this->Execute("select * from $tab limit 1");
drivers/adodb-sqlite.inc.php.bak:		for ($i=0,$max=$rs->_numOfFields; $i < $max; $i++) {
drivers/adodb-sqlite.inc.php.bak:			$fld =& $rs->FetchField($i);
drivers/adodb-sqlite.inc.php.bak:			else $arr[strtoupper($fld->name)] =& $fld;
drivers/adodb-sqlite.inc.php.bak:		$rs->Close();
drivers/adodb-sqlite.inc.php.bak:		@sqlite_create_function($this->_connectionID, 'adodb_date', 'adodb_date', 1);
drivers/adodb-sqlite.inc.php.bak:		@sqlite_create_function($this->_connectionID, 'adodb_date2', 'adodb_date2', 2);
drivers/adodb-sqlite.inc.php.bak:		$this->_connectionID = sqlite_open($argHostname);
drivers/adodb-sqlite.inc.php.bak:		if ($this->_connectionID === false) return false;
drivers/adodb-sqlite.inc.php.bak:		$this->_createFunctions();
drivers/adodb-sqlite.inc.php.bak:		$this->_connectionID = sqlite_popen($argHostname);
drivers/adodb-sqlite.inc.php.bak:		if ($this->_connectionID === false) return false;
drivers/adodb-sqlite.inc.php.bak:		$this->_createFunctions();
drivers/adodb-sqlite.inc.php.bak:		$rez = sqlite_query($sql,$this->_connectionID);
drivers/adodb-sqlite.inc.php.bak:			$this->_errorNo = sqlite_last_error($this->_connectionID);
drivers/adodb-sqlite.inc.php.bak:	function &SelectLimit($sql,$nrows=-1,$offset=-1,$inputarr=false,$secs2cache=0) 
drivers/adodb-sqlite.inc.php.bak:	   		$rs =& $this->CacheExecute($secs2cache,$sql."$limitStr$offsetStr",$inputarr);
drivers/adodb-sqlite.inc.php.bak:	   		$rs =& $this->Execute($sql."$limitStr$offsetStr",$inputarr);
drivers/adodb-sqlite.inc.php.bak:		//$this->debug=1;
drivers/adodb-sqlite.inc.php.bak:		while (--$MAXLOOPS>=0) {
drivers/adodb-sqlite.inc.php.bak:<<<<<<< adodb-sqlite.inc.php
drivers/adodb-sqlite.inc.php.bak:			$num = @$this->GetOne("select id from $seq");
drivers/adodb-sqlite.inc.php.bak:			@($num = $this->GetOne("select id from $seq"));
drivers/adodb-sqlite.inc.php.bak:				$this->Execute(sprintf($this->_genSeqSQL ,$seq));	
drivers/adodb-sqlite.inc.php.bak:				$start -= 1;
drivers/adodb-sqlite.inc.php.bak:				$ok = $this->Execute("insert into $seq values($start)");
drivers/adodb-sqlite.inc.php.bak:			$this->Execute("update $seq set id=id+1 where id=$num");
drivers/adodb-sqlite.inc.php.bak:			if ($this->affected_rows() > 0) {
drivers/adodb-sqlite.inc.php.bak:				$this->genID = $num;
drivers/adodb-sqlite.inc.php.bak:		if ($fn = $this->raiseErrorFn) {
drivers/adodb-sqlite.inc.php.bak:			$fn($this->databaseType,'GENID',-32000,"Unable to generate unique id after $MAXLOOPS attempts",$seq,$num);
drivers/adodb-sqlite.inc.php.bak:		if (empty($this->_genSeqSQL)) return false;
drivers/adodb-sqlite.inc.php.bak:		$ok = $this->Execute(sprintf($this->_genSeqSQL,$seqname));
drivers/adodb-sqlite.inc.php.bak:		$start -= 1;
drivers/adodb-sqlite.inc.php.bak:		return $this->Execute("insert into $seqname values($start)");
drivers/adodb-sqlite.inc.php.bak:		if (empty($this->_dropSeqSQL)) return false;
drivers/adodb-sqlite.inc.php.bak:		return $this->Execute(sprintf($this->_dropSeqSQL,$seqname));
drivers/adodb-sqlite.inc.php.bak:		return @sqlite_close($this->_connectionID);
drivers/adodb-sqlite.inc.php.bak:/*--------------------------------------------------------------------------------------
drivers/adodb-sqlite.inc.php.bak:--------------------------------------------------------------------------------------*/
drivers/adodb-sqlite.inc.php.bak:		case ADODB_FETCH_NUM: $this->fetchMode = SQLITE_NUM; break;
drivers/adodb-sqlite.inc.php.bak:		case ADODB_FETCH_ASSOC: $this->fetchMode = SQLITE_ASSOC; break;
drivers/adodb-sqlite.inc.php.bak:		default: $this->fetchMode = SQLITE_BOTH; break;
drivers/adodb-sqlite.inc.php.bak:		$this->_queryID = $queryID;
drivers/adodb-sqlite.inc.php.bak:		$this->_inited = true;
drivers/adodb-sqlite.inc.php.bak:		$this->fields = array();
drivers/adodb-sqlite.inc.php.bak:			$this->_currentRow = 0;
drivers/adodb-sqlite.inc.php.bak:			$this->EOF = !$this->_fetch();
drivers/adodb-sqlite.inc.php.bak:			@$this->_initrs();
drivers/adodb-sqlite.inc.php.bak:			$this->_numOfRows = 0;
drivers/adodb-sqlite.inc.php.bak:			$this->_numOfFields = 0;
drivers/adodb-sqlite.inc.php.bak:			$this->EOF = true;
drivers/adodb-sqlite.inc.php.bak:		return $this->_queryID;
drivers/adodb-sqlite.inc.php.bak:	function &FetchField($fieldOffset = -1)
drivers/adodb-sqlite.inc.php.bak:		$fld->name = sqlite_field_name($this->_queryID, $fieldOffset);
drivers/adodb-sqlite.inc.php.bak:		$fld->type = 'VARCHAR';
drivers/adodb-sqlite.inc.php.bak:		$fld->max_length = -1;
drivers/adodb-sqlite.inc.php.bak:		$this->_numOfRows = @sqlite_num_rows($this->_queryID);
drivers/adodb-sqlite.inc.php.bak:		$this->_numOfFields = @sqlite_num_fields($this->_queryID);
drivers/adodb-sqlite.inc.php.bak:		if ($this->fetchMode != SQLITE_NUM) return $this->fields[$colname];
drivers/adodb-sqlite.inc.php.bak:		if (!$this->bind) {
drivers/adodb-sqlite.inc.php.bak:			$this->bind = array();
drivers/adodb-sqlite.inc.php.bak:			for ($i=0; $i < $this->_numOfFields; $i++) {
drivers/adodb-sqlite.inc.php.bak:				$o = $this->FetchField($i);
drivers/adodb-sqlite.inc.php.bak:				$this->bind[strtoupper($o->name)] = $i;
drivers/adodb-sqlite.inc.php.bak:		 return $this->fields[$this->bind[strtoupper($colname)]];
drivers/adodb-sqlite.inc.php.bak:   		return sqlite_seek($this->_queryID, $row);
drivers/adodb-sqlite.inc.php.bak:		$this->fields = @sqlite_fetch_array($this->_queryID,$this->fetchMode);
drivers/adodb-sqlite.inc.php.bak:		return !empty($this->fields);
drivers/adodb-oracle.inc.php:V4.54 5 Nov 2004  (c) 2000-2004 John Lim (jlim@natsoft.com.my). All rights reserved.
drivers/adodb-oracle.inc.php:// security - hide paths
drivers/adodb-oracle.inc.php:	var $_initdate = true; // init date to YYYY-MM-DD
drivers/adodb-oracle.inc.php:	var $sysDate = "TO_DATE(TO_CHAR(SYSDATE,'YYYY-MM-DD'),'YYYY-MM-DD')";
drivers/adodb-oracle.inc.php:		return 'TO_DATE('.adodb_date($this->fmtDate,$d).",'YYYY-MM-DD')";
drivers/adodb-oracle.inc.php:		return 'TO_DATE('.adodb_date($this->fmtTimeStamp,$ts).",'RRRR-MM-DD, HH:MI:SS AM')";
drivers/adodb-oracle.inc.php:		 $this->autoCommit = false;
drivers/adodb-oracle.inc.php:		 ora_commitoff($this->_connectionID);
drivers/adodb-oracle.inc.php:		   if (!$ok) return $this->RollbackTrans();
drivers/adodb-oracle.inc.php:		   $ret = ora_commit($this->_connectionID);
drivers/adodb-oracle.inc.php:		   ora_commiton($this->_connectionID);
drivers/adodb-oracle.inc.php:		$ret = ora_rollback($this->_connectionID);
drivers/adodb-oracle.inc.php:		ora_commiton($this->_connectionID);
drivers/adodb-oracle.inc.php:	/* there seems to be a bug in the oracle extension -- always returns ORA-00000 - no error */
drivers/adodb-oracle.inc.php:        if ($this->_errorMsg !== false) return $this->_errorMsg;
drivers/adodb-oracle.inc.php:        if (is_resource($this->_curs)) $this->_errorMsg = @ora_error($this->_curs);
drivers/adodb-oracle.inc.php: 		if (empty($this->_errorMsg)) $this->_errorMsg = @ora_error($this->_connectionID);
drivers/adodb-oracle.inc.php:		return $this->_errorMsg;
drivers/adodb-oracle.inc.php:		if ($this->_errorCode !== false) return $this->_errorCode;
drivers/adodb-oracle.inc.php:		if (is_resource($this->_curs)) $this->_errorCode = @ora_errorcode($this->_curs);
drivers/adodb-oracle.inc.php:		if (empty($this->_errorCode)) $this->_errorCode = @ora_errorcode($this->_connectionID);
drivers/adodb-oracle.inc.php:        return $this->_errorCode;
drivers/adodb-oracle.inc.php:            $this->_errorMsg = false;
drivers/adodb-oracle.inc.php:		    $this->_errorCode = false;
drivers/adodb-oracle.inc.php:            // G. Giunta 2003/08/13 - This looks danegrously suspicious: why should we want to set
drivers/adodb-oracle.inc.php:					if ($this->connectSID) {
drivers/adodb-oracle.inc.php:		//if ($argHostname) print "<p>Connect: 1st argument should be left blank for $this->databaseType</p>";
drivers/adodb-oracle.inc.php:				$this->_connectionID = ora_plogon($argUsername,$argPassword);
drivers/adodb-oracle.inc.php:				$this->_connectionID = ora_logon($argUsername,$argPassword);
drivers/adodb-oracle.inc.php:			if ($this->_connectionID === false) return false;
drivers/adodb-oracle.inc.php:			if ($this->autoCommit) ora_commiton($this->_connectionID);
drivers/adodb-oracle.inc.php:			if ($this->_initdate) {
drivers/adodb-oracle.inc.php:				$rs = $this->_query("ALTER SESSION SET NLS_DATE_FORMAT='YYYY-MM-DD'");
drivers/adodb-oracle.inc.php:			return $this->_connect($argHostname, $argUsername, $argPassword, $argDatabasename, 1);
drivers/adodb-oracle.inc.php:            $this->_errorMsg = false;
drivers/adodb-oracle.inc.php:		    $this->_errorCode = false;
drivers/adodb-oracle.inc.php:			$curs = ora_open($this->_connectionID);
drivers/adodb-oracle.inc.php:			$this->_curs = $curs;
drivers/adodb-oracle.inc.php:            $this->_errorCode = @ora_errorcode($curs);
drivers/adodb-oracle.inc.php:            $this->_errorMsg = @ora_error($curs);
drivers/adodb-oracle.inc.php:			return @ora_logoff($this->_connectionID);
drivers/adodb-oracle.inc.php:/*--------------------------------------------------------------------------------------
drivers/adodb-oracle.inc.php:--------------------------------------------------------------------------------------*/
drivers/adodb-oracle.inc.php:		$this->fetchMode = $mode;
drivers/adodb-oracle.inc.php:		$this->_queryID = $queryID;
drivers/adodb-oracle.inc.php:		$this->_inited = true;
drivers/adodb-oracle.inc.php:		$this->fields = array();
drivers/adodb-oracle.inc.php:			$this->_currentRow = 0;
drivers/adodb-oracle.inc.php:			$this->EOF = !$this->_fetch();
drivers/adodb-oracle.inc.php:			@$this->_initrs();
drivers/adodb-oracle.inc.php:			$this->_numOfRows = 0;
drivers/adodb-oracle.inc.php:			$this->_numOfFields = 0;
drivers/adodb-oracle.inc.php:			$this->EOF = true;
drivers/adodb-oracle.inc.php:		return $this->_queryID;
drivers/adodb-oracle.inc.php:	   function FetchField($fieldOffset = -1)
drivers/adodb-oracle.inc.php:			$fld->name = ora_columnname($this->_queryID, $fieldOffset);
drivers/adodb-oracle.inc.php:			$fld->type = ora_columntype($this->_queryID, $fieldOffset);
drivers/adodb-oracle.inc.php:			$fld->max_length = ora_columnsize($this->_queryID, $fieldOffset);
drivers/adodb-oracle.inc.php:		if (!$this->bind) {
drivers/adodb-oracle.inc.php:			$this->bind = array();
drivers/adodb-oracle.inc.php:			for ($i=0; $i < $this->_numOfFields; $i++) {
drivers/adodb-oracle.inc.php:				$o = $this->FetchField($i);
drivers/adodb-oracle.inc.php:				$this->bind[strtoupper($o->name)] = $i;
drivers/adodb-oracle.inc.php:		 return $this->fields[$this->bind[strtoupper($colname)]];
drivers/adodb-oracle.inc.php:		   $this->_numOfRows = -1;
drivers/adodb-oracle.inc.php:		   $this->_numOfFields = @ora_numcols($this->_queryID);
drivers/adodb-oracle.inc.php:		if ($this->fetchMode & ADODB_FETCH_ASSOC)
drivers/adodb-oracle.inc.php:			return @ora_fetch_into($this->_queryID,&$this->fields,ORA_FETCHINTO_NULLS|ORA_FETCHINTO_ASSOC);
drivers/adodb-oracle.inc.php:			return @ora_fetch_into($this->_queryID,&$this->fields,ORA_FETCHINTO_NULLS);
drivers/adodb-oracle.inc.php:		   return @ora_close($this->_queryID);
drivers/adodb-oracle.inc.php:	function MetaType($t,$len=-1)
drivers/adodb-oracle.inc.php:			$t = $fieldobj->type;
drivers/adodb-oracle.inc.php:			$len = $fieldobj->max_length;
drivers/adodb-oracle.inc.php:				if ($len <= $this->blobSize) return 'C';
drivers/adodb-ldap.inc.php:  V4.54 5 Nov 2004  (c) 2000-2004 John Lim (jlim#natsoft.com.my). All rights reserved.
drivers/adodb-ldap.inc.php:// security - hide paths
drivers/adodb-ldap.inc.php:	   $this->_connectionID = ldap_connect( $conn_info[0], $conn_info[1] ) 
drivers/adodb-ldap.inc.php:	       or die( 'Could not connect to ' . $this->_connectionID );
drivers/adodb-ldap.inc.php:	       $bind = ldap_bind( $this->_connectionID, $username, $password ) 
drivers/adodb-ldap.inc.php:	           or die( 'Could not bind to ' . $this->_connectionID . ' with $username & $password');
drivers/adodb-ldap.inc.php:	       $bind = ldap_bind( $this->_connectionID ) 
drivers/adodb-ldap.inc.php:	           or die( 'Could not bind anonymously to ' . $this->_connectionID );
drivers/adodb-ldap.inc.php:	   return $this->_connectionID;
drivers/adodb-ldap.inc.php:	   $rs = ldap_search( $this->_connectionID, $this->database, $sql );
drivers/adodb-ldap.inc.php:		@ldap_close( $this->_connectionID );
drivers/adodb-ldap.inc.php:		$this->_connectionID = false;
drivers/adodb-ldap.inc.php:        if( is_array( $this->version ) ) return $this->version;
drivers/adodb-ldap.inc.php:        ldap_get_option( $this->_connectionID, LDAP_OPT_DEREF, $version['LDAP_OPT_DEREF'] ) ;
drivers/adodb-ldap.inc.php:        ldap_get_option( $this->_connectionID, LDAP_OPT_SIZELIMIT, $version['LDAP_OPT_SIZELIMIT'] );
drivers/adodb-ldap.inc.php:        ldap_get_option( $this->_connectionID, LDAP_OPT_TIMELIMIT, $version['LDAP_OPT_TIMELIMIT'] );
drivers/adodb-ldap.inc.php:        ldap_get_option( $this->_connectionID, LDAP_OPT_REFERRALS, $version['LDAP_OPT_REFERRALS'] );
drivers/adodb-ldap.inc.php:        ldap_get_option( $this->_connectionID, LDAP_OPT_RESTART, $version['LDAP_OPT_RESTART'] );
drivers/adodb-ldap.inc.php:        ldap_get_option( $this->_connectionID, LDAP_OPT_PROTOCOL_VERSION, $version['LDAP_OPT_PROTOCOL_VERSION'] );
drivers/adodb-ldap.inc.php:        ldap_get_option( $this->_connectionID, LDAP_OPT_HOST_NAME, $version['LDAP_OPT_HOST_NAME'] ); 
drivers/adodb-ldap.inc.php:        ldap_get_option( $this->_connectionID, OPT_ERROR_NUMBER, $version['OPT_ERROR_NUMBER'] ); 
drivers/adodb-ldap.inc.php:        ldap_get_option( $this->_connectionID, OPT_ERROR_STRING, $version['OPT_ERROR_STRING'] ); 
drivers/adodb-ldap.inc.php:        ldap_get_option( $this->_connectionID, LDAP_OPT_MATCHED_DN, $version['LDAP_OPT_MATCHED_DN'] ); 
drivers/adodb-ldap.inc.php:        return $this->version = $version;
drivers/adodb-ldap.inc.php:/*--------------------------------------------------------------------------------------
drivers/adodb-ldap.inc.php:--------------------------------------------------------------------------------------*/
drivers/adodb-ldap.inc.php:		  $this->fetchMode = LDAP_NUM; 
drivers/adodb-ldap.inc.php:		  $this->fetchMode = LDAP_ASSOC; 
drivers/adodb-ldap.inc.php:		  $this->fetchMode = LDAP_BOTH; 
drivers/adodb-ldap.inc.php:		$this->ADORecordSet($queryID);	
drivers/adodb-ldap.inc.php:	    $this->_numOfRows = ldap_count_entries( $this->connection->_connectionID, $this->_queryID );
drivers/adodb-ldap.inc.php:    Return whole recordset as a multi-dimensional associative array
drivers/adodb-ldap.inc.php:		$records = $this->_numOfRows;
drivers/adodb-ldap.inc.php:                foreach ( $this->fields as $k=>$v ) {
drivers/adodb-ldap.inc.php:        foreach ( $this->fields as $k=>$v ) {
drivers/adodb-ldap.inc.php:        foreach ( $this->fields as $k=>$v ) {
drivers/adodb-ldap.inc.php:		if ( $this->_currentRow >= $this->_numOfRows && $this->_numOfRows >= 0 )
drivers/adodb-ldap.inc.php:        if ( $this->_currentRow == 0 ) {
drivers/adodb-ldap.inc.php:		  $this->_entryID = ldap_first_entry( $this->connection->_connectionID, $this->_queryID );
drivers/adodb-ldap.inc.php:          $this->_entryID = ldap_next_entry( $this->connection->_connectionID, $this->_entryID );
drivers/adodb-ldap.inc.php:	    $this->fields = ldap_get_attributes( $this->connection->_connectionID, $this->_entryID );
drivers/adodb-ldap.inc.php:	    $this->_numOfFields = $this->fields['count'];	
drivers/adodb-ldap.inc.php:	    switch ( $this->fetchMode ) {
drivers/adodb-ldap.inc.php:            $this->fields = $this->GetRowAssoc();
drivers/adodb-ldap.inc.php:            $this->fields = $this->GetRowNums();
drivers/adodb-ldap.inc.php:        return ( is_array( $this->fields ) );        
drivers/adodb-ldap.inc.php:		@ldap_free_result( $this->_queryID );	
drivers/adodb-ldap.inc.php:		$this->_queryID = false;
drivers/adodb-access.inc.php:V4.54 5 Nov 2004  (c) 2000-2004 John Lim (jlim@natsoft.com.my). All rights reserved.
drivers/adodb-access.inc.php:	include(ADODB_DIR."/drivers/adodb-odbc.inc.php");
drivers/adodb-access.inc.php:	var $fmtDate = "#Y-m-d#";
drivers/adodb-access.inc.php:	var $fmtTimeStamp = "#Y-m-d h:i:sA#"; // note not comma
drivers/adodb-access.inc.php:	var $sysDate = "FORMAT(NOW,'yyyy-mm-dd')";
drivers/adodb-access.inc.php:		$this->ADODB_odbc();
drivers/adodb-access.inc.php:		$qid = odbc_tables($this->_connectionID);
drivers/adodb-access.inc.php:		$rs->_has_stupid_odbc_fetch_api_change = $this->_has_stupid_odbc_fetch_api_change;
drivers/adodb-access.inc.php:		$arr = &$rs->GetArray();
drivers/adodb-access.inc.php:		return $this->ADORecordSet_odbc($id,$mode);
drivers/adodb-odbc.inc.php:V4.54 5 Nov 2004  (c) 2000-2004 John Lim (jlim#natsoft.com.my). All rights reserved.
drivers/adodb-odbc.inc.php:// security - hide paths
drivers/adodb-odbc.inc.php:/*--------------------------------------------------------------------------------------
drivers/adodb-odbc.inc.php:--------------------------------------------------------------------------------------*/
drivers/adodb-odbc.inc.php:	var $fmtDate = "'Y-m-d'";
drivers/adodb-odbc.inc.php:	var $fmtTimeStamp = "'Y-m-d, h:i:sA'";
drivers/adodb-odbc.inc.php:	var $useFetchArray = false; // setting this to true will make array elements in FETCH_ASSOC mode case-sensitive
drivers/adodb-odbc.inc.php:								// breaking backward-compat
drivers/adodb-odbc.inc.php:		$this->_haserrorfunctions = ADODB_PHPVER >= 0x4050;
drivers/adodb-odbc.inc.php:		$this->_has_stupid_odbc_fetch_api_change = ADODB_PHPVER >= 0x4200;
drivers/adodb-odbc.inc.php:		if ($this->debug && $argDatabasename && $this->databaseType != 'vfp') {
drivers/adodb-odbc.inc.php:		if ($this->curmode === false) $this->_connectionID = odbc_connect($argDSN,$argUsername,$argPassword);
drivers/adodb-odbc.inc.php:		else $this->_connectionID = odbc_connect($argDSN,$argUsername,$argPassword,$this->curmode);
drivers/adodb-odbc.inc.php:		$this->_errorMsg = isset($php_errormsg) ? $php_errormsg : '';
drivers/adodb-odbc.inc.php:		if (isset($this->connectStmt)) $this->Execute($this->connectStmt);
drivers/adodb-odbc.inc.php:		return $this->_connectionID != false;
drivers/adodb-odbc.inc.php:		$this->_errorMsg = isset($php_errormsg) ? $php_errormsg : '';
drivers/adodb-odbc.inc.php:		if ($this->debug && $argDatabasename) {
drivers/adodb-odbc.inc.php:		if ($this->curmode === false) $this->_connectionID = odbc_connect($argDSN,$argUsername,$argPassword);
drivers/adodb-odbc.inc.php:		else $this->_connectionID = odbc_pconnect($argDSN,$argUsername,$argPassword,$this->curmode);
drivers/adodb-odbc.inc.php:		$this->_errorMsg = isset($php_errormsg) ? $php_errormsg : '';
drivers/adodb-odbc.inc.php:		if ($this->_connectionID && $this->autoRollback) @odbc_rollback($this->_connectionID);
drivers/adodb-odbc.inc.php:		if (isset($this->connectStmt)) $this->Execute($this->connectStmt);
drivers/adodb-odbc.inc.php:		return $this->_connectionID != false;
drivers/adodb-odbc.inc.php:		if (!empty($this->host) && ADODB_PHPVER >= 0x4300) {
drivers/adodb-odbc.inc.php:			$dsn = strtoupper($this->host);
drivers/adodb-odbc.inc.php:				$rez = @odbc_data_source($this->_connectionID,
drivers/adodb-odbc.inc.php:		if (empty($this->_genSeqSQL)) return false;
drivers/adodb-odbc.inc.php:		$ok = $this->Execute(sprintf($this->_genSeqSQL,$seqname));
drivers/adodb-odbc.inc.php:		$start -= 1;
drivers/adodb-odbc.inc.php:		return $this->Execute("insert into $seqname values($start)");
drivers/adodb-odbc.inc.php:		if (empty($this->_dropSeqSQL)) return false;
drivers/adodb-odbc.inc.php:		return $this->Execute(sprintf($this->_dropSeqSQL,$seqname));
drivers/adodb-odbc.inc.php:		//$this->debug=1;
drivers/adodb-odbc.inc.php:		while (--$MAXLOOPS>=0) {
drivers/adodb-odbc.inc.php:			$num = $this->GetOne("select id from $seq");
drivers/adodb-odbc.inc.php:				$this->Execute(sprintf($this->_genSeqSQL ,$seq));	
drivers/adodb-odbc.inc.php:				$start -= 1;
drivers/adodb-odbc.inc.php:				$ok = $this->Execute("insert into $seq values($start)");
drivers/adodb-odbc.inc.php:			$this->Execute("update $seq set id=id+1 where id=$num");
drivers/adodb-odbc.inc.php:			if ($this->affected_rows() > 0) {
drivers/adodb-odbc.inc.php:				$this->genID = $num;
drivers/adodb-odbc.inc.php:		if ($fn = $this->raiseErrorFn) {
drivers/adodb-odbc.inc.php:			$fn($this->databaseType,'GENID',-32000,"Unable to generate unique id after $MAXLOOPS attempts",$seq,$num);
drivers/adodb-odbc.inc.php:		if ($this->_haserrorfunctions) {
drivers/adodb-odbc.inc.php:			if ($this->_errorMsg !== false) return $this->_errorMsg;
drivers/adodb-odbc.inc.php:			if (empty($this->_connectionID)) return @odbc_errormsg();
drivers/adodb-odbc.inc.php:			return @odbc_errormsg($this->_connectionID);
drivers/adodb-odbc.inc.php:		if ($this->_haserrorfunctions) {
drivers/adodb-odbc.inc.php:			if ($this->_errorCode !== false) {
drivers/adodb-odbc.inc.php:				return (strlen($this->_errorCode)<=2) ? 0 : $this->_errorCode;
drivers/adodb-odbc.inc.php:			if (empty($this->_connectionID)) $e = @odbc_error(); 
drivers/adodb-odbc.inc.php:			else $e = @odbc_error($this->_connectionID);
drivers/adodb-odbc.inc.php:		if (!$this->hasTransactions) return false;
drivers/adodb-odbc.inc.php:		if ($this->transOff) return true; 
drivers/adodb-odbc.inc.php:		$this->transCnt += 1;
drivers/adodb-odbc.inc.php:		$this->_autocommit = false;
drivers/adodb-odbc.inc.php:		return odbc_autocommit($this->_connectionID,false);
drivers/adodb-odbc.inc.php:		if ($this->transOff) return true; 
drivers/adodb-odbc.inc.php:		if (!$ok) return $this->RollbackTrans();
drivers/adodb-odbc.inc.php:		if ($this->transCnt) $this->transCnt -= 1;
drivers/adodb-odbc.inc.php:		$this->_autocommit = true;
drivers/adodb-odbc.inc.php:		$ret = odbc_commit($this->_connectionID);
drivers/adodb-odbc.inc.php:		odbc_autocommit($this->_connectionID,true);
drivers/adodb-odbc.inc.php:		if ($this->transOff) return true; 
drivers/adodb-odbc.inc.php:		if ($this->transCnt) $this->transCnt -= 1;
drivers/adodb-odbc.inc.php:		$this->_autocommit = true;
drivers/adodb-odbc.inc.php:		$ret = odbc_rollback($this->_connectionID);
drivers/adodb-odbc.inc.php:		odbc_autocommit($this->_connectionID,true);
drivers/adodb-odbc.inc.php:		if ($this->uCaseTables) $table = strtoupper($table);
drivers/adodb-odbc.inc.php:		$this->_findschema($table,$schema);
drivers/adodb-odbc.inc.php:		$qid = @odbc_primarykeys($this->_connectionID,'',$schema,$table);
drivers/adodb-odbc.inc.php:		$rs->_has_stupid_odbc_fetch_api_change = $this->_has_stupid_odbc_fetch_api_change;
drivers/adodb-odbc.inc.php:		$arr =& $rs->GetArray();
drivers/adodb-odbc.inc.php:		$rs->Close();
drivers/adodb-odbc.inc.php:		$qid = odbc_tables($this->_connectionID);
drivers/adodb-odbc.inc.php:		$rs->_has_stupid_odbc_fetch_api_change = $this->_has_stupid_odbc_fetch_api_change;
drivers/adodb-odbc.inc.php:		$arr =& $rs->GetArray();
drivers/adodb-odbc.inc.php:		$rs->Close();
drivers/adodb-odbc.inc.php:See http://msdn.microsoft.com/library/default.asp?url=/library/en-us/odbc/htm/odbcdatetime_data_type_changes.asp
drivers/adodb-odbc.inc.php:/ One-parameter shortcuts for date/time data types /
drivers/adodb-odbc.inc.php:#define SQL_UNICODE                             (-95)
drivers/adodb-odbc.inc.php:#define SQL_UNICODE_VARCHAR                     (-96)
drivers/adodb-odbc.inc.php:#define SQL_UNICODE_LONGVARCHAR                 (-97)
drivers/adodb-odbc.inc.php:		case -95:
drivers/adodb-odbc.inc.php:		case -96:
drivers/adodb-odbc.inc.php:		case -97:
drivers/adodb-odbc.inc.php:		case -1: //text
drivers/adodb-odbc.inc.php:		case -4: //image
drivers/adodb-odbc.inc.php:		case -6:
drivers/adodb-odbc.inc.php:		case -11: // uniqidentifier
drivers/adodb-odbc.inc.php:		case -7: //bit
drivers/adodb-odbc.inc.php:		if ($this->uCaseTables) $table = strtoupper($table);
drivers/adodb-odbc.inc.php:		$this->_findschema($table,$schema);
drivers/adodb-odbc.inc.php:			$qid2 = odbc_tables($this->_connectionID);
drivers/adodb-odbc.inc.php:			$rs->_has_stupid_odbc_fetch_api_change = $this->_has_stupid_odbc_fetch_api_change;
drivers/adodb-odbc.inc.php:			$rs->_fetch();
drivers/adodb-odbc.inc.php:			while (!$rs->EOF) {
drivers/adodb-odbc.inc.php:				if ($table == strtoupper($rs->fields[2])) {
drivers/adodb-odbc.inc.php:					$q = $rs->fields[0];
drivers/adodb-odbc.inc.php:					$o = $rs->fields[1];
drivers/adodb-odbc.inc.php:				$rs->MoveNext();
drivers/adodb-odbc.inc.php:			$rs->Close();
drivers/adodb-odbc.inc.php:			$qid = odbc_columns($this->_connectionID,$q,$o,strtoupper($table),'%');
drivers/adodb-odbc.inc.php:		switch ($this->databaseType) {
drivers/adodb-odbc.inc.php:			$qid = odbc_columns($this->_connectionID);#,'%','',strtoupper($table),'%');
drivers/adodb-odbc.inc.php:            $qid = odbc_columns($this->_connectionID, "", $schema, $table, $colname);
drivers/adodb-odbc.inc.php:			$qid = @odbc_columns($this->_connectionID,'%','%',strtoupper($table),'%');
drivers/adodb-odbc.inc.php:			if (empty($qid)) $qid = odbc_columns($this->_connectionID);
drivers/adodb-odbc.inc.php:		$rs->_has_stupid_odbc_fetch_api_change = $this->_has_stupid_odbc_fetch_api_change;
drivers/adodb-odbc.inc.php:		$rs->_fetch();
drivers/adodb-odbc.inc.php:		$rs->fields indices
drivers/adodb-odbc.inc.php:		while (!$rs->EOF) {
drivers/adodb-odbc.inc.php:		//	adodb_pr($rs->fields);
drivers/adodb-odbc.inc.php:			if (strtoupper(trim($rs->fields[2])) == $table && (!$schema || strtoupper($rs->fields[1]) == $schema)) {
drivers/adodb-odbc.inc.php:				$fld->name = $rs->fields[3];
drivers/adodb-odbc.inc.php:				$fld->type = $this->ODBCTypes($rs->fields[4]);
drivers/adodb-odbc.inc.php:				// ref: http://msdn.microsoft.com/library/default.asp?url=/archive/en-us/dnaraccgen/html/msdn_odk.asp
drivers/adodb-odbc.inc.php:				if ($fld->type == 'C' or $fld->type == 'X') {
drivers/adodb-odbc.inc.php:					if ($this->databaseType == 'access') 
drivers/adodb-odbc.inc.php:						$fld->max_length = $rs->fields[6];
drivers/adodb-odbc.inc.php:					else if ($rs->fields[4] <= -95) // UNICODE
drivers/adodb-odbc.inc.php:						$fld->max_length = $rs->fields[7]/2;
drivers/adodb-odbc.inc.php:						$fld->max_length = $rs->fields[7];
drivers/adodb-odbc.inc.php:					$fld->max_length = $rs->fields[7];
drivers/adodb-odbc.inc.php:				$fld->not_null = !empty($rs->fields[10]);
drivers/adodb-odbc.inc.php:				$fld->scale = $rs->fields[8];
drivers/adodb-odbc.inc.php:				$retarr[strtoupper($fld->name)] = $fld;	
drivers/adodb-odbc.inc.php:			$rs->MoveNext();
drivers/adodb-odbc.inc.php:		$rs->Close(); //-- crashes 4.03pl1 -- why?
drivers/adodb-odbc.inc.php:		if (! $this->_bindInputArray) return $sql; // no binding
drivers/adodb-odbc.inc.php:		$stmt = odbc_prepare($this->_connectionID,$sql);
drivers/adodb-odbc.inc.php:		$this->_error = '';
drivers/adodb-odbc.inc.php:				$stmtid = odbc_prepare($this->_connectionID,$sql);
drivers/adodb-odbc.inc.php:					$this->_errorMsg = isset($php_errormsg) ? $php_errormsg : '';
drivers/adodb-odbc.inc.php:				if ($this->_haserrorfunctions) {
drivers/adodb-odbc.inc.php:					$this->_errorMsg = odbc_errormsg();
drivers/adodb-odbc.inc.php:					$this->_errorCode = odbc_error();
drivers/adodb-odbc.inc.php:				if ($this->_haserrorfunctions) {
drivers/adodb-odbc.inc.php:					$this->_errorMsg = odbc_errormsg();
drivers/adodb-odbc.inc.php:					$this->_errorCode = odbc_error();
drivers/adodb-odbc.inc.php:			$stmtid = odbc_exec($this->_connectionID,$sql);
drivers/adodb-odbc.inc.php:		$this->_lastAffectedRows = 0;
drivers/adodb-odbc.inc.php:				$this->_lastAffectedRows = odbc_num_rows($stmtid);
drivers/adodb-odbc.inc.php:				$this->_lastAffectedRows = 0;
drivers/adodb-odbc.inc.php:				odbc_binmode($stmtid,$this->binmode);
drivers/adodb-odbc.inc.php:				odbc_longreadlen($stmtid,$this->maxblobsize);
drivers/adodb-odbc.inc.php:			if ($this->_haserrorfunctions) {
drivers/adodb-odbc.inc.php:				$this->_errorMsg = '';
drivers/adodb-odbc.inc.php:				$this->_errorCode = 0;
drivers/adodb-odbc.inc.php:				$this->_errorMsg = isset($php_errormsg) ? $php_errormsg : '';
drivers/adodb-odbc.inc.php:			if ($this->_haserrorfunctions) {
drivers/adodb-odbc.inc.php:				$this->_errorMsg = odbc_errormsg();
drivers/adodb-odbc.inc.php:				$this->_errorCode = odbc_error();
drivers/adodb-odbc.inc.php:				$this->_errorMsg = isset($php_errormsg) ? $php_errormsg : '';
drivers/adodb-odbc.inc.php:		$conn->Execute('INSERT INTO blobtable (id, blobcol) VALUES (1, null)');
drivers/adodb-odbc.inc.php:		$conn->UpdateBlob('blobtable','blobcol',$blob,'id=1');
drivers/adodb-odbc.inc.php:		return $this->Execute("UPDATE $table SET $column=? WHERE $where",array($val)) != false;
drivers/adodb-odbc.inc.php:		$ret = @odbc_close($this->_connectionID);
drivers/adodb-odbc.inc.php:		$this->_connectionID = false;
drivers/adodb-odbc.inc.php:		return $this->_lastAffectedRows;
drivers/adodb-odbc.inc.php:/*--------------------------------------------------------------------------------------
drivers/adodb-odbc.inc.php:--------------------------------------------------------------------------------------*/
drivers/adodb-odbc.inc.php:		$this->fetchMode = $mode;
drivers/adodb-odbc.inc.php:		$this->_queryID = $id;
drivers/adodb-odbc.inc.php:		// the following is required for mysql odbc driver in 4.3.1 -- why?
drivers/adodb-odbc.inc.php:		$this->EOF = false;
drivers/adodb-odbc.inc.php:		$this->_currentRow = -1;
drivers/adodb-odbc.inc.php:		//$this->ADORecordSet($id);
drivers/adodb-odbc.inc.php:	function &FetchField($fieldOffset = -1) 
drivers/adodb-odbc.inc.php:		$o->name = @odbc_field_name($this->_queryID,$off);
drivers/adodb-odbc.inc.php:		$o->type = @odbc_field_type($this->_queryID,$off);
drivers/adodb-odbc.inc.php:		$o->max_length = @odbc_field_len($this->_queryID,$off);
drivers/adodb-odbc.inc.php:		if (ADODB_ASSOC_CASE == 0) $o->name = strtolower($o->name);
drivers/adodb-odbc.inc.php:		else if (ADODB_ASSOC_CASE == 1) $o->name = strtoupper($o->name);
drivers/adodb-odbc.inc.php:		if ($this->fetchMode & ADODB_FETCH_ASSOC) return $this->fields[$colname];
drivers/adodb-odbc.inc.php:		if (!$this->bind) {
drivers/adodb-odbc.inc.php:			$this->bind = array();
drivers/adodb-odbc.inc.php:			for ($i=0; $i < $this->_numOfFields; $i++) {
drivers/adodb-odbc.inc.php:				$o = $this->FetchField($i);
drivers/adodb-odbc.inc.php:				$this->bind[strtoupper($o->name)] = $i;
drivers/adodb-odbc.inc.php:		 return $this->fields[$this->bind[strtoupper($colname)]];
drivers/adodb-odbc.inc.php:		$this->_numOfRows = ($ADODB_COUNTRECS) ? @odbc_num_rows($this->_queryID) : -1;
drivers/adodb-odbc.inc.php:		$this->_numOfFields = @odbc_num_fields($this->_queryID);
drivers/adodb-odbc.inc.php:		if ($this->_numOfRows == 0) $this->_numOfRows = -1;
drivers/adodb-odbc.inc.php:		//$this->useFetchArray = $this->connection->useFetchArray;
drivers/adodb-odbc.inc.php:		$this->_has_stupid_odbc_fetch_api_change = ADODB_PHPVER >= 0x4200;
drivers/adodb-odbc.inc.php:	function &GetArrayLimit($nrows,$offset=-1) 
drivers/adodb-odbc.inc.php:			$rs =& $this->GetArray($nrows);
drivers/adodb-odbc.inc.php:		$savem = $this->fetchMode;
drivers/adodb-odbc.inc.php:		$this->fetchMode = ADODB_FETCH_NUM;
drivers/adodb-odbc.inc.php:		$this->Move($offset);
drivers/adodb-odbc.inc.php:		$this->fetchMode = $savem;
drivers/adodb-odbc.inc.php:		if ($this->fetchMode & ADODB_FETCH_ASSOC) {
drivers/adodb-odbc.inc.php:			$this->fields =& $this->GetRowAssoc(ADODB_ASSOC_CASE);
drivers/adodb-odbc.inc.php:		while (!$this->EOF && $nrows != $cnt) {
drivers/adodb-odbc.inc.php:			$results[$cnt++] = $this->fields;
drivers/adodb-odbc.inc.php:			$this->MoveNext();
drivers/adodb-odbc.inc.php:		if ($this->_numOfRows != 0 && !$this->EOF) {		
drivers/adodb-odbc.inc.php:			$this->_currentRow++;
drivers/adodb-odbc.inc.php:			if ($this->_has_stupid_odbc_fetch_api_change)
drivers/adodb-odbc.inc.php:				$rez = @odbc_fetch_into($this->_queryID,$this->fields);
drivers/adodb-odbc.inc.php:				$rez = @odbc_fetch_into($this->_queryID,$row,$this->fields);
drivers/adodb-odbc.inc.php:				if ($this->fetchMode & ADODB_FETCH_ASSOC) {
drivers/adodb-odbc.inc.php:					$this->fields =& $this->GetRowAssoc(ADODB_ASSOC_CASE);
drivers/adodb-odbc.inc.php:		$this->fields = false;
drivers/adodb-odbc.inc.php:		$this->EOF = true;
drivers/adodb-odbc.inc.php:		if ($this->_has_stupid_odbc_fetch_api_change)
drivers/adodb-odbc.inc.php:			$rez = @odbc_fetch_into($this->_queryID,$this->fields,$row);
drivers/adodb-odbc.inc.php:			$rez = @odbc_fetch_into($this->_queryID,$row,$this->fields);
drivers/adodb-odbc.inc.php:			if ($this->fetchMode & ADODB_FETCH_ASSOC) {
drivers/adodb-odbc.inc.php:				$this->fields =& $this->GetRowAssoc(ADODB_ASSOC_CASE);
drivers/adodb-odbc.inc.php:		$this->fields = false;
drivers/adodb-odbc.inc.php:		return @odbc_free_result($this->_queryID);		
drivers/adodb-sqlite.inc.php:V4.54 5 Nov 2004  (c) 2000-2004 John Lim (jlim@natsoft.com.my). All rights reserved.
drivers/adodb-sqlite.inc.php:// security - hide paths
drivers/adodb-sqlite.inc.php:	var $sysDate = "adodb_date('Y-m-d')";
drivers/adodb-sqlite.inc.php:	var $sysTimeStamp = "adodb_date('Y-m-d H:i:s')";
drivers/adodb-sqlite.inc.php:	var $fmtTimeStamp = "'Y-m-d H:i:s'";
drivers/adodb-sqlite.inc.php:	case 'sysDate': return "'".date($this->fmtDate)."'";
drivers/adodb-sqlite.inc.php:	case 'sysTimeStamp' : return "'".date($this->sysTimeStamp)."'";
drivers/adodb-sqlite.inc.php:		 if ($this->transOff) return true; 
drivers/adodb-sqlite.inc.php:		 $ret = $this->Execute("BEGIN TRANSACTION");
drivers/adodb-sqlite.inc.php:		 $this->transCnt += 1;
drivers/adodb-sqlite.inc.php:		if ($this->transOff) return true; 
drivers/adodb-sqlite.inc.php:		if (!$ok) return $this->RollbackTrans();
drivers/adodb-sqlite.inc.php:		$ret = $this->Execute("COMMIT");
drivers/adodb-sqlite.inc.php:		if ($this->transCnt>0)$this->transCnt -= 1;
drivers/adodb-sqlite.inc.php:		if ($this->transOff) return true; 
drivers/adodb-sqlite.inc.php:		$ret = $this->Execute("ROLLBACK");
drivers/adodb-sqlite.inc.php:		if ($this->transCnt>0)$this->transCnt -= 1;
drivers/adodb-sqlite.inc.php:		return sqlite_last_insert_rowid($this->_connectionID);
drivers/adodb-sqlite.inc.php:        return sqlite_changes($this->_connectionID);
drivers/adodb-sqlite.inc.php:		if ($this->_logsql) return $this->_errorMsg;
drivers/adodb-sqlite.inc.php:		return ($this->_errorNo) ? sqlite_error_string($this->_errorNo) : '';
drivers/adodb-sqlite.inc.php:		return $this->_errorNo;
drivers/adodb-sqlite.inc.php:		$fmt = $this->qstr($fmt);
drivers/adodb-sqlite.inc.php:		$rs = $this->Execute("select * from $tab limit 1");
drivers/adodb-sqlite.inc.php:		for ($i=0,$max=$rs->_numOfFields; $i < $max; $i++) {
drivers/adodb-sqlite.inc.php:			$fld =& $rs->FetchField($i);
drivers/adodb-sqlite.inc.php:			else $arr[strtoupper($fld->name)] =& $fld;
drivers/adodb-sqlite.inc.php:		$rs->Close();
drivers/adodb-sqlite.inc.php:		@sqlite_create_function($this->_connectionID, 'adodb_date', 'adodb_date', 1);
drivers/adodb-sqlite.inc.php:		@sqlite_create_function($this->_connectionID, 'adodb_date2', 'adodb_date2', 2);
drivers/adodb-sqlite.inc.php:		$this->_connectionID = sqlite_open($argHostname);
drivers/adodb-sqlite.inc.php:		if ($this->_connectionID === false) return false;
drivers/adodb-sqlite.inc.php:		$this->_createFunctions();
drivers/adodb-sqlite.inc.php:		$this->_connectionID = sqlite_popen($argHostname);
drivers/adodb-sqlite.inc.php:		if ($this->_connectionID === false) return false;
drivers/adodb-sqlite.inc.php:		$this->_createFunctions();
drivers/adodb-sqlite.inc.php:		$rez = sqlite_query($sql,$this->_connectionID);
drivers/adodb-sqlite.inc.php:			$this->_errorNo = sqlite_last_error($this->_connectionID);
drivers/adodb-sqlite.inc.php:	function &SelectLimit($sql,$nrows=-1,$offset=-1,$inputarr=false,$secs2cache=0) 
drivers/adodb-sqlite.inc.php:	   		$rs =& $this->CacheExecute($secs2cache,$sql."$limitStr$offsetStr",$inputarr);
drivers/adodb-sqlite.inc.php:	   		$rs =& $this->Execute($sql."$limitStr$offsetStr",$inputarr);
drivers/adodb-sqlite.inc.php:		//$this->debug=1;
drivers/adodb-sqlite.inc.php:		while (--$MAXLOOPS>=0) {
drivers/adodb-sqlite.inc.php:			@($num = $this->GetOne("select id from $seq"));
drivers/adodb-sqlite.inc.php:				$this->Execute(sprintf($this->_genSeqSQL ,$seq));	
drivers/adodb-sqlite.inc.php:				$start -= 1;
drivers/adodb-sqlite.inc.php:				$ok = $this->Execute("insert into $seq values($start)");
drivers/adodb-sqlite.inc.php:			$this->Execute("update $seq set id=id+1 where id=$num");
drivers/adodb-sqlite.inc.php:			if ($this->affected_rows() > 0) {
drivers/adodb-sqlite.inc.php:				$this->genID = $num;
drivers/adodb-sqlite.inc.php:		if ($fn = $this->raiseErrorFn) {
drivers/adodb-sqlite.inc.php:			$fn($this->databaseType,'GENID',-32000,"Unable to generate unique id after $MAXLOOPS attempts",$seq,$num);
drivers/adodb-sqlite.inc.php:		if (empty($this->_genSeqSQL)) return false;
drivers/adodb-sqlite.inc.php:		$ok = $this->Execute(sprintf($this->_genSeqSQL,$seqname));
drivers/adodb-sqlite.inc.php:		$start -= 1;
drivers/adodb-sqlite.inc.php:		return $this->Execute("insert into $seqname values($start)");
drivers/adodb-sqlite.inc.php:		if (empty($this->_dropSeqSQL)) return false;
drivers/adodb-sqlite.inc.php:		return $this->Execute(sprintf($this->_dropSeqSQL,$seqname));
drivers/adodb-sqlite.inc.php:		return @sqlite_close($this->_connectionID);
drivers/adodb-sqlite.inc.php:/*--------------------------------------------------------------------------------------
drivers/adodb-sqlite.inc.php:--------------------------------------------------------------------------------------*/
drivers/adodb-sqlite.inc.php:		case ADODB_FETCH_NUM: $this->fetchMode = SQLITE_NUM; break;
drivers/adodb-sqlite.inc.php:		case ADODB_FETCH_ASSOC: $this->fetchMode = SQLITE_ASSOC; break;
drivers/adodb-sqlite.inc.php:		default: $this->fetchMode = SQLITE_BOTH; break;
drivers/adodb-sqlite.inc.php:		$this->adodbFetchMode = $mode;
drivers/adodb-sqlite.inc.php:		$this->_queryID = $queryID;
drivers/adodb-sqlite.inc.php:		$this->_inited = true;
drivers/adodb-sqlite.inc.php:		$this->fields = array();
drivers/adodb-sqlite.inc.php:			$this->_currentRow = 0;
drivers/adodb-sqlite.inc.php:			$this->EOF = !$this->_fetch();
drivers/adodb-sqlite.inc.php:			@$this->_initrs();
drivers/adodb-sqlite.inc.php:			$this->_numOfRows = 0;
drivers/adodb-sqlite.inc.php:			$this->_numOfFields = 0;
drivers/adodb-sqlite.inc.php:			$this->EOF = true;
drivers/adodb-sqlite.inc.php:		return $this->_queryID;
drivers/adodb-sqlite.inc.php:	function &FetchField($fieldOffset = -1)
drivers/adodb-sqlite.inc.php:		$fld->name = sqlite_field_name($this->_queryID, $fieldOffset);
drivers/adodb-sqlite.inc.php:		$fld->type = 'VARCHAR';
drivers/adodb-sqlite.inc.php:		$fld->max_length = -1;
drivers/adodb-sqlite.inc.php:		$this->_numOfRows = @sqlite_num_rows($this->_queryID);
drivers/adodb-sqlite.inc.php:		$this->_numOfFields = @sqlite_num_fields($this->_queryID);
drivers/adodb-sqlite.inc.php:		if ($this->fetchMode != SQLITE_NUM) return $this->fields[$colname];
drivers/adodb-sqlite.inc.php:		if (!$this->bind) {
drivers/adodb-sqlite.inc.php:			$this->bind = array();
drivers/adodb-sqlite.inc.php:			for ($i=0; $i < $this->_numOfFields; $i++) {
drivers/adodb-sqlite.inc.php:				$o = $this->FetchField($i);
drivers/adodb-sqlite.inc.php:				$this->bind[strtoupper($o->name)] = $i;
drivers/adodb-sqlite.inc.php:		 return $this->fields[$this->bind[strtoupper($colname)]];
drivers/adodb-sqlite.inc.php:   		return sqlite_seek($this->_queryID, $row);
drivers/adodb-sqlite.inc.php:		$this->fields = @sqlite_fetch_array($this->_queryID,$this->fetchMode);
drivers/adodb-sqlite.inc.php:		return !empty($this->fields);
drivers/adodb-odbc_oracle.inc.php:V4.54 5 Nov 2004  (c) 2000-2004 John Lim (jlim@natsoft.com.my). All rights reserved.
drivers/adodb-odbc_oracle.inc.php:// security - hide paths
drivers/adodb-odbc_oracle.inc.php:	include(ADODB_DIR."/drivers/adodb-odbc.inc.php");
drivers/adodb-odbc_oracle.inc.php:	var $fmtDate = "'Y-m-d 00:00:00'"; 
drivers/adodb-odbc_oracle.inc.php:	var $fmtTimeStamp = "'Y-m-d h:i:sA'";
drivers/adodb-odbc_oracle.inc.php:		$this->ADODB_odbc();
drivers/adodb-odbc_oracle.inc.php:		$rs = $this->Execute($this->metaTablesSQL);
drivers/adodb-odbc_oracle.inc.php:		$arr = $rs->GetArray();
drivers/adodb-odbc_oracle.inc.php:		$rs->Close();
drivers/adodb-odbc_oracle.inc.php:		$rs = $this->Execute(sprintf($this->metaColumnsSQL,strtoupper($table)));
drivers/adodb-odbc_oracle.inc.php:		while (!$rs->EOF) { //print_r($rs->fields);
drivers/adodb-odbc_oracle.inc.php:			$fld->name = $rs->fields[0];
drivers/adodb-odbc_oracle.inc.php:			$fld->type = $rs->fields[1];
drivers/adodb-odbc_oracle.inc.php:			$fld->max_length = $rs->fields[2];
drivers/adodb-odbc_oracle.inc.php:			else $retarr[strtoupper($fld->name)] = $fld;
drivers/adodb-odbc_oracle.inc.php:			$rs->MoveNext();
drivers/adodb-odbc_oracle.inc.php:		$rs->Close();
drivers/adodb-odbc_oracle.inc.php:		$this->_connectionID = odbc_connect($argDSN,$argUsername,$argPassword,SQL_CUR_USE_ODBC );
drivers/adodb-odbc_oracle.inc.php:		$this->_errorMsg = $php_errormsg;
drivers/adodb-odbc_oracle.inc.php:		$this->Execute("ALTER SESSION SET NLS_DATE_FORMAT='YYYY-MM-DD HH24:MI:SS'");
drivers/adodb-odbc_oracle.inc.php:		//if ($this->_connectionID) odbc_autocommit($this->_connectionID,true);
drivers/adodb-odbc_oracle.inc.php:		return $this->_connectionID != false;
drivers/adodb-odbc_oracle.inc.php:		$this->_connectionID = odbc_pconnect($argDSN,$argUsername,$argPassword,SQL_CUR_USE_ODBC );
drivers/adodb-odbc_oracle.inc.php:		$this->_errorMsg = $php_errormsg;
drivers/adodb-odbc_oracle.inc.php:		$this->Execute("ALTER SESSION SET NLS_DATE_FORMAT='YYYY-MM-DD HH24:MI:SS'");
drivers/adodb-odbc_oracle.inc.php:		//if ($this->_connectionID) odbc_autocommit($this->_connectionID,true);
drivers/adodb-odbc_oracle.inc.php:		return $this->_connectionID != false;
drivers/adodb-odbc_oracle.inc.php:		return $this->ADORecordSet_odbc($id,$mode);
drivers/adodb-sqlitepo.inc.php:V4.54 5 Nov 2004  (c) 2000-2004 John Lim (jlim@natsoft.com.my). All rights reserved.
drivers/adodb-sqlitepo.inc.php:include_once(ADODB_DIR.'/drivers/adodb-sqlite.inc.php');
drivers/adodb-sqlitepo.inc.php:      $this->ADODB_sqlite();
drivers/adodb-sqlitepo.inc.php:/*--------------------------------------------------------------------------------------
drivers/adodb-sqlitepo.inc.php:--------------------------------------------------------------------------------------*/
drivers/adodb-sqlitepo.inc.php:      $this->ADORecordset_sqlite($queryID,$mode);
drivers/adodb-sqlitepo.inc.php:      $this->fields = array();
drivers/adodb-sqlitepo.inc.php:      $fields = @sqlite_fetch_array($this->_queryID,$this->fetchMode);
drivers/adodb-sqlitepo.inc.php:            $this->fields[$n] = $v;
drivers/adodb-sqlitepo.inc.php:      return !empty($this->fields);
lang/adodb-nl.inc.php:// Translated by Pim Koeman (pim#wittenborg-university.com)
lang/adodb-ar.inc.php:// by "El-Shamaa, Khaled" <k.el-shamaa#cgiar.org>
lang/adodb-hu.inc.php:# Hungarian language, encoding by ISO 8859-2 charset (Iso Latin-2)
lang/adodb-bg.inc.php:	Bulgarian language, v1.0, 25.03.2004, encoding by Windows-1251 charset
lang/adodb-cz.inc.php:# Czech language, encoding by ISO 8859-2 charset (Iso Latin-2)
lang/adodb-cz.inc.php:#    iconv -f ISO_8859-2 -t CP1250 < adodb-cz.inc.php
lang/adodb-cz.inc.php:#    unaccent ISO_8859-2 < adodb-cz.inc.php
lang/adodb-bgutf8.inc.php:	Bulgarian language, v1.0, 25.03.2004, encoding by UTF-8 charset
lang/adodb-pt-br.inc.php:			'LANG'                      => 'pt-br',
lang/adodb-ro.inc.php:/* Romanian - by "bogdan stefan" <sbogdan#rsb.ro> */
lang/adodb-ro.inc.php:            DB_ERROR_MISMATCH           => 'nepotrivire-mismatch',
license.txt:BSD Style-License
license.txt:59 Temple Place, Suite 330, Boston, MA  02111-1307  USA
license.txt:The licenses for most software are designed to take away your freedom to share and change it. By contrast, the GNU General Public Licenses are intended to guarantee your freedom to share and change free software--to make sure the software is free for all its users. 
license.txt:This license, the Lesser General Public License, applies to some specially designated software packages--typically libraries--of the Free Software Foundation and other authors who decide to use it. You can use it too, but we suggest you first think carefully about whether this license or the ordinary General Public License is the better strategy to use in any particular case, based on the explanations below. 
license.txt:We protect your rights with a two-step method: (1) we copyright the library, and (2) we offer you this license, which gives you legal permission to copy, distribute and/or modify the library. 
license.txt:Most GNU software, including some libraries, is covered by the ordinary GNU General Public License. This license, the GNU Lesser General Public License, applies to certain designated libraries, and is quite different from the ordinary General Public License. We use this license for certain libraries in order to permit linking those libraries into non-free programs. 
license.txt:We call this license the "Lesser" General Public License because it does Less to protect the user's freedom than the ordinary General Public License. It also provides other free software developers Less of an advantage over competing non-free programs. These disadvantages are the reason we use the ordinary General Public License for many libraries. However, the Lesser license provides advantages in certain special circumstances. 
license.txt:For example, on rare occasions, there may be a special need to encourage the widest possible use of a certain library, so that it becomes a de-facto standard. To achieve this, non-free programs must be allowed to use the library. A more frequent case is that a free library does the same job as widely used non-free libraries. In this case, there is little to gain by limiting the free library to free software only, so we use the Lesser General Public License. 
license.txt:In other cases, permission to use a particular library in non-free programs enables a greater number of people to use a large body of free software. For example, permission to use the GNU C Library in non-free programs enables many more people to use the whole GNU operating system, as well as its variant, the GNU/Linux operating system. 
license.txt:(For example, a function in a library to compute square roots has a purpose that is entirely well-defined independent of the application. Therefore, Subsection 2d requires that any application-supplied function or table used by this function must be optional: if the application does not supply it, the square root function must still compute square roots.) 
license.txt:4. You may copy and distribute the Library (or a portion or derivative of it, under Section 2) in object code or executable form under the terms of Sections 1 and 2 above provided that you accompany it with the complete corresponding machine-readable source code, which must be distributed under the terms of Sections 1 and 2 above on a medium customarily used for software interchange. 
license.txt:a) Accompany the work with the complete corresponding machine-readable source code for the Library including whatever changes were used in the work (which must be distributed under Sections 1 and 2 above); and, if the work is an executable linked with the Library, with the complete machine-readable "work that uses the Library", as object code and/or source code, so that the user can modify the Library and then relink to produce a modified executable containing the modified Library. (It is understood that the user who changes the contents of definitions files in the Library will not necessarily be able to recompile the application to use the modified definitions.) 
license.txt:b) Use a suitable shared library mechanism for linking with the Library. A suitable mechanism is one that (1) uses at run time a copy of the library already present on the user's computer system, rather than copying library functions into the executable, and (2) will operate properly with a modified version of the library, if the user installs one, as long as the modified version is interface-compatible with the version that the work was made with. 
license.txt:7. You may place library facilities that are a work based on the Library side-by-side in a single library together with other library facilities not covered by this License, and distribute such a combined library, provided that the separate distribution of the work based on the Library and of the other library facilities is otherwise permitted, and provided that you do these two things: 
license.txt:11. If, as a consequence of a court judgment or allegation of patent infringement or for any other reason (not limited to patent issues), conditions are imposed on you (whether by court order, agreement or otherwise) that contradict the conditions of this License, they do not excuse you from the conditions of this License. If you cannot distribute so as to satisfy simultaneously your obligations under this License and any other pertinent obligations, then as a consequence you may not distribute the Library at all. For example, if a patent license would not permit royalty-free redistribution of the Library by all those who receive copies directly or indirectly through you, then the only way you could satisfy both it and this License would be to refrain entirely from distribution of the Library. 
pear/readme.Auth.txt:From: Rich Tango-Lowy (richtl#arscognita.com)
pear/readme.Auth.txt:OK, I hacked out an ADOdb container for PEAR-Auth. The error handling's 
pear/readme.Auth.txt:-------------------
pear/Auth/Container/ADOdb.php:// +----------------------------------------------------------------------+
pear/Auth/Container/ADOdb.php:// +----------------------------------------------------------------------+
pear/Auth/Container/ADOdb.php:// +----------------------------------------------------------------------+
pear/Auth/Container/ADOdb.php:// | available at through the world-wide-web at                           |
pear/Auth/Container/ADOdb.php:// | obtain it through the world-wide-web, please send a note to          |
pear/Auth/Container/ADOdb.php:// +----------------------------------------------------------------------+
pear/Auth/Container/ADOdb.php:// |	Richard Tango-Lowy <richtl@arscognita.com>                                  |
pear/Auth/Container/ADOdb.php:// +----------------------------------------------------------------------+
pear/Auth/Container/ADOdb.php:require_once 'adodb-pear.inc.php';
pear/Auth/Container/ADOdb.php:require_once 'adodb-errorpear.inc.php';
pear/Auth/Container/ADOdb.php: * Storage driver for fetching login data from a database using ADOdb-PHP.
pear/Auth/Container/ADOdb.php: * @author   Richard Tango-Lowy <richtl@arscognita.com>
pear/Auth/Container/ADOdb.php:        $this->_setDefaults();
pear/Auth/Container/ADOdb.php:            $this->_parseOptions($dsn);
pear/Auth/Container/ADOdb.php:            if (empty($this->options['dsn'])) {
pear/Auth/Container/ADOdb.php:            $this->options['dsn'] = $dsn;
pear/Auth/Container/ADOdb.php:            $this->_parseDsn( $dsn );
pear/Auth/Container/ADOdb.php:        	if(!$this->db) {
pear/Auth/Container/ADOdb.php:	        	$this->db = &ADONewConnection($this->options['db_type']);
pear/Auth/Container/ADOdb.php:        	$dbconnected = $this->db->Connect( 
pear/Auth/Container/ADOdb.php:        		$this->options['db_host'],
pear/Auth/Container/ADOdb.php:        		$this->options['db_user'],
pear/Auth/Container/ADOdb.php:        		$this->options['db_pass'],
pear/Auth/Container/ADOdb.php:        		$this->options['db_name'] );
pear/Auth/Container/ADOdb.php:        if(!$this->db) {
pear/Auth/Container/ADOdb.php:    	if(!$this->db) {
pear/Auth/Container/ADOdb.php:    		$res = $this->_connect($this->options['dsn']);  		
pear/Auth/Container/ADOdb.php:        $err = $this->_prepare();
pear/Auth/Container/ADOdb.php:        return $this->db->query($query);
pear/Auth/Container/ADOdb.php:    	$this->options['db_type']	= 'mysql';
pear/Auth/Container/ADOdb.php:        $this->options['table']       = 'auth';
pear/Auth/Container/ADOdb.php:        $this->options['usernamecol'] = 'username';
pear/Auth/Container/ADOdb.php:        $this->options['passwordcol'] = 'password';
pear/Auth/Container/ADOdb.php:        $this->options['dsn']         = '';
pear/Auth/Container/ADOdb.php:        $this->options['db_fields']   = '';
pear/Auth/Container/ADOdb.php:        $this->options['cryptType']   = 'md5';
pear/Auth/Container/ADOdb.php:            if (isset($this->options[$key])) {
pear/Auth/Container/ADOdb.php:                $this->options[$key] = $value;
pear/Auth/Container/ADOdb.php:        if(!empty($this->options['db_fields'])){
pear/Auth/Container/ADOdb.php:            if(is_array($this->options['db_fields'])){
pear/Auth/Container/ADOdb.php:                $this->options['db_fields'] = join($this->options['db_fields'], ', ');
pear/Auth/Container/ADOdb.php:            $this->options['db_fields'] = ', '.$this->options['db_fields'];
pear/Auth/Container/ADOdb.php:        $err = $this->_prepare();
pear/Auth/Container/ADOdb.php:            return PEAR::raiseError($err->getMessage(), $err->getCode());
pear/Auth/Container/ADOdb.php:        if(strstr($this->options['db_fields'], '*')){
pear/Auth/Container/ADOdb.php:            $sql_from = $this->options['usernamecol'] . ", ".$this->options['passwordcol'].$this->options['db_fields'];
pear/Auth/Container/ADOdb.php:                " FROM ".$this->options['table'].
pear/Auth/Container/ADOdb.php:                " WHERE ".$this->options['usernamecol']." = " . $this->db->Quote($username);
pear/Auth/Container/ADOdb.php:        $rset = $this->db->Execute( $query );
pear/Auth/Container/ADOdb.php:        $res = $rset->fetchRow();
pear/Auth/Container/ADOdb.php:            return PEAR::raiseError($res->getMessage(), $res->getCode());
pear/Auth/Container/ADOdb.php:            $this->activeUser = '';
pear/Auth/Container/ADOdb.php:        if ($this->verifyPassword(trim($password, "\r\n"),
pear/Auth/Container/ADOdb.php:                                  trim($res[$this->options['passwordcol']], "\r\n"),
pear/Auth/Container/ADOdb.php:                                  $this->options['cryptType'])) {
pear/Auth/Container/ADOdb.php:                if ($key == $this->options['passwordcol'] ||
pear/Auth/Container/ADOdb.php:                    $key == $this->options['usernamecol']) {
pear/Auth/Container/ADOdb.php:                if(is_object($this->_auth_obj)){
pear/Auth/Container/ADOdb.php:                    $this->_auth_obj->setAuthData($key, $value);
pear/Auth/Container/ADOdb.php:        $this->activeUser = $res[$this->options['usernamecol']];
pear/Auth/Container/ADOdb.php:        $err = $this->_prepare();
pear/Auth/Container/ADOdb.php:            return PEAR::raiseError($err->getMessage(), $err->getCode());
pear/Auth/Container/ADOdb.php:        if(strstr($this->options['db_fields'], '*')){
pear/Auth/Container/ADOdb.php:            $sql_from = $this->options['usernamecol'] . ", ".$this->options['passwordcol'].$this->options['db_fields'];
pear/Auth/Container/ADOdb.php:                         $this->options['table']
pear/Auth/Container/ADOdb.php:        $res = $this->db->getAll($query, null, DB_FETCHMODE_ASSOC);
pear/Auth/Container/ADOdb.php:            return PEAR::raiseError($res->getMessage(), $res->getCode());
pear/Auth/Container/ADOdb.php:                $user['username'] = $user[$this->options['usernamecol']];
pear/Auth/Container/ADOdb.php:        if (function_exists($this->options['cryptType'])) {
pear/Auth/Container/ADOdb.php:            $cryptFunction = $this->options['cryptType'];
pear/Auth/Container/ADOdb.php:                         $this->options['table'],
pear/Auth/Container/ADOdb.php:                         $this->options['usernamecol'],
pear/Auth/Container/ADOdb.php:                         $this->options['passwordcol'],
pear/Auth/Container/ADOdb.php:        $res = $this->query($query);
pear/Auth/Container/ADOdb.php:           return PEAR::raiseError($res->getMessage(), $res->getCode());
pear/Auth/Container/ADOdb.php:                         $this->options['table'],
pear/Auth/Container/ADOdb.php:                         $this->options['usernamecol'],
pear/Auth/Container/ADOdb.php:        $res = $this->query($query);
pear/Auth/Container/ADOdb.php:           return PEAR::raiseError($res->getMessage(), $res->getCode());
pear/Auth/Container/ADOdb.php:			$this->options['db_type'] = $match[1];
pear/Auth/Container/ADOdb.php:			$this->options['db_user'] = $match[2];
pear/Auth/Container/ADOdb.php:			$this->options['db_pass'] = $match[3];
pear/Auth/Container/ADOdb.php:			$this->options['db_host'] = $match[5];
pear/Auth/Container/ADOdb.php:			$this->options['db_name'] = $match[6];
perf/perf-mysql.inc.php:V4.54 5 Nov 2004  (c) 2000-2004 John Lim (jlim@natsoft.com.my). All rights reserved.
perf/perf-mysql.inc.php:// security - hide paths
perf/perf-mysql.inc.php:		$this->conn =& $conn;
perf/perf-mysql.inc.php:		if (strtoupper(substr(trim($sql),0,6)) !== 'SELECT') return '<p>Unable to EXPLAIN non-select statement</p>';
perf/perf-mysql.inc.php:		$save = $this->conn->LogSQL(false);
perf/perf-mysql.inc.php:			$sqlq = $this->conn->qstr($sql.'%');
perf/perf-mysql.inc.php:			$arr = $this->conn->GetArray("select distinct sql1 from adodb_logsql where sql1 like $sqlq");
perf/perf-mysql.inc.php:			$sqlq = $this->conn->qstr($sql.'%');
perf/perf-mysql.inc.php:			$sql = $this->conn->GetOne("select sql1 from adodb_logsql where sql1 like $sqlq");
perf/perf-mysql.inc.php:		$rs = $this->conn->Execute('EXPLAIN '.$sql);
perf/perf-mysql.inc.php:		$this->conn->LogSQL($save);
perf/perf-mysql.inc.php:		$s .= $this->Tracer($sql);
perf/perf-mysql.inc.php:		if (!$this->tablesSQL) return false;
perf/perf-mysql.inc.php:		$rs = $this->conn->Execute($this->tablesSQL);
perf/perf-mysql.inc.php:		$rs = $this->conn->Execute('show status');
perf/perf-mysql.inc.php:		while (!$rs->EOF) {
perf/perf-mysql.inc.php:			switch($rs->fields[0]) {
perf/perf-mysql.inc.php:				$val = $rs->fields[1];
perf/perf-mysql.inc.php:				$rs->Close();
perf/perf-mysql.inc.php:			$rs->MoveNext();
perf/perf-mysql.inc.php:		$rs->Close();
perf/perf-mysql.inc.php:		$rs = $this->conn->Execute('show status');
perf/perf-mysql.inc.php:		while (!$rs->EOF) {
perf/perf-mysql.inc.php:			switch($rs->fields[0]) {
perf/perf-mysql.inc.php:				$val += $rs->fields[1]; break;
perf/perf-mysql.inc.php:				$val += $rs->fields[1]; break;
perf/perf-mysql.inc.php:				$val += $rs->fields[1]/2;
perf/perf-mysql.inc.php:				$rs->Close();
perf/perf-mysql.inc.php:			$rs->MoveNext();
perf/perf-mysql.inc.php:		$rs->Close();
perf/perf-mysql.inc.php:		//$this->conn->debug=1;
perf/perf-mysql.inc.php:		$rs = $this->conn->Execute('show table status');
perf/perf-mysql.inc.php:		$type = strtoupper($rs->fields[1]);
perf/perf-mysql.inc.php:		$rs->Close();
perf/perf-mysql.inc.php:			return $this->DBParameter('MyISAM cache hit ratio').' (MyISAM)';
perf/perf-mysql.inc.php:			return $this->DBParameter('InnoDB cache hit ratio').' (InnoDB)';
perf/perf-mysql.inc.php:		$hits = $this->_DBParameter(array("show status","Qcache_hits"));
perf/perf-mysql.inc.php:		$total = $this->_DBParameter(array("show status","Qcache_inserts"));
perf/perf-mysql.inc.php:		$total += $this->_DBParameter(array("show status","Qcache_not_cached"));
perf/perf-mysql.inc.php:		$rs = $this->conn->Execute('show innodb status');
perf/perf-mysql.inc.php:		if (!$rs || $rs->EOF) return 0;
perf/perf-mysql.inc.php:		$stat = $rs->fields[0];
perf/perf-mysql.inc.php:		$rs->Close();
perf/perf-mysql.inc.php:		if (preg_match('!Buffer pool hit rate\s*([0-9]*) / ([0-9]*)!',$stat,$arr)) {
perf/perf-mysql.inc.php:		$hits = $this->_DBParameter(array("show status","Key_read_requests"));
perf/perf-mysql.inc.php:		$reqs = $this->_DBParameter(array("show status","Key_reads"));
perf/perf-oci8.inc.php:V4.54 5 Nov 2004  (c) 2000-2004 John Lim (jlim@natsoft.com.my). All rights reserved.
perf/perf-oci8.inc.php:// security - hide paths
perf/perf-oci8.inc.php:			"select round((1-(phy.value / (cur.value + con.value)))*100,2) 
perf/perf-oci8.inc.php:			'select round(100*(sum(pins)-sum(reloads))/sum(pins),2)  from v$librarycache',
perf/perf-oci8.inc.php:           round((1 - (sum(getmisses) / (sum(gets) +          
perf/perf-oci8.inc.php:	"% of memory sorts compared to disk sorts - should be over 95%"),
perf/perf-oci8.inc.php:			'program global area is private memory for sorting, and hash and bitmap merges - since oracle 9i (pga_aggregate_target)' ),
perf/perf-oci8.inc.php:			"select round((1-bytes/sgasize)*100, 2)
perf/perf-oci8.inc.php:		'Percentage of data cache actually in use - should be over 85%'),
perf/perf-oci8.inc.php:		'Percentage of shared pool actually used - too low is bad, too high is worse'),
perf/perf-oci8.inc.php:			"select round((1-bytes/sgasize)*100, 2)
perf/perf-oci8.inc.php:		'Percentage of large_pool actually in use - too low is bad, too high is worse'),
perf/perf-oci8.inc.php:			'max in-mem sort_area_size (per query), uses memory in pga' ),
perf/perf-oci8.inc.php:			'Taken from high-water-mark'),
perf/perf-oci8.inc.php:		$savelog = $conn->LogSQL(false);	
perf/perf-oci8.inc.php:		$this->version = $conn->ServerInfo();
perf/perf-oci8.inc.php:		$conn->LogSQL($savelog);	
perf/perf-oci8.inc.php:		$this->conn =& $conn;
perf/perf-oci8.inc.php:		return $s.'Recommended is 20-50 for TP, and 50 for data warehouses. Default is 100. See <a href=http://www.dba-oracle.com/oracle_tips_cost_adj.htm>optimizer_index_cost_adj</a>. ';
perf/perf-oci8.inc.php:			 See <a href=http://www.dba-oracle.com/oracle_tips_cbo_part1.htm>optimizer_index_caching</a>.';
perf/perf-oci8.inc.php:		if ($this->version['version'] < 9) return 'Oracle 9i or later required';
perf/perf-oci8.inc.php:		$rs = $this->conn->Execute("select a.mb,a.targ as pga_size_pct,a.pct from 
perf/perf-oci8.inc.php:		$rs->Close();
perf/perf-oci8.inc.php:		if ($rs->EOF) return "PGA could be too big";
perf/perf-oci8.inc.php:		return reset($rs->fields);
perf/perf-oci8.inc.php:		$savelog = $this->conn->LogSQL(false);
perf/perf-oci8.inc.php:		$rs =& $this->conn->SelectLimit("select ID FROM PLAN_TABLE");
perf/perf-oci8.inc.php:		$rs->Close();
perf/perf-oci8.inc.php:	//	$this->conn->debug=1;
perf/perf-oci8.inc.php:			$sqlq = $this->conn->qstr($sql.'%');
perf/perf-oci8.inc.php:			$arr = $this->conn->GetArray("select distinct distinct sql1 from adodb_logsql where sql1 like $sqlq");
perf/perf-oci8.inc.php:		$this->conn->BeginTrans();
perf/perf-oci8.inc.php:		$rs =& $this->conn->Execute("EXPLAIN PLAN SET STATEMENT_ID='$id' FOR $sql");
perf/perf-oci8.inc.php:		$m = $this->conn->ErrorMsg();
perf/perf-oci8.inc.php:			$this->conn->RollbackTrans();
perf/perf-oci8.inc.php:			$this->conn->LogSQL($savelog);
perf/perf-oci8.inc.php:		$rs = $this->conn->Execute("
perf/perf-oci8.inc.php:  '<pre>'||lpad('--', (level-1)*2,'-') || trim(operation) || ' ' || trim(options)||'</pre>'  as Operation, 
perf/perf-oci8.inc.php:		$this->conn->RollbackTrans();
perf/perf-oci8.inc.php:		$this->conn->LogSQL($savelog);
perf/perf-oci8.inc.php:		$s .= $this->Tracer($sql,$partial);
perf/perf-oci8.inc.php:		if ($this->version['version'] < 9) return 'Oracle 9i or later required';
perf/perf-oci8.inc.php:		 $rs =& $this->conn->Execute("
perf/perf-oci8.inc.php:	 when a.estd_physical_read_factor-b.estd_physical_read_factor > 0 and a.estd_physical_read_factor<1 then
perf/perf-oci8.inc.php:		'- BETTER - '
perf/perf-oci8.inc.php:   a.estd_physical_read_factor-b.estd_physical_read_factor as best_when_0
perf/perf-oci8.inc.php:   (select size_for_estimate,size_factor,estd_physical_read_factor,rownum r from v\$db_cache_advice) b where a.r = b.r-1");
perf/perf-oci8.inc.php:		if ($rs->EOF) {
perf/perf-oci8.inc.php:		$o1 = $rs->FetchField(0);
perf/perf-oci8.inc.php:		$o2 = $rs->FetchField(1);
perf/perf-oci8.inc.php:		$o3 = $rs->FetchField(2);
perf/perf-oci8.inc.php:		if ($rs->EOF) return '<p>None found</p>';
perf/perf-oci8.inc.php:		$s = "\n\n<table border=1 bgcolor=white><tr><td><b>".$o1->name.'</b></td><td><b>'.$o2->name.'</b></td><td><b>'.$o3->name.'</b></td></tr>';
perf/perf-oci8.inc.php:		while (!$rs->EOF) {
perf/perf-oci8.inc.php:			if ($check != $rs->fields[0].'::'.$rs->fields[1]) {
perf/perf-oci8.inc.php:				$sql = $rs->fields[2];
perf/perf-oci8.inc.php:				$check = $rs->fields[0].'::'.$rs->fields[1];			
perf/perf-oci8.inc.php:				$sql .= $rs->fields[2];
perf/perf-oci8.inc.php:			$rs->MoveNext();
perf/perf-oci8.inc.php:		$rs->Close();
perf/perf-oci8.inc.php:				echo "<a name=explain></a>".$this->Explain($HTTP_GET_VARS['sql'],$partial)."\n";
perf/perf-oci8.inc.php:		if (isset($HTTP_GET_VARS['sql'])) return $this->_SuspiciousSQL();
perf/perf-oci8.inc.php:		$savelog = $this->conn->LogSQL(false);
perf/perf-oci8.inc.php:		$rs =& $this->conn->SelectLimit($sql);
perf/perf-oci8.inc.php:		$this->conn->LogSQL($savelog);
perf/perf-oci8.inc.php:			$s .= $this->tohtml($rs,'expsixora');
perf/perf-oci8.inc.php:		$s .= $this->_SuspiciousSQL();
perf/perf-oci8.inc.php:			echo "<a name=explain></a>".$this->Explain($HTTP_GET_VARS['sql'],$partial)."\n";
perf/perf-oci8.inc.php:			 $var =& $this->_ExpensiveSQL();
perf/perf-oci8.inc.php:		$savelog = $this->conn->LogSQL(false);
perf/perf-oci8.inc.php:		$rs =& $this->conn->Execute($sql);
perf/perf-oci8.inc.php:		$this->conn->LogSQL($savelog);
perf/perf-oci8.inc.php:			$s .= $this->tohtml($rs,'expeixora');
perf/perf-oci8.inc.php:		$s .= $this->_ExpensiveSQL();
perf/perf-mssql.inc.php:V4.54 5 Nov 2004  (c) 2000-2004 John Lim (jlim@natsoft.com.my). All rights reserved.
perf/perf-mssql.inc.php:// security - hide paths
perf/perf-mssql.inc.php:		if ($conn->dataProvider == 'odbc') {
perf/perf-mssql.inc.php:			$this->sql1 = 'sql1';
perf/perf-mssql.inc.php:			//$this->explain = false;
perf/perf-mssql.inc.php:		$this->conn =& $conn;
perf/perf-mssql.inc.php:		$save = $this->conn->LogSQL(false);
perf/perf-mssql.inc.php:			$sqlq = $this->conn->qstr($sql.'%');
perf/perf-mssql.inc.php:			$arr = $this->conn->GetArray("select distinct sql1 from adodb_logsql where sql1 like $sqlq");
perf/perf-mssql.inc.php:		$this->conn->Execute("SET SHOWPLAN_ALL ON;");
perf/perf-mssql.inc.php:		$rs =& $this->conn->Execute($sql);
perf/perf-mssql.inc.php:			$rs->MoveNext();
perf/perf-mssql.inc.php:			while (!$rs->EOF) {
perf/perf-mssql.inc.php:				$s .= '<tr><td>'.round($rs->fields[8],1).'<td>'.round($rs->fields[9],3).'<td align=right>'.round($rs->fields[10],3).'<td nowrap><pre>'.htmlspecialchars($rs->fields[0])."</td></pre></tr>\n"; ## NOTE CORRUPT </td></pre> tag is intentional!!!!
perf/perf-mssql.inc.php:				$rs->MoveNext();
perf/perf-mssql.inc.php:			$rs->NextRecordSet();
perf/perf-mssql.inc.php:		$this->conn->Execute("SET SHOWPLAN_ALL OFF;");
perf/perf-mssql.inc.php:		$this->conn->LogSQL($save);
perf/perf-mssql.inc.php:		$s .= $this->Tracer($sql);
perf/perf-mssql.inc.php:		//$this->conn->debug=1;
perf/perf-mssql.inc.php:		$rs1 = $this->conn->Execute("select distinct name from sysobjects where xtype='U'");
perf/perf-mssql.inc.php:			while (!$rs1->EOF) {
perf/perf-mssql.inc.php:				$tab = $rs1->fields[0];
perf/perf-mssql.inc.php:				$tabq = $this->conn->qstr($tab);
perf/perf-mssql.inc.php:				$rs2 = $this->conn->Execute("sp_spaceused $tabq");
perf/perf-mssql.inc.php:					$s .= '<tr><td>'.$tab.'</td><td align=right>'.$rs2->fields[3].'</td><td align=right>'.$rs2->fields[4].'</td><td align=right>'.$rs2->fields[2].'</td></tr>';
perf/perf-mssql.inc.php:					$rs2->Close();
perf/perf-mssql.inc.php:				$rs1->MoveNext();
perf/perf-mssql.inc.php:			$rs1->Close();
perf/perf-mssql.inc.php:		$arr = $this->conn->GetArray('sp_who');
perf/perf-mssql.inc.php:		$this->conn->Execute('dbcc traceon(3604)');
perf/perf-mssql.inc.php:		$this->conn->Execute('dbcc traceoff(3604)');
perf/perf-postgres.inc.php:V4.54 5 Nov 2004  (c) 2000-2004 John Lim (jlim@natsoft.com.my). All rights reserved.
perf/perf-postgres.inc.php:// security - hide paths
perf/perf-postgres.inc.php:			"select case when blks_hit=0 then 0 else (1-blks_read::float/blks_hit)*100 end from pg_stat_database where datname='\$DATABASE'",
perf/perf-postgres.inc.php:		$this->conn =& $conn;
perf/perf-postgres.inc.php:		$save = $this->conn->LogSQL(false);
perf/perf-postgres.inc.php:			$sqlq = $this->conn->qstr($sql.'%');
perf/perf-postgres.inc.php:			$arr = $this->conn->GetArray("select distinct distinct sql1 from adodb_logsql where sql1 like $sqlq");
perf/perf-postgres.inc.php:		$rs = $this->conn->Execute('EXPLAIN '.$sql);
perf/perf-postgres.inc.php:		$this->conn->LogSQL($save);
perf/perf-postgres.inc.php:			while (!$rs->EOF) {
perf/perf-postgres.inc.php:				$s .= reset($rs->fields)."\n";
perf/perf-postgres.inc.php:				$rs->MoveNext();
perf/perf-postgres.inc.php:		$s .= $this->Tracer($sql,$partial);
perf/perf-db2.inc.php:V4.54 5 Nov 2004  (c) 2000-2004 John Lim (jlim@natsoft.com.my). All rights reserved.
perf/perf-db2.inc.php:// security - hide paths
perf/perf-db2.inc.php:// Simple guide to configuring db2: so-so http://www.devx.com/gethelpon/10MinuteSolution/16575
perf/perf-db2.inc.php:// SELECT * FROM TABLE(SNAPSHOT_APPL('SAMPLE', -1)) as t
perf/perf-db2.inc.php:				else 100*(1-sum(POOL_DATA_P_READS+POOL_INDEX_P_READS)/sum(POOL_DATA_L_READS+POOL_INDEX_L_READS)) end 
perf/perf-db2.inc.php:				FROM TABLE(SNAPSHOT_APPL('',-2)) as t",
perf/perf-db2.inc.php:			"SELECT count(*) FROM TABLE(SNAPSHOT_APPL_INFO('',-2)) as t",
perf/perf-db2.inc.php:		$this->conn =& $conn;
perf/perf-db2.inc.php:		$save = $this->conn->LogSQL(false);
perf/perf-db2.inc.php:			$sqlq = $this->conn->qstr($sql.'%');
perf/perf-db2.inc.php:			$arr = $this->conn->GetArray("select distinct sql1 from adodb_logsql where sql1 like $sqlq");
perf/perf-db2.inc.php:		$ok = $this->conn->Execute("EXPLAIN PLAN SET QUERYNO=$qno FOR $sql");
perf/perf-db2.inc.php:			$rs = $this->conn->Execute("select * from explain_statement where queryno=$qno");
perf/perf-db2.inc.php:		$this->conn->LogSQL($save);
perf/perf-db2.inc.php:		$s .= $this->Tracer($sql);
perf/perf-db2.inc.php:		$rs = $this->conn->Execute("select tabschema,tabname,card as rows,
perf/perf-informix.inc.php:V4.54 5 Nov 2004  (c) 2000-2004 John Lim (jlim@natsoft.com.my). All rights reserved.
perf/perf-informix.inc.php:// security - hide paths
perf/perf-informix.inc.php:		"select round((1-(wt.value / (rd.value + wr.value)))*100,2)
perf/perf-informix.inc.php:		$this->conn =& $conn;
pivottable.inc.php: * @version V4.50 6 July 2004 (c) 2000-2004 John Lim (jlim@natsoft.com.my). All rights reserved.
pivottable.inc.php:	if (!is_array($colfield)) $colarr = $db->GetCol("select distinct $colfield from $tables $where order by 1");
pivottable.inc.php:			if (!is_numeric($v)) $vq = $db->qstr($v);
pivottable.inc.php:		$sel = substr($sel,0,strlen($sel)-2);
pivottable.inc.php: $rs = $gDB->Execute($sql);
pivottable.inc.php: $rs = $gDB->Execute($sql);
readme.txt:(c) 2000-2004 John Lim (jlim@natsoft.com.my)
readme.txt:Adodb-*.inc.php are the database specific driver code.
readme.txt:Adodb-session.php is the PHP4 session handling code.
rsfilter.inc.php: * @version V4.50 6 July 2004 (c) 2000-2004 John Lim (jlim@natsoft.com.my). All rights reserved.
rsfilter.inc.php:	if ($rs->databaseType != 'array') {
rsfilter.inc.php:		if (!$rs->connection) return false;
rsfilter.inc.php:		$rs = &$rs->connection->_rs2rs($rs);
rsfilter.inc.php:	$rows = $rs->RecordCount();
rsfilter.inc.php:		$fn($rs->_array[$i],$rs);
rsfilter.inc.php:	if (!$rs->EOF) {
rsfilter.inc.php:		$rs->_currentRow = 0;
rsfilter.inc.php:		$rs->fields = $rs->_array[0];
server.php: * @version V4.50 6 July 2004 (c) 2000-2004 John Lim (jlim@natsoft.com.my). All rights reserved.
server.php:include_once(ADODB_DIR.'/adodb-csvlib.inc.php');
server.php:if (!$conn->Connect($host,$uid,$pwd,$database)) err($conn->ErrorNo(). $sep . $conn->ErrorMsg());
server.php:	$offset = isset($HTTP_GET_VARS['offset']) ? $HTTP_GET_VARS['offset'] : -1;
server.php:	$rs = $conn->SelectLimit($sql,$nrows,$offset);
server.php:	$rs = $conn->Execute($sql);
server.php:	//$rs->timeToLive = 1;
server.php:	$rs->Close();
server.php:	err($conn->ErrorNo(). $sep .$conn->ErrorMsg());
session/adodb-compress-gzip.php:V4.01 23 Oct 2003  (c) 2000-2004 John Lim (jlim@natsoft.com.my). All rights reserved.
session/adodb-compress-gzip.php:		return $this->_level;
session/adodb-compress-gzip.php:		$this->_level = (int) $level;
session/adodb-compress-gzip.php:		return $this->_min_length;
session/adodb-compress-gzip.php:		$this->_min_length = (int) $min_length;
session/adodb-compress-gzip.php:			$this->setLevel($level);
session/adodb-compress-gzip.php:			$this->setMinLength($min_length);
session/adodb-compress-gzip.php:		if (strlen($data) < $this->_min_length) {
session/adodb-compress-gzip.php:		if (!is_null($this->_level)) {
session/adodb-compress-gzip.php:			return gzcompress($data, $this->_level);
session/adodb-sessions.mysql.sql:-- $CVSHeader$
session/adodb-session.php:V4.01 23 Oct 2003  (c) 2000-2004 John Lim (jlim@natsoft.com.my). All rights reserved.
session/adodb-session.php:				// bug in PHP 4.0.3 pl 1  -- how about other versions?
session/adodb-session.php:				$conn->debug = $_debug;
session/adodb-session.php:		//echo "<br />\nAffected_Rows=",$conn->Affected_Rows(),"<br />\n";
session/adodb-session.php:		// cannot use =& below - do not know why...
session/adodb-session.php:			$conn->debug = true;
session/adodb-session.php:			case 'P': $ok = $conn->PConnect($host, $user, $password, $database); break;
session/adodb-session.php:			case 'C': $ok = $conn->Connect($host, $user, $password, $database); break;
session/adodb-session.php:			case 'N': $ok = $conn->NConnect($host, $user, $password, $database); break;
session/adodb-session.php:			$ok = $conn->Connect($host, $user, $password, $database);
session/adodb-session.php:			$conn->Close();
session/adodb-session.php:		$qkey = $conn->quote($key);
session/adodb-session.php:		$binary = $conn->dataProvider === 'mysql' ? '/*! BINARY */' : '';
session/adodb-session.php:		$rs =& $conn->Execute($sql);
session/adodb-session.php:			if ($rs->EOF) {
session/adodb-session.php:				$v = reset($rs->fields);
session/adodb-session.php:						$v = $f->read($v, ADODB_Session::_sessionKey());
session/adodb-session.php:			$rs->Close();
session/adodb-session.php:		$qkey = $conn->quote($key);
session/adodb-session.php:		$binary = $conn->dataProvider === 'mysql' ? '/*! BINARY */' : '';
session/adodb-session.php:				echo '<p>Session: Only updating date - crc32 not changed</p>';
session/adodb-session.php:			$rs =& $conn->Execute($sql);
session/adodb-session.php:				$rs->Close();
session/adodb-session.php:				$val = $f->write($val, ADODB_Session::_sessionKey());
session/adodb-session.php:			$arr[$data] = $conn->qstr($val);
session/adodb-session.php:			$rs = $conn->Replace($table, $arr, 'sesskey', $autoQuote = true);
session/adodb-session.php:			$rs =& $conn->Execute("SELECT COUNT(*) AS cnt FROM $table WHERE $binary sesskey = $qkey");
session/adodb-session.php:			if ($rs && reset($rs->fields) > 0) {
session/adodb-session.php:				$rs->Close();
session/adodb-session.php:			$rs1 =& $conn->Execute($sql);
session/adodb-session.php:				$err = $conn->ErrorMsg()."\n";
session/adodb-session.php:			$rs2 =& $conn->UpdateBlob($table, $data, $val, " sesskey=$qkey", strtoupper($clob));
session/adodb-session.php:				$err .= $conn->ErrorMsg()."\n";
session/adodb-session.php:				$rs1->Close();
session/adodb-session.php:				$rs2->Close();
session/adodb-session.php:			ADOConnection::outp('<p>Session Replace: ' . $conn->ErrorMsg() . '</p>', false);
session/adodb-session.php:			if ($conn->databaseType == 'access') {
session/adodb-session.php:				$rs =& $conn->Execute($sql);
session/adodb-session.php:					$rs->Close();
session/adodb-session.php:		$qkey = $conn->quote($key);
session/adodb-session.php:		$binary = $conn->dataProvider === 'mysql' ? '/*! BINARY */' : '';
session/adodb-session.php:			$savem = $conn->SetFetchMode(ADODB_FETCH_NUM);
session/adodb-session.php:			$rs =& $conn->Execute($sql);
session/adodb-session.php:			$conn->SetFetchMode($savem);
session/adodb-session.php:			if (!$rs->EOF) {
session/adodb-session.php:				$ref = $rs->fields[0];
session/adodb-session.php:				$key = $rs->fields[1];
session/adodb-session.php:			$rs->Close();
session/adodb-session.php:		$rs =& $conn->Execute($sql);
session/adodb-session.php:			$rs->Close();
session/adodb-session.php:		$binary = $conn->dataProvider === 'mysql' ? '/*! BINARY */' : '';
session/adodb-session.php:			$savem = $conn->SetFetchMode(ADODB_FETCH_NUM);
session/adodb-session.php:			$rs =& $conn->Execute($sql);
session/adodb-session.php:			$conn->SetFetchMode($savem);
session/adodb-session.php:				$conn->BeginTrans();
session/adodb-session.php:				while (!$rs->EOF) {
session/adodb-session.php:					$ref = $rs->fields[0];
session/adodb-session.php:					$key = $rs->fields[1];
session/adodb-session.php:					$del = $conn->Execute("DELETE FROM $table WHERE sesskey='$key'");
session/adodb-session.php:					$rs->MoveNext();
session/adodb-session.php:				$rs->Close();
session/adodb-session.php:				$conn->CommitTrans();
session/adodb-session.php:			$rs =& $conn->Execute($sql);
session/adodb-session.php:				$rs->Close();
session/adodb-session.php:				$conn->Execute($sql);
session/adodb-session.php:			if ($conn->dataProvider === 'oci8') {
session/adodb-session.php:				$sql .= "TO_CHAR({$conn->sysTimeStamp}, 'RRRR-MM-DD HH24:MI:SS')";
session/adodb-session.php:				$sql .= $conn->sysTimeStamp;
session/adodb-session.php:			$rs =& $conn->SelectLimit($sql, 1);
session/adodb-session.php:			if ($rs && !$rs->EOF) {
session/adodb-session.php:				$dbts = reset($rs->fields);
session/adodb-session.php:				$rs->Close();
session/adodb-session.php:				$dbt = $conn->UnixTimeStamp($dbts);
session/adodb-session.php:				if (abs($dbt - $t) >= $sync_seconds) {
session/adodb-session.php:						" database=$dbt ($dbts), webserver=$t (diff=". (abs($dbt - $t) / 3600) . ' hours)';
session/adodb-sess.txt:days rewriting the adodb-session.php code.
session/adodb-sess.txt:----------
session/adodb-sess.txt:----------
session/adodb-sess.txt:adodb-session.php
session/adodb-sess.txt:adodb-session-clob.php
session/adodb-sess.txt:adodb-cryptsession.php
session/adodb-sess.txt:each with very similar functionality, into a single file adodb-session.php.
session/adodb-sess.txt:Also, the built-in MCrypt functions will be *much* faster, and more secure,
session/adodb-sess.txt:* adodb-session.php contains a single class ADODB_Session that encapsulates
session/adodb-sess.txt:------------
session/adodb-sess.txt:------------
session/adodb-sess.txt:---------------
session/adodb-sess.txt:---------------
session/adodb-sess.txt:------------
session/adodb-sess.txt:------------
session/old/adodb-session.php:V4.54 5 Nov 2004  (c) 2000-2004 John Lim (jlim@natsoft.com.my). All rights reserved.
session/old/adodb-session.php:	include('adodb-session.php');
session/old/adodb-session.php:To force non-persistent connections, call adodb_session_open first before session_start():
session/old/adodb-session.php:	include('adodb-session.php');
session/old/adodb-session.php:	 // bug in PHP 4.0.3 pl 1  -- how about other versions?
session/old/adodb-session.php:	//  Made table name configurable - by David Johnson djohnson@inpro.net
session/old/adodb-session.php:	// cannot use & below - do not know why...
session/old/adodb-session.php:		$ADODB_SESS_CONN->debug = true;
session/old/adodb-session.php:	if ($persist) $ok = $ADODB_SESS_CONN->PConnect($ADODB_SESSION_CONNECT,
session/old/adodb-session.php:	else $ok = $ADODB_SESS_CONN->Connect($ADODB_SESSION_CONNECT,
session/old/adodb-session.php:	if ($ADODB_SESS_CONN) $ADODB_SESS_CONN->Close();
session/old/adodb-session.php:	$rs = $ADODB_SESS_CONN->Execute("SELECT data FROM $ADODB_SESSION_TBL WHERE sesskey = '$key' AND expiry >= " . time());
session/old/adodb-session.php:		if ($rs->EOF) {
session/old/adodb-session.php:			$v = rawurldecode(reset($rs->fields));
session/old/adodb-session.php:		$rs->Close();
session/old/adodb-session.php:		if ($ADODB_SESS_DEBUG) echo "<p>Session: Only updating date - crc32 not changed</p>";
session/old/adodb-session.php:		$rs = $ADODB_SESS_CONN->Execute($qry);	
session/old/adodb-session.php:	$rs = $ADODB_SESS_CONN->Replace($ADODB_SESSION_TBL,$arr,
session/old/adodb-session.php:		ADOConnection::outp( '<p>Session Replace: '.$ADODB_SESS_CONN->ErrorMsg().'</p>',false);
session/old/adodb-session.php:		if ($ADODB_SESS_CONN->databaseType == 'access') 
session/old/adodb-session.php:			$rs = $ADODB_SESS_CONN->Execute("select sesskey from $ADODB_SESSION_TBL WHERE sesskey='$key'");
session/old/adodb-session.php:		$savem = $ADODB_SESS_CONN->SetFetchMode(ADODB_FETCH_NUM);
session/old/adodb-session.php:		$rs = $ADODB_SESS_CONN->Execute("SELECT expireref,sesskey FROM $ADODB_SESSION_TBL WHERE sesskey='$key'");
session/old/adodb-session.php:		$ADODB_SESS_CONN->SetFetchMode($savem);
session/old/adodb-session.php:			$ADODB_SESS_CONN->BeginTrans();
session/old/adodb-session.php:			while (!$rs->EOF) {
session/old/adodb-session.php:				$ref = $rs->fields[0];
session/old/adodb-session.php:				$key = $rs->fields[1];
session/old/adodb-session.php:				$del = $ADODB_SESS_CONN->Execute("DELETE FROM $ADODB_SESSION_TBL WHERE sesskey='$key'");
session/old/adodb-session.php:				$rs->MoveNext();
session/old/adodb-session.php:			$ADODB_SESS_CONN->CommitTrans();
session/old/adodb-session.php:		$rs = $ADODB_SESS_CONN->Execute($qry);
session/old/adodb-session.php:		$savem = $ADODB_SESS_CONN->SetFetchMode(ADODB_FETCH_NUM);
session/old/adodb-session.php:		$rs =& $ADODB_SESS_CONN->Execute("SELECT expireref,sesskey FROM $ADODB_SESSION_TBL WHERE expiry < $t");
session/old/adodb-session.php:		$ADODB_SESS_CONN->SetFetchMode($savem);
session/old/adodb-session.php:			$ADODB_SESS_CONN->BeginTrans();
session/old/adodb-session.php:			while (!$rs->EOF) {
session/old/adodb-session.php:				$ref = $rs->fields[0];
session/old/adodb-session.php:				$key = $rs->fields[1];
session/old/adodb-session.php:				$del = $ADODB_SESS_CONN->Execute("DELETE FROM $ADODB_SESSION_TBL WHERE sesskey='$key'");
session/old/adodb-session.php:				$rs->MoveNext();
session/old/adodb-session.php:			$rs->Close();
session/old/adodb-session.php:			$ADODB_SESS_CONN->CommitTrans();
session/old/adodb-session.php:		$ADODB_SESS_CONN->Execute($qry);
session/old/adodb-session.php:			$ADODB_SESS_CONN->Execute($opt_qry);
session/old/adodb-session.php:	if ($ADODB_SESS_CONN->dataProvider === 'oci8') $sql = 'select  TO_CHAR('.($ADODB_SESS_CONN->sysTimeStamp).', \'RRRR-MM-DD HH24:MI:SS\') from '. $ADODB_SESSION_TBL;
session/old/adodb-session.php:	else $sql = 'select '.$ADODB_SESS_CONN->sysTimeStamp.' from '. $ADODB_SESSION_TBL;
session/old/adodb-session.php:	$rs =& $ADODB_SESS_CONN->SelectLimit($sql,1);
session/old/adodb-session.php:	if ($rs && !$rs->EOF) {
session/old/adodb-session.php:		$dbts = reset($rs->fields);
session/old/adodb-session.php:		$rs->Close();
session/old/adodb-session.php:		$dbt = $ADODB_SESS_CONN->UnixTimeStamp($dbts);
session/old/adodb-session.php:		if (abs($dbt - $t) >= ADODB_SESSION_SYNCH_SECS) {
session/old/adodb-session.php:			__FILE__.": Server time for webserver {$HTTP_SERVER_VARS['HTTP_HOST']} not in synch with database: database=$dbt ($dbts), webserver=$t (diff=".(abs($dbt-$t)/3600)." hrs)";
session/old/adodb-session.php:/*  TEST SCRIPT -- UNCOMMENT */
session/old/adodb-cryptsession.php:V4.54 5 Nov 2004  (c) 2000-2004 John Lim (jlim@natsoft.com.my). All rights reserved.
session/old/adodb-cryptsession.php:	Made table name configurable - by David Johnson djohnson@inpro.net
session/old/adodb-cryptsession.php:	#---------------------------------#
session/old/adodb-cryptsession.php:	include('adodb-cryptsession.php'); 
session/old/adodb-cryptsession.php:	#---------------------------------#
session/old/adodb-cryptsession.php:	// bug in PHP 4.0.3 pl 1  -- how about other versions?
session/old/adodb-cryptsession.php:		$ADODB_SESS_CONN->debug = true;
session/old/adodb-cryptsession.php:	return $ADODB_SESS_CONN->PConnect($ADODB_SESSION_CONNECT,
session/old/adodb-cryptsession.php:	if ($ADODB_SESS_CONN) $ADODB_SESS_CONN->Close();
session/old/adodb-cryptsession.php:	$rs = $ADODB_SESS_CONN->Execute("SELECT data FROM $ADODB_SESSION_TBL WHERE sesskey = '$key' AND expiry >= " . time());
session/old/adodb-cryptsession.php:		if ($rs->EOF) {
session/old/adodb-cryptsession.php:			$v = rawurldecode($Crypt->Decrypt(reset($rs->fields), ADODB_Session_Key()));
session/old/adodb-cryptsession.php:		$rs->Close();
session/old/adodb-cryptsession.php:	$val = $Crypt->Encrypt(rawurlencode($val), ADODB_Session_Key());
session/old/adodb-cryptsession.php:	$rs = $ADODB_SESS_CONN->Replace($ADODB_SESSION_TBL,
session/old/adodb-cryptsession.php:		ADOConnection::outp( '<p>Session Replace: '.$ADODB_SESS_CONN->ErrorMsg().'</p>',false);
session/old/adodb-cryptsession.php:	if ($ADODB_SESS_CONN->databaseType == 'access') $rs = $ADODB_SESS_CONN->Execute("select sesskey from $ADODB_SESSION_TBL WHERE sesskey='$key'");
session/old/adodb-cryptsession.php:		$savem = $ADODB_SESS_CONN->SetFetchMode(ADODB_FETCH_NUM);
session/old/adodb-cryptsession.php:		$rs = $ADODB_SESS_CONN->Execute("SELECT expireref,sesskey FROM $ADODB_SESSION_TBL WHERE sesskey='$key'");
session/old/adodb-cryptsession.php:		$ADODB_SESS_CONN->SetFetchMode($savem);
session/old/adodb-cryptsession.php:			$ADODB_SESS_CONN->BeginTrans();
session/old/adodb-cryptsession.php:			while (!$rs->EOF) {
session/old/adodb-cryptsession.php:				$ref = $rs->fields[0];
session/old/adodb-cryptsession.php:				$key = $rs->fields[1];
session/old/adodb-cryptsession.php:				$del = $ADODB_SESS_CONN->Execute("DELETE FROM $ADODB_SESSION_TBL WHERE sesskey='$key'");
session/old/adodb-cryptsession.php:				$rs->MoveNext();
session/old/adodb-cryptsession.php:			$ADODB_SESS_CONN->CommitTrans();
session/old/adodb-cryptsession.php:		$rs = $ADODB_SESS_CONN->Execute($qry);
session/old/adodb-cryptsession.php:		$savem = $ADODB_SESS_CONN->SetFetchMode(ADODB_FETCH_NUM);
session/old/adodb-cryptsession.php:		$rs = $ADODB_SESS_CONN->Execute("SELECT expireref,sesskey FROM $ADODB_SESSION_TBL WHERE expiry < $t");
session/old/adodb-cryptsession.php:		$ADODB_SESS_CONN->SetFetchMode($savem);
session/old/adodb-cryptsession.php:			$ADODB_SESS_CONN->BeginTrans();
session/old/adodb-cryptsession.php:			while (!$rs->EOF) {
session/old/adodb-cryptsession.php:				$ref = $rs->fields[0];
session/old/adodb-cryptsession.php:				$key = $rs->fields[1];
session/old/adodb-cryptsession.php:				//$del = $ADODB_SESS_CONN->Execute("DELETE FROM $ADODB_SESSION_TBL WHERE sesskey='$key'");
session/old/adodb-cryptsession.php:				$rs->MoveNext();
session/old/adodb-cryptsession.php:			$rs->Close();
session/old/adodb-cryptsession.php:			$ADODB_SESS_CONN->Execute("DELETE FROM $ADODB_SESSION_TBL WHERE expiry < $t");
session/old/adodb-cryptsession.php:			$ADODB_SESS_CONN->CommitTrans();
session/old/adodb-cryptsession.php:		$ADODB_SESS_CONN->Execute($qry);
session/old/adodb-cryptsession.php:	if ($ADODB_SESS_CONN->dataProvider === 'oci8') $sql = 'select  TO_CHAR('.($ADODB_SESS_CONN->sysTimeStamp).', \'RRRR-MM-DD HH24:MI:SS\') from '. $ADODB_SESSION_TBL;
session/old/adodb-cryptsession.php:	else $sql = 'select '.$ADODB_SESS_CONN->sysTimeStamp.' from '. $ADODB_SESSION_TBL;
session/old/adodb-cryptsession.php:	$rs =& $ADODB_SESS_CONN->SelectLimit($sql,1);
session/old/adodb-cryptsession.php:	if ($rs && !$rs->EOF) {
session/old/adodb-cryptsession.php:		$dbts = reset($rs->fields);
session/old/adodb-cryptsession.php:		$rs->Close();
session/old/adodb-cryptsession.php:		$dbt = $ADODB_SESS_CONN->UnixTimeStamp($dbts);
session/old/adodb-cryptsession.php:		if (abs($dbt - $t) >= ADODB_SESSION_SYNCH_SECS) {
session/old/adodb-cryptsession.php:			__FILE__.": Server time for webserver {$HTTP_SERVER_VARS['HTTP_HOST']} not in synch with database: database=$dbt ($dbts), webserver=$t (diff=".(abs($dbt-$t)/3600)." hrs)";
session/old/adodb-cryptsession.php:/*  TEST SCRIPT -- UNCOMMENT */
session/old/crypt.inc.php:				return base64_encode($this->keyED($tmp,$key));
session/old/crypt.inc.php:				$txt = $this->keyED(base64_decode($txt),$key);
session/old/adodb-session-clob.php:  V4.54 5 Nov 2004  (c) 2000-2004 John Lim (jlim@natsoft.com.my). All rights reserved.
session/old/adodb-session-clob.php:	include('adodb-session.php');
session/old/adodb-session-clob.php:To force non-persistent connections, call adodb_session_open first before session_start():
session/old/adodb-session-clob.php:	include('adodb-session.php');
session/old/adodb-session-clob.php:	 // bug in PHP 4.0.3 pl 1  -- how about other versions?
session/old/adodb-session-clob.php:	//  Made table name configurable - by David Johnson djohnson@inpro.net
session/old/adodb-session-clob.php:	// cannot use & below - do not know why...
session/old/adodb-session-clob.php:		$ADODB_SESS_CONN->debug = true;
session/old/adodb-session-clob.php:	if ($persist) $ok = $ADODB_SESS_CONN->PConnect($ADODB_SESSION_CONNECT,
session/old/adodb-session-clob.php:	else $ok = $ADODB_SESS_CONN->Connect($ADODB_SESSION_CONNECT,
session/old/adodb-session-clob.php:	if ($ADODB_SESS_CONN) $ADODB_SESS_CONN->Close();
session/old/adodb-session-clob.php:	$rs = $ADODB_SESS_CONN->Execute("SELECT data FROM $ADODB_SESSION_TBL WHERE sesskey = '$key' AND expiry >= " . time());
session/old/adodb-session-clob.php:		if ($rs->EOF) {
session/old/adodb-session-clob.php:			$v = rawurldecode(reset($rs->fields));
session/old/adodb-session-clob.php:		$rs->Close();
session/old/adodb-session-clob.php:		if ($ADODB_SESS_DEBUG) echo "<p>Session: Only updating date - crc32 not changed</p>";
session/old/adodb-session-clob.php:		$rs = $ADODB_SESS_CONN->Execute($qry);	
session/old/adodb-session-clob.php:		$rs = $ADODB_SESS_CONN->Replace($ADODB_SESSION_TBL,$arr, 'sesskey',$autoQuote = true);
session/old/adodb-session-clob.php:			$err = $ADODB_SESS_CONN->ErrorMsg();
session/old/adodb-session-clob.php:		$res = $ADODB_SESS_CONN->Execute("select count(*) as cnt from $ADODB_SESSION_TBL where sesskey = '$key'");
session/old/adodb-session-clob.php:		if ($res && reset($res->fields) > 0) {
session/old/adodb-session-clob.php:		$rs1 = $ADODB_SESS_CONN->Execute($qry);
session/old/adodb-session-clob.php:			$err .= $ADODB_SESS_CONN->ErrorMsg()."\n";
session/old/adodb-session-clob.php:		$rs2 = $ADODB_SESS_CONN->UpdateBlob($ADODB_SESSION_TBL, 'data', $val, "sesskey='$key'", strtoupper($ADODB_SESSION_USE_LOBS));
session/old/adodb-session-clob.php:			$err .= $ADODB_SESS_CONN->ErrorMsg()."\n";
session/old/adodb-session-clob.php:		if ($ADODB_SESS_CONN->databaseType == 'access') 
session/old/adodb-session-clob.php:			$rs = $ADODB_SESS_CONN->Execute("select sesskey from $ADODB_SESSION_TBL WHERE sesskey='$key'");
session/old/adodb-session-clob.php:		$savem = $ADODB_SESS_CONN->SetFetchMode(ADODB_FETCH_NUM);
session/old/adodb-session-clob.php:		$rs = $ADODB_SESS_CONN->Execute("SELECT expireref,sesskey FROM $ADODB_SESSION_TBL WHERE sesskey='$key'");
session/old/adodb-session-clob.php:		$ADODB_SESS_CONN->SetFetchMode($savem);
session/old/adodb-session-clob.php:			$ADODB_SESS_CONN->BeginTrans();
session/old/adodb-session-clob.php:			while (!$rs->EOF) {
session/old/adodb-session-clob.php:				$ref = $rs->fields[0];
session/old/adodb-session-clob.php:				$key = $rs->fields[1];
session/old/adodb-session-clob.php:				$del = $ADODB_SESS_CONN->Execute("DELETE FROM $ADODB_SESSION_TBL WHERE sesskey='$key'");
session/old/adodb-session-clob.php:				$rs->MoveNext();
session/old/adodb-session-clob.php:			$ADODB_SESS_CONN->CommitTrans();
session/old/adodb-session-clob.php:		$rs = $ADODB_SESS_CONN->Execute($qry);
session/old/adodb-session-clob.php:		$savem = $ADODB_SESS_CONN->SetFetchMode(ADODB_FETCH_NUM);
session/old/adodb-session-clob.php:		$rs = $ADODB_SESS_CONN->Execute("SELECT expireref,sesskey FROM $ADODB_SESSION_TBL WHERE expiry < $t");
session/old/adodb-session-clob.php:		$ADODB_SESS_CONN->SetFetchMode($savem);
session/old/adodb-session-clob.php:			$ADODB_SESS_CONN->BeginTrans();
session/old/adodb-session-clob.php:			while (!$rs->EOF) {
session/old/adodb-session-clob.php:				$ref = $rs->fields[0];
session/old/adodb-session-clob.php:				$key = $rs->fields[1];
session/old/adodb-session-clob.php:				$del = $ADODB_SESS_CONN->Execute("DELETE FROM $ADODB_SESSION_TBL WHERE sesskey='$key'");
session/old/adodb-session-clob.php:				$rs->MoveNext();
session/old/adodb-session-clob.php:			$rs->Close();
session/old/adodb-session-clob.php:			//$ADODB_SESS_CONN->Execute("DELETE FROM $ADODB_SESSION_TBL WHERE expiry < $t");
session/old/adodb-session-clob.php:			$ADODB_SESS_CONN->CommitTrans();
session/old/adodb-session-clob.php:		$ADODB_SESS_CONN->Execute("DELETE FROM $ADODB_SESSION_TBL WHERE expiry < " . time());
session/old/adodb-session-clob.php:			$ADODB_SESS_CONN->Execute($opt_qry);
session/old/adodb-session-clob.php:	if ($ADODB_SESS_CONN->dataProvider === 'oci8') $sql = 'select  TO_CHAR('.($ADODB_SESS_CONN->sysTimeStamp).', \'RRRR-MM-DD HH24:MI:SS\') from '. $ADODB_SESSION_TBL;
session/old/adodb-session-clob.php:	else $sql = 'select '.$ADODB_SESS_CONN->sysTimeStamp.' from '. $ADODB_SESSION_TBL;
session/old/adodb-session-clob.php:	$rs =& $ADODB_SESS_CONN->SelectLimit($sql,1);
session/old/adodb-session-clob.php:	if ($rs && !$rs->EOF) {
session/old/adodb-session-clob.php:		$dbts = reset($rs->fields);
session/old/adodb-session-clob.php:		$rs->Close();
session/old/adodb-session-clob.php:		$dbt = $ADODB_SESS_CONN->UnixTimeStamp($dbts);
session/old/adodb-session-clob.php:		if (abs($dbt - $t) >= ADODB_SESSION_SYNCH_SECS) {
session/old/adodb-session-clob.php:			__FILE__.": Server time for webserver {$HTTP_SERVER_VARS['HTTP_HOST']} not in synch with database: database=$dbt ($dbts), webserver=$t (diff=".(abs($dbt-$t)/3600)." hrs)";
session/old/adodb-session-clob.php:/*  TEST SCRIPT -- UNCOMMENT */
session/adodb-sessions.oracle.clob.sql:-- $CVSHeader$
session/adodb-cryptsession.php:V4.01 23 Oct 2003  (c) 2000-2004 John Lim (jlim@natsoft.com.my). All rights reserved.
session/adodb-cryptsession.php:require_once dirname(__FILE__) . '/adodb-session.php';
session/adodb-cryptsession.php:require_once  ADODB_SESSION . '/adodb-encrypt-md5.php';
session/adodb-compress-bzip2.php:V4.01 23 Oct 2003  (c) 2000-2004 John Lim (jlim@natsoft.com.my). All rights reserved.
session/adodb-compress-bzip2.php:		return $this->_block_size;
session/adodb-compress-bzip2.php:		$this->_block_size = (int) $block_size;
session/adodb-compress-bzip2.php:		return $this->_work_level;
session/adodb-compress-bzip2.php:		$this->_work_level = (int) $work_level;
session/adodb-compress-bzip2.php:		return $this->_min_length;
session/adodb-compress-bzip2.php:		$this->_min_length = (int) $min_length;
session/adodb-compress-bzip2.php:			$this->setBlockSize($block_size);
session/adodb-compress-bzip2.php:			$this->setWorkLevel($work_level);
session/adodb-compress-bzip2.php:			$this->setMinLength($min_length);
session/adodb-compress-bzip2.php:		if (strlen($data) < $this->_min_length) {
session/adodb-compress-bzip2.php:		if (!is_null($this->_block_size)) {
session/adodb-compress-bzip2.php:			if (!is_null($this->_work_level)) {
session/adodb-compress-bzip2.php:				return bzcompress($data, $this->_block_size, $this->_work_level);
session/adodb-compress-bzip2.php:				return bzcompress($data, $this->_block_size);
session/adodb-encrypt-md5.php:V4.01 23 Oct 2003  (c) 2000-2004 John Lim (jlim@natsoft.com.my). All rights reserved.
session/adodb-encrypt-md5.php:// security - hide paths
session/adodb-encrypt-md5.php:		return $md5crypt->encrypt($data, $key);
session/adodb-encrypt-md5.php:		return $md5crypt->decrypt($data, $key);
session/adodb-encrypt-secret.php:V4.01 23 Oct 2003  (c) 2000-2004 John Lim (jlim@natsoft.com.my). All rights reserved.
session/adodb-sessions.oracle.sql:-- $CVSHeader$
session/crypt.inc.php:				return base64_encode($this->keyED($tmp,$key));
session/crypt.inc.php:				$txt = $this->keyED(base64_decode($txt),$key);
session/adodb-session-clob.php:V4.01 23 Oct 2003  (c) 2000-2004 John Lim (jlim@natsoft.com.my). All rights reserved.
session/adodb-session-clob.php:require_once dirname(__FILE__) . '/adodb-session.php';
session/adodb-encrypt-mcrypt.php:V4.01 23 Oct 2003  (c) 2000-2004 John Lim (jlim@natsoft.com.my). All rights reserved.
session/adodb-encrypt-mcrypt.php:		return $this->_cipher;
session/adodb-encrypt-mcrypt.php:		$this->_cipher = $cipher;
session/adodb-encrypt-mcrypt.php:		return $this->_mode;
session/adodb-encrypt-mcrypt.php:		$this->_mode = $mode;
session/adodb-encrypt-mcrypt.php:		return $this->_source;
session/adodb-encrypt-mcrypt.php:		$this->_source = $source;
session/adodb-encrypt-mcrypt.php:		$this->_cipher = $cipher;
session/adodb-encrypt-mcrypt.php:		$this->_mode = $mode;
session/adodb-encrypt-mcrypt.php:		$this->_source = $source;
session/adodb-encrypt-mcrypt.php:		$iv_size = mcrypt_get_iv_size($this->_cipher, $this->_mode);
session/adodb-encrypt-mcrypt.php:		$iv = mcrypt_create_iv($iv_size, $this->_source);
session/adodb-encrypt-mcrypt.php:		return mcrypt_encrypt($this->_cipher, $key, $data, $this->_mode, $iv);
session/adodb-encrypt-mcrypt.php:		$iv_size = mcrypt_get_iv_size($this->_cipher, $this->_mode);
session/adodb-encrypt-mcrypt.php:		$iv = mcrypt_create_iv($iv_size, $this->_source);
session/adodb-encrypt-mcrypt.php:		$rv = mcrypt_decrypt($this->_cipher, $key, $data, $this->_mode, $iv);
tests/test-pgblob.php:		$db->Param(false);
tests/test-pgblob.php:		$db->debug= ($i==1);
tests/test-pgblob.php:		$id = $db->GetOne($sql,
tests/test-pgblob.php:$db->PConnect('localhost','tester','test','test') || die("failed connection");
tests/test-pgblob.php:adodb_pr($db->ServerInfo());
tests/test-pgblob.php:$db->_bindInputArray = true; // requires postgresql 7.3+ and ability to modify database
tests/test-pgblob.php:echo '<p>',$MAX,' times, with plan=',getmicrotime() - $t,'</p>';
tests/test-pgblob.php:$db->_bindInputArray = false;
tests/test-pgblob.php:echo '<p>',$MAX,' times, no plan=',getmicrotime() - $t,'</p>';
tests/test-pgblob.php:$db->debug=1;
tests/test-pgblob.php:$db->Execute("insert into photos (id,name) values(9999,'dot.gif')");
tests/test-pgblob.php:$db->UpdateBlob('photos','photo',$val,'id=9999');
tests/test-pgblob.php:$v = $db->GetOne('select photo from photos where id=9999');
tests/test-pgblob.php:$db->Execute("delete from photos where id=9999");
tests/pdo.php:$DB->Connect($pdo_connection_string,'','') || die("CONNECT FAILED");
tests/pdo.php:$rs = $DB->Execute("select * from products where productid<3");
tests/pdo.php:echo "e=".$DB->ErrorNo() . " ".($DB->ErrorMsg())."\n";
tests/pdo.php://print_r(get_class_methods($DB->_stmt));
tests/pdo.php:while (!$rs->EOF) {
tests/pdo.php:	print_r($rs->fields);
tests/pdo.php:	$rs->MoveNext();
tests/pdo.php:echo "<br>--------------------------------------------------------<br>\n\n\n";
tests/pdo.php:$stmt = $DB->PrepareStmt("select * from products");
tests/pdo.php:$rs = $stmt->Execute();
tests/pdo.php:echo "e=".$stmt->ErrorNo() . " ".($stmt->ErrorMsg())."\n";
tests/pdo.php:while ($arr = $rs->FetchRow()) {
tests/testoci8.php:V4.54 5 Nov 2004  (c) 2000-2004 John Lim (jlim@natsoft.com.my). All rights reserved.
tests/testoci8.php:	$db->PConnect('','scott','natsoft');
tests/testoci8.php:		$db->Execute('insert into ATABLE (id,ablob) values('.$num.',empty_blob())');
tests/testoci8.php:		$db->UpdateBlob('ATABLE', 'ablob', $varHoldingBlob, 'id='.$num, 'BLOB');
tests/testoci8.php:		$rs = &$db->Execute('select * from atable');
tests/testoci8.php:		if ($rs->EOF) die("EOF RS");
tests/testoci8.php:	$stmt = $db->Prepare('select * from adoxyz where id=?');
tests/testoci8.php:	$rs = &$db->Execute(
tests/testoci8.php:		if ($rs->EOF) die("EOF RS");
tests/testoci8.php:	$db->PConnect('','scott','natsoft');
tests/testoci8.php:	$db->debug = true;
tests/testoci8.php:	$db->Execute("delete from emp where ename='John'");
tests/testoci8.php:	print $db->Affected_Rows().'<BR>';
tests/testoci8.php:	$stmt = &$db->Prepare('insert into emp (empno, ename) values (:empno, :ename)');
tests/testoci8.php:	$rs = $db->Execute($stmt,array('empno'=>4321,'ename'=>'John'));
tests/testoci8.php:	//$rs = $db->Execute($stmt,array('empno'=>3775,'ename'=>'John'));
tests/testoci8.php:	$db->setfetchmode(ADODB_FETCH_NUM);
tests/testoci8.php:	$stmt = $db->PrepareSP("BEGIN adodb.open_tab2(:rs,:tt); END;",true);
tests/testoci8.php:	$db->OutParameter($stmt, $cur, 'rs', -1, OCI_B_CURSOR);
tests/testoci8.php:	$db->OutParameter($stmt, $vv, 'tt');
tests/testoci8.php:	$rs = $db->Execute($stmt);
tests/testoci8.php:	while (!$rs->EOF) {
tests/testoci8.php:		adodb_pr($rs->fields);
tests/testoci8.php:		$rs->MoveNext();
tests/testoci8.php:	if (!$db->PConnect('local_oracle','scott','tiger')) die('fail connect');
tests/testoci8.php:	$db->debug = true;
tests/testoci8.php:	$rs = &$db->Execute(
tests/testoci8.php:	if ($rs->EOF) die("EOF RS");
tests/test-xmlschema.php:include_once( "../adodb-xmlschema.inc.php" );
tests/test-xmlschema.php:$db->Connect( 'localhost', 'root', '', 'schematest' );
tests/test-xmlschema.php:#$schema->upgradeSchema();
tests/test-xmlschema.php:$sql = $schema->ParseSchema( "xmlschema.xml" );
tests/test-xmlschema.php://$result = $schema->ExecuteSchema( $sql );
tests/test-xmlschema.php://$schema->Destroy();
tests/test-xmlschema.php:$db2->Connect('localhost','sa','natsoft','northwind') || die("Fail 2");
tests/test-xmlschema.php:$db2->Execute("drop table simple_table");
tests/test-xmlschema.php:print "<b>SQL to build xmlschema-mssql.xml</b>:\n<pre>";
tests/test-xmlschema.php:$sql = $schema->ParseSchema( "xmlschema-mssql.xml" );
tests/test-xmlschema.php:$db2->debug=1;
tests/test-xmlschema.php:$db2->Execute($sql[0]);
tests/client.php: * V4.50 6 July 2004  (c) 2001-2002 John Lim (jlim@natsoft.com.my). All rights reserved.
tests/client.php:$conn->Connect($serverURL);
tests/client.php:$conn->debug = true;
tests/client.php:$rs = $conn->Execute($sql1);
tests/client.php:$rs = $conn->Execute($sql2);
tests/client.php:$rs = $conn->Execute($sql3);
tests/client.php:$rs = $conn->Execute($sql5);
tests/client.php:$rs = $conn->Execute($sql4);
tests/client.php:$rs = $conn->Execute($sql5);
tests/client.php:	[_numOfRows] => -1
tests/client.php:	[_currentRow] => -1
tests/client.php:--------------------------------------------------------------------------------
tests/client.php:	[_numOfRows] => -1
tests/client.php:	[_currentRow] => -1
tests/client.php:--------------------------------------------------------------------------------
tests/client.php:	[_numOfRows] => -1
tests/client.php:	[_currentRow] => -1
tests/test-perf.php:include_once('../adodb-perf.inc.php');
tests/test-perf.php:	echo "<font size=1>";print_r($db->ServerInfo()); echo " user=".$db->user."</font>";
tests/test-perf.php:		//$DB->debug=1;
tests/test-perf.php:		echo "Data Cache Size=".$perf->DBParameter('data cache size').'<p>';
tests/test-perf.php:		echo $perf->HealthCheck();
tests/test-perf.php:		echo($perf->SuspiciousSQL());
tests/test-perf.php:		echo($perf->ExpensiveSQL());
tests/test-perf.php:		echo($perf->InvalidSQL());
tests/test-perf.php:		echo $perf->Tables();
tests/test-perf.php:		echo $perf->HealthCheckCLI();
tests/test-perf.php:		$perf->Poll(3);
tests/test-perf.php:	if ($perf) $perf->UI(3);
tests/time.php:include_once('../adodb-time.inc.php');
tests/time.php://require("adodb-time.inc.php"); 
tests/time.php:$datestring = "1963-12-04"; // string normally from mySQL 
tests/time.php:$stringArray = explode("-", $datestring);
tests/time.php:$convertedDate = date("d-M-Y", $date); // converted string to UK style date
tests/tmssql.php:	print "date=".$conn->GetOne('select getdate()')."<br>";
tests/tmssql.php:	@$conn->query('create table tester (id integer)');
tests/tmssql.php:	$rs = $conn->query('delete from tester');
tests/tmssql.php:	print "date=".$conn->GetOne('select getdate()')."<br>";
tests/tmssql.php:	$conn->Connect('JAGUAR\vsdotnet','adodb','natsoft','northwind');
tests/tmssql.php://	$conn->debug=1;
tests/tmssql.php:	print "date=".$conn->GetOne('select getdate()')."<br>";
tests/tmssql.php:	$conn->Execute('create table tester (id integer)');
tests/tmssql.php:	$rs = $conn->Execute('delete from tester');
tests/tmssql.php:	print "date=".$conn->GetOne('select getdate()')."<br>";
tests/test-php5.php:  V4.54 5 Nov 2004  (c) 2000-2004 John Lim (jlim@natsoft.com.my). All rights reserved.
tests/test-php5.php:include("$path/../adodb-exceptions.inc.php");
tests/test-php5.php:	$db->Connect('','scott','natsoft');
tests/test-php5.php:	$db->Connect('localhost','root','','test');
tests/test-php5.php:	//$db->Connect('localhost','root','','test');
tests/test-php5.php:$db->debug=1;
tests/test-php5.php:$cnt = $db->GetOne("select count(*) from adoxyz where ?<id and id<?",array(10,20));
tests/test-php5.php:$stmt = $db->Prepare("select * from adoxyz where ?<id and id<?");
tests/test-php5.php:if (!$stmt) echo $db->ErrorMsg(),"\n";
tests/test-php5.php:$rs = $db->Execute($stmt,array(10,20));
tests/test-php5.php:	echo "rec $i: "; adodb_pr($v); adodb_pr($rs->fields);
tests/test-php5.php:$rs = $db->Execute("select bad from badder");
tests/test-php5.php:	$e = adodb_backtrace($e->gettrace());
tests/test-php5.php:$rs = $db->Execute("select distinct id, firstname,lastname from adoxyz order by id");
tests/test2.php:	$db->debug=1;
tests/test2.php:	$db->Connect($myDSN) || die('fail');
tests/test2.php:	print_r($db->ServerInfo());
tests/test2.php:	$rs = $db->Execute("select $db->sysTimeStamp,* from adoxyz where id>02xx");
tests/test2.php:	print_r($rs->fields);
tests/test2.php:	echo "<p> Date m/d/Y =",$db->UserDate($rs->fields[4],'m/d/Y');
tests/testmssql.php: * @version V4.50 6 July 2004 (c) 2000-2004 John Lim (jlim@natsoft.com.my). All rights reserved.
tests/testmssql.php:$conn->Connect('localhost','sa','natsoft','northwind') or die('Fail');
tests/testmssql.php:$conn->debug =1;
tests/testmssql.php:$conn->SetFetchMode(ADODB_FETCH_ASSOC);
tests/testmssql.php:$rs = $conn->Execute($query);
tests/testmssql.php:while( !$rs->EOF ) {
tests/testmssql.php:	$output[] = $rs->fields;
tests/testmssql.php:	var_dump($rs->fields);
tests/testmssql.php:	$rs->MoveNext();
tests/testmssql.php:$p = $conn->Prepare('insert into products (productname,unitprice,dcreated) values (?,?,?)');
tests/testmssql.php:$conn->debug=1;
tests/testmssql.php:$conn->Execute($p,array('John'.rand(),33.3,$conn->DBDate(time())));
tests/testmssql.php:$p = $conn->Prepare('select * from products where productname like ?');
tests/testmssql.php:$arr = $conn->getarray($p,array('V%'));
tests/testmssql.php://$conn->Connect('mangrove','sa','natsoft','ai');
tests/testmssql.php://$conn->Connect('mangrove','sa','natsoft','ai');
tests/testmssql.php:$conn->debug=1;
tests/testmssql.php:$conn->Execute('delete from blobtest');
tests/testmssql.php:$conn->Execute('insert into blobtest (id) values(1)');
tests/testmssql.php:$conn->UpdateBlobFile('blobtest','b1','../cute_icons_for_site/adodb.gif','id=1');
tests/testmssql.php:$rs = $conn->Execute('select b1 from blobtest where id=1');
tests/testmssql.php:$output = "c:\\temp\\test_out-".date('H-i-s').".gif"; 
tests/testmssql.php:print "Saving file <b>$output</b>, size=".strlen($rs->fields[0])."<p>";
tests/testmssql.php:fwrite($fd, $rs->fields[0]); 
tests/testmssql.php://$rs = $conn->Execute('SELECT id,SUBSTRING(b1, 1, 10) FROM blobtest');
tests/test5.php:V4.54 5 Nov 2004  (c) 2000-2004 John Lim (jlim@natsoft.com.my). All rights reserved.
tests/test5.php:include('../adodb-errorpear.inc.php');
tests/test5.php:	$conn->debug=1;
tests/test5.php:	$conn->PConnect("localhost","root","","xphplens");
tests/test5.php:	print $conn->databaseType.':'.$conn->GenID().'<br>';
tests/test5.php:	$conn->debug=1;
tests/test5.php:	$conn->PConnect("falcon", "scott", "tiger", "juris8.ecosystem.natsoft.com.my"); // connect to MySQL, testdb
tests/test5.php:	print $conn->databaseType.':'.$conn->GenID();
tests/test5.php:	$conn->debug=1;
tests/test5.php:	$conn->Connect("localhost:c:\\Interbase\\Examples\\Database\\employee.gdb", "sysdba", "masterkey", ""); // connect to MySQL, testdb
tests/test5.php:	print $conn->databaseType.':'.$conn->GenID().'<br>';
tests/test5.php:	$conn->debug=1;
tests/test5.php:	@$conn->PConnect("susetikus","tester","test","test");
tests/test5.php:	print $conn->databaseType.':'.$conn->GenID().'<br>';
tests/testoci8cursor.php:V4.54 5 Nov 2004  (c) 2000-2004 John Lim (jlim@natsoft.com.my). All rights reserved.
tests/testoci8cursor.php:------------------------------------------------------------------
tests/testoci8cursor.php:-- TEST PACKAGE YOU NEED TO INSTALL ON ORACLE - run from sql*plus
tests/testoci8cursor.php:------------------------------------------------------------------
tests/testoci8cursor.php:-- TEST PACKAGE
tests/testoci8cursor.php:------------------------------------------------------------------
tests/testoci8cursor.php:-- END PACKAGE
tests/testoci8cursor.php:------------------------------------------------------------------
tests/testoci8cursor.php:	$db->PConnect('','scott','natsoft');
tests/testoci8cursor.php:	$db->debug = 99;
tests/testoci8cursor.php:	$rs = $db->ExecuteCursor("BEGIN adodb.open_tab(:RS,'A%'); END;");
tests/testoci8cursor.php:	if ($rs && !$rs->EOF) {
tests/testoci8cursor.php:		print "Test 1 RowCount: ".$rs->RecordCount()."<p>";
tests/testoci8cursor.php:	$stid = $db->PrepareSP('BEGIN adodb.myproc('.MYNUM.', :myov); END;');
tests/testoci8cursor.php:	$db->OutParameter($stid, $myov, 'myov');
tests/testoci8cursor.php:	$db->Execute($stid);
tests/testoci8cursor.php:	$stmt = $db->PrepareSP("BEGIN adodb.data_out(:a1, :a2); END;",true);
tests/testoci8cursor.php:	$db->InParameter($stmt,$a1,'a1');
tests/testoci8cursor.php:	$db->OutParameter($stmt,$a2,'a2');
tests/testoci8cursor.php:	$rs = $db->Execute($stmt);
tests/testoci8cursor.php:	$stmt = $db->PrepareSP('select * from tab where tname like :tablename');
tests/testoci8cursor.php:	$db->Parameter($stmt,$tname,'tablename');
tests/testoci8cursor.php:	$rs = $db->Execute($stmt);
tests/test3.php:  V4.54 5 Nov 2004  (c) 2000-2004 John Lim (jlim@natsoft.com.my). All rights reserved.
tests/test3.php:include("$path/../adodb-exceptions.inc.php");
tests/test3.php:$db->Connect('','scott','natsoft');
tests/test3.php:$db->debug=1;
tests/test3.php:$cnt = $db->GetOne("select count(*) from adoxyz");
tests/test3.php:$rs = $db->Execute("select * from adoxyz order by id");
tests/test3.php:$rs = $db->Execute("select bad from badder");
tests/test3.php:	$e = adodb_backtrace($e->trace);
tests/test4.php: * @version V4.50 6 July 2004 (c) 2000-2004 John Lim (jlim@natsoft.com.my). All rights reserved.
tests/test4.php:FROM ADOXYZ WHERE id = -1"; 
tests/test4.php:$conn->PConnect("", "sa", "natsoft", "northwind"); // connect to MySQL, testdb
tests/test4.php://$conn->PConnect("localhost", "root", "", "test"); // connect to MySQL, testdb
tests/test4.php://$conn->Connect('','scott','natsoft');
tests/test4.php:$conn->debug=1;
tests/test4.php:$conn->Execute("delete from adoxyz where lastname like 'Smi%'");
tests/test4.php:$rs = $conn->Execute($sql); // Execute the query and get the empty recordset
tests/test4.php:if (strpos($conn->databaseType,'mssql')!==false) $record['id'] = 751;
tests/test4.php:$insertSQL = $conn->GetInsertSQL($rs, $record);
tests/test4.php:$conn->Execute($insertSQL); // Insert the record into the database
tests/test4.php:if (strpos($conn->databaseType,'mssql')!==false) $record['id'] = 752;
tests/test4.php://$record["id"] = -1;
tests/test4.php:$insertSQL = $conn->GetInsertSQL($rs, $record);
tests/test4.php:$conn->Execute($insertSQL); // Insert the record into the database
tests/test4.php:$insertSQL2 = $conn->GetInsertSQL($table='ADOXYZ', $record);
tests/test4.php:FROM ADOXYZ WHERE lastname=".$conn->Param('var'). " ORDER BY 1"; 
tests/test4.php:$rs = $conn->Execute($sql,$varr); // Execute the query and get the existing record to update
tests/test4.php:if (!$rs || $rs->EOF) print "<p><b>No record found!</b></p>";
tests/test4.php:$record["creAted"] = '2002-12-'.(rand()%30+1);
tests/test4.php:$updateSQL = $conn->GetUpdateSQL($rs, $record);
tests/test4.php:$conn->Execute($updateSQL,$varr); // Update the record in the database
tests/test4.php:if ($conn->Affected_Rows() != 1)print "<p><b>Error1 </b>: Rows Affected=".$conn->Affected_Rows().", should be 1</p>";
tests/test4.php:$record["creAted"] = '2002-12-'.(rand()%30+1);
tests/test4.php:$updateSQL = $conn->GetUpdateSQL($rs, $record);
tests/test4.php:$conn->Execute($updateSQL,$varr); // Update the record in the database
tests/test4.php:if ($conn->Affected_Rows() != 1)print "<p><b>Error 2</b>: Rows Affected=".$conn->Affected_Rows().", should be 1</p>";
tests/test4.php:$rs = $conn->Execute("select * from ADOXYZ where lastname like 'Sm%'");
tests/testpaging.php:V4.54 5 Nov 2004  (c) 2000-2004 John Lim (jlim@natsoft.com.my). All rights reserved.
tests/testpaging.php:include_once('../adodb-pager.inc.php');
tests/testpaging.php:	$db->PConnect('localhost','tester','test','test');
tests/testpaging.php:	$db->PConnect("nwind", "", "", "");
tests/testpaging.php:	$db->PConnect("localhost:e:\\firebird\\examples\\employee.gdb", "sysdba", "masterkey", "");
tests/testpaging.php:	$db->Connect('JAGUAR\vsdotnet','adodb','natsoft','northwind');
tests/testpaging.php:	$db->Connect('','scott','natsoft');
tests/testpaging.php:	$db->Connect('nwind');
tests/testpaging.php:	$db->Connect('localhost','root','','xphplens');
tests/testpaging.php://$db->pageExecuteCountRows = false;
tests/testpaging.php:$db->debug = true;
tests/testpaging.php:$rs = &$db->Execute($sql);
tests/testpaging.php:$rs->MoveFirst(); # note, some databases do not support MoveFirst
tests/testpaging.php:$rs->MoveFirst();
tests/testpaging.php:$pager->showPageLinks = true;
tests/testpaging.php:$pager->linksPerPage = 3;
tests/testpaging.php:$pager->cache = 60;
tests/testpaging.php:$pager->Render($rows=7);
tests/testpear.php:V4.54 5 Nov 2004  (c) 2000-2004 John Lim (jlim@natsoft.com.my). All rights reserved.
tests/testpear.php:include_once('../adodb-pear.inc.php');
tests/testpear.php:$db->setFetchMode(ADODB_FETCH_ASSOC);
tests/testpear.php:$rs = $db->Query('select firstname,lastname from adoxyz');
tests/testpear.php:while ($arr = $rs->FetchRow()) {
tests/testsessions.php:V4.54 5 Nov 2004  (c) 2000-2004 John Lim (jlim@natsoft.com.my). All rights reserved.
tests/testsessions.php://-------------------------------------------------------------------
tests/testsessions.php:	include('../session/adodb-cryptsession.php');
tests/testcache.php:V4.54 5 Nov 2004  (c) 2000-2004 John Lim (jlim@natsoft.com.my). All rights reserved.
tests/testcache.php:	$db->PConnect('nwind');
tests/testcache.php:	$db->PConnect('mangrove','root','','xphplens');
tests/testcache.php:if (isset($cache)) $rs = $db->CacheExecute(120,'select * from products');
tests/testcache.php:else $rs = $db->Execute('select * from products');
tests/testcache.php:$arr = $rs->GetArray();
tests/test.php:V4.54 5 Nov 2004  (c) 2000-2004 John Lim (jlim@natsoft.com.my). All rights reserved.
tests/test.php:if (PHP_VERSION < 5) include_once('../adodb-pear.inc.php');
tests/test.php://--------------------------------------------------------------------------------------
tests/test.php:	include_once('../session/adodb-session.php');
tests/test.php:		print "<p><b>White space detected in adodb-$conn.inc.php or include file...</b></p>";
tests/test.php:	$rs = $db->Execute('select lastname,firstname,lastname,id from adoxyz');
tests/test.php:	$arr = $rs->GetAssoc();
tests/test.php:	//$db->Execute("drop table adodb_logsql");
tests/test.php:	if ((rand()%3) == 0) @$db->Execute("delete from adodb_logsql");
tests/test.php:	$db->debug=1;
tests/test.php:	$db->fnExecute = 'CountExecs';
tests/test.php:	$db->fnCacheExecute = 'CountCachedExecs';
tests/test.php:		$db->LogSQL();/*
tests/test.php:		$db->SelectLimit($sql);
tests/test.php:		echo $db->ErrorMsg();*/
tests/test.php:	$db->debug = false;
tests/test.php:	//print $db->UnixTimeStamp('2003-7-22 23:00:00');
tests/test.php:	print "<h3>ADODB Version: $ADODB_vers Host: <i>$db->host</i> &nbsp; Database: <i>$db->database</i> &nbsp; PHP: $phpv $ext</h3>";
tests/test.php:	$arr = $db->ServerInfo();
tests/test.php:	$e = error_reporting(E_ALL-E_WARNING);
tests/test.php:	$tt  = $db->Time(); 
tests/test.php:	if ($tt == 0) echo '<br><b>$db->Time failed</b>';
tests/test.php:	else echo "<br>db->Time: ".date('d-m-Y H:i:s',$tt);
tests/test.php:	echo "Date=",$db->UserDate('2002-04-07'),'<br>';
tests/test.php:	print "<i>date1</i> (1969-02-20) = ".$db->DBDate('1969-2-20');
tests/test.php:	print "<br><i>date1</i> (1999-02-20) = ".$db->DBDate('1999-2-20');
tests/test.php:	print "<br><i>date1.1</i> 1999 = ".$db->DBDate("'1999'");
tests/test.php:	print "<br><i>date2</i> (1970-1-2) = ".$db->DBDate(24*3600)."<p>";
tests/test.php:	print "<i>ts1</i> (1999-02-20 13:40:50) = ".$db->DBTimeStamp('1999-2-20 1:40:50 pm');
tests/test.php:	print "<br><i>ts1.1</i> (1999-02-20 13:40:00) = ".$db->DBTimeStamp('1999-2-20 13:40');
tests/test.php:	print "<br><i>ts2</i> (1999-02-20) = ".$db->DBTimeStamp('1999-2-20');
tests/test.php:	print "<br><i>ts3</i> (1970-1-2 +/- timezone) = ".$db->DBTimeStamp(24*3600);
tests/test.php:	print "<br> Fractional TS (1999-2-20 13:40:50.91): ".$db->DBTimeStamp($db->UnixTimeStamp('1999-2-20 13:40:50.91+1'));
tests/test.php:	 $dd = $db->UnixDate('1999-02-20');
tests/test.php:	print "<br>unixdate</i> 1999-02-20 = ".date('Y-m-d',$dd)."<p>";
tests/test.php:	print "<br><i>ts4</i> =".($db->UnixTimeStamp("19700101000101")+8*3600);
tests/test.php:	print "<br><i>ts5</i> =".$db->DBTimeStamp($db->UnixTimeStamp("20040110092123"));
tests/test.php:	print "<br><i>ts6</i> =".$db->UserTimeStamp("20040110092123");
tests/test.php:	print "<br><i>ts7</i> =".$db->DBTimeStamp("20040110092123");
tests/test.php:	if (false && $db->databaseType != 'mssql') {
tests/test.php:		$rez = $db2->Connect("bad connection");
tests/test.php:		$err = $db2->ErrorMsg();
tests/test.php:	$rs=$db->Execute('select * from adoxyz order by id');
tests/test.php:	else $rs->Close();
tests/test.php:	//if ($db->databaseType !='vfp') $db->Execute("drop table ADOXYZ");
tests/test.php:		if (false && $db->databaseType == 'ibase') {
tests/test.php:			$db->debug = 1;
tests/test.php:			$e = error_reporting(E_ALL-E_WARNING);
tests/test.php:			$db->Execute($createtab);
tests/test.php:	$rs = &$db->Execute("delete from ADOXYZ"); // some ODBC drivers will fail the drop so we delete
tests/test.php:		if(! $rs->EOF) print "<b>Error: </b>RecordSet returned by Execute('delete...') should show EOF</p>";
tests/test.php:		$rs->Close();
tests/test.php:	} else print "err=".$db->ErrorMsg();
tests/test.php:	$rs = &$db->Execute("select id,firstname from ADOXYZ where id=9999");
tests/test.php:	if ($rs && !$rs->EOF) print "<b>Error: </b>RecordSet returned by Execute(select...') on empty table should show EOF</p>";
tests/test.php:	if ($rs->EOF && ($o = $rs->FetchField(0) && !empty($o->name))) {
tests/test.php:		$sql =  $db->GetInsertSQL($rs, $record);
tests/test.php:	if ($rs) $rs->Close();
tests/test.php:	//$db->debug=true;	
tests/test.php:	$time = $db->DBDate(time());
tests/test.php:	if (!$db->BeginTrans()) {
tests/test.php:		if ($db->hasTransactions) Err("hasTransactions should be false");
tests/test.php:		if (!$db->hasTransactions) Err("hasTransactions should be true");
tests/test.php:		if ($db->transCnt != 1) Err("Invalid transCnt = $db->transCnt (should be 1)");
tests/test.php:		$rs = $db->Execute("insert into ADOXYZ (id,firstname,lastname,created) values (99,'Should Not','Exist (Commit)',$time)");
tests/test.php:		if ($rs && $db->CommitTrans()) {
tests/test.php:			$rs->Close();
tests/test.php:			$rs = &$db->Execute("select * from ADOXYZ where id=99");
tests/test.php:			if ($rs === false || $rs->EOF) {
tests/test.php:				$rs = &$db->Execute("select * from ADOXYZ where id=99");
tests/test.php:			if ($rs) $rs->Close();
tests/test.php:				$db->RollbackTrans();
tests/test.php:		if ($db->transCnt != 0) Err("Invalid transCnt = $db->transCnt (should be 0)");
tests/test.php:		if (!$db->BeginTrans()) print "<p><b>Error in BeginTrans</b>()</p>";
tests/test.php:		$db->Execute("insert into ADOXYZ (id,firstname,lastname,created) values (100,'Should Not','Exist (Rollback)',$time)");
tests/test.php:		if ($db->RollbackTrans()) {
tests/test.php:			$rs = $db->Execute("select * from ADOXYZ where id=100");
tests/test.php:			if ($rs && !$rs->EOF) print '<b>Fail: Data should rollback</b></p>';
tests/test.php:			if ($rs) $rs->Close();
tests/test.php:		$rs = &$db->Execute('delete from ADOXYZ where id>50');
tests/test.php:		if ($rs) $rs->Close();
tests/test.php:		if ($db->transCnt != 0) Err("Invalid transCnt = $db->transCnt (should be 0)");
tests/test.php:		print_r( $db->MetaDatabases());
tests/test.php:		$a = $db->MetaTables();
tests/test.php:		$a = $db->MetaTables('VIEW');
tests/test.php:		$a = $db->MetaTables(false,false,'aDo%');
tests/test.php:		$a = $db->MetaTables('TABLE');
tests/test.php:		$db->debug=0;
tests/test.php:		$rez = $db->MetaColumns("NOSUCHTABLEHERE");
tests/test.php:		$db->debug=1;
tests/test.php:		$a = $db->MetaColumns('ADOXYZ');
tests/test.php:		$a = $db->MetaIndexes(('ADOXYZ'),true);
tests/test.php:		$a = $db->MetaPrimaryKeys('ADOXYZ');
tests/test.php:	$rs = &$db->Execute('delete from ADOXYZ');
tests/test.php:	if ($rs) $rs->Close();
tests/test.php:	$db->debug = false;
tests/test.php:	switch ($db->databaseType) {
tests/test.php:			$rs = $db->Execute("select data from memo");
tests/test.php:		print "<p>Encode=".$db->BlobEncode("abc\0d\"'
tests/test.php:		$arr = $db->MetaForeignKeys('adoxyz',false,true);
tests/test.php:		$arr = $db->MetaForeignKeys('Orders',false,true);
tests/test.php:		if ($db->databaseType == 'odbc_mssql') break;
tests/test.php:	TotalPurchase=ROUND(SUM(CONVERT(decimal(14,2), OD.Quantity * (1-OD.Discount) * OD.UnitPrice)), 0)
tests/test.php:		$saved = $db->debug;
tests/test.php:		$db->debug=true;
tests/test.php:		$stmt = $db->PrepareSP('SalesByCategory');
tests/test.php:		$db->InParameter($stmt,$cat,'CategoryName');
tests/test.php:		$db->InParameter($stmt,$yr,'OrdYear');
tests/test.php:		$rs = $db->Execute($stmt);
tests/test.php:		$stmt = $db->PrepareSP('SalesByCategory');
tests/test.php:		$db->InParameter($stmt,$cat,'CategoryName');
tests/test.php:		$db->InParameter($stmt,$yr,'OrdYear');
tests/test.php:		$rs = $db->Execute($stmt);
tests/test.php:		Test out params - works in PHP 4.2.3 and 4.3.3 and 4.3.8 but not 4.3.0:
tests/test.php:		$db->debug=1;
tests/test.php:		$stmt = $db->PrepareSP('at_date_interval');
tests/test.php:		$db->InParameter($stmt,$days,'days', 4, SQLINT4); 
tests/test.php:		$db->OutParameter($stmt,$begin_date,'start', 20, SQLVARCHAR ); 
tests/test.php:		$db->OutParameter($stmt,$end_date,'end', 20, SQLVARCHAR ); 
tests/test.php:		$db->Execute($stmt);
tests/test.php:		$db->debug = $saved;
tests/test.php:		$saved = $db->debug;
tests/test.php:		$db->debug=true;
tests/test.php:		$ok = $db->Updateblob('photos','photo',$s,'id=1');
tests/test.php:			$s2= $db->GetOne("select photo from photos where id=1");
tests/test.php:		$ok = $db->UpdateClob('photos','descclob',$s,'id=1');
tests/test.php:			$s2= $db->GetOne("select descclob from photos where id=1");
tests/test.php:		$arr = $db->MetaForeignKeys('emp');
tests/test.php:-- TEST PACKAGE
tests/test.php:-- "Set scan off" turns off substitution variables. 
tests/test.php:		$rs = $db->ExecuteCursor("BEGIN adodb.open_tab(:zz,'A%'); END;",'zz');
tests/test.php:		if ($rs && !$rs->EOF) {
tests/test.php:			$v = $db->GetOne("SELECT count(*) FROM tab where tname like 'A%'");
tests/test.php:			if ($v == $rs->RecordCount()) print "Test 1 RowCount: OK<p>";
tests/test.php:			else Err("Test 1 RowCount ".$rs->RecordCount().", actual = $v");
tests/test.php:		$stmt = $db->PrepareSP("BEGIN adodb.data_out(:a1, :a2); END;");
tests/test.php:		$db->InParameter($stmt,$a1,'a1');
tests/test.php:		$db->OutParameter($stmt,$a2,'a2');
tests/test.php:		$rs = $db->Execute($stmt);
tests/test.php:		$stmt = $db->PrepareSP('select * from tab where tname like :tablename');
tests/test.php:		$db->Parameter($stmt,$tname,'tablename');
tests/test.php:		$rs = $db->Execute($stmt);
tests/test.php:		$stmt = $db->PrepareSP("begin adodb.data_in(:a1); end;");
tests/test.php:		$db->InParameter($stmt,$a1,'a1');
tests/test.php:		$db->Execute($stmt);
tests/test.php:		$db->debug = $saved;
tests/test.php:	$db->debug=1;
tests/test.php:	$sql = "insert into ADOXYZ (id,firstname,lastname) values (".$db->Param('0').",".$db->Param('1').",".$db->Param('2').")";
tests/test.php:	$db->StartTrans();
tests/test.php:	$db->Execute($sql,$arr);
tests/test.php:	$db->CompleteTrans();
tests/test.php:	$rs = $db->Execute('select * from ADOXYZ order by id');
tests/test.php:	if ($rs->RecordCount() != 3) Err("Bad bulk insert");
tests/test.php:	$db->Execute('delete from ADOXYZ');
tests/test.php:	$time = $db->DBDate(time());
tests/test.php:	if (empty($HTTP_GET_VARS['hide'])) $db->debug = true;
tests/test.php:	switch($db->databaseType){
tests/test.php:  		//$db->debug=1;
tests/test.php:  		if (!$db->Execute("delete from mytable")) 
tests/test.php:			$db->Execute($sqlt);
tests/test.php:		$ok = $db->Execute("insert into mytable (row2) values ('test')");
tests/test.php:		$ins_id=$db->Insert_ID();
tests/test.php:		$ins_id2 = $db->GetOne("select row1 from mytable");
tests/test.php:		if (!$db->Execute("delete from mytable")) 
tests/test.php:			$db->Execute($sqlt);
tests/test.php:		$ok = $db->Execute("insert into mytable (row2) values ('test')");
tests/test.php:		$ins_id=$db->Insert_ID();
tests/test.php:		$ins_id2 = $db->GetOne("select row1 from mytable");
tests/test.php:		$sql = $db->Prepare($sql);
tests/test.php:	$rs = $db->Execute($sql,$arr);
tests/test.php:	else $rs->Close();
tests/test.php:	$db->debug = false;
tests/test.php:	$db->Execute("insert into ADOXYZ (id,firstname,lastname,created) values ($i*10+1,'John','Lim',$time)");
tests/test.php:	/*$ins_id=$db->Insert_ID();
tests/test.php:	if ($db->databaseType == 'mysql') if ($ins_id == 0) Err('Bad Insert_ID');
tests/test.php:	$db->Execute("insert into ADOXYZ (id,firstname,lastname,created) values ($i*10+2,'Mary','Lamb',$time )");
tests/test.php:	$db->Execute("insert into ADOXYZ (id,firstname,lastname,created) values ($i*10+3,'George','Washington',$time )");
tests/test.php:	$db->Execute("insert into ADOXYZ (id,firstname,lastname,created) values ($i*10+4,'Mr. Alan','Tam',$time )");
tests/test.php:	$db->Execute("insert into ADOXYZ (id,firstname,lastname,created) values ($i*10+5,'Alan',".$db->quote("Turing'ton").",$time )");
tests/test.php:	$db->Execute("insert into ADOXYZ (id,firstname,lastname,created)values ($i*10+6,'Serena','Williams',$time )");
tests/test.php:	$db->Execute("insert into ADOXYZ (id,firstname,lastname,created) values ($i*10+7,'Yat Sun','Sun',$time )");
tests/test.php:	$db->Execute("insert into ADOXYZ (id,firstname,lastname,created) values ($i*10+8,'Wai Hun','See',$time )");
tests/test.php:	$db->Execute("insert into ADOXYZ (id,firstname,lastname,created) values ($i*10+9,'Steven','Oey',$time )");
tests/test.php:	$db->debug=1;
tests/test.php:	$cnt = $db->GetOne("select count(*) from ADOXYZ");
tests/test.php:	$rs = $db->Execute('update ADOXYZ set id=id+1');	
tests/test.php:	$nrows = $db->Affected_Rows();   
tests/test.php:	$array = array('zid'=>1,'zdate'=>date('Y-m-d',time()));
tests/test.php:	$id = $db->GetOne("select id from ADOXYZ 
tests/test.php:		where id=".$db->Param('zid')." and created>=".$db->Param('ZDATE')."",
tests/test.php:	$db->debug = false;
tests/test.php:	$rs = $db->Execute("select * from ADOXYZ where firstname = 'not known'");
tests/test.php:	if (!$rs ||  !$rs->EOF) print "<p><b>Error on empty recordset</b></p>";
tests/test.php:	else if ($rs->RecordCount() != 0) {
tests/test.php:		print "<p><b>Error on RecordCount. Should be 0. Was ".$rs->RecordCount()."</b></p>"; 
tests/test.php:		print_r($rs->fields);
tests/test.php:	if ($db->databaseType !== 'odbc') {
tests/test.php:		$rs = &$db->Execute("select id,firstname,lastname,created,".$db->random." from ADOXYZ order by id");
tests/test.php:			if ($rs->RecordCount() != 50) {
tests/test.php:				print "<p><b>RecordCount returns ".$rs->RecordCount()."</b></p>";
tests/test.php:				$poc = $rs->PO_RecordCount('ADOXYZ');
tests/test.php:			if (isset($rs->fields['firstname'])) print '<p>The fields columns can be indexed by column name.</p>';
tests/test.php:				print_r($rs->fields);
tests/test.php:	$val = $db->GetOne("select count(*) from ADOXYZ");
tests/test.php:	$val = $db->GetRow("select count(*) from ADOXYZ");
tests/test.php:	$rs = &$db->Execute('select * from ADOXYZ');
tests/test.php:	if (empty($rs->connection)) print "<b>Connection object missing from recordset</b></br>";
tests/test.php:	while ($o = $rs->FetchNextObject()) { // calls FetchObject internally
tests/test.php:		if (!is_string($o->FIRSTNAME) || !is_string($o->LASTNAME)) {
tests/test.php:	$rs = &$db->Execute('select * from ADOXYZ');
tests/test.php:	if (empty($rs->connection)) print "<b>Connection object missing from recordset</b></br>";
tests/test.php:	print_r($rs->fields);
tests/test.php:	while ($o = $rs->FetchNextObject()) { // calls FetchObject internally
tests/test.php:		if (!is_string($o->FIRSTNAME) || !is_string($o->LASTNAME)) {
tests/test.php:	$db->debug=1;
tests/test.php:	$rs = $db->CacheSelectLimit('  select  id, firstname from  ADOXYZ order by id',2);
tests/test.php:	if ($rs && !$rs->EOF) {
tests/test.php:		if (isset($rs->fields[0])) {
tests/test.php:			print_r($rs->fields);
tests/test.php:		if ($rs->fields['id'] != 1)  {Err("Error"); print_r($rs->fields);};
tests/test.php:		if (trim($rs->fields['firstname']) != 'Caroline')  {print Err("Error 2"); print_r($rs->fields);};
tests/test.php:		$rs->MoveNext();
tests/test.php:		if ($rs->fields['id'] != 2)  {Err("Error 3"); print_r($rs->fields);};
tests/test.php:		$rs->MoveNext();
tests/test.php:		if (!$rs->EOF) {
tests/test.php:	$rs = &$db->SelectLimit('select id,firstname from ADOXYZ order by id',2);
tests/test.php:	if ($rs && !$rs->EOF) {
tests/test.php:		if ($rs->fields[$id] != 1)  {Err("Error 1"); print_r($rs->fields);};
tests/test.php:		if (trim($rs->fields[$fname]) != 'Caroline')  {Err("Error 2"); print_r($rs->fields);};
tests/test.php:		$rs->MoveNext();
tests/test.php:		if ($rs->fields[$id] != 2)  {Err("Error 3"); print_r($rs->fields);};
tests/test.php:		$rs->MoveNext();
tests/test.php:		if (!$rs->EOF) Err("Error EOF");
tests/test.php:		else if (is_array($rs->fields) || $rs->fields) {
tests/test.php:			print_r($rs->fields);
tests/test.php:	$rs = &$db->SelectLimit('select id,firstname from ADOXYZ order by id',1);
tests/test.php:	if ($rs && !$rs->EOF) {
tests/test.php:		if (isset($rs->fields['id'])) Err("FETCH_NUM has ASSOC fields");
tests/test.php:		if ($rs->fields[0] != 1)  {Err("Error 1"); print_r($rs->fields);};
tests/test.php:		if (trim($rs->fields[1]) != 'Caroline')  {Err("Error 2");print_r($rs->fields);};
tests/test.php:		$rs->MoveNext();
tests/test.php:		if (!$rs->EOF) Err("Error EOF");
tests/test.php:	$db->debug = false;
tests/test.php:	$rs = &$db->SelectLimit('select id,firstname from ADOXYZ order by id',1);
tests/test.php:	if ($rs && !$rs->EOF) {
tests/test.php:		$arr = &$rs->GetRowAssoc();
tests/test.php:		$rs->MoveNext();
tests/test.php:		if (!$rs->EOF) Err("Error EOF");
tests/test.php:	$rs = &$db->SelectLimit('select id,firstname from ADOXYZ order by id',1);
tests/test.php:	if ($rs && !$rs->EOF) {
tests/test.php:		$arr = &$rs->GetRowAssoc(false);
tests/test.php:	$col = $db->GetCol('select distinct firstname from adoxyz order by 1');
tests/test.php:	$db->debug = true;
tests/test.php:	$zdate = date('Y-m-d',time()+3600*24);
tests/test.php:	$zdate = $db->DBDate($zdate);
tests/test.php:	$db->Execute("update ADOXYZ set created=$zdate where id=1");
tests/test.php:	$row = $db->GetRow("select created,firstname from ADOXYZ where id=1");
tests/test.php:	$rs = &$db->SelectLimit('select distinct * from ADOXYZ order by id',3);
tests/test.php:	if ($rs && !$rs->EOF) {
tests/test.php:		if (trim($rs->fields[1]) != 'Caroline') Err("Error 1 (exp Caroline), ".$rs->fields[1]);
tests/test.php:		$rs->MoveNext();
tests/test.php:		if (trim($rs->fields[1]) != 'John') Err("Error 2 (exp John), ".$rs->fields[1]);
tests/test.php:		$rs->MoveNext();
tests/test.php:		if (trim($rs->fields[1]) != 'Mary') Err("Error 3 (exp Mary),".$rs->fields[1]);
tests/test.php:		$rs->MoveNext();
tests/test.php:		if (! $rs->EOF) Err("Error EOF");
tests/test.php:	$rs = &$db->SelectLimit('select * from ADOXYZ order by id',3,2);
tests/test.php:	if ($rs && !$rs->EOF) {
tests/test.php:		if (trim($rs->fields[1]) != 'Mary') Err("Error 1 - No Mary, instead: ".$rs->fields[1]);
tests/test.php:		$rs->MoveNext();
tests/test.php:		if (trim($rs->fields[1]) != 'George')Err("Error 2 - No George, instead: ".$rs->fields[1]);
tests/test.php:		$rs->MoveNext();
tests/test.php:		if (trim($rs->fields[1]) != 'Mr. Alan') Err("Error 3 - No Mr. Alan, instead: ".$rs->fields[1]);
tests/test.php:		$rs->MoveNext();
tests/test.php:		if (! $rs->EOF) Err("Error EOF");
tests/test.php:	$db->debug=1;
tests/test.php:	$rs = &$db->SelectLimit('select * from ADOXYZ order by id',-1,48);
tests/test.php:	if ($rs && !$rs->EOF) {
tests/test.php:		if (empty($rs->connection)) print "<b>Connection object missing from recordset</b></br>";
tests/test.php:		if (trim($rs->fields[1]) != 'Wai Hun') Err("Error 1 ".$rs->fields[1]);
tests/test.php:		$rs->MoveNext();
tests/test.php:		if (trim($rs->fields[1]) != 'Steven') Err("Error 2 ".$rs->fields[1]);
tests/test.php:		$rs->MoveNext();
tests/test.php:		if (! $rs->EOF) {
tests/test.php:		$db->debug = false;
tests/test.php:	$rs = &$db->Execute("select * from ADOXYZ order by id");
tests/test.php:		if (!$rs->Move(2)) {
tests/test.php:			if (!$rs->canSeek) print "<p>$db->databaseType: <b>Move(), MoveFirst() nor MoveLast() not supported.</b></p>";
tests/test.php:			else print '<p><b>RecordSet->canSeek property should be set to false</b></p>';
tests/test.php:			$rs->MoveFirst();
tests/test.php:			if (trim($rs->Fields("firstname")) != 'Caroline') {
tests/test.php:				print "<p><b>$db->databaseType: MoveFirst failed -- probably cannot scroll backwards</b></p>";
tests/test.php:						// Move(3) tests error handling -- MoveFirst should not move cursor
tests/test.php:			$rs->Move(3);
tests/test.php:			if (trim($rs->Fields("firstname")) != 'George') {
tests/test.php:				print '<p>'.$rs->Fields("id")."<b>$db->databaseType: Move(3) failed</b></p>";
tests/test.php:			$rs->Move(7);
tests/test.php:			if (trim($rs->Fields("firstname")) != 'Yat Sun') {
tests/test.php:				print '<p>'.$rs->Fields("id")."<b>$db->databaseType: Move(7) failed</b></p>";
tests/test.php:			if ($rs->EOF) Err("Move(7) is EOF already");
tests/test.php:			$rs->MoveLast();
tests/test.php:			if (trim($rs->Fields("firstname")) != 'Steven'){
tests/test.php:				 print '<p>'.$rs->Fields("id")."<b>$db->databaseType: MoveLast() failed</b></p>";
tests/test.php:			$rs->MoveNext();
tests/test.php:			if (!$rs->EOF) err("Bad MoveNext");
tests/test.php:			if ($rs->canSeek) {
tests/test.php:				$rs->Move(3);
tests/test.php:				if (trim($rs->Fields("firstname")) != 'George') {
tests/test.php:					print '<p>'.$rs->Fields("id")."<b>$db->databaseType: Move(3) after MoveLast failed</b></p>";
tests/test.php:			$rs = $db->Execute("select * from ADOXYZ where id > 0 and id < 0");
tests/test.php:			$rs->MoveFirst();
tests/test.php:			if (!$rs->EOF || $rs->fields) Err("Error in empty move first");
tests/test.php:	$rs = $db->Execute('select * from ADOXYZ where id = 2');
tests/test.php:	if ($rs->EOF || !is_array($rs->fields)) Err("Error in select");
tests/test.php:	$rs->MoveNext();
tests/test.php:	if (!$rs->EOF) Err("Error in EOF (xx) ");
tests/test.php: //	$db->debug=true;
tests/test.php:	if ($db->dataProvider == 'postgres') {
tests/test.php:		$sql = "select ".$db->Concat('cast(firstname as varchar)',$db->qstr(' '),'lastname')." as fullname,id,".$db->sysTimeStamp." as d from ADOXYZ";
tests/test.php:		$rs = &$db->Execute($sql);
tests/test.php:		$sql = "select distinct ".$db->Concat('firstname',$db->qstr(' '),'lastname')." as fullname,id,".$db->sysTimeStamp." as d from ADOXYZ";
tests/test.php:		$rs = &$db->Execute($sql);
tests/test.php:	$rs = &$db->Execute("select * from ADOXYZ order by id");
tests/test.php:		$arr = &$rs->GetArray(10);
tests/test.php:	$arr = $db->GetArray("select x from ADOXYZ");
tests/test.php:	$e = $db->ErrorMsg(); $e2 = $db->ErrorNo();
tests/test.php:	$rs = &$db->Execute("select distinct lastname,firstname from ADOXYZ where firstname='Caroline'");
tests/test.php:	while ($o = $rs->FetchNextObject()) {
tests/test.php:	$stmt = $db->Prepare("select * from ADOXYZ where id < 3");
tests/test.php:	$rs = $db->Execute($stmt);
tests/test.php:		$arr = $rs->GetArray();
tests/test.php:	//$arr = $db->GetArray("select  lastname,firstname from ADOXYZ");
tests/test.php:	$rs =& $db->Execute("select distinct lastname,firstname,created from ADOXYZ");
tests/test.php:		$arr = $rs->GetAssoc();
tests/test.php:	$arr = &$db->GetAssoc("select distinct lastname,firstname from ADOXYZ");
tests/test.php:	$db->debug = true;
tests/test.php:	$rs = &$db->CacheExecute(4,"select distinct firstname,lastname from ADOXYZ");
tests/test.php:	if ($rs) print 'With blanks, Steven selected:'. $rs->GetMenu('menu','Steven').'<BR>'; 
tests/test.php:	$rs = &$db->CacheExecute(4,"select distinct firstname,lastname from ADOXYZ");
tests/test.php:	if ($rs) print ' No blanks, Steven selected: '. $rs->GetMenu('menu','Steven',false).'<BR>';
tests/test.php:	$rs = &$db->CacheExecute(4,"select distinct firstname,lastname from ADOXYZ");
tests/test.php:	if ($rs) print ' Multiple, Alan selected: '. $rs->GetMenu('menu','Alan',false,true).'<BR>';
tests/test.php:	$rs = &$db->CacheExecute(4,"select distinct firstname,lastname from ADOXYZ");
tests/test.php:		print ' Multiple, Alan and George selected: '. $rs->GetMenu('menu',array('Alan','George'),false,true);
tests/test.php:		if (empty($rs->connection)) print "<b>Connection object missing from recordset</b></br>";
tests/test.php:	$rs = &$db->CacheExecute(4,"select distinct firstname,lastname from ADOXYZ");
tests/test.php:	if ($rs) print 'With blanks, Steven selected:'. $rs->GetMenu2('menu',('Oey')).'<BR>'; 
tests/test.php:	$rs = &$db->CacheExecute(6,"select distinct firstname,lastname from ADOXYZ");
tests/test.php:	if ($rs) print ' No blanks, Steven selected: '. $rs->GetMenu2('menu',('Oey'),false).'<BR>';
tests/test.php:	$rs = &$db->CacheExecute(6,"select distinct firstname,lastname from ADOXYZ");
tests/test.php:	print_r($rs->fields); echo $rs->fetchMode;echo "<br>";
tests/test.php:	echo $rs->Fields('firstname');
tests/test.php:	$rs = &$db->CacheExecute(6,"select distinct firstname,lastname from ADOXYZ");
tests/test.php:	print_r($rs->fields);echo "<br>";
tests/test.php:	echo $rs->Fields('firstname');
tests/test.php:	$db->debug = false;
tests/test.php:	$rs = &$db->Execute($sql);
tests/test.php:	if (!$rs->FieldCount()) err( "<b>No fields returned for $sql</b>");
tests/test.php:	if (!$rs->FetchField(1)) err( "<b>FetchField failed for $sql</b>");
tests/test.php:	$rs = &$db->Execute($sql);
tests/test.php:	if (!$rs) err( "<b>No recordset returned for '$sql'<br>".$db->ErrorMsg()."</b>");
tests/test.php:	$rs = &$db->Execute($sql);
tests/test.php:	if (!$rs) err( "<b>No recordset returned for '$sql'<br>".$db->ErrorMsg()."</b>");
tests/test.php:	$rs1 = &$db->Execute("select id from ADOXYZ where id <= 2 order by 1");
tests/test.php:	$rs2 = &$db->Execute("select id from ADOXYZ where id = 3 or id = 4 order by 1");
tests/test.php:	if ($rs1) $rs1->MoveLast();
tests/test.php:	if ($rs2) $rs2->MoveLast();
tests/test.php:	if (empty($rs1) || empty($rs2) || $rs1->fields[0] != 2 || $rs2->fields[0] != 4) {
tests/test.php:		$a = $rs1->fields[0];
tests/test.php:		$b = $rs2->fields[0];
tests/test.php:		echo  "($i: ",$val = $db->GenID($db->databaseType.'abcseq6' ,5), ") ";
tests/test.php:		$db->DropSequence('abc_seq2');
tests/test.php:		$db->CreateSequence('abc_seq2');
tests/test.php:		$val = $db->GenID('abc_seq2');
tests/test.php:		$db->DropSequence('abc_seq2');
tests/test.php:		$db->CreateSequence('abc_seq2');
tests/test.php:		$val = $db->GenID('abc_seq2');
tests/test.php:	if (substr($db->dataProvider,0,3) != 'notused') { // used to crash ado
tests/test.php:		if ($db->Execute($sql) === false) {
tests/test.php:			print "<p>This returns the following ErrorMsg(): <i>".$db->ErrorMsg()."</i> and ErrorNo(): ".$db->ErrorNo().'</p>';
tests/test.php:			print "<p><b>Error in error handling -- Execute() should return false</b></p>";
tests/test.php:	$rs = $db->query('select * from adoxyz order by id');
tests/test.php:	if ($ee = $db->ErrorMsg()) {
tests/test.php:	if ($ee = $db->ErrorNo()) {
tests/test.php:	print_r($rs->fields);
tests/test.php:	for($i=0;$i<$rs->FieldCount();$i++) 
tests/test.php:		$fld=$rs->FetchField($i); 
tests/test.php:		print "<br> Field name is ".$fld->name; 
tests/test.php:		print " ".$rs->Fields($fld->name); 
tests/test.php:	if ($db->dataProvider == 'ado') {
tests/test.php:		print "<b>ADODB_FETCH_BOTH not supported</b> for dataProvider=".$db->dataProvider."<br>";
tests/test.php:		$rs = $db->query('select * from adoxyz order by id');
tests/test.php:		for($i=0;$i<$rs->FieldCount();$i++) 
tests/test.php:			$fld=$rs->FetchField($i); 
tests/test.php:			print "<br> Field name is ".$fld->name; 
tests/test.php:			print " ".$rs->Fields($fld->name); 
tests/test.php:	$rs = $db->query('select * from adoxyz order by id');
tests/test.php:	for($i=0;$i<$rs->FieldCount();$i++) 
tests/test.php:		$fld=$rs->FetchField($i); 
tests/test.php:		print "<br> Field name is ".$fld->name; 
tests/test.php:		print " ".$rs->Fields($fld->name); 
tests/test.php:	$rs = $db->selectlimit('select * from adoxyz order by id',3,4);
tests/test.php:	while ($rs && !$rs->EOF) {
tests/test.php:		if (!isset($rs->fields['firstname'])) {
tests/test.php:		$rs->MoveNext();
tests/test.php:	if ($db->sysDate) {
tests/test.php:		$saved = $db->debug;
tests/test.php:		$db->debug = 1;
tests/test.php:		$rs = $db->Execute("select {$db->sysDate} from adoxyz where id=1");
tests/test.php:		if (ADORecordSet::UnixDate(date('Y-m-d')) != $rs->UnixDate($rs->fields[0])) {
tests/test.php:			print "<p><b>Invalid date {$rs->fields[0]}</b></p>";
tests/test.php:			print "<p>Passed \$sysDate test ({$rs->fields[0]})</p>";
tests/test.php:		print_r($rs->FetchField(0));
tests/test.php:		$db->debug=$saved;
tests/test.php:		print "<p><b>\$db->sysDate not defined</b></p>";
tests/test.php:	$rs = $db->SelectLimit('select id,firstname,lastname,created,\'He, he\' he,\'"\' q  from adoxyz',10);	
tests/test.php:	$rs = $db->SelectLimit('select id,firstname,lastname,created,\'The	"young man", he said\' from adoxyz',10);	
tests/test.php:	//$db->CacheFlush();
tests/test.php:	$date = $db->SQLDate('d-m-M-Y-\QQ h:i:s A');
tests/test.php:	$rs = $db->SelectLimit($sql,1);
tests/test.php:	$d = date('d-m-M-Y-').'Q'.(ceil(date('m')/3.0)).date(' h:i:s A');
tests/test.php:	else if ($d != $rs->fields[0]) Err("SQLDate 1 failed expected: <br>act:$d <br>sql:".$rs->fields[0]);
tests/test.php:	$date = $db->SQLDate('d-m-M-Y-\QQ h:i:s A',$db->DBDate("1974-02-25"));
tests/test.php:	$rs = $db->SelectLimit($sql,1);
tests/test.php:	$ts = ADOConnection::UnixDate('1974-02-25');
tests/test.php:	$d = date('d-m-M-Y-',$ts).'Q'.(ceil(date('m',$ts)/3.0)).date(' h:i:s A',$ts);
tests/test.php:	else if ($d != $rs->fields[0]) Err("SQLDate 2 failed expected: <br>act:$d <br>sql:".$rs->fields[0]);
tests/test.php:	$db->debug = 1;
tests/test.php:	$rs = $db->SelectLimit('select * from ADOXYZ where id < 3 order by id');
tests/test.php:	if (trim($rs->fields[1]) != 'caroline'  && trim($rs->fields[2]) != 'miranda') {
tests/test.php:		print_r($rs->fields);
tests/test.php:	$db->debug=1;
tests/test.php:	$ret = $db->Replace('adoxyz', 
tests/test.php:		$saved = $db->debug;
tests/test.php:		$db->debug = 0;
tests/test.php:		$rs = $db->Execute('select * FROM ADOXYZ where id=1');
tests/test.php:		$db->debug = $saved;
tests/test.php:		if ($rs->RecordCount() != 1) {
tests/test.php:			$cnt = $rs->RecordCount();
tests/test.php:			print "<b>Error - Replace failed, count=$cnt</b><p>";
tests/test.php:	$ret = $db->Replace('adoxyz', 
tests/test.php:		array('id'=>1000,'firstname'=>'Harun','lastname'=>'Al-Rashid'),
tests/test.php:	$ret = $db->Replace('adoxyz', 
tests/test.php:		array('id'=>1000,'firstname'=>'Sherazade','lastname'=>'Al-Rashid'),
tests/test.php:		if ($db->dataProvider == 'ibase' && $ret == 2);
tests/test.php:	$rs = $db->Execute('select * from adoxyz order by id');
tests/test.php:	$rs = $db->_rs2rs($rs);
tests/test.php:	$rs->valueX = 'X';
tests/test.php:	$rs->MoveNext();
tests/test.php:	$rs = $db->_rs2rs($rs);
tests/test.php:	if (!isset($rs->valueX)) err("rs2rs does not preserve array recordsets");
tests/test.php:	if (reset($rs->fields) != 1) err("rs2rs does not move to first row");
tests/test.php:	$db->debug=true;
tests/test.php:	$rs = $db->Execute($sql);
tests/test.php:	$db->debug=false;
tests/test.php:	$rs = $db->query('select * from adoxyz where id>0 and id<10 order by id');
tests/test.php:	if ($rs && !$rs->EOF) {
tests/test.php:		while ($arr = $rs->fetchRow()) {
tests/test.php:		$rs->Close();
tests/test.php:	if ($i != $db->GetOne('select count(*) from adoxyz where id>0 and id<10')) {
tests/test.php:	$rs = $db->limitQuery('select * from adoxyz where id>0 order by id',$i=3,$top=3);
tests/test.php:	if ($rs && !$rs->EOF) {
tests/test.php:		while (!is_object($rs->fetchInto($arr))) {
tests/test.php:		$rs->Close();
tests/test.php:	$rs = $db->SelectLimit("select ".$db->sysDate." from adoxyz",1);
tests/test.php:	$date = $rs->fields[0];
tests/test.php:		$ds = $db->UserDate($date,"d m Y");
tests/test.php:	$db->debug=1;
tests/test.php:	if ($db->dataProvider == 'oci8') 
tests/test.php:		$rs = $db->SelectLimit("select to_char(".$db->sysTimeStamp.",'YYYY-MM-DD HH24:MI:SS') from adoxyz",1);
tests/test.php:		$rs = $db->SelectLimit("select ".$db->sysTimeStamp." from adoxyz",1);
tests/test.php:	$date = $rs->fields[0];
tests/test.php:		$ds = $db->UserTimeStamp($date,"H \\h\\r\\s-d m Y");
tests/test.php:		if ($ds != date("H \\h\\r\\s-d m Y")) Err("Bad UserTimeStamp: ".$ds.", correct is ".date("H \\h\\r\\s-d m Y"));
tests/test.php:		$ds = $db->UserTimeStamp($date,"H \\h\\r\\s-d m Y");
tests/test.php:		$ds2 = date("H \\h\\r\\s-d m Y",$date);
tests/test.php:	if ($db->hasTransactions) {
tests/test.php:		//$db->debug=1;
tests/test.php:		$db->raiseErrorFn = false;
tests/test.php:		$db->StartTrans();
tests/test.php:		$rs = $db->Execute('select * from notable');
tests/test.php:			$db->StartTrans();
tests/test.php:				$db->BeginTrans();
tests/test.php:			$db->Execute("update ADOXYZ set firstname='Carolx' where id=1");
tests/test.php:				$db->CommitTrans();
tests/test.php:			$db->CompleteTrans();
tests/test.php:		$rez = $db->CompleteTrans();
tests/test.php:			$name = $db->GetOne("Select firstname from ADOXYZ where id=1");
tests/test.php:			else echo "<p> -- Passed StartTrans test1 - rolling back</p>";
tests/test.php:		$db->StartTrans();
tests/test.php:			$db->BeginTrans();
tests/test.php:		$db->Execute("update ADOXYZ set firstname='Carolx' where id=1");
tests/test.php:			$db->RollbackTrans();
tests/test.php:		$rez = $db->CompleteTrans();
tests/test.php:			$name = $db->GetOne("Select firstname from ADOXYZ where id=1");
tests/test.php:			else echo "<p> -- Passed StartTrans test2 - commiting</p>";
tests/test.php:	$saved = $db->debug;
tests/test.php:	$db->debug=1;
tests/test.php:	$db->debug=$saved;
tests/test.php:	$db->debug = false;
tests/test.php:	$db->raiseErrorFn = 'adodb_test_err';
tests/test.php:	$db->Execute('select * from nowhere');
tests/test.php:	$metae = $db->MetaError($ERRNO);
tests/test.php:	else print "<p>MetaError ok (".DB_ERROR_NOSUCHTABLE."): ".$db->MetaErrorMsg($metae)."</p>";
tests/test.php:	$rs = $db->Execute('select * from adoxyz');
tests/test.php:	$rs->Move(100);
tests/test.php:	$rs->_queryID = false;
tests/test.php:	$rs->MoveNext();
tests/test.php:	$db->SetFetchMode(ADODB_FETCH_ASSOC);
tests/test.php:	$rs = $db->SelectLimit('select firstname from adoxyz',1);
tests/test.php:	//	var_dump($rs->fields);
tests/test.php:	if (!isset($rs->fields['firstname'])) Err("BAD FETCH ASSOC");
tests/test.php:	$rs = $db->SelectLimit('select firstname from adoxyz',1);
tests/test.php:	//var_dump($rs->fields);
tests/test.php:	if (!isset($rs->fields['firstname'])) Err("BAD FETCH ASSOC");
tests/test.php:	$db->SetFetchMode(ADODB_FETCH_NUM);
tests/test.php:	$rs = $db->SelectLimit('select firstname from adoxyz',1);
tests/test.php:	if (!isset($rs->fields[0])) Err("BAD FETCH NUM");
tests/test.php:	$db->SetFetchMode(ADODB_FETCH_ASSOC);
tests/test.php:	print_r($db->MetaTables());
tests/test.php:	if ($db->dataProvider == 'odbtp') $db->databaseType = 'odbtp';
tests/test.php:	$conn = NewADOConnection($db->databaseType);
tests/test.php:	$conn->raiseErrorFn = 'adodb_test_err';
tests/test.php:	@$conn->PConnect('abc');
tests/test.php:	if ($rs1) $rs1->Close();
tests/test.php:	if ($rs2) $rs2->Close();
tests/test.php:	if ($rs) $rs->Close();
tests/test.php:	$db->Close();
tests/test.php:	if ($db->transCnt != 0) Err("Error in transCnt=$db->transCnt (should be 0)");
tests/test.php://--------------------------------------------------------------------------------------
tests/test.php:	<a href=test-perf.php>Perf Monitor</a><p>
tests/test.php:include_once('../adodb-time.inc.php');
tests/test.php:<p><i>ADODB Database Library  (c) 2000-2004 John Lim. All rights reserved. Released under BSD and LGPL.</i></p>
tests/test-datadict.php:  V4.54 5 Nov 2004  (c) 2000-2004 John Lim (jlim@natsoft.com.my). All rights reserved.
tests/test-datadict.php:	$dict->debug = 1;
tests/test-datadict.php:	$sqla = $dict->CreateDatabase('KUTU',array('postgres'=>"LOCATION='/u01/postdata'"));
tests/test-datadict.php:	$dict->SetSchema('KUTU');
tests/test-datadict.php:	$sqli = ($dict->CreateTableSQL('testtable',$flds, $opts));
tests/test-datadict.php:	$sqli = $dict->CreateIndexSQL('idx','testtable','firstname,lastname',array('BITMAP','FULLTEXT','CLUSTERED','HASH'));
tests/test-datadict.php:	$sqli = $dict->CreateIndexSQL('idx2','testtable','price,lastname');//,array('BITMAP','FULLTEXT','CLUSTERED'));
tests/test-datadict.php:	$sqli = $dict->AddColumnSQL('testtable',$addflds);
tests/test-datadict.php:	$sqli = $dict->AlterColumnSQL('testtable',$addflds);
tests/test-datadict.php:		$db->Connect('localhost', "root", "", "test");
tests/test-datadict.php:		$dict->SetSchema('');
tests/test-datadict.php:		$sqla2 = $dict->ChangeTableSQL('adoxyz',$flds);
tests/test-datadict.php:		if (@$db->Connect('localhost', "tester", "test", "test"));
tests/test-datadict.php:		$dict->SetSchema('');
tests/test-datadict.php:		$sqla2 = $dict->ChangeTableSQL('adoxyz',$flds);
tests/test-datadict.php:		if (@$db->Connect($dsn, "sa", "natsoft", "test"));
tests/test-datadict.php:		$dict->SetSchema('');
tests/test-datadict.php:		$sqla2 = $dict->ChangeTableSQL('adoxyz',$flds);
tests/test-datadict.php:	adodb_pr($dict->databaseType);
tests/test-datadict.php:	printsqla($dbType, $dict->DropColumnSQL('table',array('`col`','col2')));
tests/test-datadict.php:	printsqla($dbType, $dict->ChangeTableSQL('adoxyz','LASTNAME varchar(32)'));
tests/test-datadict.php:	//print_r($dict->MetaTables());
tests/test-datadict.php:--------------------------------------------------------------------------------
tests/test-datadict.php:--------------------------------------------------------------------------------
tests/test-datadict.php:--------------------------------------------------------------------------------
tests/test-datadict.php:--------------------------------------------------------------------------------
tests/test-datadict.php:include_once('test-xmlschema.php');
tests/benchmark.php:<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
tests/benchmark.php:V4.54 5 Nov 2004  (c) 2000-2004 John Lim (jlim@natsoft.com.my). All rights reserved.
tests/benchmark.php:	//print "<h3>ADODB Version: $ADODB_version Host: <i>$db->host</i> &nbsp; Database: <i>$db->database</i></h3>";
tests/benchmark.php:	$rs = $db->Execute($sql);
tests/benchmark.php:	$arr = $rs->GetArray();
tests/benchmark.php:	//$db->debug = true;
tests/benchmark.php:		$rs =& $db->Execute($sql);	
tests/benchmark.php:		$arr =& $rs->GetArray();
tests/benchmark.php:	$total = $end[0]+trim($end[1]) - $start[0]-trim($start[1]);
tests/benchmark.php:		//$db->Close();
tests/testgenid.php:	$db->Execute("drop table $table");
tests/testgenid.php:	//$db->debug=true;
tests/testgenid.php:	while (--$ctr >= 0) {
tests/testgenid.php:		$num = $db->GenID($table);
tests/testdatabases.inc.php:V4.54 5 Nov 2004  (c) 2000-2004 John Lim (jlim@natsoft.com.my). All rights reserved.
tests/testdatabases.inc.php:	print "<h1>Connecting $db->databaseType...</h1>";
tests/testdatabases.inc.php:	if ($db->Connect("localhost","tester","test","test")) {
tests/testdatabases.inc.php:		print "ERROR: PostgreSQL requires a database called test on server, user tester, password test.<BR>".$db->ErrorMsg();
tests/testdatabases.inc.php:	$db->hasTransactions = false;
tests/testdatabases.inc.php:	print "<h1>Connecting $db->databaseType...</h1>";
tests/testdatabases.inc.php:	if ($db->PConnect('Postgresql')) {
tests/testdatabases.inc.php:		$db->hasTransactions = true;
tests/testdatabases.inc.php:	} else print "ERROR: PostgreSQL requires a database called test on server, user tester, password test.<BR>".$db->ErrorMsg();
tests/testdatabases.inc.php:	print "<h1>Connecting $db->databaseType...</h1>";
tests/testdatabases.inc.php:	if ($db->PConnect("localhost:d:\\firebird\\151\\examples\\EMPLOYEE.fdb", "sysdba", "masterkey", ""))
tests/testdatabases.inc.php:	 else print "ERROR: Interbase test requires a database called employee.gdb".'<BR>'.$db->ErrorMsg();
tests/testdatabases.inc.php:	print "<h1>Connecting $db->databaseType...</h1>";
tests/testdatabases.inc.php:	if ($db->PConnect("d:\\inetpub\\adodb\\sqlite.db", "", "", ""))
tests/testdatabases.inc.php:	print "<h1>Connecting $db->databaseType...</h1>";
tests/testdatabases.inc.php:	if ($db->PConnect($dsn, "", "", ""))
tests/testdatabases.inc.php:	print "<h1>Connecting $db->databaseType...</h1>";
tests/testdatabases.inc.php:	if ($db->PConnect($myDSN, "", "", "")) {
tests/testdatabases.inc.php:		print "ADO version=".$db->_connectionID->version."<br>";
tests/testdatabases.inc.php:	} else print "ERROR: Access test requires a Access database $access".'<BR>'.$db->ErrorMsg();
tests/testdatabases.inc.php:	print "<h1>Connecting $db->databaseType...</h1>";flush();
tests/testdatabases.inc.php:	if ( $db->PConnect("vfp-adoxyz")) {
tests/testdatabases.inc.php:	 } else print "ERROR: Visual FoxPro test requires a Windows ODBC DSN=vfp-adoxyz, VFP driver";
tests/testdatabases.inc.php:	if ( $db->PConnect('localhost','DRIVER={Microsoft Visual FoxPro Driver};SOURCETYPE=DBF;SOURCEDB=d:\inetpub\adodb;EXCLUSIVE=NO;')) {
tests/testdatabases.inc.php:	print "<h1>Connecting $db->databaseType...</h1>";flush();
tests/testdatabases.inc.php:	 } else print "ERROR: Visual FoxPro odbtp requires a Windows ODBC DSN=vfp-adoxyz, VFP driver";
tests/testdatabases.inc.php:	print "<h1>Connecting $db->databaseType...</h1>";
tests/testdatabases.inc.php:	if (true || $db->PConnect($server, "root", "", "northwind")) {
tests/testdatabases.inc.php:		//$db->debug=1;$db->Execute('drop table ADOXYZ');
tests/testdatabases.inc.php:	} else print "ERROR: MySQL test requires a MySQL server on localhost, userid='admin', password='', database='test'".'<BR>'.$db->ErrorMsg();
tests/testdatabases.inc.php:	print "<h1>Connecting $db->databaseType...</h1>";
tests/testdatabases.inc.php:	if ($db->PConnect($server, "root", "", "northwind")) {
tests/testdatabases.inc.php:		//$db->debug=1;$db->Execute('drop table ADOXYZ');
tests/testdatabases.inc.php:	} else print "ERROR: MySQL test requires a MySQL server on localhost, userid='admin', password='', database='test'".'<BR>'.$db->ErrorMsg();
tests/testdatabases.inc.php:	$db->hasTransactions = false;
tests/testdatabases.inc.php:	print "<h1>Connecting $db->databaseType...</h1>";
tests/testdatabases.inc.php:	if ($db->PConnect('mysql', "root", ""))
tests/testdatabases.inc.php:	else print "ERROR: MySQL test requires a MySQL server on localhost, userid='admin', password='', database='test'".'<BR>'.$db->ErrorMsg();
tests/testdatabases.inc.php:	print "<h1>Connecting $db->databaseType...</h1>";
tests/testdatabases.inc.php:	if ($db->PConnect('http://localhost/php/phplens/adodb/server.php'))
tests/testdatabases.inc.php:	else print "ERROR: MySQL test requires a MySQL server on localhost, userid='admin', password='', database='test'".'<BR>'.$db->ErrorMsg();
tests/testdatabases.inc.php:	print "<h1>Connecting $db->databaseType...</h1>";
tests/testdatabases.inc.php:	if (true || $db->Connect('', "scott", "natsoft",''))
tests/testdatabases.inc.php:	else print "ERROR: Oracle test requires an Oracle server setup with scott/natsoft".'<BR>'.$db->ErrorMsg();
tests/testdatabases.inc.php:	print "<h1>Connecting $db->databaseType...</h1>";
tests/testdatabases.inc.php:	if ($db->PConnect("", "scott", "tiger", "natsoft.domain"))
tests/testdatabases.inc.php:	else print "ERROR: Oracle test requires an Oracle server setup with scott/tiger".'<BR>'.$db->ErrorMsg();
tests/testdatabases.inc.php:	print "<h1>Connecting $db->databaseType...</h1>";
tests/testdatabases.inc.php:	if ($db->Connect($dsn)) {
tests/testdatabases.inc.php:	} else print "ERROR: DB2 test requires an server setup with odbc data source db2_sample".'<BR>'.$db->ErrorMsg();
tests/testdatabases.inc.php:	if ($db->Connect('127.0.0.1',$dsn)) {
tests/testdatabases.inc.php:		$db->debug=1;
tests/testdatabases.inc.php:		 $arr = $db->GetArray( "||SQLProcedures" ); adodb_pr($arr);
tests/testdatabases.inc.php:	     $arr = $db->GetArray( "||SQLProcedureColumns|||GET_ROUTINE_SAR" );adodb_pr($arr);
tests/testdatabases.inc.php:	echo $db->ErrorMsg();
tests/testdatabases.inc.php:	if ($db->PConnect('localhost',$dsn, "", ""))  {
tests/testdatabases.inc.php:		print "<h1>Connecting $db->databaseType...</h1>";				
tests/testdatabases.inc.php:	print "<h1>Connecting $db->databaseType...</h1>";
tests/testdatabases.inc.php:	if ($db->PConnect($dsn, "adodb", "natsoft", ""))  {
tests/testdatabases.inc.php:if (!empty($testmssql) && !empty($testado) ) { // ADO ACCESS MSSQL -- thru ODBC -- DSN-less
tests/testdatabases.inc.php:	//$db->debug=1;
tests/testdatabases.inc.php:	print "<h1>Connecting DSN-less $db->databaseType...</h1>";
tests/testdatabases.inc.php:	if ($db->PConnect($myDSN, "", "", ""))
tests/testdatabases.inc.php:if (!empty($testmssql)) { // MS SQL Server -- the extension is buggy -- probably better to use ODBC
tests/testdatabases.inc.php:	//$db->debug=1;
tests/testdatabases.inc.php:	print "<h1>Connecting $db->databaseType...</h1>";
tests/testdatabases.inc.php:	$ok = $db->Connect('','adodb','natsoft','northwind');
tests/testdatabases.inc.php:	if ($ok or $db->PConnect("mangrove", "sa", "natsoft", "ai")) {
tests/testdatabases.inc.php:	//	$db->Execute('drop table adoxyz');
tests/testdatabases.inc.php:	} else print "ERROR: MSSQL test 2 requires a MS SQL 7 on a server='192.168.0.1', userid='adodb', password='natsoft', database='ai'".'<BR>'.$db->ErrorMsg();
tests/testdatabases.inc.php:	print "<h1>Connecting DSN-less OLEDB Provider $db->databaseType...</h1>";
tests/testdatabases.inc.php:	//$db->debug=1;
tests/testdatabases.inc.php:	if ($db->PConnect($myDSN, "adodb", "natsoft", 'SQLOLEDB')) {
tests/test_rs_array.php:$rs->InitArray($array,$typearr);
tests/test_rs_array.php:while (!$rs->EOF) {
tests/test_rs_array.php:	print_r($rs->fields);echo "<br>";
tests/test_rs_array.php:	$rs->MoveNext();
tests/test_rs_array.php:$rs->Move(1);
tests/test_rs_array.php:while (!$rs->EOF) {
tests/test_rs_array.php:	print_r($rs->fields);echo "<br>";
tests/test_rs_array.php:	$rs->MoveNext();
tests/test_rs_array.php:$rs->Move(2);
tests/test_rs_array.php:while (!$rs->EOF) {
tests/test_rs_array.php:	print_r($rs->fields);echo "<br>";
tests/test_rs_array.php:	$rs->MoveNext();
tests/test_rs_array.php:$rs->Move(3);
tests/test_rs_array.php:while (!$rs->EOF) {
tests/test_rs_array.php:	print_r($rs->fields);echo "<br>";
tests/test_rs_array.php:	$rs->MoveNext();
toexport.inc.php: * @version V4.54 5 Nov 2004 (c) 2000-2004 John Lim (jlim@natsoft.com.my). All rights reserved.
toexport.inc.php: * $s = rs2csv($rs); # comma-separated values
toexport.inc.php:	//----------
toexport.inc.php:		$fieldTypes = $rs->FieldTypesArray();
toexport.inc.php:			$v = $o->name;
toexport.inc.php:	$hasNumIndex = isset($rs->fields[0]);
toexport.inc.php:	$max = $rs->FieldCount();
toexport.inc.php:	while (!$rs->EOF) {
toexport.inc.php:				$v = $rs->fields[$j];
toexport.inc.php:			foreach($rs->fields as $v) {
toexport.inc.php:		$rs->MoveNext();
tohtml.inc.php:  V4.54 5 Nov 2004  (c) 2000-2004 John Lim (jlim@natsoft.com.my). All rights reserved.
tohtml.inc.php:  Some pretty-printing by Chris Oxenreider <oxenreid@state.net>
tohtml.inc.php://------------------------------------------------------------
tohtml.inc.php://	$db->Connect('mysql','userid','password','database');
tohtml.inc.php://	$rs = $db->Execute('select col1,col2,col3 from table');
tohtml.inc.php://	$rs->Close();
tohtml.inc.php:	$ncols = $rs->FieldCount();
tohtml.inc.php:		$field = $rs->FetchField($i);
tohtml.inc.php:		else $fname = htmlspecialchars($field->name);	
tohtml.inc.php:		$typearr[$i] = $rs->MetaType($field->type,$field->max_length);
tohtml.inc.php: 		//print " $field->name $field->type $typearr[$i] ";
tohtml.inc.php:	// smart algorithm - handles ADODB_FETCH_MODE's correctly by probing...
tohtml.inc.php:	$numoffset = isset($rs->fields[0]) ||isset($rs->fields[1]) || isset($rs->fields[2]);
tohtml.inc.php:	while (!$rs->EOF) {
tohtml.inc.php:			if ($i===0) $v=($numoffset) ? $rs->fields[0] : reset($rs->fields);
tohtml.inc.php:			else $v = ($numoffset) ? $rs->fields[$i] : next($rs->fields);
tohtml.inc.php:					$s .= "	<TD>".$rs->UserDate($v,"D d, M Y") ."&nbsp;</TD>\n";
tohtml.inc.php:				$s .= "	<TD>".$rs->UserTimeStamp($v,"D d, M Y, h:i:s") ."&nbsp;</TD>\n";
tohtml.inc.php:				    return exec("file -bi ".escapeshellarg($file));
tohtml.inc.php:		$rs->MoveNext();
tohtml.inc.php:		if (!$rs->EOF && $rows % $gSQLBlockRows == 0) {
xsl/convert-0.2-0.1.xsl:<?xml version="1.0" encoding="UTF-8"?>
xsl/convert-0.2-0.1.xsl:	<xsl:output method="xml" indent="yes" omit-xml-declaration="no" encoding="UTF-8"/>
xsl/convert-0.2-0.1.xsl:	<!-- Schema -->
xsl/convert-0.2-0.1.xsl:http://adodb-xmlschema.sourceforge.net
xsl/convert-0.2-0.1.xsl:			<xsl:apply-templates select="schema/table|schema/sql"/>
xsl/convert-0.2-0.1.xsl:	<!-- Table -->
xsl/convert-0.2-0.1.xsl:			<xsl:attribute name="name"><xsl:value-of select="$table_name"/></xsl:attribute>
xsl/convert-0.2-0.1.xsl:			<xsl:if test="string-length(@platform) > 0">
xsl/convert-0.2-0.1.xsl:				<xsl:attribute name="platform"><xsl:value-of select="@platform"/></xsl:attribute>
xsl/convert-0.2-0.1.xsl:			<xsl:if test="string-length(@version) > 0">
xsl/convert-0.2-0.1.xsl:				<xsl:attribute name="version"><xsl:value-of select="@version"/></xsl:attribute>
xsl/convert-0.2-0.1.xsl:			<xsl:apply-templates select="descr[1]"/>
xsl/convert-0.2-0.1.xsl:					<xsl:apply-templates select="field"/>
xsl/convert-0.2-0.1.xsl:			<xsl:apply-templates select="constraint"/>
xsl/convert-0.2-0.1.xsl:		<xsl:apply-templates select="index"/>
xsl/convert-0.2-0.1.xsl:	<!-- Field -->
xsl/convert-0.2-0.1.xsl:			<xsl:attribute name="name"><xsl:value-of select="@name"/></xsl:attribute>
xsl/convert-0.2-0.1.xsl:			<xsl:attribute name="type"><xsl:value-of select="@type"/></xsl:attribute>
xsl/convert-0.2-0.1.xsl:			<xsl:if test="string-length(@size) > 0">
xsl/convert-0.2-0.1.xsl:				<xsl:attribute name="size"><xsl:value-of select="@size"/></xsl:attribute>
xsl/convert-0.2-0.1.xsl:							<xsl:value-of select="DEFAULT[1]/@value"/>
xsl/convert-0.2-0.1.xsl:							<xsl:value-of select="DEFDATE[1]/@value"/>
xsl/convert-0.2-0.1.xsl:							<xsl:value-of select="DEFTIMESTAMP[1]/@value"/>
xsl/convert-0.2-0.1.xsl:			<xsl:apply-templates select="constraint"/>
xsl/convert-0.2-0.1.xsl:	<!-- Constraint -->
xsl/convert-0.2-0.1.xsl:			<xsl:value-of select="normalize-space(text())"/>
xsl/convert-0.2-0.1.xsl:	<!-- Index -->
xsl/convert-0.2-0.1.xsl:			<xsl:attribute name="name"><xsl:value-of select="@name"/></xsl:attribute>
xsl/convert-0.2-0.1.xsl:			<xsl:attribute name="table"><xsl:value-of select="../@name"/></xsl:attribute>
xsl/convert-0.2-0.1.xsl:			<xsl:apply-templates select="descr[1]"/>
xsl/convert-0.2-0.1.xsl:					<xsl:apply-templates select="col"/>
xsl/convert-0.2-0.1.xsl:	<!-- Index Column -->
xsl/convert-0.2-0.1.xsl:			<xsl:value-of select="normalize-space(text())"/>
xsl/convert-0.2-0.1.xsl:	<!-- SQL QuerySet -->
xsl/convert-0.2-0.1.xsl:			<xsl:if test="string-length(@platform) > 0">
xsl/convert-0.2-0.1.xsl:				<xsl:attribute name="platform"><xsl:value-of select="@platform"/></xsl:attribute>
xsl/convert-0.2-0.1.xsl:			<xsl:if test="string-length(@key) > 0">
xsl/convert-0.2-0.1.xsl:				<xsl:attribute name="key"><xsl:value-of select="@key"/></xsl:attribute>
xsl/convert-0.2-0.1.xsl:			<xsl:if test="string-length(@prefixmethod) > 0">
xsl/convert-0.2-0.1.xsl:				<xsl:attribute name="prefixmethod"><xsl:value-of select="@prefixmethod"/></xsl:attribute>
xsl/convert-0.2-0.1.xsl:			<xsl:apply-templates select="descr[1]"/>
xsl/convert-0.2-0.1.xsl:			<xsl:apply-templates select="query"/>
xsl/convert-0.2-0.1.xsl:	<!-- Query -->
xsl/convert-0.2-0.1.xsl:			<xsl:if test="string-length(@platform) > 0">
xsl/convert-0.2-0.1.xsl:				<xsl:attribute name="platform"><xsl:value-of select="@platform"/></xsl:attribute>
xsl/convert-0.2-0.1.xsl:			<xsl:value-of select="normalize-space(text())"/>
xsl/convert-0.2-0.1.xsl:	<!-- Description -->
xsl/convert-0.2-0.1.xsl:			<xsl:value-of select="normalize-space(text())"/>
xsl/remove-0.2.xsl:<?xml version="1.0" encoding="UTF-8"?>
xsl/remove-0.2.xsl:	<xsl:output method="xml" indent="yes" omit-xml-declaration="no" encoding="UTF-8"/>
xsl/remove-0.2.xsl:	<!-- Schema -->
xsl/remove-0.2.xsl:http://adodb-xmlschema.sourceforge.net
xsl/remove-0.2.xsl:			<xsl:apply-templates select="schema/table">
xsl/remove-0.2.xsl:				<xsl:sort select="position()" data-type="number" order="descending"/>
xsl/remove-0.2.xsl:			</xsl:apply-templates>
xsl/remove-0.2.xsl:	<!-- Table -->
xsl/remove-0.2.xsl:				<xsl:attribute name="name"><xsl:value-of select="@name"/></xsl:attribute>
xsl/remove-0.2.xsl:				<xsl:if test="string-length(@platform) > 0">
xsl/remove-0.2.xsl:					<xsl:attribute name="platform"><xsl:value-of select="@platform"/></xsl:attribute>
xsl/remove-0.2.xsl:				<xsl:if test="string-length(@version) > 0">
xsl/remove-0.2.xsl:					<xsl:attribute name="version"><xsl:value-of select="@version"/></xsl:attribute>
xsl/remove-0.2.xsl:				<xsl:apply-templates select="descr[1]"/>
xsl/remove-0.2.xsl:	<!-- Description -->
xsl/remove-0.2.xsl:			<xsl:value-of select="normalize-space(text())"/>
xsl/convert-0.1-0.2.xsl:<?xml version="1.0" encoding="UTF-8"?>
xsl/convert-0.1-0.2.xsl:	<xsl:output method="xml" indent="yes" omit-xml-declaration="no" encoding="UTF-8"/>
xsl/convert-0.1-0.2.xsl:	<!-- Schema -->
xsl/convert-0.1-0.2.xsl:http://adodb-xmlschema.sourceforge.net
xsl/convert-0.1-0.2.xsl:			<xsl:apply-templates select="schema/table|schema/sql"/>
xsl/convert-0.1-0.2.xsl:	<!-- Table -->
xsl/convert-0.1-0.2.xsl:			<xsl:attribute name="name"><xsl:value-of select="$table_name"/></xsl:attribute>
xsl/convert-0.1-0.2.xsl:			<xsl:if test="string-length(@platform) > 0">
xsl/convert-0.1-0.2.xsl:				<xsl:attribute name="platform"><xsl:value-of select="@platform"/></xsl:attribute>
xsl/convert-0.1-0.2.xsl:			<xsl:if test="string-length(@version) > 0">
xsl/convert-0.1-0.2.xsl:				<xsl:attribute name="version"><xsl:value-of select="@version"/></xsl:attribute>
xsl/convert-0.1-0.2.xsl:			<xsl:apply-templates select="descr[1]"/>
xsl/convert-0.1-0.2.xsl:					<xsl:apply-templates select="field"/>
xsl/convert-0.1-0.2.xsl:			<xsl:apply-templates select="constraint"/>
xsl/convert-0.1-0.2.xsl:			<xsl:apply-templates select="../index[@table=$table_name]"/>
xsl/convert-0.1-0.2.xsl:	<!-- Field -->
xsl/convert-0.1-0.2.xsl:			<xsl:attribute name="name"><xsl:value-of select="@name"/></xsl:attribute>
xsl/convert-0.1-0.2.xsl:			<xsl:attribute name="type"><xsl:value-of select="@type"/></xsl:attribute>
xsl/convert-0.1-0.2.xsl:			<xsl:if test="string-length(@size) > 0">
xsl/convert-0.1-0.2.xsl:				<xsl:attribute name="size"><xsl:value-of select="@size"/></xsl:attribute>
xsl/convert-0.1-0.2.xsl:							<xsl:value-of select="DEFAULT[1]/@value"/>
xsl/convert-0.1-0.2.xsl:							<xsl:value-of select="DEFDATE[1]/@value"/>
xsl/convert-0.1-0.2.xsl:							<xsl:value-of select="DEFTIMESTAMP[1]/@value"/>
xsl/convert-0.1-0.2.xsl:			<xsl:apply-templates select="constraint"/>
xsl/convert-0.1-0.2.xsl:	<!-- Constraint -->
xsl/convert-0.1-0.2.xsl:			<xsl:value-of select="normalize-space(text())"/>
xsl/convert-0.1-0.2.xsl:	<!-- Index -->
xsl/convert-0.1-0.2.xsl:			<xsl:attribute name="name"><xsl:value-of select="@name"/></xsl:attribute>
xsl/convert-0.1-0.2.xsl:			<xsl:apply-templates select="descr[1]"/>
xsl/convert-0.1-0.2.xsl:					<xsl:apply-templates select="col"/>
xsl/convert-0.1-0.2.xsl:	<!-- Index Column -->
xsl/convert-0.1-0.2.xsl:			<xsl:value-of select="normalize-space(text())"/>
xsl/convert-0.1-0.2.xsl:	<!-- SQL QuerySet -->
xsl/convert-0.1-0.2.xsl:			<xsl:if test="string-length(@platform) > 0">
xsl/convert-0.1-0.2.xsl:				<xsl:attribute name="platform"><xsl:value-of select="@platform"/></xsl:attribute>
xsl/convert-0.1-0.2.xsl:			<xsl:if test="string-length(@key) > 0">
xsl/convert-0.1-0.2.xsl:				<xsl:attribute name="key"><xsl:value-of select="@key"/></xsl:attribute>
xsl/convert-0.1-0.2.xsl:			<xsl:if test="string-length(@prefixmethod) > 0">
xsl/convert-0.1-0.2.xsl:				<xsl:attribute name="prefixmethod"><xsl:value-of select="@prefixmethod"/></xsl:attribute>
xsl/convert-0.1-0.2.xsl:			<xsl:apply-templates select="descr[1]"/>
xsl/convert-0.1-0.2.xsl:			<xsl:apply-templates select="query"/>
xsl/convert-0.1-0.2.xsl:	<!-- Query -->
xsl/convert-0.1-0.2.xsl:			<xsl:if test="string-length(@platform) > 0">
xsl/convert-0.1-0.2.xsl:				<xsl:attribute name="platform"><xsl:value-of select="@platform"/></xsl:attribute>
xsl/convert-0.1-0.2.xsl:			<xsl:value-of select="normalize-space(text())"/>
xsl/convert-0.1-0.2.xsl:	<!-- Description -->
xsl/convert-0.1-0.2.xsl:			<xsl:value-of select="normalize-space(text())"/>
